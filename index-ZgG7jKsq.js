(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const u of a)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(a){const u={};return a.integrity&&(u.integrity=a.integrity),a.referrerPolicy&&(u.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?u.credentials="include":a.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(a){if(a.ep)return;a.ep=!0;const u=n(a);fetch(a.href,u)}})();/* @license twgl.js 5.5.3 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */let VecType=Float32Array;function create$1(m,t,n){const r=new VecType(3);return m&&(r[0]=m),t&&(r[1]=t),n&&(r[2]=n),r}function subtract(m,t,n){return n=n||new VecType(3),n[0]=m[0]-t[0],n[1]=m[1]-t[1],n[2]=m[2]-t[2],n}function cross(m,t,n){n=n||new VecType(3);const r=m[2]*t[0]-m[0]*t[2],a=m[0]*t[1]-m[1]*t[0];return n[0]=m[1]*t[2]-m[2]*t[1],n[1]=r,n[2]=a,n}function normalize$1(m,t){t=t||new VecType(3);const n=m[0]*m[0]+m[1]*m[1]+m[2]*m[2],r=Math.sqrt(n);return r>1e-5?(t[0]=m[0]/r,t[1]=m[1]/r,t[2]=m[2]/r):(t[0]=0,t[1]=0,t[2]=0),t}let MatType=Float32Array;function setDefaultType(m){const t=MatType;return MatType=m,t}function negate(m,t){return t=t||new MatType(16),t[0]=-m[0],t[1]=-m[1],t[2]=-m[2],t[3]=-m[3],t[4]=-m[4],t[5]=-m[5],t[6]=-m[6],t[7]=-m[7],t[8]=-m[8],t[9]=-m[9],t[10]=-m[10],t[11]=-m[11],t[12]=-m[12],t[13]=-m[13],t[14]=-m[14],t[15]=-m[15],t}function create(){return new MatType(16).fill(0)}function copy(m,t){return t=t||new MatType(16),t[0]=m[0],t[1]=m[1],t[2]=m[2],t[3]=m[3],t[4]=m[4],t[5]=m[5],t[6]=m[6],t[7]=m[7],t[8]=m[8],t[9]=m[9],t[10]=m[10],t[11]=m[11],t[12]=m[12],t[13]=m[13],t[14]=m[14],t[15]=m[15],t}function identity(m){return m=m||new MatType(16),m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=1,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m}function transpose(m,t){if(t=t||new MatType(16),t===m){let _;return _=m[1],m[1]=m[4],m[4]=_,_=m[2],m[2]=m[8],m[8]=_,_=m[3],m[3]=m[12],m[12]=_,_=m[6],m[6]=m[9],m[9]=_,_=m[7],m[7]=m[13],m[13]=_,_=m[11],m[11]=m[14],m[14]=_,t}const n=m[0*4+0],r=m[0*4+1],a=m[0*4+2],u=m[0*4+3],h=m[1*4+0],f=m[1*4+1],d=m[1*4+2],p=m[1*4+3],c=m[2*4+0],o=m[2*4+1],e=m[2*4+2],s=m[2*4+3],l=m[3*4+0],g=m[3*4+1],y=m[3*4+2],b=m[3*4+3];return t[0]=n,t[1]=h,t[2]=c,t[3]=l,t[4]=r,t[5]=f,t[6]=o,t[7]=g,t[8]=a,t[9]=d,t[10]=e,t[11]=y,t[12]=u,t[13]=p,t[14]=s,t[15]=b,t}function inverse(m,t){t=t||new MatType(16);const n=m[0*4+0],r=m[0*4+1],a=m[0*4+2],u=m[0*4+3],h=m[1*4+0],f=m[1*4+1],d=m[1*4+2],p=m[1*4+3],c=m[2*4+0],o=m[2*4+1],e=m[2*4+2],s=m[2*4+3],l=m[3*4+0],g=m[3*4+1],y=m[3*4+2],b=m[3*4+3],_=e*b,v=y*s,T=d*b,w=y*p,A=d*s,S=e*p,O=a*b,C=y*u,D=a*s,$=e*u,L=a*p,P=d*u,B=c*g,I=l*o,M=h*g,k=l*f,X=h*o,G=c*f,J=n*g,Y=l*r,Q=n*o,tt=c*r,nt=n*f,ot=h*r,lt=_*f+w*o+A*g-(v*f+T*o+S*g),ut=v*r+O*o+$*g-(_*r+C*o+D*g),gt=T*r+C*f+L*g-(w*r+O*f+P*g),xt=S*r+D*f+P*o-(A*r+$*f+L*o),pt=1/(n*lt+h*ut+c*gt+l*xt);return t[0]=pt*lt,t[1]=pt*ut,t[2]=pt*gt,t[3]=pt*xt,t[4]=pt*(v*h+T*c+S*l-(_*h+w*c+A*l)),t[5]=pt*(_*n+C*c+D*l-(v*n+O*c+$*l)),t[6]=pt*(w*n+O*h+P*l-(T*n+C*h+L*l)),t[7]=pt*(A*n+$*h+L*c-(S*n+D*h+P*c)),t[8]=pt*(B*p+k*s+X*b-(I*p+M*s+G*b)),t[9]=pt*(I*u+J*s+tt*b-(B*u+Y*s+Q*b)),t[10]=pt*(M*u+Y*p+nt*b-(k*u+J*p+ot*b)),t[11]=pt*(G*u+Q*p+ot*s-(X*u+tt*p+nt*s)),t[12]=pt*(M*e+G*y+I*d-(X*y+B*d+k*e)),t[13]=pt*(Q*y+B*a+Y*e-(J*e+tt*y+I*a)),t[14]=pt*(J*d+ot*y+k*a-(nt*y+M*a+Y*d)),t[15]=pt*(nt*e+X*a+tt*d-(Q*d+ot*e+G*a)),t}function multiply(m,t,n){n=n||new MatType(16);const r=m[0],a=m[1],u=m[2],h=m[3],f=m[4],d=m[5],p=m[6],c=m[7],o=m[8],e=m[9],s=m[10],l=m[11],g=m[12],y=m[13],b=m[14],_=m[15],v=t[0],T=t[1],w=t[2],A=t[3],S=t[4],O=t[5],C=t[6],D=t[7],$=t[8],L=t[9],P=t[10],B=t[11],I=t[12],M=t[13],k=t[14],X=t[15];return n[0]=r*v+f*T+o*w+g*A,n[1]=a*v+d*T+e*w+y*A,n[2]=u*v+p*T+s*w+b*A,n[3]=h*v+c*T+l*w+_*A,n[4]=r*S+f*O+o*C+g*D,n[5]=a*S+d*O+e*C+y*D,n[6]=u*S+p*O+s*C+b*D,n[7]=h*S+c*O+l*C+_*D,n[8]=r*$+f*L+o*P+g*B,n[9]=a*$+d*L+e*P+y*B,n[10]=u*$+p*L+s*P+b*B,n[11]=h*$+c*L+l*P+_*B,n[12]=r*I+f*M+o*k+g*X,n[13]=a*I+d*M+e*k+y*X,n[14]=u*I+p*M+s*k+b*X,n[15]=h*I+c*M+l*k+_*X,n}function setTranslation(m,t,n){return n=n||identity(),m!==n&&(n[0]=m[0],n[1]=m[1],n[2]=m[2],n[3]=m[3],n[4]=m[4],n[5]=m[5],n[6]=m[6],n[7]=m[7],n[8]=m[8],n[9]=m[9],n[10]=m[10],n[11]=m[11]),n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function getTranslation(m,t){return t=t||create$1(),t[0]=m[12],t[1]=m[13],t[2]=m[14],t}function getAxis(m,t,n){n=n||create$1();const r=t*4;return n[0]=m[r+0],n[1]=m[r+1],n[2]=m[r+2],n}function setAxis(m,t,n,r){r!==m&&(r=copy(m,r));const a=n*4;return r[a+0]=t[0],r[a+1]=t[1],r[a+2]=t[2],r}function perspective(m,t,n,r,a){a=a||new MatType(16);const u=Math.tan(Math.PI*.5-.5*m),h=1/(n-r);return a[0]=u/t,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=u,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(n+r)*h,a[11]=-1,a[12]=0,a[13]=0,a[14]=n*r*h*2,a[15]=0,a}function ortho(m,t,n,r,a,u,h){return h=h||new MatType(16),h[0]=2/(t-m),h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=2/(r-n),h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2/(a-u),h[11]=0,h[12]=(t+m)/(m-t),h[13]=(r+n)/(n-r),h[14]=(u+a)/(a-u),h[15]=1,h}function frustum(m,t,n,r,a,u,h){h=h||new MatType(16);const f=t-m,d=r-n,p=a-u;return h[0]=2*a/f,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=2*a/d,h[6]=0,h[7]=0,h[8]=(m+t)/f,h[9]=(r+n)/d,h[10]=u/p,h[11]=-1,h[12]=0,h[13]=0,h[14]=a*u/p,h[15]=0,h}let xAxis,yAxis,zAxis;function lookAt(m,t,n,r){return r=r||new MatType(16),xAxis=xAxis||create$1(),yAxis=yAxis||create$1(),zAxis=zAxis||create$1(),normalize$1(subtract(m,t,zAxis),zAxis),normalize$1(cross(n,zAxis,xAxis),xAxis),normalize$1(cross(zAxis,xAxis,yAxis),yAxis),r[0]=xAxis[0],r[1]=xAxis[1],r[2]=xAxis[2],r[3]=0,r[4]=yAxis[0],r[5]=yAxis[1],r[6]=yAxis[2],r[7]=0,r[8]=zAxis[0],r[9]=zAxis[1],r[10]=zAxis[2],r[11]=0,r[12]=m[0],r[13]=m[1],r[14]=m[2],r[15]=1,r}function translation(m,t){return t=t||new MatType(16),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=m[0],t[13]=m[1],t[14]=m[2],t[15]=1,t}function translate(m,t,n){n=n||new MatType(16);const r=t[0],a=t[1],u=t[2],h=m[0],f=m[1],d=m[2],p=m[3],c=m[1*4+0],o=m[1*4+1],e=m[1*4+2],s=m[1*4+3],l=m[2*4+0],g=m[2*4+1],y=m[2*4+2],b=m[2*4+3],_=m[3*4+0],v=m[3*4+1],T=m[3*4+2],w=m[3*4+3];return m!==n&&(n[0]=h,n[1]=f,n[2]=d,n[3]=p,n[4]=c,n[5]=o,n[6]=e,n[7]=s,n[8]=l,n[9]=g,n[10]=y,n[11]=b),n[12]=h*r+c*a+l*u+_,n[13]=f*r+o*a+g*u+v,n[14]=d*r+e*a+y*u+T,n[15]=p*r+s*a+b*u+w,n}function rotationX(m,t){t=t||new MatType(16);const n=Math.cos(m),r=Math.sin(m);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rotateX(m,t,n){n=n||new MatType(16);const r=m[4],a=m[5],u=m[6],h=m[7],f=m[8],d=m[9],p=m[10],c=m[11],o=Math.cos(t),e=Math.sin(t);return n[4]=o*r+e*f,n[5]=o*a+e*d,n[6]=o*u+e*p,n[7]=o*h+e*c,n[8]=o*f-e*r,n[9]=o*d-e*a,n[10]=o*p-e*u,n[11]=o*c-e*h,m!==n&&(n[0]=m[0],n[1]=m[1],n[2]=m[2],n[3]=m[3],n[12]=m[12],n[13]=m[13],n[14]=m[14],n[15]=m[15]),n}function rotationY(m,t){t=t||new MatType(16);const n=Math.cos(m),r=Math.sin(m);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rotateY(m,t,n){n=n||new MatType(16);const r=m[0*4+0],a=m[0*4+1],u=m[0*4+2],h=m[0*4+3],f=m[2*4+0],d=m[2*4+1],p=m[2*4+2],c=m[2*4+3],o=Math.cos(t),e=Math.sin(t);return n[0]=o*r-e*f,n[1]=o*a-e*d,n[2]=o*u-e*p,n[3]=o*h-e*c,n[8]=o*f+e*r,n[9]=o*d+e*a,n[10]=o*p+e*u,n[11]=o*c+e*h,m!==n&&(n[4]=m[4],n[5]=m[5],n[6]=m[6],n[7]=m[7],n[12]=m[12],n[13]=m[13],n[14]=m[14],n[15]=m[15]),n}function rotationZ(m,t){t=t||new MatType(16);const n=Math.cos(m),r=Math.sin(m);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rotateZ(m,t,n){n=n||new MatType(16);const r=m[0*4+0],a=m[0*4+1],u=m[0*4+2],h=m[0*4+3],f=m[1*4+0],d=m[1*4+1],p=m[1*4+2],c=m[1*4+3],o=Math.cos(t),e=Math.sin(t);return n[0]=o*r+e*f,n[1]=o*a+e*d,n[2]=o*u+e*p,n[3]=o*h+e*c,n[4]=o*f-e*r,n[5]=o*d-e*a,n[6]=o*p-e*u,n[7]=o*c-e*h,m!==n&&(n[8]=m[8],n[9]=m[9],n[10]=m[10],n[11]=m[11],n[12]=m[12],n[13]=m[13],n[14]=m[14],n[15]=m[15]),n}function axisRotation(m,t,n){n=n||new MatType(16);let r=m[0],a=m[1],u=m[2];const h=Math.sqrt(r*r+a*a+u*u);r/=h,a/=h,u/=h;const f=r*r,d=a*a,p=u*u,c=Math.cos(t),o=Math.sin(t),e=1-c;return n[0]=f+(1-f)*c,n[1]=r*a*e+u*o,n[2]=r*u*e-a*o,n[3]=0,n[4]=r*a*e-u*o,n[5]=d+(1-d)*c,n[6]=a*u*e+r*o,n[7]=0,n[8]=r*u*e+a*o,n[9]=a*u*e-r*o,n[10]=p+(1-p)*c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function axisRotate(m,t,n,r){r=r||new MatType(16);let a=t[0],u=t[1],h=t[2];const f=Math.sqrt(a*a+u*u+h*h);a/=f,u/=f,h/=f;const d=a*a,p=u*u,c=h*h,o=Math.cos(n),e=Math.sin(n),s=1-o,l=d+(1-d)*o,g=a*u*s+h*e,y=a*h*s-u*e,b=a*u*s-h*e,_=p+(1-p)*o,v=u*h*s+a*e,T=a*h*s+u*e,w=u*h*s-a*e,A=c+(1-c)*o,S=m[0],O=m[1],C=m[2],D=m[3],$=m[4],L=m[5],P=m[6],B=m[7],I=m[8],M=m[9],k=m[10],X=m[11];return r[0]=l*S+g*$+y*I,r[1]=l*O+g*L+y*M,r[2]=l*C+g*P+y*k,r[3]=l*D+g*B+y*X,r[4]=b*S+_*$+v*I,r[5]=b*O+_*L+v*M,r[6]=b*C+_*P+v*k,r[7]=b*D+_*B+v*X,r[8]=T*S+w*$+A*I,r[9]=T*O+w*L+A*M,r[10]=T*C+w*P+A*k,r[11]=T*D+w*B+A*X,m!==r&&(r[12]=m[12],r[13]=m[13],r[14]=m[14],r[15]=m[15]),r}function scaling(m,t){return t=t||new MatType(16),t[0]=m[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=m[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=m[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function scale(m,t,n){n=n||new MatType(16);const r=t[0],a=t[1],u=t[2];return n[0]=r*m[0*4+0],n[1]=r*m[0*4+1],n[2]=r*m[0*4+2],n[3]=r*m[0*4+3],n[4]=a*m[1*4+0],n[5]=a*m[1*4+1],n[6]=a*m[1*4+2],n[7]=a*m[1*4+3],n[8]=u*m[2*4+0],n[9]=u*m[2*4+1],n[10]=u*m[2*4+2],n[11]=u*m[2*4+3],m!==n&&(n[12]=m[12],n[13]=m[13],n[14]=m[14],n[15]=m[15]),n}function transformPoint(m,t,n){n=n||create$1();const r=t[0],a=t[1],u=t[2],h=r*m[0*4+3]+a*m[1*4+3]+u*m[2*4+3]+m[3*4+3];return n[0]=(r*m[0*4+0]+a*m[1*4+0]+u*m[2*4+0]+m[3*4+0])/h,n[1]=(r*m[0*4+1]+a*m[1*4+1]+u*m[2*4+1]+m[3*4+1])/h,n[2]=(r*m[0*4+2]+a*m[1*4+2]+u*m[2*4+2]+m[3*4+2])/h,n}function transformDirection(m,t,n){n=n||create$1();const r=t[0],a=t[1],u=t[2];return n[0]=r*m[0*4+0]+a*m[1*4+0]+u*m[2*4+0],n[1]=r*m[0*4+1]+a*m[1*4+1]+u*m[2*4+1],n[2]=r*m[0*4+2]+a*m[1*4+2]+u*m[2*4+2],n}function transformNormal$1(m,t,n){n=n||create$1();const r=inverse(m),a=t[0],u=t[1],h=t[2];return n[0]=a*r[0*4+0]+u*r[0*4+1]+h*r[0*4+2],n[1]=a*r[1*4+0]+u*r[1*4+1]+h*r[1*4+2],n[2]=a*r[2*4+0]+u*r[2*4+1]+h*r[2*4+2],n}var m4=Object.freeze({__proto__:null,axisRotate,axisRotation,copy,create,frustum,getAxis,getTranslation,identity,inverse,lookAt,multiply,negate,ortho,perspective,rotateX,rotateY,rotateZ,rotationX,rotationY,rotationZ,scale,scaling,setAxis,setDefaultType,setTranslation,transformDirection,transformNormal:transformNormal$1,transformPoint,translate,translation,transpose});const BYTE$2=5120,UNSIGNED_BYTE$3=5121,SHORT$2=5122,UNSIGNED_SHORT$3=5123,INT$3=5124,UNSIGNED_INT$3=5125,FLOAT$3=5126,UNSIGNED_SHORT_4_4_4_4$1=32819,UNSIGNED_SHORT_5_5_5_1$1=32820,UNSIGNED_SHORT_5_6_5$1=33635,HALF_FLOAT$1=5131,UNSIGNED_INT_2_10_10_10_REV$1=33640,UNSIGNED_INT_10F_11F_11F_REV$1=35899,UNSIGNED_INT_5_9_9_9_REV$1=35902,FLOAT_32_UNSIGNED_INT_24_8_REV$1=36269,UNSIGNED_INT_24_8$1=34042,glTypeToTypedArray={};{const m=glTypeToTypedArray;m[BYTE$2]=Int8Array,m[UNSIGNED_BYTE$3]=Uint8Array,m[SHORT$2]=Int16Array,m[UNSIGNED_SHORT$3]=Uint16Array,m[INT$3]=Int32Array,m[UNSIGNED_INT$3]=Uint32Array,m[FLOAT$3]=Float32Array,m[UNSIGNED_SHORT_4_4_4_4$1]=Uint16Array,m[UNSIGNED_SHORT_5_5_5_1$1]=Uint16Array,m[UNSIGNED_SHORT_5_6_5$1]=Uint16Array,m[HALF_FLOAT$1]=Uint16Array,m[UNSIGNED_INT_2_10_10_10_REV$1]=Uint32Array,m[UNSIGNED_INT_10F_11F_11F_REV$1]=Uint32Array,m[UNSIGNED_INT_5_9_9_9_REV$1]=Uint32Array,m[FLOAT_32_UNSIGNED_INT_24_8_REV$1]=Uint32Array,m[UNSIGNED_INT_24_8$1]=Uint32Array}function getGLTypeForTypedArray(m){if(m instanceof Int8Array)return BYTE$2;if(m instanceof Uint8Array||m instanceof Uint8ClampedArray)return UNSIGNED_BYTE$3;if(m instanceof Int16Array)return SHORT$2;if(m instanceof Uint16Array)return UNSIGNED_SHORT$3;if(m instanceof Int32Array)return INT$3;if(m instanceof Uint32Array)return UNSIGNED_INT$3;if(m instanceof Float32Array)return FLOAT$3;throw new Error("unsupported typed array type")}function getGLTypeForTypedArrayType(m){if(m===Int8Array)return BYTE$2;if(m===Uint8Array||m===Uint8ClampedArray)return UNSIGNED_BYTE$3;if(m===Int16Array)return SHORT$2;if(m===Uint16Array)return UNSIGNED_SHORT$3;if(m===Int32Array)return INT$3;if(m===Uint32Array)return UNSIGNED_INT$3;if(m===Float32Array)return FLOAT$3;throw new Error("unsupported typed array type")}function getTypedArrayTypeForGLType(m){const t=glTypeToTypedArray[m];if(!t)throw new Error("unknown gl type");return t}const isArrayBuffer$1=typeof SharedArrayBuffer<"u"?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer};function copyExistingProperties(m,t){Object.keys(t).forEach(function(n){t.hasOwnProperty(n)&&m.hasOwnProperty(n)&&(t[n]=m[n])})}function error$1(...m){console.error(...m)}const isTypeWeakMaps=new Map;function isType(m,t){if(!m||typeof m!="object")return!1;let n=isTypeWeakMaps.get(t);n||(n=new WeakMap,isTypeWeakMaps.set(t,n));let r=n.get(m);if(r===void 0){const a=Object.prototype.toString.call(m);r=a.substring(8,a.length-1)===t,n.set(m,r)}return r}function isBuffer$2(m,t){return typeof WebGLBuffer<"u"&&isType(t,"WebGLBuffer")}function isTexture(m,t){return typeof WebGLTexture<"u"&&isType(t,"WebGLTexture")}function isSampler(m,t){return typeof WebGLSampler<"u"&&isType(t,"WebGLSampler")}const STATIC_DRAW=35044,ARRAY_BUFFER$1=34962,ELEMENT_ARRAY_BUFFER$2=34963,BUFFER_SIZE=34660,BYTE$1=5120,UNSIGNED_BYTE$2=5121,SHORT$1=5122,UNSIGNED_SHORT$2=5123,INT$2=5124,UNSIGNED_INT$2=5125,FLOAT$2=5126,defaults$2={attribPrefix:""};function setDefaults$2(m){copyExistingProperties(m,defaults$2)}function setBufferFromTypedArray(m,t,n,r,a){m.bindBuffer(t,n),m.bufferData(t,r,a||STATIC_DRAW)}function createBufferFromTypedArray(m,t,n,r){if(isBuffer$2(m,t))return t;n=n||ARRAY_BUFFER$1;const a=m.createBuffer();return setBufferFromTypedArray(m,n,a,t,r),a}function isIndices(m){return m==="indices"}function getNormalizationForTypedArrayType(m){return m===Int8Array||m===Uint8Array}function getArray$1(m){return m.length?m:m.data}const texcoordRE=/coord|texture/i,colorRE=/color|colour/i;function guessNumComponentsFromName(m,t){let n;if(texcoordRE.test(m)?n=2:colorRE.test(m)?n=4:n=3,t%n>0)throw new Error(`Can not guess numComponents for attribute '${m}'. Tried ${n} but ${t} values is not evenly divisible by ${n}. You should specify it.`);return n}function getNumComponents$1(m,t,n){return m.numComponents||m.size||guessNumComponentsFromName(t,n||getArray$1(m).length)}function makeTypedArray(m,t){if(isArrayBuffer$1(m))return m;if(isArrayBuffer$1(m.data))return m.data;Array.isArray(m)&&(m={data:m});let n=m.type?typedArrayTypeFromGLTypeOrTypedArrayCtor(m.type):void 0;return n||(isIndices(t)?n=Uint16Array:n=Float32Array),new n(m.data)}function glTypeFromGLTypeOrTypedArrayType(m){return typeof m=="number"?m:m?getGLTypeForTypedArrayType(m):FLOAT$2}function typedArrayTypeFromGLTypeOrTypedArrayCtor(m){return typeof m=="number"?getTypedArrayTypeForGLType(m):m||Float32Array}function attribBufferFromBuffer(m,t){return{buffer:t.buffer,numValues:2*3*4,type:glTypeFromGLTypeOrTypedArrayType(t.type),arrayType:typedArrayTypeFromGLTypeOrTypedArrayCtor(t.type)}}function attribBufferFromSize(m,t){const n=t.data||t,r=typedArrayTypeFromGLTypeOrTypedArrayCtor(t.type),a=n*r.BYTES_PER_ELEMENT,u=m.createBuffer();return m.bindBuffer(ARRAY_BUFFER$1,u),m.bufferData(ARRAY_BUFFER$1,a,t.drawType||STATIC_DRAW),{buffer:u,numValues:n,type:getGLTypeForTypedArrayType(r),arrayType:r}}function attribBufferFromArrayLike(m,t,n){const r=makeTypedArray(t,n);return{arrayType:r.constructor,buffer:createBufferFromTypedArray(m,r,void 0,t.drawType),type:getGLTypeForTypedArray(r),numValues:0}}function createAttribsFromArrays(m,t){const n={};return Object.keys(t).forEach(function(r){if(!isIndices(r)){const a=t[r],u=a.attrib||a.name||a.attribName||defaults$2.attribPrefix+r;if(a.value){if(!Array.isArray(a.value)&&!isArrayBuffer$1(a.value))throw new Error("array.value is not array or typedarray");n[u]={value:a.value}}else{let h;a.buffer&&a.buffer instanceof WebGLBuffer?h=attribBufferFromBuffer:typeof a=="number"||typeof a.data=="number"?h=attribBufferFromSize:h=attribBufferFromArrayLike;const{buffer:f,type:d,numValues:p,arrayType:c}=h(m,a,r),o=a.normalize!==void 0?a.normalize:getNormalizationForTypedArrayType(c),e=getNumComponents$1(a,r,p);n[u]={buffer:f,numComponents:e,type:d,normalize:o,stride:a.stride||0,offset:a.offset||0,divisor:a.divisor===void 0?void 0:a.divisor,drawType:a.drawType}}}}),m.bindBuffer(ARRAY_BUFFER$1,null),n}function getBytesPerValueForGLType(m,t){return t===BYTE$1||t===UNSIGNED_BYTE$2?1:t===SHORT$1||t===UNSIGNED_SHORT$2?2:t===INT$2||t===UNSIGNED_INT$2||t===FLOAT$2?4:0}const positionKeys=["position","positions","a_position"];function getNumElementsFromAttributes(m,t){let n,r;for(r=0;r<positionKeys.length&&(n=positionKeys[r],!(n in t||(n=defaults$2.attribPrefix+n,n in t)));++r);r===positionKeys.length&&(n=Object.keys(t)[0]);const a=t[n];if(!a.buffer)return 1;m.bindBuffer(ARRAY_BUFFER$1,a.buffer);const u=m.getBufferParameter(ARRAY_BUFFER$1,BUFFER_SIZE);m.bindBuffer(ARRAY_BUFFER$1,null);const h=getBytesPerValueForGLType(m,a.type),f=u/h,d=a.numComponents||a.size,p=f/d;if(p%1!==0)throw new Error(`numComponents ${d} not correct for length ${length}`);return p}function createBufferInfoFromArrays(m,t,n){const r=createAttribsFromArrays(m,t),a=Object.assign({},n||{});a.attribs=Object.assign({},n?n.attribs:{},r);const u=t.indices;if(u){const h=makeTypedArray(u,"indices");a.indices=createBufferFromTypedArray(m,h,ELEMENT_ARRAY_BUFFER$2),a.numElements=h.length,a.elementType=getGLTypeForTypedArray(h)}else a.numElements||(a.numElements=getNumElementsFromAttributes(m,a.attribs));return a}function isWebGL2(m){return!!m.texStorage2D}const glEnumToString=function(){const m={},t={};function n(r){const a=r.constructor.name;if(!m[a]){for(const u in r)if(typeof r[u]=="number"){const h=t[r[u]];t[r[u]]=h?`${h} | ${u}`:u}m[a]=!0}}return function(a,u){return n(a),t[u]||(typeof u=="number"?`0x${u.toString(16)}`:u)}}(),defaults$1={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},isArrayBuffer=isArrayBuffer$1,getShared2DContext=function(){let m;return function(){return m=m||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),m}}(),ALPHA=6406,RGB=6407,RGBA$1=6408,LUMINANCE=6409,LUMINANCE_ALPHA=6410,DEPTH_COMPONENT$1=6402,DEPTH_STENCIL$1=34041,CLAMP_TO_EDGE$1=33071,NEAREST=9728,LINEAR$1=9729,TEXTURE_2D$2=3553,TEXTURE_CUBE_MAP$1=34067,TEXTURE_3D$1=32879,TEXTURE_2D_ARRAY$1=35866,TEXTURE_CUBE_MAP_POSITIVE_X=34069,TEXTURE_CUBE_MAP_NEGATIVE_X=34070,TEXTURE_CUBE_MAP_POSITIVE_Y=34071,TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,TEXTURE_CUBE_MAP_POSITIVE_Z=34073,TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,TEXTURE_MIN_FILTER=10241,TEXTURE_MAG_FILTER=10240,TEXTURE_WRAP_S=10242,TEXTURE_WRAP_T=10243,TEXTURE_WRAP_R=32882,TEXTURE_MIN_LOD=33082,TEXTURE_MAX_LOD=33083,TEXTURE_BASE_LEVEL=33084,TEXTURE_MAX_LEVEL=33085,TEXTURE_COMPARE_MODE=34892,TEXTURE_COMPARE_FUNC=34893,UNPACK_ALIGNMENT=3317,UNPACK_ROW_LENGTH=3314,UNPACK_IMAGE_HEIGHT=32878,UNPACK_SKIP_PIXELS=3316,UNPACK_SKIP_ROWS=3315,UNPACK_SKIP_IMAGES=32877,UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,UNPACK_FLIP_Y_WEBGL=37440,R8=33321,R8_SNORM=36756,R16F=33325,R32F=33326,R8UI=33330,R8I=33329,RG16UI=33338,RG16I=33337,RG32UI=33340,RG32I=33339,RG8=33323,RG8_SNORM=36757,RG16F=33327,RG32F=33328,RG8UI=33336,RG8I=33335,R16UI=33332,R16I=33331,R32UI=33334,R32I=33333,RGB8=32849,SRGB8=35905,RGB565$1=36194,RGB8_SNORM=36758,R11F_G11F_B10F=35898,RGB9_E5=35901,RGB16F=34843,RGB32F=34837,RGB8UI=36221,RGB8I=36239,RGB16UI=36215,RGB16I=36233,RGB32UI=36209,RGB32I=36227,RGBA8=32856,SRGB8_ALPHA8=35907,RGBA8_SNORM=36759,RGB5_A1$1=32855,RGBA4$1=32854,RGB10_A2=32857,RGBA16F=34842,RGBA32F=34836,RGBA8UI=36220,RGBA8I=36238,RGB10_A2UI=36975,RGBA16UI=36214,RGBA16I=36232,RGBA32I=36226,RGBA32UI=36208,DEPTH_COMPONENT16$1=33189,DEPTH_COMPONENT24$1=33190,DEPTH_COMPONENT32F$1=36012,DEPTH32F_STENCIL8$1=36013,DEPTH24_STENCIL8$1=35056,BYTE=5120,UNSIGNED_BYTE$1=5121,SHORT=5122,UNSIGNED_SHORT$1=5123,INT$1=5124,UNSIGNED_INT$1=5125,FLOAT$1=5126,UNSIGNED_SHORT_4_4_4_4=32819,UNSIGNED_SHORT_5_5_5_1=32820,UNSIGNED_SHORT_5_6_5=33635,HALF_FLOAT=5131,HALF_FLOAT_OES=36193,UNSIGNED_INT_2_10_10_10_REV=33640,UNSIGNED_INT_10F_11F_11F_REV=35899,UNSIGNED_INT_5_9_9_9_REV=35902,FLOAT_32_UNSIGNED_INT_24_8_REV=36269,UNSIGNED_INT_24_8=34042,RG=33319,RG_INTEGER=33320,RED=6403,RED_INTEGER=36244,RGB_INTEGER=36248,RGBA_INTEGER=36249;let s_textureInternalFormatInfo;function getTextureInternalFormatInfo(m){if(!s_textureInternalFormatInfo){const t={};t[ALPHA]={textureFormat:ALPHA,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[UNSIGNED_BYTE$1,HALF_FLOAT,HALF_FLOAT_OES,FLOAT$1]},t[LUMINANCE]={textureFormat:LUMINANCE,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[UNSIGNED_BYTE$1,HALF_FLOAT,HALF_FLOAT_OES,FLOAT$1]},t[LUMINANCE_ALPHA]={textureFormat:LUMINANCE_ALPHA,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[UNSIGNED_BYTE$1,HALF_FLOAT,HALF_FLOAT_OES,FLOAT$1]},t[RGB]={textureFormat:RGB,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[UNSIGNED_BYTE$1,HALF_FLOAT,HALF_FLOAT_OES,FLOAT$1,UNSIGNED_SHORT_5_6_5]},t[RGBA$1]={textureFormat:RGBA$1,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[UNSIGNED_BYTE$1,HALF_FLOAT,HALF_FLOAT_OES,FLOAT$1,UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1]},t[DEPTH_COMPONENT$1]={textureFormat:DEPTH_COMPONENT$1,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[UNSIGNED_INT$1,UNSIGNED_SHORT$1]},t[R8]={textureFormat:RED,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[UNSIGNED_BYTE$1]},t[R8_SNORM]={textureFormat:RED,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[BYTE]},t[R16F]={textureFormat:RED,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[FLOAT$1,HALF_FLOAT]},t[R32F]={textureFormat:RED,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[FLOAT$1]},t[R8UI]={textureFormat:RED_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[UNSIGNED_BYTE$1]},t[R8I]={textureFormat:RED_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[BYTE]},t[R16UI]={textureFormat:RED_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[UNSIGNED_SHORT$1]},t[R16I]={textureFormat:RED_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[SHORT]},t[R32UI]={textureFormat:RED_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[UNSIGNED_INT$1]},t[R32I]={textureFormat:RED_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[INT$1]},t[RG8]={textureFormat:RG,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[UNSIGNED_BYTE$1]},t[RG8_SNORM]={textureFormat:RG,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[BYTE]},t[RG16F]={textureFormat:RG,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[FLOAT$1,HALF_FLOAT]},t[RG32F]={textureFormat:RG,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[FLOAT$1]},t[RG8UI]={textureFormat:RG_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[UNSIGNED_BYTE$1]},t[RG8I]={textureFormat:RG_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[BYTE]},t[RG16UI]={textureFormat:RG_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[UNSIGNED_SHORT$1]},t[RG16I]={textureFormat:RG_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[SHORT]},t[RG32UI]={textureFormat:RG_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[UNSIGNED_INT$1]},t[RG32I]={textureFormat:RG_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[INT$1]},t[RGB8]={textureFormat:RGB,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[UNSIGNED_BYTE$1]},t[SRGB8]={textureFormat:RGB,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[UNSIGNED_BYTE$1]},t[RGB565$1]={textureFormat:RGB,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[UNSIGNED_BYTE$1,UNSIGNED_SHORT_5_6_5]},t[RGB8_SNORM]={textureFormat:RGB,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[BYTE]},t[R11F_G11F_B10F]={textureFormat:RGB,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[FLOAT$1,HALF_FLOAT,UNSIGNED_INT_10F_11F_11F_REV]},t[RGB9_E5]={textureFormat:RGB,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[FLOAT$1,HALF_FLOAT,UNSIGNED_INT_5_9_9_9_REV]},t[RGB16F]={textureFormat:RGB,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[FLOAT$1,HALF_FLOAT]},t[RGB32F]={textureFormat:RGB,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[FLOAT$1]},t[RGB8UI]={textureFormat:RGB_INTEGER,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[UNSIGNED_BYTE$1]},t[RGB8I]={textureFormat:RGB_INTEGER,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[BYTE]},t[RGB16UI]={textureFormat:RGB_INTEGER,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[UNSIGNED_SHORT$1]},t[RGB16I]={textureFormat:RGB_INTEGER,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[SHORT]},t[RGB32UI]={textureFormat:RGB_INTEGER,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[UNSIGNED_INT$1]},t[RGB32I]={textureFormat:RGB_INTEGER,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[INT$1]},t[RGBA8]={textureFormat:RGBA$1,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[UNSIGNED_BYTE$1]},t[SRGB8_ALPHA8]={textureFormat:RGBA$1,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[UNSIGNED_BYTE$1]},t[RGBA8_SNORM]={textureFormat:RGBA$1,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[BYTE]},t[RGB5_A1$1]={textureFormat:RGBA$1,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[UNSIGNED_BYTE$1,UNSIGNED_SHORT_5_5_5_1,UNSIGNED_INT_2_10_10_10_REV]},t[RGBA4$1]={textureFormat:RGBA$1,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[UNSIGNED_BYTE$1,UNSIGNED_SHORT_4_4_4_4]},t[RGB10_A2]={textureFormat:RGBA$1,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[UNSIGNED_INT_2_10_10_10_REV]},t[RGBA16F]={textureFormat:RGBA$1,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[FLOAT$1,HALF_FLOAT]},t[RGBA32F]={textureFormat:RGBA$1,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[FLOAT$1]},t[RGBA8UI]={textureFormat:RGBA_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[UNSIGNED_BYTE$1]},t[RGBA8I]={textureFormat:RGBA_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[BYTE]},t[RGB10_A2UI]={textureFormat:RGBA_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[UNSIGNED_INT_2_10_10_10_REV]},t[RGBA16UI]={textureFormat:RGBA_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[UNSIGNED_SHORT$1]},t[RGBA16I]={textureFormat:RGBA_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[SHORT]},t[RGBA32I]={textureFormat:RGBA_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[INT$1]},t[RGBA32UI]={textureFormat:RGBA_INTEGER,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[UNSIGNED_INT$1]},t[DEPTH_COMPONENT16$1]={textureFormat:DEPTH_COMPONENT$1,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[UNSIGNED_SHORT$1,UNSIGNED_INT$1]},t[DEPTH_COMPONENT24$1]={textureFormat:DEPTH_COMPONENT$1,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[UNSIGNED_INT$1]},t[DEPTH_COMPONENT32F$1]={textureFormat:DEPTH_COMPONENT$1,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[FLOAT$1]},t[DEPTH24_STENCIL8$1]={textureFormat:DEPTH_STENCIL$1,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[UNSIGNED_INT_24_8]},t[DEPTH32F_STENCIL8$1]={textureFormat:DEPTH_STENCIL$1,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[FLOAT_32_UNSIGNED_INT_24_8_REV]},Object.keys(t).forEach(function(n){const r=t[n];r.bytesPerElementMap={},r.bytesPerElement.forEach(function(a,u){const h=r.type[u];r.bytesPerElementMap[h]=a})}),s_textureInternalFormatInfo=t}return s_textureInternalFormatInfo[m]}function getBytesPerElementForInternalFormat(m,t){const n=getTextureInternalFormatInfo(m);if(!n)throw"unknown internal format";const r=n.bytesPerElementMap[t];if(r===void 0)throw"unknown internal format";return r}function getFormatAndTypeForInternalFormat(m){const t=getTextureInternalFormatInfo(m);if(!t)throw"unknown internal format";return{format:t.textureFormat,type:t.type[0]}}function isPowerOf2(m){return(m&m-1)===0}function canGenerateMipmap(m,t,n,r){if(!isWebGL2(m))return isPowerOf2(t)&&isPowerOf2(n);const a=getTextureInternalFormatInfo(r);if(!a)throw"unknown internal format";return a.colorRenderable&&a.textureFilterable}function canFilter(m){const t=getTextureInternalFormatInfo(m);if(!t)throw"unknown internal format";return t.textureFilterable}function getTextureTypeForArrayType(m,t,n){return isArrayBuffer(t)?getGLTypeForTypedArray(t):n||UNSIGNED_BYTE$1}function guessDimensions(m,t,n,r,a){if(a%1!==0)throw"can't guess dimensions";if(!n&&!r){const u=Math.sqrt(a/(t===TEXTURE_CUBE_MAP$1?6:1));u%1===0?(n=u,r=u):(n=a,r=1)}else if(r){if(!n&&(n=a/r,n%1))throw"can't guess dimensions"}else if(r=a/n,r%1)throw"can't guess dimensions";return{width:n,height:r}}function setDefaultTextureColor(m){defaults$1.textureColor=new Uint8Array([m[0]*255,m[1]*255,m[2]*255,m[3]*255])}function setDefaults$1(m){copyExistingProperties(m,defaults$1),m.textureColor&&setDefaultTextureColor(m.textureColor)}function setPackState(m,t){t.colorspaceConversion!==void 0&&m.pixelStorei(UNPACK_COLORSPACE_CONVERSION_WEBGL,t.colorspaceConversion),t.premultiplyAlpha!==void 0&&m.pixelStorei(UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),t.flipY!==void 0&&m.pixelStorei(UNPACK_FLIP_Y_WEBGL,t.flipY)}function setSkipStateToDefault(m){m.pixelStorei(UNPACK_ALIGNMENT,4),isWebGL2(m)&&(m.pixelStorei(UNPACK_ROW_LENGTH,0),m.pixelStorei(UNPACK_IMAGE_HEIGHT,0),m.pixelStorei(UNPACK_SKIP_PIXELS,0),m.pixelStorei(UNPACK_SKIP_ROWS,0),m.pixelStorei(UNPACK_SKIP_IMAGES,0))}function setTextureSamplerParameters(m,t,n,r){r.minMag&&(n.call(m,t,TEXTURE_MIN_FILTER,r.minMag),n.call(m,t,TEXTURE_MAG_FILTER,r.minMag)),r.min&&n.call(m,t,TEXTURE_MIN_FILTER,r.min),r.mag&&n.call(m,t,TEXTURE_MAG_FILTER,r.mag),r.wrap&&(n.call(m,t,TEXTURE_WRAP_S,r.wrap),n.call(m,t,TEXTURE_WRAP_T,r.wrap),(t===TEXTURE_3D$1||isSampler(m,t))&&n.call(m,t,TEXTURE_WRAP_R,r.wrap)),r.wrapR&&n.call(m,t,TEXTURE_WRAP_R,r.wrapR),r.wrapS&&n.call(m,t,TEXTURE_WRAP_S,r.wrapS),r.wrapT&&n.call(m,t,TEXTURE_WRAP_T,r.wrapT),r.minLod!==void 0&&n.call(m,t,TEXTURE_MIN_LOD,r.minLod),r.maxLod!==void 0&&n.call(m,t,TEXTURE_MAX_LOD,r.maxLod),r.baseLevel!==void 0&&n.call(m,t,TEXTURE_BASE_LEVEL,r.baseLevel),r.maxLevel!==void 0&&n.call(m,t,TEXTURE_MAX_LEVEL,r.maxLevel),r.compareFunc!==void 0&&n.call(m,t,TEXTURE_COMPARE_FUNC,r.compareFunc),r.compareMode!==void 0&&n.call(m,t,TEXTURE_COMPARE_MODE,r.compareMode)}function setTextureParameters(m,t,n){const r=n.target||TEXTURE_2D$2;m.bindTexture(r,t),setTextureSamplerParameters(m,r,m.texParameteri,n)}function make1Pixel(m){return m=m||defaults$1.textureColor,isArrayBuffer(m)?m:new Uint8Array([m[0]*255,m[1]*255,m[2]*255,m[3]*255])}function setTextureFilteringForSize(m,t,n,r,a,u){n=n||defaults$1.textureOptions,u=u||RGBA$1;const h=n.target||TEXTURE_2D$2;if(r=r||n.width,a=a||n.height,m.bindTexture(h,t),canGenerateMipmap(m,r,a,u))m.generateMipmap(h);else{const f=canFilter(u)?LINEAR$1:NEAREST;m.texParameteri(h,TEXTURE_MIN_FILTER,f),m.texParameteri(h,TEXTURE_MAG_FILTER,f),m.texParameteri(h,TEXTURE_WRAP_S,CLAMP_TO_EDGE$1),m.texParameteri(h,TEXTURE_WRAP_T,CLAMP_TO_EDGE$1)}}function shouldAutomaticallySetTextureFilteringForSize(m){return m.auto===!0||m.auto===void 0&&m.level===void 0}function getCubeFaceOrder(m,t){return t=t||{},t.cubeFaceOrder||[TEXTURE_CUBE_MAP_POSITIVE_X,TEXTURE_CUBE_MAP_NEGATIVE_X,TEXTURE_CUBE_MAP_POSITIVE_Y,TEXTURE_CUBE_MAP_NEGATIVE_Y,TEXTURE_CUBE_MAP_POSITIVE_Z,TEXTURE_CUBE_MAP_NEGATIVE_Z]}function getCubeFacesWithNdx(m,t){const r=getCubeFaceOrder(m,t).map(function(a,u){return{face:a,ndx:u}});return r.sort(function(a,u){return a.face-u.face}),r}function setTextureFromElement(m,t,n,r){r=r||defaults$1.textureOptions;const a=r.target||TEXTURE_2D$2,u=r.level||0;let h=n.width,f=n.height;const d=r.internalFormat||r.format||RGBA$1,p=getFormatAndTypeForInternalFormat(d),c=r.format||p.format,o=r.type||p.type;if(setPackState(m,r),m.bindTexture(a,t),a===TEXTURE_CUBE_MAP$1){const e=n.width,s=n.height;let l,g;if(e/6===s)l=s,g=[0,0,1,0,2,0,3,0,4,0,5,0];else if(s/6===e)l=e,g=[0,0,0,1,0,2,0,3,0,4,0,5];else if(e/3===s/2)l=e/3,g=[0,0,1,0,2,0,0,1,1,1,2,1];else if(e/2===s/3)l=e/2,g=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(n.src?n.src:n.nodeName);const y=getShared2DContext();y?(y.canvas.width=l,y.canvas.height=l,h=l,f=l,getCubeFacesWithNdx(m,r).forEach(function(b){const _=g[b.ndx*2+0]*l,v=g[b.ndx*2+1]*l;y.drawImage(n,_,v,l,l,0,0,l,l),m.texImage2D(b.face,u,d,c,o,y.canvas)}),y.canvas.width=1,y.canvas.height=1):typeof createImageBitmap<"u"&&(h=l,f=l,getCubeFacesWithNdx(m,r).forEach(function(b){const _=g[b.ndx*2+0]*l,v=g[b.ndx*2+1]*l;m.texImage2D(b.face,u,d,l,l,0,c,o,null),createImageBitmap(n,_,v,l,l,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(T){setPackState(m,r),m.bindTexture(a,t),m.texImage2D(b.face,u,d,c,o,T),shouldAutomaticallySetTextureFilteringForSize(r)&&setTextureFilteringForSize(m,t,r,h,f,d)})}))}else if(a===TEXTURE_3D$1||a===TEXTURE_2D_ARRAY$1){const e=Math.min(n.width,n.height),s=Math.max(n.width,n.height),l=s/e;if(l%1!==0)throw"can not compute 3D dimensions of element";const g=n.width===s?1:0,y=n.height===s?1:0;m.pixelStorei(UNPACK_ALIGNMENT,1),m.pixelStorei(UNPACK_ROW_LENGTH,n.width),m.pixelStorei(UNPACK_IMAGE_HEIGHT,0),m.pixelStorei(UNPACK_SKIP_IMAGES,0),m.texImage3D(a,u,d,e,e,e,0,c,o,null);for(let b=0;b<l;++b){const _=b*e*g,v=b*e*y;m.pixelStorei(UNPACK_SKIP_PIXELS,_),m.pixelStorei(UNPACK_SKIP_ROWS,v),m.texSubImage3D(a,u,0,0,b,e,e,1,c,o,n)}setSkipStateToDefault(m)}else m.texImage2D(a,u,d,c,o,n);shouldAutomaticallySetTextureFilteringForSize(r)&&setTextureFilteringForSize(m,t,r,h,f,d),setTextureParameters(m,t,r)}function noop(){}function urlIsSameOrigin(m){if(typeof document<"u"){const t=document.createElement("a");return t.href=m,t.hostname===location.hostname&&t.port===location.port&&t.protocol===location.protocol}else{const t=new URL(location.href).origin;return new URL(m,location.href).origin===t}}function setToAnonymousIfUndefinedAndURLIsNotSameOrigin(m,t){return t===void 0&&!urlIsSameOrigin(m)?"anonymous":t}function loadImage(m,t,n){n=n||noop;let r;if(t=t!==void 0?t:defaults$1.crossOrigin,t=setToAnonymousIfUndefinedAndURLIsNotSameOrigin(m,t),typeof Image<"u"){r=new Image,t!==void 0&&(r.crossOrigin=t);const a=function(){r.removeEventListener("error",u),r.removeEventListener("load",h),r=null},u=function(){const d="couldn't load image: "+m;error$1(d),n(d,r),a()},h=function(){n(null,r),a()};return r.addEventListener("error",u),r.addEventListener("load",h),r.src=m,r}else if(typeof ImageBitmap<"u"){let a,u;const h=function(){n(a,u)},f={};t&&(f.mode="cors"),fetch(m,f).then(function(d){if(!d.ok)throw d;return d.blob()}).then(function(d){return createImageBitmap(d,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(d){u=d,setTimeout(h)}).catch(function(d){a=d,setTimeout(h)}),r=null}return r}function isTexImageSource(m){return typeof ImageBitmap<"u"&&m instanceof ImageBitmap||typeof ImageData<"u"&&m instanceof ImageData||typeof HTMLElement<"u"&&m instanceof HTMLElement}function loadAndUseImage(m,t,n){return isTexImageSource(m)?(setTimeout(function(){n(null,m)}),m):loadImage(m,t,n)}function setTextureTo1PixelColor(m,t,n){n=n||defaults$1.textureOptions;const r=n.target||TEXTURE_2D$2;if(m.bindTexture(r,t),n.color===!1)return;const a=make1Pixel(n.color);if(r===TEXTURE_CUBE_MAP$1)for(let u=0;u<6;++u)m.texImage2D(TEXTURE_CUBE_MAP_POSITIVE_X+u,0,RGBA$1,1,1,0,RGBA$1,UNSIGNED_BYTE$1,a);else r===TEXTURE_3D$1||r===TEXTURE_2D_ARRAY$1?m.texImage3D(r,0,RGBA$1,1,1,1,0,RGBA$1,UNSIGNED_BYTE$1,a):m.texImage2D(r,0,RGBA$1,1,1,0,RGBA$1,UNSIGNED_BYTE$1,a)}function loadTextureFromUrl(m,t,n,r){return r=r||noop,n=n||defaults$1.textureOptions,setTextureTo1PixelColor(m,t,n),n=Object.assign({},n),loadAndUseImage(n.src,n.crossOrigin,function(u,h){u?r(u,t,h):(setTextureFromElement(m,t,h,n),r(null,t,h))})}function loadCubemapFromUrls(m,t,n,r){r=r||noop;const a=n.src;if(a.length!==6)throw"there must be 6 urls for a cubemap";const u=n.level||0,h=n.internalFormat||n.format||RGBA$1,f=getFormatAndTypeForInternalFormat(h),d=n.format||f.format,p=n.type||UNSIGNED_BYTE$1,c=n.target||TEXTURE_2D$2;if(c!==TEXTURE_CUBE_MAP$1)throw"target must be TEXTURE_CUBE_MAP";setTextureTo1PixelColor(m,t,n),n=Object.assign({},n);let o=6;const e=[],s=getCubeFaceOrder(m,n);let l;function g(y){return function(b,_){--o,b?e.push(b):_.width!==_.height?e.push("cubemap face img is not a square: "+_.src):(setPackState(m,n),m.bindTexture(c,t),o===5?getCubeFaceOrder().forEach(function(v){m.texImage2D(v,u,h,d,p,_)}):m.texImage2D(y,u,h,d,p,_),shouldAutomaticallySetTextureFilteringForSize(n)&&m.generateMipmap(c)),o===0&&r(e.length?e:void 0,t,l)}}l=a.map(function(y,b){return loadAndUseImage(y,n.crossOrigin,g(s[b]))})}function loadSlicesFromUrls(m,t,n,r){r=r||noop;const a=n.src,u=n.internalFormat||n.format||RGBA$1,h=getFormatAndTypeForInternalFormat(u),f=n.format||h.format,d=n.type||UNSIGNED_BYTE$1,p=n.target||TEXTURE_2D_ARRAY$1;if(p!==TEXTURE_3D$1&&p!==TEXTURE_2D_ARRAY$1)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";setTextureTo1PixelColor(m,t,n),n=Object.assign({},n);let c=a.length;const o=[];let e;const s=n.level||0;let l=n.width,g=n.height;const y=a.length;let b=!0;function _(v){return function(T,w){if(--c,T)o.push(T);else{if(setPackState(m,n),m.bindTexture(p,t),b){b=!1,l=n.width||w.width,g=n.height||w.height,m.texImage3D(p,s,u,l,g,y,0,f,d,null);for(let A=0;A<y;++A)m.texSubImage3D(p,s,0,0,A,l,g,1,f,d,w)}else{let A=w,S;(w.width!==l||w.height!==g)&&(S=getShared2DContext(),A=S.canvas,S.canvas.width=l,S.canvas.height=g,S.drawImage(w,0,0,l,g)),m.texSubImage3D(p,s,0,0,v,l,g,1,f,d,A),S&&A===S.canvas&&(S.canvas.width=0,S.canvas.height=0)}shouldAutomaticallySetTextureFilteringForSize(n)&&m.generateMipmap(p)}c===0&&r(o.length?o:void 0,t,e)}}e=a.map(function(v,T){return loadAndUseImage(v,n.crossOrigin,_(T))})}function setTextureFromArray(m,t,n,r){r=r||defaults$1.textureOptions;const a=r.target||TEXTURE_2D$2;m.bindTexture(a,t);let u=r.width,h=r.height,f=r.depth;const d=r.level||0,p=r.internalFormat||r.format||RGBA$1,c=getFormatAndTypeForInternalFormat(p),o=r.format||c.format,e=r.type||getTextureTypeForArrayType(m,n,c.type);if(isArrayBuffer(n))n instanceof Uint8ClampedArray&&(n=new Uint8Array(n.buffer));else{const y=getTypedArrayTypeForGLType(e);n=new y(n)}const s=getBytesPerElementForInternalFormat(p,e),l=n.byteLength/s;if(l%1)throw"length wrong size for format: "+glEnumToString(m,o);let g;if(a===TEXTURE_3D$1||a===TEXTURE_2D_ARRAY$1)if(!u&&!h&&!f){const y=Math.cbrt(l);if(y%1!==0)throw"can't guess cube size of array of numElements: "+l;u=y,h=y,f=y}else u&&(!h||!f)?(g=guessDimensions(m,a,h,f,l/u),h=g.width,f=g.height):h&&(!u||!f)?(g=guessDimensions(m,a,u,f,l/h),u=g.width,f=g.height):(g=guessDimensions(m,a,u,h,l/f),u=g.width,h=g.height);else g=guessDimensions(m,a,u,h,l),u=g.width,h=g.height;if(setSkipStateToDefault(m),m.pixelStorei(UNPACK_ALIGNMENT,r.unpackAlignment||1),setPackState(m,r),a===TEXTURE_CUBE_MAP$1){const y=s/n.BYTES_PER_ELEMENT,b=l/6*y;getCubeFacesWithNdx(m,r).forEach(_=>{const v=b*_.ndx,T=n.subarray(v,v+b);m.texImage2D(_.face,d,p,u,h,0,o,e,T)})}else a===TEXTURE_3D$1||a===TEXTURE_2D_ARRAY$1?m.texImage3D(a,d,p,u,h,f,0,o,e,n):m.texImage2D(a,d,p,u,h,0,o,e,n);return{width:u,height:h,depth:f,type:e}}function setEmptyTexture(m,t,n){const r=n.target||TEXTURE_2D$2;m.bindTexture(r,t);const a=n.level||0,u=n.internalFormat||n.format||RGBA$1,h=getFormatAndTypeForInternalFormat(u),f=n.format||h.format,d=n.type||h.type;if(setPackState(m,n),r===TEXTURE_CUBE_MAP$1)for(let p=0;p<6;++p)m.texImage2D(TEXTURE_CUBE_MAP_POSITIVE_X+p,a,u,n.width,n.height,0,f,d,null);else r===TEXTURE_3D$1||r===TEXTURE_2D_ARRAY$1?m.texImage3D(r,a,u,n.width,n.height,n.depth,0,f,d,null):m.texImage2D(r,a,u,n.width,n.height,0,f,d,null)}function createTexture(m,t,n){n=n||noop,t=t||defaults$1.textureOptions;const r=m.createTexture(),a=t.target||TEXTURE_2D$2;let u=t.width||1,h=t.height||1;const f=t.internalFormat||RGBA$1;m.bindTexture(a,r),a===TEXTURE_CUBE_MAP$1&&(m.texParameteri(a,TEXTURE_WRAP_S,CLAMP_TO_EDGE$1),m.texParameteri(a,TEXTURE_WRAP_T,CLAMP_TO_EDGE$1));let d=t.src;if(d)if(typeof d=="function"&&(d=d(m,t)),typeof d=="string")loadTextureFromUrl(m,r,t,n);else if(isArrayBuffer(d)||Array.isArray(d)&&(typeof d[0]=="number"||Array.isArray(d[0])||isArrayBuffer(d[0]))){const p=setTextureFromArray(m,r,d,t);u=p.width,h=p.height}else Array.isArray(d)&&(typeof d[0]=="string"||isTexImageSource(d[0]))?a===TEXTURE_CUBE_MAP$1?loadCubemapFromUrls(m,r,t,n):loadSlicesFromUrls(m,r,t,n):(setTextureFromElement(m,r,d,t),u=d.width,h=d.height);else setEmptyTexture(m,r,t);return shouldAutomaticallySetTextureFilteringForSize(t)&&setTextureFilteringForSize(m,r,t,u,h,f),setTextureParameters(m,r,t),r}function isAsyncSrc(m){return typeof m=="string"||Array.isArray(m)&&typeof m[0]=="string"}function createTextures(m,t,n){n=n||noop;let r=0;const a=[],u={},h={};function f(){r===0&&setTimeout(function(){n(a.length?a:void 0,u,h)},0)}return Object.keys(t).forEach(function(d){const p=t[d];let c;isAsyncSrc(p.src)&&(c=function(o,e,s){h[d]=s,--r,o&&a.push(o),f()},++r),u[d]=createTexture(m,p,c)}),f(),u}const error=error$1;function getElementById(m){return typeof document<"u"&&document.getElementById?document.getElementById(m):null}const TEXTURE0=33984,ARRAY_BUFFER=34962,COMPILE_STATUS=35713,LINK_STATUS=35714,FRAGMENT_SHADER=35632,VERTEX_SHADER=35633,SEPARATE_ATTRIBS=35981,ACTIVE_UNIFORMS=35718,ACTIVE_ATTRIBUTES=35721,TRANSFORM_FEEDBACK_VARYINGS=35971,ACTIVE_UNIFORM_BLOCKS=35382,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398,UNIFORM_BLOCK_DATA_SIZE=35392,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395,FLOAT=5126,FLOAT_VEC2=35664,FLOAT_VEC3=35665,FLOAT_VEC4=35666,INT=5124,INT_VEC2=35667,INT_VEC3=35668,INT_VEC4=35669,BOOL=35670,BOOL_VEC2=35671,BOOL_VEC3=35672,BOOL_VEC4=35673,FLOAT_MAT2=35674,FLOAT_MAT3=35675,FLOAT_MAT4=35676,SAMPLER_2D=35678,SAMPLER_CUBE=35680,SAMPLER_3D=35679,SAMPLER_2D_SHADOW=35682,FLOAT_MAT2x3=35685,FLOAT_MAT2x4=35686,FLOAT_MAT3x2=35687,FLOAT_MAT3x4=35688,FLOAT_MAT4x2=35689,FLOAT_MAT4x3=35690,SAMPLER_2D_ARRAY=36289,SAMPLER_2D_ARRAY_SHADOW=36292,SAMPLER_CUBE_SHADOW=36293,UNSIGNED_INT=5125,UNSIGNED_INT_VEC2=36294,UNSIGNED_INT_VEC3=36295,UNSIGNED_INT_VEC4=36296,INT_SAMPLER_2D=36298,INT_SAMPLER_3D=36299,INT_SAMPLER_CUBE=36300,INT_SAMPLER_2D_ARRAY=36303,UNSIGNED_INT_SAMPLER_2D=36306,UNSIGNED_INT_SAMPLER_3D=36307,UNSIGNED_INT_SAMPLER_CUBE=36308,UNSIGNED_INT_SAMPLER_2D_ARRAY=36311,TEXTURE_2D$1=3553,TEXTURE_CUBE_MAP=34067,TEXTURE_3D=32879,TEXTURE_2D_ARRAY=35866,typeMap={};function getBindPointForSamplerType(m,t){return typeMap[t].bindPoint}function floatSetter(m,t){return function(n){m.uniform1f(t,n)}}function floatArraySetter(m,t){return function(n){m.uniform1fv(t,n)}}function floatVec2Setter(m,t){return function(n){m.uniform2fv(t,n)}}function floatVec3Setter(m,t){return function(n){m.uniform3fv(t,n)}}function floatVec4Setter(m,t){return function(n){m.uniform4fv(t,n)}}function intSetter(m,t){return function(n){m.uniform1i(t,n)}}function intArraySetter(m,t){return function(n){m.uniform1iv(t,n)}}function intVec2Setter(m,t){return function(n){m.uniform2iv(t,n)}}function intVec3Setter(m,t){return function(n){m.uniform3iv(t,n)}}function intVec4Setter(m,t){return function(n){m.uniform4iv(t,n)}}function uintSetter(m,t){return function(n){m.uniform1ui(t,n)}}function uintArraySetter(m,t){return function(n){m.uniform1uiv(t,n)}}function uintVec2Setter(m,t){return function(n){m.uniform2uiv(t,n)}}function uintVec3Setter(m,t){return function(n){m.uniform3uiv(t,n)}}function uintVec4Setter(m,t){return function(n){m.uniform4uiv(t,n)}}function floatMat2Setter(m,t){return function(n){m.uniformMatrix2fv(t,!1,n)}}function floatMat3Setter(m,t){return function(n){m.uniformMatrix3fv(t,!1,n)}}function floatMat4Setter(m,t){return function(n){m.uniformMatrix4fv(t,!1,n)}}function floatMat23Setter(m,t){return function(n){m.uniformMatrix2x3fv(t,!1,n)}}function floatMat32Setter(m,t){return function(n){m.uniformMatrix3x2fv(t,!1,n)}}function floatMat24Setter(m,t){return function(n){m.uniformMatrix2x4fv(t,!1,n)}}function floatMat42Setter(m,t){return function(n){m.uniformMatrix4x2fv(t,!1,n)}}function floatMat34Setter(m,t){return function(n){m.uniformMatrix3x4fv(t,!1,n)}}function floatMat43Setter(m,t){return function(n){m.uniformMatrix4x3fv(t,!1,n)}}function samplerSetter(m,t,n,r){const a=getBindPointForSamplerType(m,t);return isWebGL2(m)?function(u){let h,f;!u||isTexture(m,u)?(h=u,f=null):(h=u.texture,f=u.sampler),m.uniform1i(r,n),m.activeTexture(TEXTURE0+n),m.bindTexture(a,h),m.bindSampler(n,f)}:function(u){m.uniform1i(r,n),m.activeTexture(TEXTURE0+n),m.bindTexture(a,u)}}function samplerArraySetter(m,t,n,r,a){const u=getBindPointForSamplerType(m,t),h=new Int32Array(a);for(let f=0;f<a;++f)h[f]=n+f;return isWebGL2(m)?function(f){m.uniform1iv(r,h),f.forEach(function(d,p){m.activeTexture(TEXTURE0+h[p]);let c,o;!d||isTexture(m,d)?(c=d,o=null):(c=d.texture,o=d.sampler),m.bindSampler(n,o),m.bindTexture(u,c)})}:function(f){m.uniform1iv(r,h),f.forEach(function(d,p){m.activeTexture(TEXTURE0+h[p]),m.bindTexture(u,d)})}}typeMap[FLOAT]={Type:Float32Array,size:4,setter:floatSetter,arraySetter:floatArraySetter};typeMap[FLOAT_VEC2]={Type:Float32Array,size:8,setter:floatVec2Setter,cols:2};typeMap[FLOAT_VEC3]={Type:Float32Array,size:12,setter:floatVec3Setter,cols:3};typeMap[FLOAT_VEC4]={Type:Float32Array,size:16,setter:floatVec4Setter,cols:4};typeMap[INT]={Type:Int32Array,size:4,setter:intSetter,arraySetter:intArraySetter};typeMap[INT_VEC2]={Type:Int32Array,size:8,setter:intVec2Setter,cols:2};typeMap[INT_VEC3]={Type:Int32Array,size:12,setter:intVec3Setter,cols:3};typeMap[INT_VEC4]={Type:Int32Array,size:16,setter:intVec4Setter,cols:4};typeMap[UNSIGNED_INT]={Type:Uint32Array,size:4,setter:uintSetter,arraySetter:uintArraySetter};typeMap[UNSIGNED_INT_VEC2]={Type:Uint32Array,size:8,setter:uintVec2Setter,cols:2};typeMap[UNSIGNED_INT_VEC3]={Type:Uint32Array,size:12,setter:uintVec3Setter,cols:3};typeMap[UNSIGNED_INT_VEC4]={Type:Uint32Array,size:16,setter:uintVec4Setter,cols:4};typeMap[BOOL]={Type:Uint32Array,size:4,setter:intSetter,arraySetter:intArraySetter};typeMap[BOOL_VEC2]={Type:Uint32Array,size:8,setter:intVec2Setter,cols:2};typeMap[BOOL_VEC3]={Type:Uint32Array,size:12,setter:intVec3Setter,cols:3};typeMap[BOOL_VEC4]={Type:Uint32Array,size:16,setter:intVec4Setter,cols:4};typeMap[FLOAT_MAT2]={Type:Float32Array,size:32,setter:floatMat2Setter,rows:2,cols:2};typeMap[FLOAT_MAT3]={Type:Float32Array,size:48,setter:floatMat3Setter,rows:3,cols:3};typeMap[FLOAT_MAT4]={Type:Float32Array,size:64,setter:floatMat4Setter,rows:4,cols:4};typeMap[FLOAT_MAT2x3]={Type:Float32Array,size:32,setter:floatMat23Setter,rows:2,cols:3};typeMap[FLOAT_MAT2x4]={Type:Float32Array,size:32,setter:floatMat24Setter,rows:2,cols:4};typeMap[FLOAT_MAT3x2]={Type:Float32Array,size:48,setter:floatMat32Setter,rows:3,cols:2};typeMap[FLOAT_MAT3x4]={Type:Float32Array,size:48,setter:floatMat34Setter,rows:3,cols:4};typeMap[FLOAT_MAT4x2]={Type:Float32Array,size:64,setter:floatMat42Setter,rows:4,cols:2};typeMap[FLOAT_MAT4x3]={Type:Float32Array,size:64,setter:floatMat43Setter,rows:4,cols:3};typeMap[SAMPLER_2D]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D$1};typeMap[SAMPLER_CUBE]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_CUBE_MAP};typeMap[SAMPLER_3D]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_3D};typeMap[SAMPLER_2D_SHADOW]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D$1};typeMap[SAMPLER_2D_ARRAY]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D_ARRAY};typeMap[SAMPLER_2D_ARRAY_SHADOW]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D_ARRAY};typeMap[SAMPLER_CUBE_SHADOW]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_CUBE_MAP};typeMap[INT_SAMPLER_2D]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D$1};typeMap[INT_SAMPLER_3D]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_3D};typeMap[INT_SAMPLER_CUBE]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_CUBE_MAP};typeMap[INT_SAMPLER_2D_ARRAY]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D_ARRAY};typeMap[UNSIGNED_INT_SAMPLER_2D]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D$1};typeMap[UNSIGNED_INT_SAMPLER_3D]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_3D};typeMap[UNSIGNED_INT_SAMPLER_CUBE]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_CUBE_MAP};typeMap[UNSIGNED_INT_SAMPLER_2D_ARRAY]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D_ARRAY};function floatAttribSetter(m,t){return function(n){if(n.value)switch(m.disableVertexAttribArray(t),n.value.length){case 4:m.vertexAttrib4fv(t,n.value);break;case 3:m.vertexAttrib3fv(t,n.value);break;case 2:m.vertexAttrib2fv(t,n.value);break;case 1:m.vertexAttrib1fv(t,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else m.bindBuffer(ARRAY_BUFFER,n.buffer),m.enableVertexAttribArray(t),m.vertexAttribPointer(t,n.numComponents||n.size,n.type||FLOAT,n.normalize||!1,n.stride||0,n.offset||0),m.vertexAttribDivisor&&m.vertexAttribDivisor(t,n.divisor||0)}}function intAttribSetter(m,t){return function(n){if(n.value)if(m.disableVertexAttribArray(t),n.value.length===4)m.vertexAttrib4iv(t,n.value);else throw new Error("The length of an integer constant value must be 4!");else m.bindBuffer(ARRAY_BUFFER,n.buffer),m.enableVertexAttribArray(t),m.vertexAttribIPointer(t,n.numComponents||n.size,n.type||INT,n.stride||0,n.offset||0),m.vertexAttribDivisor&&m.vertexAttribDivisor(t,n.divisor||0)}}function uintAttribSetter(m,t){return function(n){if(n.value)if(m.disableVertexAttribArray(t),n.value.length===4)m.vertexAttrib4uiv(t,n.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else m.bindBuffer(ARRAY_BUFFER,n.buffer),m.enableVertexAttribArray(t),m.vertexAttribIPointer(t,n.numComponents||n.size,n.type||UNSIGNED_INT,n.stride||0,n.offset||0),m.vertexAttribDivisor&&m.vertexAttribDivisor(t,n.divisor||0)}}function matAttribSetter(m,t,n){const r=n.size,a=n.count;return function(u){m.bindBuffer(ARRAY_BUFFER,u.buffer);const h=u.size||u.numComponents||r,f=h/a,d=u.type||FLOAT,c=typeMap[d].size*h,o=u.normalize||!1,e=u.offset||0,s=c/a;for(let l=0;l<a;++l)m.enableVertexAttribArray(t+l),m.vertexAttribPointer(t+l,f,d,o,c,e+s*l),m.vertexAttribDivisor&&m.vertexAttribDivisor(t+l,u.divisor||0)}}const attrTypeMap={};attrTypeMap[FLOAT]={size:4,setter:floatAttribSetter};attrTypeMap[FLOAT_VEC2]={size:8,setter:floatAttribSetter};attrTypeMap[FLOAT_VEC3]={size:12,setter:floatAttribSetter};attrTypeMap[FLOAT_VEC4]={size:16,setter:floatAttribSetter};attrTypeMap[INT]={size:4,setter:intAttribSetter};attrTypeMap[INT_VEC2]={size:8,setter:intAttribSetter};attrTypeMap[INT_VEC3]={size:12,setter:intAttribSetter};attrTypeMap[INT_VEC4]={size:16,setter:intAttribSetter};attrTypeMap[UNSIGNED_INT]={size:4,setter:uintAttribSetter};attrTypeMap[UNSIGNED_INT_VEC2]={size:8,setter:uintAttribSetter};attrTypeMap[UNSIGNED_INT_VEC3]={size:12,setter:uintAttribSetter};attrTypeMap[UNSIGNED_INT_VEC4]={size:16,setter:uintAttribSetter};attrTypeMap[BOOL]={size:4,setter:intAttribSetter};attrTypeMap[BOOL_VEC2]={size:8,setter:intAttribSetter};attrTypeMap[BOOL_VEC3]={size:12,setter:intAttribSetter};attrTypeMap[BOOL_VEC4]={size:16,setter:intAttribSetter};attrTypeMap[FLOAT_MAT2]={size:4,setter:matAttribSetter,count:2};attrTypeMap[FLOAT_MAT3]={size:9,setter:matAttribSetter,count:3};attrTypeMap[FLOAT_MAT4]={size:16,setter:matAttribSetter,count:4};const errorRE=/ERROR:\s*\d+:(\d+)/gi;function addLineNumbersWithError(m,t="",n=0){const r=[...t.matchAll(errorRE)],a=new Map(r.map((u,h)=>{const f=parseInt(u[1]),d=r[h+1],p=d?d.index:t.length,c=t.substring(u.index,p);return[f-1,c]}));return m.split(`
`).map((u,h)=>{const f=a.get(h);return`${h+1+n}: ${u}${f?`

^^^ ${f}`:""}`}).join(`
`)}const spaceRE=/^[ \t]*\n/;function prepShaderSource(m){let t=0;return spaceRE.test(m)&&(t=1,m=m.replace(spaceRE,"")),{lineOffset:t,shaderSource:m}}function reportError(m,t){return m.errorCallback(t),m.callback&&setTimeout(()=>{m.callback(`${t}
${m.errors.join(`
`)}`)}),null}function checkShaderStatus(m,t,n,r){if(r=r||error,!m.getShaderParameter(n,COMPILE_STATUS)){const u=m.getShaderInfoLog(n),{lineOffset:h,shaderSource:f}=prepShaderSource(m.getShaderSource(n)),d=`${addLineNumbersWithError(f,u,h)}
Error compiling ${glEnumToString(m,t)}: ${u}`;return r(d),d}return""}function getProgramOptions(m,t,n){let r,a,u;if(typeof t=="function"&&(n=t,t=void 0),typeof m=="function")n=m,m=void 0;else if(m&&!Array.isArray(m)){const p=m;n=p.errorCallback,m=p.attribLocations,r=p.transformFeedbackVaryings,a=p.transformFeedbackMode,u=p.callback}const h=n||error,f=[],d={errorCallback(p,...c){f.push(p),h(p,...c)},transformFeedbackVaryings:r,transformFeedbackMode:a,callback:u,errors:f};{let p={};Array.isArray(m)?m.forEach(function(c,o){p[c]=t?t[o]:o}):p=m||{},d.attribLocations=p}return d}const defaultShaderType=["VERTEX_SHADER","FRAGMENT_SHADER"];function getShaderTypeFromScriptType(m,t){if(t.indexOf("frag")>=0)return FRAGMENT_SHADER;if(t.indexOf("vert")>=0)return VERTEX_SHADER}function deleteProgramAndShaders(m,t,n){const r=m.getAttachedShaders(t);for(const a of r)n.has(a)&&m.deleteShader(a);m.deleteProgram(t)}const wait=(m=0)=>new Promise(t=>setTimeout(t,m));function createProgramNoCheck(m,t,n){const r=m.createProgram(),{attribLocations:a,transformFeedbackVaryings:u,transformFeedbackMode:h}=getProgramOptions(n);for(let f=0;f<t.length;++f){let d=t[f];if(typeof d=="string"){const p=getElementById(d),c=p?p.text:d;let o=m[defaultShaderType[f]];p&&p.type&&(o=getShaderTypeFromScriptType(m,p.type)||o),d=m.createShader(o),m.shaderSource(d,prepShaderSource(c).shaderSource),m.compileShader(d),m.attachShader(r,d)}}Object.entries(a).forEach(([f,d])=>m.bindAttribLocation(r,d,f));{let f=u;f&&(f.attribs&&(f=f.attribs),Array.isArray(f)||(f=Object.keys(f)),m.transformFeedbackVaryings(r,f,h||SEPARATE_ATTRIBS))}return m.linkProgram(r),r}function createProgram(m,t,n,r,a){const u=getProgramOptions(n,r,a),h=new Set(t),f=createProgramNoCheck(m,t,u);function d(p,c){const o=getProgramErrors(p,c,u.errorCallback);return o&&deleteProgramAndShaders(p,c,h),o}if(u.callback){waitForProgramLinkCompletionAsync(m,f).then(()=>{const p=d(m,f);u.callback(p,p?void 0:f)});return}return d(m,f)?void 0:f}async function waitForProgramLinkCompletionAsync(m,t){const n=m.getExtension("KHR_parallel_shader_compile"),r=n?(u,h)=>u.getProgramParameter(h,n.COMPLETION_STATUS_KHR):()=>!0;let a=0;do await wait(a),a=1e3/60;while(!r(m,t))}function getProgramErrors(m,t,n){if(n=n||error,!m.getProgramParameter(t,LINK_STATUS)){const a=m.getProgramInfoLog(t);n(`Error in program linking: ${a}`);const h=m.getAttachedShaders(t).map(f=>checkShaderStatus(m,m.getShaderParameter(f,m.SHADER_TYPE),f,n));return`${a}
${h.filter(f=>f).join(`
`)}`}}function createProgramFromSources(m,t,n,r,a){return createProgram(m,t,n,r,a)}function isBuiltIn(m){const t=m.name;return t.startsWith("gl_")||t.startsWith("webgl_")}const tokenRE=/(\.|\[|]|\w+)/g,isDigit=m=>m>="0"&&m<="9";function addSetterToUniformTree(m,t,n,r){const a=m.split(tokenRE).filter(f=>f!=="");let u=0,h="";for(;;){const f=a[u++];h+=f;const d=isDigit(f[0]),p=d?parseInt(f):f;if(d&&(h+=a[u++]),u===a.length){n[p]=t;break}else{const o=a[u++],e=o==="[",s=n[p]||(e?[]:{});n[p]=s,n=s,r[h]=r[h]||function(l){return function(g){setUniformTree(l,g)}}(s),h+=o}}}function createUniformSetters(m,t){let n=0;function r(f,d,p){const c=d.name.endsWith("[0]"),o=d.type,e=typeMap[o];if(!e)throw new Error(`unknown type: 0x${o.toString(16)}`);let s;if(e.bindPoint){const l=n;n+=d.size,c?s=e.arraySetter(m,o,l,p,d.size):s=e.setter(m,o,l,p,d.size)}else e.arraySetter&&c?s=e.arraySetter(m,p):s=e.setter(m,p);return s.location=p,s}const a={},u={},h=m.getProgramParameter(t,ACTIVE_UNIFORMS);for(let f=0;f<h;++f){const d=m.getActiveUniform(t,f);if(isBuiltIn(d))continue;let p=d.name;p.endsWith("[0]")&&(p=p.substr(0,p.length-3));const c=m.getUniformLocation(t,d.name);if(c){const o=r(t,d,c);a[p]=o,addSetterToUniformTree(p,o,u,a)}}return a}function createTransformFeedbackInfo(m,t){const n={},r=m.getProgramParameter(t,TRANSFORM_FEEDBACK_VARYINGS);for(let a=0;a<r;++a){const u=m.getTransformFeedbackVarying(t,a);n[u.name]={index:a,type:u.type,size:u.size}}return n}function createUniformBlockSpecFromProgram(m,t){const n=m.getProgramParameter(t,ACTIVE_UNIFORMS),r=[],a=[];for(let f=0;f<n;++f){a.push(f),r.push({});const d=m.getActiveUniform(t,f);r[f].name=d.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(f){const d=f[0],p=f[1];m.getActiveUniforms(t,a,m[d]).forEach(function(c,o){r[o][p]=c})});const u={},h=m.getProgramParameter(t,ACTIVE_UNIFORM_BLOCKS);for(let f=0;f<h;++f){const d=m.getActiveUniformBlockName(t,f),p={index:m.getUniformBlockIndex(t,d),usedByVertexShader:m.getActiveUniformBlockParameter(t,f,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),usedByFragmentShader:m.getActiveUniformBlockParameter(t,f,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),size:m.getActiveUniformBlockParameter(t,f,UNIFORM_BLOCK_DATA_SIZE),uniformIndices:m.getActiveUniformBlockParameter(t,f,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES)};p.used=p.usedByVertexShader||p.usedByFragmentShader,u[d]=p}return{blockSpecs:u,uniformData:r}}function setUniformTree(m,t){for(const n in t){const r=m[n];typeof r=="function"?r(t[n]):setUniformTree(m[n],t[n])}}function setUniforms(m,...t){const n=m.uniformSetters||m,r=t.length;for(let a=0;a<r;++a){const u=t[a];if(Array.isArray(u)){const h=u.length;for(let f=0;f<h;++f)setUniforms(n,u[f])}else for(const h in u){const f=n[h];f&&f(u[h])}}}function createAttributeSetters(m,t){const n={},r=m.getProgramParameter(t,ACTIVE_ATTRIBUTES);for(let a=0;a<r;++a){const u=m.getActiveAttrib(t,a);if(isBuiltIn(u))continue;const h=m.getAttribLocation(t,u.name),f=attrTypeMap[u.type],d=f.setter(m,h,f);d.location=h,n[u.name]=d}return n}function setAttributes(m,t){for(const n in t){const r=m[n];r&&r(t[n])}}function createProgramInfoFromProgram(m,t){const n=createUniformSetters(m,t),r=createAttributeSetters(m,t),a={program:t,uniformSetters:n,attribSetters:r};return isWebGL2(m)&&(a.uniformBlockSpec=createUniformBlockSpecFromProgram(m,t),a.transformFeedbackInfo=createTransformFeedbackInfo(m,t)),a}const notIdRE=/\s|{|}|;/;function createProgramInfo(m,t,n,r,a){const u=getProgramOptions(n,r,a),h=[];if(t=t.map(function(p){if(!notIdRE.test(p)){const c=getElementById(p);if(c)p=c.text;else{const o=`no element with id: ${p}`;u.errorCallback(o),h.push(o)}}return p}),h.length)return reportError(u,"");const f=u.callback;f&&(u.callback=(p,c)=>{f(p,p?void 0:createProgramInfoFromProgram(m,c))});const d=createProgramFromSources(m,t,u);return d?createProgramInfoFromProgram(m,d):null}const TRIANGLES=4,UNSIGNED_SHORT=5123;function drawBufferInfo(m,t,n,r,a,u){n=n===void 0?TRIANGLES:n;const h=t.indices,f=t.elementType,d=r===void 0?t.numElements:r;a=a===void 0?0:a,f||h?u!==void 0?m.drawElementsInstanced(n,d,f===void 0?UNSIGNED_SHORT:t.elementType,a,u):m.drawElements(n,d,f===void 0?UNSIGNED_SHORT:t.elementType,a):u!==void 0?m.drawArraysInstanced(n,a,d,u):m.drawArrays(n,a,d)}const ELEMENT_ARRAY_BUFFER=34963;function createVAOAndSetAttributes(m,t,n,r){const a=m.createVertexArray();return m.bindVertexArray(a),setAttributes(t,n),r&&m.bindBuffer(ELEMENT_ARRAY_BUFFER,r),m.bindVertexArray(null),a}function createVAOFromBufferInfo(m,t,n){return createVAOAndSetAttributes(m,t.attribSetters||t,n.attribs,n.indices)}const defaults={addExtensionsToContext:!0};function setDefaults(m){copyExistingProperties(m,defaults),setDefaults$2(m),setDefaults$1(m)}function resizeCanvasToDisplaySize(m,t){t=t||1,t=Math.max(0,t);const n=m.clientWidth*t|0,r=m.clientHeight*t|0;return m.width!==n||m.height!==r?(m.width=n,m.height=r,!0):!1}const vsSource=`#version 300 es

in vec3 a_position;
in vec3 a_normal;
in vec2 a_uv;

uniform mat4 u_projection;
uniform mat4 u_view;
uniform mat4 u_world;

out vec4 v_worldPos;
out vec3 v_viewPos;
out vec3 v_normal;
out vec2 v_uv;

void main() {
    gl_Position = u_projection * u_view * u_world * vec4(a_position, 1.0);
    v_worldPos = u_world * vec4(a_position, 1.0);
    v_viewPos = transpose(mat3(u_view)) * -u_view[3].xyz;
    v_normal  = mat3(u_world) * a_normal;
    v_uv = vec2(a_uv.x, -a_uv.y);
}
`,fsSource=`#version 300 es

precision highp float;

uniform sampler2D u_albedo;
uniform sampler2D u_occlusion;
uniform sampler2D u_emission;
uniform sampler2D u_shininess;

uniform vec3 u_lightPos;
uniform vec3 u_lightColor;
uniform vec3 u_ambientColor;
uniform vec3 u_styleMean;
uniform vec3 u_styleStd;

in vec4 v_worldPos;
in vec3 v_viewPos;
in vec3 v_normal;
in vec2 v_uv;

out vec4 fragColor;

const mat3 conv_lgt_0_weight_0 = mat3(0.00000000, 0.00000000, -0.00803071, -0.15168414, 0.08816471, 0.01686509, 0.29677373, 0.07736473, -0.00339539);
const mat3 conv_lgt_0_weight_1 = mat3(-0.42641106, -0.95069349, 0.00003925, -0.66182077, -0.61783767, 0.00081890, 0.03244254, -0.16375503, -0.00006972);
const vec3 conv_lgt_0_bias = vec3(0.8055619597434998, 0.5941834449768066, -0.2303735911846161);
const mat3 conv_lgt_1_weight = mat3(1.63268578, -0.00025563, -0.00016434, 0.92085719, 0.00388690, 0.00006069, -0.02657001, -0.00553063, 0.00019203);
const vec3 conv_lgt_1_bias = vec3(0.17507442831993103, -0.06554356962442398, -0.022941825911402702);
const mat3 conv_lgt_2_weight = mat3(0.86393136, 1.40284622, -0.45821241, -0.00077882, 0.00035306, 0.00454504, -0.00001402, 0.00086880, -0.00017212);
const vec3 conv_lgt_2_bias = vec3(0.6411716938018799, 0.3183196187019348, -0.07949614524841309);
const mat3 conv_lgt_3_weight = mat3(0.17398299, 0.44896966, 0.27768105, 0.57659459, 0.94531846, 0.70338953, 0.12003411, 0.00023569, -0.26372793);
const vec3 conv_lgt_3_bias = vec3(0.36807695031166077, -0.0722191259264946, 0.41702306270599365);
const mat3 conv_shad_0_weight_0 = mat3(0.15342245, 0.44183522, 0.00307558, 0.40318379, 0.55213690, -0.00027415, 0.40889031, 0.49199867, 0.00176936);
const mat3 conv_shad_0_weight_1 = mat3(0.68825370, -0.68958551, -0.00147964, -0.90781307, -0.41224211, 0.00264597, 0.01890765, -0.71897894, 0.00197219);
const vec3 conv_shad_0_bias = vec3(0.16848771274089813, 0.28855130076408386, -0.579033613204956);
const mat3 conv_shad_1_weight = mat3(-0.00000232, -0.00019028, 0.01873682, -0.00000212, 0.00028210, 1.53645313, -0.00000002, -0.00000071, -0.00179048);
const vec3 conv_shad_1_bias = vec3(-0.14506810903549194, -0.29552969336509705, -0.03612350672483444);
const mat3 conv_shad_2_weight = mat3(0.00063310, -0.00044743, -0.00023480, 0.00102125, 0.00275843, 0.09293491, -1.22484183, 0.88119119, 0.45697182);
const vec3 conv_shad_2_bias = vec3(0.3446977436542511, -0.0002613725373521447, -0.16102707386016846);
const vec3 conv_shad_3_weight = vec3(1.108639121055603, -0.794776439666748, -0.4122093617916107);
const float conv_shad_3_bias = 0.6914172172546387;


vec3 leakyReLU(vec3 v) {
    float x = v.x > 0.0 ? v.x : 0.01*v.x;
    float y = v.y > 0.0 ? v.y : 0.01*v.y;
    float z = v.z > 0.0 ? v.z : 0.01*v.z;
    return vec3(x, y, z);
}

mat3 leakyReLU(mat3 m) {
    return mat3(leakyReLU(m[0]), leakyReLU(m[1]), leakyReLU(m[2]));
}

vec3 sigmoid(vec3 v) {
    return 1. / (1. + exp(-v));
}

vec3 toonShaderAI(vec3 light, vec3 normal, vec3 view, 
					float occlusion, float emission, float shininess, 
					vec3 albedo, vec3 light_color, vec3 ambient_color,
                    vec3 style_std, vec3 style_mean) {

										
	vec3 L = normalize(light);
	vec3 N = normalize(normal);
	vec3 V = normalize(view);
	vec3 R = reflect(L, N);
	
	vec3 lgt = vec3(0, dot(L, N), dot(R, V));
	vec3 mask = vec3(occlusion, emission, shininess);
	
     // lighting module
	vec3 feature = conv_lgt_0_weight_0 * lgt + conv_lgt_0_weight_1 * mask + conv_lgt_0_bias;
    feature = leakyReLU(feature);
    feature = feature * style_std + style_mean;
    
    vec3 feature_conv = conv_lgt_1_weight * feature + conv_lgt_1_bias;
    feature_conv = leakyReLU(feature_conv);
    feature_conv = conv_lgt_2_weight * feature_conv + conv_lgt_2_bias;
    feature = feature + feature_conv;
    feature = feature*style_std + style_mean;

    feature = conv_lgt_3_weight * feature + conv_lgt_3_bias;
    feature = sigmoid(feature);
	
	// coloring module
	mat3 feature_mat = mat3(feature, feature, feature);
    mat3 color_mat = transpose(mat3(albedo, light_color, ambient_color));
	
	color_mat = conv_shad_0_weight_1 * color_mat + mat3(conv_shad_0_bias, conv_shad_0_bias, conv_shad_0_bias);
    color_mat = conv_shad_0_weight_0 * feature_mat + color_mat; 
    color_mat = leakyReLU(color_mat);
    
    mat3 color_mat_conv = conv_shad_1_weight * color_mat + mat3(conv_shad_1_bias, conv_shad_1_bias, conv_shad_1_bias);
    color_mat_conv = leakyReLU(color_mat_conv);
    color_mat_conv = conv_shad_2_weight * color_mat_conv + mat3(conv_shad_2_bias, conv_shad_2_bias, conv_shad_2_bias);
    color_mat = color_mat + color_mat_conv;
    
    vec3 color = conv_shad_3_weight * color_mat + vec3(conv_shad_3_bias, conv_shad_3_bias, conv_shad_3_bias);
	color = sigmoid(color);
	
	return color;
}

void main() {
    vec4 albedo = texture(u_albedo, v_uv);
    float occlusion = texture(u_occlusion, v_uv).r;
    float emission = texture(u_emission, v_uv).r;
    float shininess = texture(u_shininess, v_uv).r;

    vec3 color = toonShaderAI(
		u_lightPos,
		v_normal,
		v_viewPos - v_worldPos.xyz,
		occlusion,
		emission,
		shininess,
		albedo.rgb,
		u_lightColor,
		u_ambientColor,
        u_styleStd,
        u_styleMean 
	);

    fragColor = vec4(color, albedo.a);
}
`,fsSphere=`#version 300 es

precision highp float;

uniform vec3 u_lightPos;
uniform vec3 u_lightColor;
uniform vec3 u_ambientColor;
uniform vec3 u_featureMean;
uniform vec3 u_featureStd;

in vec4 v_worldPos;
in vec3 v_viewPos;
in vec3 v_normal;
in vec2 v_uv;

out vec4 fragColor;

void main() {

    vec3 V = normalize(v_viewPos - v_worldPos.xyz);
    vec3 N = normalize(v_normal);
    vec3 L = normalize(u_lightPos);
    vec3 R = reflect(L, N);

    float diffuse = max(dot(L, N), 0.0);
    float specular = diffuse > 0.0 ? pow(max(dot(R, V), 0.0), 32.0) : 0.0;

    vec3 color = 0.2*u_ambientColor + (0.8*diffuse + specular)*u_lightColor;

    fragColor = vec4(color, 1.0);
}
`;/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="160",FrontSide=0,BackSide=1,NormalBlending=1,AddEquation=100,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,LessEqualDepth=3,MultiplyOperation=0,AttachedBindMode="attached",DetachedBindMode="detached",UVMapping=300,EquirectangularReflectionMapping=303,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,LinearFilter=1006,LinearMipmapLinearFilter=1008,UnsignedByteType=1009,UnsignedIntType=1014,FloatType=1015,UnsignedInt248Type=1020,RGBAFormat=1023,DepthFormat=1026,DepthStencilFormat=1027,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,LinearEncoding=3e3,sRGBEncoding=3001,TangentSpaceNormalMap=0,NoColorSpace="",SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DisplayP3ColorSpace="display-p3",LinearDisplayP3ColorSpace="display-p3-linear",LinearTransfer="linear",SRGBTransfer="srgb",Rec709Primaries="rec709",P3Primaries="p3",KeepStencilOp=7680,AlwaysStencilFunc=519,LessEqualCompare=515,StaticDrawUsage=35044,WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001;class EventDispatcher{addEventListener(t,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[t]===void 0&&(r[t]=[]),r[t].indexOf(n)===-1&&r[t].push(n)}hasEventListener(t,n){if(this._listeners===void 0)return!1;const r=this._listeners;return r[t]!==void 0&&r[t].indexOf(n)!==-1}removeEventListener(t,n){if(this._listeners===void 0)return;const a=this._listeners[t];if(a!==void 0){const u=a.indexOf(n);u!==-1&&a.splice(u,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const r=this._listeners[t.type];if(r!==void 0){t.target=this;const a=r.slice(0);for(let u=0,h=a.length;u<h;u++)a[u].call(this,t);t.target=null}}}const _lut=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID(){const m=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(_lut[m&255]+_lut[m>>8&255]+_lut[m>>16&255]+_lut[m>>24&255]+"-"+_lut[t&255]+_lut[t>>8&255]+"-"+_lut[t>>16&15|64]+_lut[t>>24&255]+"-"+_lut[n&63|128]+_lut[n>>8&255]+"-"+_lut[n>>16&255]+_lut[n>>24&255]+_lut[r&255]+_lut[r>>8&255]+_lut[r>>16&255]+_lut[r>>24&255]).toLowerCase()}function clamp(m,t,n){return Math.max(t,Math.min(n,m))}function euclideanModulo(m,t){return(m%t+t)%t}function mapLinear(m,t,n,r,a){return r+(m-t)*(a-r)/(n-t)}function inverseLerp(m,t,n){return m!==t?(n-m)/(t-m):0}function lerp(m,t,n){return(1-n)*m+n*t}function damp(m,t,n,r){return lerp(m,t,1-Math.exp(-n*r))}function pingpong(m,t=1){return t-Math.abs(euclideanModulo(m,t*2)-t)}function smoothstep(m,t,n){return m<=t?0:m>=n?1:(m=(m-t)/(n-t),m*m*(3-2*m))}function smootherstep(m,t,n){return m<=t?0:m>=n?1:(m=(m-t)/(n-t),m*m*m*(m*(m*6-15)+10))}function randInt(m,t){return m+Math.floor(Math.random()*(t-m+1))}function randFloat(m,t){return m+Math.random()*(t-m)}function randFloatSpread(m){return m*(.5-Math.random())}function seededRandom(m){m!==void 0&&(_seed=m);let t=_seed+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function degToRad(m){return m*DEG2RAD}function radToDeg(m){return m*RAD2DEG}function isPowerOfTwo(m){return(m&m-1)===0&&m!==0}function ceilPowerOfTwo(m){return Math.pow(2,Math.ceil(Math.log(m)/Math.LN2))}function floorPowerOfTwo(m){return Math.pow(2,Math.floor(Math.log(m)/Math.LN2))}function setQuaternionFromProperEuler(m,t,n,r,a){const u=Math.cos,h=Math.sin,f=u(n/2),d=h(n/2),p=u((t+r)/2),c=h((t+r)/2),o=u((t-r)/2),e=h((t-r)/2),s=u((r-t)/2),l=h((r-t)/2);switch(a){case"XYX":m.set(f*c,d*o,d*e,f*p);break;case"YZY":m.set(d*e,f*c,d*o,f*p);break;case"ZXZ":m.set(d*o,d*e,f*c,f*p);break;case"XZX":m.set(f*c,d*l,d*s,f*p);break;case"YXY":m.set(d*s,f*c,d*l,f*p);break;case"ZYZ":m.set(d*l,d*s,f*c,f*p);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+a)}}function denormalize(m,t){switch(t.constructor){case Float32Array:return m;case Uint32Array:return m/4294967295;case Uint16Array:return m/65535;case Uint8Array:return m/255;case Int32Array:return Math.max(m/2147483647,-1);case Int16Array:return Math.max(m/32767,-1);case Int8Array:return Math.max(m/127,-1);default:throw new Error("Invalid component type.")}}function normalize(m,t){switch(t.constructor){case Float32Array:return m;case Uint32Array:return Math.round(m*4294967295);case Uint16Array:return Math.round(m*65535);case Uint8Array:return Math.round(m*255);case Int32Array:return Math.round(m*2147483647);case Int16Array:return Math.round(m*32767);case Int8Array:return Math.round(m*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID,clamp,euclideanModulo,mapLinear,inverseLerp,lerp,damp,pingpong,smoothstep,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize,denormalize};class Vector2{constructor(t=0,n=0){Vector2.prototype.isVector2=!0,this.x=t,this.y=n}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,n){return this.x=t,this.y=n,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this}addScaledVector(t,n){return this.x+=t.x*n,this.y+=t.y*n,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const n=this.x,r=this.y,a=t.elements;return this.x=a[0]*n+a[3]*r+a[6],this.y=a[1]*n+a[4]*r+a[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this}clampScalar(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this}clampLength(t,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const n=Math.sqrt(this.lengthSq()*t.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(t)/n;return Math.acos(clamp(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const n=this.x-t.x,r=this.y-t.y;return n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this}lerpVectors(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,n=0){return this.x=t[n],this.y=t[n+1],this}toArray(t=[],n=0){return t[n]=this.x,t[n+1]=this.y,t}fromBufferAttribute(t,n){return this.x=t.getX(n),this.y=t.getY(n),this}rotateAround(t,n){const r=Math.cos(n),a=Math.sin(n),u=this.x-t.x,h=this.y-t.y;return this.x=u*r-h*a+t.x,this.y=u*a+h*r+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(t,n,r,a,u,h,f,d,p){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,n,r,a,u,h,f,d,p)}set(t,n,r,a,u,h,f,d,p){const c=this.elements;return c[0]=t,c[1]=a,c[2]=f,c[3]=n,c[4]=u,c[5]=d,c[6]=r,c[7]=h,c[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const n=this.elements,r=t.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(t,n,r){return t.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const n=t.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,n){const r=t.elements,a=n.elements,u=this.elements,h=r[0],f=r[3],d=r[6],p=r[1],c=r[4],o=r[7],e=r[2],s=r[5],l=r[8],g=a[0],y=a[3],b=a[6],_=a[1],v=a[4],T=a[7],w=a[2],A=a[5],S=a[8];return u[0]=h*g+f*_+d*w,u[3]=h*y+f*v+d*A,u[6]=h*b+f*T+d*S,u[1]=p*g+c*_+o*w,u[4]=p*y+c*v+o*A,u[7]=p*b+c*T+o*S,u[2]=e*g+s*_+l*w,u[5]=e*y+s*v+l*A,u[8]=e*b+s*T+l*S,this}multiplyScalar(t){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=t,n[4]*=t,n[7]*=t,n[2]*=t,n[5]*=t,n[8]*=t,this}determinant(){const t=this.elements,n=t[0],r=t[1],a=t[2],u=t[3],h=t[4],f=t[5],d=t[6],p=t[7],c=t[8];return n*h*c-n*f*p-r*u*c+r*f*d+a*u*p-a*h*d}invert(){const t=this.elements,n=t[0],r=t[1],a=t[2],u=t[3],h=t[4],f=t[5],d=t[6],p=t[7],c=t[8],o=c*h-f*p,e=f*d-c*u,s=p*u-h*d,l=n*o+r*e+a*s;if(l===0)return this.set(0,0,0,0,0,0,0,0,0);const g=1/l;return t[0]=o*g,t[1]=(a*p-c*r)*g,t[2]=(f*r-a*h)*g,t[3]=e*g,t[4]=(c*n-a*d)*g,t[5]=(a*u-f*n)*g,t[6]=s*g,t[7]=(r*d-p*n)*g,t[8]=(h*n-r*u)*g,this}transpose(){let t;const n=this.elements;return t=n[1],n[1]=n[3],n[3]=t,t=n[2],n[2]=n[6],n[6]=t,t=n[5],n[5]=n[7],n[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const n=this.elements;return t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8],this}setUvTransform(t,n,r,a,u,h,f){const d=Math.cos(u),p=Math.sin(u);return this.set(r*d,r*p,-r*(d*h+p*f)+h+t,-a*p,a*d,-a*(-p*h+d*f)+f+n,0,0,1),this}scale(t,n){return this.premultiply(_m3.makeScale(t,n)),this}rotate(t){return this.premultiply(_m3.makeRotation(-t)),this}translate(t,n){return this.premultiply(_m3.makeTranslation(t,n)),this}makeTranslation(t,n){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,n,0,0,1),this}makeRotation(t){const n=Math.cos(t),r=Math.sin(t);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(t,n){return this.set(t,0,0,0,n,0,0,0,1),this}equals(t){const n=this.elements,r=t.elements;for(let a=0;a<9;a++)if(n[a]!==r[a])return!1;return!0}fromArray(t,n=0){for(let r=0;r<9;r++)this.elements[r]=t[r+n];return this}toArray(t=[],n=0){const r=this.elements;return t[n]=r[0],t[n+1]=r[1],t[n+2]=r[2],t[n+3]=r[3],t[n+4]=r[4],t[n+5]=r[5],t[n+6]=r[6],t[n+7]=r[7],t[n+8]=r[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(m){for(let t=m.length-1;t>=0;--t)if(m[t]>=65535)return!0;return!1}function createElementNS(m){return document.createElementNS("http://www.w3.org/1999/xhtml",m)}const _cache={};function warnOnce(m){m in _cache||(_cache[m]=!0,console.warn(m))}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),COLOR_SPACES={[LinearSRGBColorSpace]:{transfer:LinearTransfer,primaries:Rec709Primaries,toReference:m=>m,fromReference:m=>m},[SRGBColorSpace]:{transfer:SRGBTransfer,primaries:Rec709Primaries,toReference:m=>m.convertSRGBToLinear(),fromReference:m=>m.convertLinearToSRGB()},[LinearDisplayP3ColorSpace]:{transfer:LinearTransfer,primaries:P3Primaries,toReference:m=>m.applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:m=>m.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3)},[DisplayP3ColorSpace]:{transfer:SRGBTransfer,primaries:P3Primaries,toReference:m=>m.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:m=>m.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3).convertLinearToSRGB()}},SUPPORTED_WORKING_COLOR_SPACES=new Set([LinearSRGBColorSpace,LinearDisplayP3ColorSpace]),ColorManagement={enabled:!0,_workingColorSpace:LinearSRGBColorSpace,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(m){if(!SUPPORTED_WORKING_COLOR_SPACES.has(m))throw new Error(`Unsupported working color space, "${m}".`);this._workingColorSpace=m},convert:function(m,t,n){if(this.enabled===!1||t===n||!t||!n)return m;const r=COLOR_SPACES[t].toReference,a=COLOR_SPACES[n].fromReference;return a(r(m))},fromWorkingColorSpace:function(m,t){return this.convert(m,this._workingColorSpace,t)},toWorkingColorSpace:function(m,t){return this.convert(m,t,this._workingColorSpace)},getPrimaries:function(m){return COLOR_SPACES[m].primaries},getTransfer:function(m){return m===NoColorSpace?LinearTransfer:COLOR_SPACES[m].transfer}};function SRGBToLinear(m){return m<.04045?m*.0773993808:Math.pow(m*.9478672986+.0521327014,2.4)}function LinearToSRGB(m){return m<.0031308?m*12.92:1.055*Math.pow(m,.41666)-.055}let _canvas;class ImageUtils{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let n;if(t instanceof HTMLCanvasElement)n=t;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=t.width,_canvas.height=t.height;const r=_canvas.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height),n=_canvas}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const n=createElementNS("canvas");n.width=t.width,n.height=t.height;const r=n.getContext("2d");r.drawImage(t,0,0,t.width,t.height);const a=r.getImageData(0,0,t.width,t.height),u=a.data;for(let h=0;h<u.length;h++)u[h]=SRGBToLinear(u[h]/255)*255;return r.putImageData(a,0,0),n}else if(t.data){const n=t.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor(SRGBToLinear(n[r]/255)*255):n[r]=SRGBToLinear(n[r]);return{data:n,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let _sourceId=0;class Source{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_sourceId++}),this.uuid=generateUUID(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const n=t===void 0||typeof t=="string";if(!n&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const r={uuid:this.uuid,url:""},a=this.data;if(a!==null){let u;if(Array.isArray(a)){u=[];for(let h=0,f=a.length;h<f;h++)a[h].isDataTexture?u.push(serializeImage(a[h].image)):u.push(serializeImage(a[h]))}else u=serializeImage(a);r.url=u}return n||(t.images[this.uuid]=r),r}}function serializeImage(m){return typeof HTMLImageElement<"u"&&m instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&m instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&m instanceof ImageBitmap?ImageUtils.getDataURL(m):m.data?{data:Array.from(m.data),width:m.width,height:m.height,type:m.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _textureId=0;class Texture extends EventDispatcher{constructor(t=Texture.DEFAULT_IMAGE,n=Texture.DEFAULT_MAPPING,r=ClampToEdgeWrapping,a=ClampToEdgeWrapping,u=LinearFilter,h=LinearMipmapLinearFilter,f=RGBAFormat,d=UnsignedByteType,p=Texture.DEFAULT_ANISOTROPY,c=NoColorSpace){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_textureId++}),this.uuid=generateUUID(),this.name="",this.source=new Source(t),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=a,this.magFilter=u,this.minFilter=h,this.anisotropy=p,this.format=f,this.internalFormat=null,this.type=d,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof c=="string"?this.colorSpace=c:(warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=c===sRGBEncoding?SRGBColorSpace:NoColorSpace),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=t===void 0||typeof t=="string";if(!n&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==UVMapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case RepeatWrapping:t.x=t.x-Math.floor(t.x);break;case ClampToEdgeWrapping:t.x=t.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case RepeatWrapping:t.y=t.y-Math.floor(t.y);break;case ClampToEdgeWrapping:t.y=t.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===SRGBColorSpace?sRGBEncoding:LinearEncoding}set encoding(t){warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===sRGBEncoding?SRGBColorSpace:NoColorSpace}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=UVMapping;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(t=0,n=0,r=0,a=1){Vector4.prototype.isVector4=!0,this.x=t,this.y=n,this.z=r,this.w=a}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,n,r,a){return this.x=t,this.y=n,this.z=r,this.w=a,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this.w=t.w+n.w,this}addScaledVector(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this.w+=t.w*n,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this.w=t.w-n.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const n=this.x,r=this.y,a=this.z,u=this.w,h=t.elements;return this.x=h[0]*n+h[4]*r+h[8]*a+h[12]*u,this.y=h[1]*n+h[5]*r+h[9]*a+h[13]*u,this.z=h[2]*n+h[6]*r+h[10]*a+h[14]*u,this.w=h[3]*n+h[7]*r+h[11]*a+h[15]*u,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const n=Math.sqrt(1-t.w*t.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/n,this.y=t.y/n,this.z=t.z/n),this}setAxisAngleFromRotationMatrix(t){let n,r,a,u;const d=t.elements,p=d[0],c=d[4],o=d[8],e=d[1],s=d[5],l=d[9],g=d[2],y=d[6],b=d[10];if(Math.abs(c-e)<.01&&Math.abs(o-g)<.01&&Math.abs(l-y)<.01){if(Math.abs(c+e)<.1&&Math.abs(o+g)<.1&&Math.abs(l+y)<.1&&Math.abs(p+s+b-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const v=(p+1)/2,T=(s+1)/2,w=(b+1)/2,A=(c+e)/4,S=(o+g)/4,O=(l+y)/4;return v>T&&v>w?v<.01?(r=0,a=.707106781,u=.707106781):(r=Math.sqrt(v),a=A/r,u=S/r):T>w?T<.01?(r=.707106781,a=0,u=.707106781):(a=Math.sqrt(T),r=A/a,u=O/a):w<.01?(r=.707106781,a=.707106781,u=0):(u=Math.sqrt(w),r=S/u,a=O/u),this.set(r,a,u,n),this}let _=Math.sqrt((y-l)*(y-l)+(o-g)*(o-g)+(e-c)*(e-c));return Math.abs(_)<.001&&(_=1),this.x=(y-l)/_,this.y=(o-g)/_,this.z=(e-c)/_,this.w=Math.acos((p+s+b-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this.z=Math.max(t.z,Math.min(n.z,this.z)),this.w=Math.max(t.w,Math.min(n.w,this.w)),this}clampScalar(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this.z=Math.max(t,Math.min(n,this.z)),this.w=Math.max(t,Math.min(n,this.w)),this}clampLength(t,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this.w+=(t.w-this.w)*n,this}lerpVectors(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this.z=t.z+(n.z-t.z)*r,this.w=t.w+(n.w-t.w)*r,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,n=0){return this.x=t[n],this.y=t[n+1],this.z=t[n+2],this.w=t[n+3],this}toArray(t=[],n=0){return t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t[n+3]=this.w,t}fromBufferAttribute(t,n){return this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this.w=t.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Quaternion{constructor(t=0,n=0,r=0,a=1){this.isQuaternion=!0,this._x=t,this._y=n,this._z=r,this._w=a}static slerpFlat(t,n,r,a,u,h,f){let d=r[a+0],p=r[a+1],c=r[a+2],o=r[a+3];const e=u[h+0],s=u[h+1],l=u[h+2],g=u[h+3];if(f===0){t[n+0]=d,t[n+1]=p,t[n+2]=c,t[n+3]=o;return}if(f===1){t[n+0]=e,t[n+1]=s,t[n+2]=l,t[n+3]=g;return}if(o!==g||d!==e||p!==s||c!==l){let y=1-f;const b=d*e+p*s+c*l+o*g,_=b>=0?1:-1,v=1-b*b;if(v>Number.EPSILON){const w=Math.sqrt(v),A=Math.atan2(w,b*_);y=Math.sin(y*A)/w,f=Math.sin(f*A)/w}const T=f*_;if(d=d*y+e*T,p=p*y+s*T,c=c*y+l*T,o=o*y+g*T,y===1-f){const w=1/Math.sqrt(d*d+p*p+c*c+o*o);d*=w,p*=w,c*=w,o*=w}}t[n]=d,t[n+1]=p,t[n+2]=c,t[n+3]=o}static multiplyQuaternionsFlat(t,n,r,a,u,h){const f=r[a],d=r[a+1],p=r[a+2],c=r[a+3],o=u[h],e=u[h+1],s=u[h+2],l=u[h+3];return t[n]=f*l+c*o+d*s-p*e,t[n+1]=d*l+c*e+p*o-f*s,t[n+2]=p*l+c*s+f*e-d*o,t[n+3]=c*l-f*o-d*e-p*s,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,n,r,a){return this._x=t,this._y=n,this._z=r,this._w=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,n=!0){const r=t._x,a=t._y,u=t._z,h=t._order,f=Math.cos,d=Math.sin,p=f(r/2),c=f(a/2),o=f(u/2),e=d(r/2),s=d(a/2),l=d(u/2);switch(h){case"XYZ":this._x=e*c*o+p*s*l,this._y=p*s*o-e*c*l,this._z=p*c*l+e*s*o,this._w=p*c*o-e*s*l;break;case"YXZ":this._x=e*c*o+p*s*l,this._y=p*s*o-e*c*l,this._z=p*c*l-e*s*o,this._w=p*c*o+e*s*l;break;case"ZXY":this._x=e*c*o-p*s*l,this._y=p*s*o+e*c*l,this._z=p*c*l+e*s*o,this._w=p*c*o-e*s*l;break;case"ZYX":this._x=e*c*o-p*s*l,this._y=p*s*o+e*c*l,this._z=p*c*l-e*s*o,this._w=p*c*o+e*s*l;break;case"YZX":this._x=e*c*o+p*s*l,this._y=p*s*o+e*c*l,this._z=p*c*l-e*s*o,this._w=p*c*o-e*s*l;break;case"XZY":this._x=e*c*o-p*s*l,this._y=p*s*o-e*c*l,this._z=p*c*l+e*s*o,this._w=p*c*o+e*s*l;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+h)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,n){const r=n/2,a=Math.sin(r);return this._x=t.x*a,this._y=t.y*a,this._z=t.z*a,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(t){const n=t.elements,r=n[0],a=n[4],u=n[8],h=n[1],f=n[5],d=n[9],p=n[2],c=n[6],o=n[10],e=r+f+o;if(e>0){const s=.5/Math.sqrt(e+1);this._w=.25/s,this._x=(c-d)*s,this._y=(u-p)*s,this._z=(h-a)*s}else if(r>f&&r>o){const s=2*Math.sqrt(1+r-f-o);this._w=(c-d)/s,this._x=.25*s,this._y=(a+h)/s,this._z=(u+p)/s}else if(f>o){const s=2*Math.sqrt(1+f-r-o);this._w=(u-p)/s,this._x=(a+h)/s,this._y=.25*s,this._z=(d+c)/s}else{const s=2*Math.sqrt(1+o-r-f);this._w=(h-a)/s,this._x=(u+p)/s,this._y=(d+c)/s,this._z=.25*s}return this._onChangeCallback(),this}setFromUnitVectors(t,n){let r=t.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*n.z-t.z*n.y,this._y=t.z*n.x-t.x*n.z,this._z=t.x*n.y-t.y*n.x,this._w=r),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(clamp(this.dot(t),-1,1)))}rotateTowards(t,n){const r=this.angleTo(t);if(r===0)return this;const a=Math.min(1,n/r);return this.slerp(t,a),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,n){const r=t._x,a=t._y,u=t._z,h=t._w,f=n._x,d=n._y,p=n._z,c=n._w;return this._x=r*c+h*f+a*p-u*d,this._y=a*c+h*d+u*f-r*p,this._z=u*c+h*p+r*d-a*f,this._w=h*c-r*f-a*d-u*p,this._onChangeCallback(),this}slerp(t,n){if(n===0)return this;if(n===1)return this.copy(t);const r=this._x,a=this._y,u=this._z,h=this._w;let f=h*t._w+r*t._x+a*t._y+u*t._z;if(f<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,f=-f):this.copy(t),f>=1)return this._w=h,this._x=r,this._y=a,this._z=u,this;const d=1-f*f;if(d<=Number.EPSILON){const s=1-n;return this._w=s*h+n*this._w,this._x=s*r+n*this._x,this._y=s*a+n*this._y,this._z=s*u+n*this._z,this.normalize(),this}const p=Math.sqrt(d),c=Math.atan2(p,f),o=Math.sin((1-n)*c)/p,e=Math.sin(n*c)/p;return this._w=h*o+this._w*e,this._x=r*o+this._x*e,this._y=a*o+this._y*e,this._z=u*o+this._z*e,this._onChangeCallback(),this}slerpQuaternions(t,n,r){return this.copy(t).slerp(n,r)}random(){const t=Math.random(),n=Math.sqrt(1-t),r=Math.sqrt(t),a=2*Math.PI*Math.random(),u=2*Math.PI*Math.random();return this.set(n*Math.cos(a),r*Math.sin(u),r*Math.cos(u),n*Math.sin(a))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,n=0){return this._x=t[n],this._y=t[n+1],this._z=t[n+2],this._w=t[n+3],this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._w,t}fromBufferAttribute(t,n){return this._x=t.getX(n),this._y=t.getY(n),this._z=t.getZ(n),this._w=t.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(t=0,n=0,r=0){Vector3.prototype.isVector3=!0,this.x=t,this.y=n,this.z=r}set(t,n,r){return r===void 0&&(r=this.z),this.x=t,this.y=n,this.z=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this}addScaledVector(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,n){return this.x=t.x*n.x,this.y=t.y*n.y,this.z=t.z*n.z,this}applyEuler(t){return this.applyQuaternion(_quaternion$4.setFromEuler(t))}applyAxisAngle(t,n){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(t,n))}applyMatrix3(t){const n=this.x,r=this.y,a=this.z,u=t.elements;return this.x=u[0]*n+u[3]*r+u[6]*a,this.y=u[1]*n+u[4]*r+u[7]*a,this.z=u[2]*n+u[5]*r+u[8]*a,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const n=this.x,r=this.y,a=this.z,u=t.elements,h=1/(u[3]*n+u[7]*r+u[11]*a+u[15]);return this.x=(u[0]*n+u[4]*r+u[8]*a+u[12])*h,this.y=(u[1]*n+u[5]*r+u[9]*a+u[13])*h,this.z=(u[2]*n+u[6]*r+u[10]*a+u[14])*h,this}applyQuaternion(t){const n=this.x,r=this.y,a=this.z,u=t.x,h=t.y,f=t.z,d=t.w,p=2*(h*a-f*r),c=2*(f*n-u*a),o=2*(u*r-h*n);return this.x=n+d*p+h*o-f*c,this.y=r+d*c+f*p-u*o,this.z=a+d*o+u*c-h*p,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const n=this.x,r=this.y,a=this.z,u=t.elements;return this.x=u[0]*n+u[4]*r+u[8]*a,this.y=u[1]*n+u[5]*r+u[9]*a,this.z=u[2]*n+u[6]*r+u[10]*a,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this.z=Math.max(t.z,Math.min(n.z,this.z)),this}clampScalar(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this.z=Math.max(t,Math.min(n,this.z)),this}clampLength(t,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this}lerpVectors(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this.z=t.z+(n.z-t.z)*r,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,n){const r=t.x,a=t.y,u=t.z,h=n.x,f=n.y,d=n.z;return this.x=a*d-u*f,this.y=u*h-r*d,this.z=r*f-a*h,this}projectOnVector(t){const n=t.lengthSq();if(n===0)return this.set(0,0,0);const r=t.dot(this)/n;return this.copy(t).multiplyScalar(r)}projectOnPlane(t){return _vector$c.copy(this).projectOnVector(t),this.sub(_vector$c)}reflect(t){return this.sub(_vector$c.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const n=Math.sqrt(this.lengthSq()*t.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(t)/n;return Math.acos(clamp(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const n=this.x-t.x,r=this.y-t.y,a=this.z-t.z;return n*n+r*r+a*a}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,n,r){const a=Math.sin(n)*t;return this.x=a*Math.sin(r),this.y=Math.cos(n)*t,this.z=a*Math.cos(r),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,n,r){return this.x=t*Math.sin(n),this.y=r,this.z=t*Math.cos(n),this}setFromMatrixPosition(t){const n=t.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(t){const n=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),a=this.setFromMatrixColumn(t,2).length();return this.x=n,this.y=r,this.z=a,this}setFromMatrixColumn(t,n){return this.fromArray(t.elements,n*4)}setFromMatrix3Column(t,n){return this.fromArray(t.elements,n*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,n=0){return this.x=t[n],this.y=t[n+1],this.z=t[n+2],this}toArray(t=[],n=0){return t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t}fromBufferAttribute(t,n){return this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,r=Math.sqrt(1-t**2);return this.x=r*Math.cos(n),this.y=r*Math.sin(n),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$c=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(t=new Vector3(1/0,1/0,1/0),n=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=n}set(t,n){return this.min.copy(t),this.max.copy(n),this}setFromArray(t){this.makeEmpty();for(let n=0,r=t.length;n<r;n+=3)this.expandByPoint(_vector$b.fromArray(t,n));return this}setFromBufferAttribute(t){this.makeEmpty();for(let n=0,r=t.count;n<r;n++)this.expandByPoint(_vector$b.fromBufferAttribute(t,n));return this}setFromPoints(t){this.makeEmpty();for(let n=0,r=t.length;n<r;n++)this.expandByPoint(t[n]);return this}setFromCenterAndSize(t,n){const r=_vector$b.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}setFromObject(t,n=!1){return this.makeEmpty(),this.expandByObject(t,n)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,n=!1){t.updateWorldMatrix(!1,!1);const r=t.geometry;if(r!==void 0){const u=r.getAttribute("position");if(n===!0&&u!==void 0&&t.isInstancedMesh!==!0)for(let h=0,f=u.count;h<f;h++)t.isMesh===!0?t.getVertexPosition(h,_vector$b):_vector$b.fromBufferAttribute(u,h),_vector$b.applyMatrix4(t.matrixWorld),this.expandByPoint(_vector$b);else t.boundingBox!==void 0?(t.boundingBox===null&&t.computeBoundingBox(),_box$4.copy(t.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),_box$4.copy(r.boundingBox)),_box$4.applyMatrix4(t.matrixWorld),this.union(_box$4)}const a=t.children;for(let u=0,h=a.length;u<h;u++)this.expandByObject(a[u],n);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,n){return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,_vector$b),_vector$b.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let n,r;return t.normal.x>0?(n=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(n=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(n+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(n+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(n+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(n+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),n<=-t.constant&&r>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$2.subVectors(t.a,_center),_v1$7.subVectors(t.b,_center),_v2$4.subVectors(t.c,_center),_f0.subVectors(_v1$7,_v0$2),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$2,_v2$4);let n=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(n,_v0$2,_v1$7,_v2$4,_extents)||(n=[1,0,0,0,1,0,0,0,1],!satForAxes(n,_v0$2,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),n=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(n,_v0$2,_v1$7,_v2$4,_extents))}clampPoint(t,n){return n.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,_vector$b).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(_vector$b).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(_points),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$b=new Vector3,_box$4=new Box3,_v0$2=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(m,t,n,r,a){for(let u=0,h=m.length-3;u<=h;u+=3){_testAxis.fromArray(m,u);const f=a.x*Math.abs(_testAxis.x)+a.y*Math.abs(_testAxis.y)+a.z*Math.abs(_testAxis.z),d=t.dot(_testAxis),p=n.dot(_testAxis),c=r.dot(_testAxis);if(Math.max(-Math.max(d,p,c),Math.min(d,p,c))>f)return!1}return!0}const _box$3=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(t=new Vector3,n=-1){this.isSphere=!0,this.center=t,this.radius=n}set(t,n){return this.center.copy(t),this.radius=n,this}setFromPoints(t,n){const r=this.center;n!==void 0?r.copy(n):_box$3.setFromPoints(t).getCenter(r);let a=0;for(let u=0,h=t.length;u<h;u++)a=Math.max(a,r.distanceToSquared(t[u]));return this.radius=Math.sqrt(a),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const n=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=n*n}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,n){const r=this.center.distanceToSquared(t);return n.copy(t),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;_v1$6.subVectors(t,this.center);const n=_v1$6.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),a=(r-this.radius)*.5;this.center.addScaledVector(_v1$6,a/r),this.radius+=a}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(_v2$3.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(_v1$6.copy(t.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(t.center).sub(_v2$3))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$a=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;class Ray{constructor(t=new Vector3,n=new Vector3(0,0,-1)){this.origin=t,this.direction=n}set(t,n){return this.origin.copy(t),this.direction.copy(n),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,n){return n.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,_vector$a)),this}closestPointToPoint(t,n){n.subVectors(t,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const n=_vector$a.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(_vector$a.copy(this.origin).addScaledVector(this.direction,n),_vector$a.distanceToSquared(t))}distanceSqToSegment(t,n,r,a){_segCenter.copy(t).add(n).multiplyScalar(.5),_segDir.copy(n).sub(t).normalize(),_diff.copy(this.origin).sub(_segCenter);const u=t.distanceTo(n)*.5,h=-this.direction.dot(_segDir),f=_diff.dot(this.direction),d=-_diff.dot(_segDir),p=_diff.lengthSq(),c=Math.abs(1-h*h);let o,e,s,l;if(c>0)if(o=h*d-f,e=h*f-d,l=u*c,o>=0)if(e>=-l)if(e<=l){const g=1/c;o*=g,e*=g,s=o*(o+h*e+2*f)+e*(h*o+e+2*d)+p}else e=u,o=Math.max(0,-(h*e+f)),s=-o*o+e*(e+2*d)+p;else e=-u,o=Math.max(0,-(h*e+f)),s=-o*o+e*(e+2*d)+p;else e<=-l?(o=Math.max(0,-(-h*u+f)),e=o>0?-u:Math.min(Math.max(-u,-d),u),s=-o*o+e*(e+2*d)+p):e<=l?(o=0,e=Math.min(Math.max(-u,-d),u),s=e*(e+2*d)+p):(o=Math.max(0,-(h*u+f)),e=o>0?u:Math.min(Math.max(-u,-d),u),s=-o*o+e*(e+2*d)+p);else e=h>0?-u:u,o=Math.max(0,-(h*e+f)),s=-o*o+e*(e+2*d)+p;return r&&r.copy(this.origin).addScaledVector(this.direction,o),a&&a.copy(_segCenter).addScaledVector(_segDir,e),s}intersectSphere(t,n){_vector$a.subVectors(t.center,this.origin);const r=_vector$a.dot(this.direction),a=_vector$a.dot(_vector$a)-r*r,u=t.radius*t.radius;if(a>u)return null;const h=Math.sqrt(u-a),f=r-h,d=r+h;return d<0?null:f<0?this.at(d,n):this.at(f,n)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const n=t.normal.dot(this.direction);if(n===0)return t.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(t.normal)+t.constant)/n;return r>=0?r:null}intersectPlane(t,n){const r=this.distanceToPlane(t);return r===null?null:this.at(r,n)}intersectsPlane(t){const n=t.distanceToPoint(this.origin);return n===0||t.normal.dot(this.direction)*n<0}intersectBox(t,n){let r,a,u,h,f,d;const p=1/this.direction.x,c=1/this.direction.y,o=1/this.direction.z,e=this.origin;return p>=0?(r=(t.min.x-e.x)*p,a=(t.max.x-e.x)*p):(r=(t.max.x-e.x)*p,a=(t.min.x-e.x)*p),c>=0?(u=(t.min.y-e.y)*c,h=(t.max.y-e.y)*c):(u=(t.max.y-e.y)*c,h=(t.min.y-e.y)*c),r>h||u>a||((u>r||isNaN(r))&&(r=u),(h<a||isNaN(a))&&(a=h),o>=0?(f=(t.min.z-e.z)*o,d=(t.max.z-e.z)*o):(f=(t.max.z-e.z)*o,d=(t.min.z-e.z)*o),r>d||f>a)||((f>r||r!==r)&&(r=f),(d<a||a!==a)&&(a=d),a<0)?null:this.at(r>=0?r:a,n)}intersectsBox(t){return this.intersectBox(t,_vector$a)!==null}intersectTriangle(t,n,r,a,u){_edge1.subVectors(n,t),_edge2.subVectors(r,t),_normal$1.crossVectors(_edge1,_edge2);let h=this.direction.dot(_normal$1),f;if(h>0){if(a)return null;f=1}else if(h<0)f=-1,h=-h;else return null;_diff.subVectors(this.origin,t);const d=f*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(d<0)return null;const p=f*this.direction.dot(_edge1.cross(_diff));if(p<0||d+p>h)return null;const c=-f*_diff.dot(_normal$1);return c<0?null:this.at(c/h,u)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(t,n,r,a,u,h,f,d,p,c,o,e,s,l,g,y){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,n,r,a,u,h,f,d,p,c,o,e,s,l,g,y)}set(t,n,r,a,u,h,f,d,p,c,o,e,s,l,g,y){const b=this.elements;return b[0]=t,b[4]=n,b[8]=r,b[12]=a,b[1]=u,b[5]=h,b[9]=f,b[13]=d,b[2]=p,b[6]=c,b[10]=o,b[14]=e,b[3]=s,b[7]=l,b[11]=g,b[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(t){const n=this.elements,r=t.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(t){const n=this.elements,r=t.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(t){const n=t.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(t,n,r){return t.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(t,n,r){return this.set(t.x,n.x,r.x,0,t.y,n.y,r.y,0,t.z,n.z,r.z,0,0,0,0,1),this}extractRotation(t){const n=this.elements,r=t.elements,a=1/_v1$5.setFromMatrixColumn(t,0).length(),u=1/_v1$5.setFromMatrixColumn(t,1).length(),h=1/_v1$5.setFromMatrixColumn(t,2).length();return n[0]=r[0]*a,n[1]=r[1]*a,n[2]=r[2]*a,n[3]=0,n[4]=r[4]*u,n[5]=r[5]*u,n[6]=r[6]*u,n[7]=0,n[8]=r[8]*h,n[9]=r[9]*h,n[10]=r[10]*h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(t){const n=this.elements,r=t.x,a=t.y,u=t.z,h=Math.cos(r),f=Math.sin(r),d=Math.cos(a),p=Math.sin(a),c=Math.cos(u),o=Math.sin(u);if(t.order==="XYZ"){const e=h*c,s=h*o,l=f*c,g=f*o;n[0]=d*c,n[4]=-d*o,n[8]=p,n[1]=s+l*p,n[5]=e-g*p,n[9]=-f*d,n[2]=g-e*p,n[6]=l+s*p,n[10]=h*d}else if(t.order==="YXZ"){const e=d*c,s=d*o,l=p*c,g=p*o;n[0]=e+g*f,n[4]=l*f-s,n[8]=h*p,n[1]=h*o,n[5]=h*c,n[9]=-f,n[2]=s*f-l,n[6]=g+e*f,n[10]=h*d}else if(t.order==="ZXY"){const e=d*c,s=d*o,l=p*c,g=p*o;n[0]=e-g*f,n[4]=-h*o,n[8]=l+s*f,n[1]=s+l*f,n[5]=h*c,n[9]=g-e*f,n[2]=-h*p,n[6]=f,n[10]=h*d}else if(t.order==="ZYX"){const e=h*c,s=h*o,l=f*c,g=f*o;n[0]=d*c,n[4]=l*p-s,n[8]=e*p+g,n[1]=d*o,n[5]=g*p+e,n[9]=s*p-l,n[2]=-p,n[6]=f*d,n[10]=h*d}else if(t.order==="YZX"){const e=h*d,s=h*p,l=f*d,g=f*p;n[0]=d*c,n[4]=g-e*o,n[8]=l*o+s,n[1]=o,n[5]=h*c,n[9]=-f*c,n[2]=-p*c,n[6]=s*o+l,n[10]=e-g*o}else if(t.order==="XZY"){const e=h*d,s=h*p,l=f*d,g=f*p;n[0]=d*c,n[4]=-o,n[8]=p*c,n[1]=e*o+g,n[5]=h*c,n[9]=s*o-l,n[2]=l*o-s,n[6]=f*c,n[10]=g*o+e}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(t){return this.compose(_zero,t,_one)}lookAt(t,n,r){const a=this.elements;return _z.subVectors(t,n),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(r,_z),_x.lengthSq()===0&&(Math.abs(r.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(r,_z)),_x.normalize(),_y.crossVectors(_z,_x),a[0]=_x.x,a[4]=_y.x,a[8]=_z.x,a[1]=_x.y,a[5]=_y.y,a[9]=_z.y,a[2]=_x.z,a[6]=_y.z,a[10]=_z.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,n){const r=t.elements,a=n.elements,u=this.elements,h=r[0],f=r[4],d=r[8],p=r[12],c=r[1],o=r[5],e=r[9],s=r[13],l=r[2],g=r[6],y=r[10],b=r[14],_=r[3],v=r[7],T=r[11],w=r[15],A=a[0],S=a[4],O=a[8],C=a[12],D=a[1],$=a[5],L=a[9],P=a[13],B=a[2],I=a[6],M=a[10],k=a[14],X=a[3],G=a[7],J=a[11],Y=a[15];return u[0]=h*A+f*D+d*B+p*X,u[4]=h*S+f*$+d*I+p*G,u[8]=h*O+f*L+d*M+p*J,u[12]=h*C+f*P+d*k+p*Y,u[1]=c*A+o*D+e*B+s*X,u[5]=c*S+o*$+e*I+s*G,u[9]=c*O+o*L+e*M+s*J,u[13]=c*C+o*P+e*k+s*Y,u[2]=l*A+g*D+y*B+b*X,u[6]=l*S+g*$+y*I+b*G,u[10]=l*O+g*L+y*M+b*J,u[14]=l*C+g*P+y*k+b*Y,u[3]=_*A+v*D+T*B+w*X,u[7]=_*S+v*$+T*I+w*G,u[11]=_*O+v*L+T*M+w*J,u[15]=_*C+v*P+T*k+w*Y,this}multiplyScalar(t){const n=this.elements;return n[0]*=t,n[4]*=t,n[8]*=t,n[12]*=t,n[1]*=t,n[5]*=t,n[9]*=t,n[13]*=t,n[2]*=t,n[6]*=t,n[10]*=t,n[14]*=t,n[3]*=t,n[7]*=t,n[11]*=t,n[15]*=t,this}determinant(){const t=this.elements,n=t[0],r=t[4],a=t[8],u=t[12],h=t[1],f=t[5],d=t[9],p=t[13],c=t[2],o=t[6],e=t[10],s=t[14],l=t[3],g=t[7],y=t[11],b=t[15];return l*(+u*d*o-a*p*o-u*f*e+r*p*e+a*f*s-r*d*s)+g*(+n*d*s-n*p*e+u*h*e-a*h*s+a*p*c-u*d*c)+y*(+n*p*o-n*f*s-u*h*o+r*h*s+u*f*c-r*p*c)+b*(-a*f*c-n*d*o+n*f*e+a*h*o-r*h*e+r*d*c)}transpose(){const t=this.elements;let n;return n=t[1],t[1]=t[4],t[4]=n,n=t[2],t[2]=t[8],t[8]=n,n=t[6],t[6]=t[9],t[9]=n,n=t[3],t[3]=t[12],t[12]=n,n=t[7],t[7]=t[13],t[13]=n,n=t[11],t[11]=t[14],t[14]=n,this}setPosition(t,n,r){const a=this.elements;return t.isVector3?(a[12]=t.x,a[13]=t.y,a[14]=t.z):(a[12]=t,a[13]=n,a[14]=r),this}invert(){const t=this.elements,n=t[0],r=t[1],a=t[2],u=t[3],h=t[4],f=t[5],d=t[6],p=t[7],c=t[8],o=t[9],e=t[10],s=t[11],l=t[12],g=t[13],y=t[14],b=t[15],_=o*y*p-g*e*p+g*d*s-f*y*s-o*d*b+f*e*b,v=l*e*p-c*y*p-l*d*s+h*y*s+c*d*b-h*e*b,T=c*g*p-l*o*p+l*f*s-h*g*s-c*f*b+h*o*b,w=l*o*d-c*g*d-l*f*e+h*g*e+c*f*y-h*o*y,A=n*_+r*v+a*T+u*w;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const S=1/A;return t[0]=_*S,t[1]=(g*e*u-o*y*u-g*a*s+r*y*s+o*a*b-r*e*b)*S,t[2]=(f*y*u-g*d*u+g*a*p-r*y*p-f*a*b+r*d*b)*S,t[3]=(o*d*u-f*e*u-o*a*p+r*e*p+f*a*s-r*d*s)*S,t[4]=v*S,t[5]=(c*y*u-l*e*u+l*a*s-n*y*s-c*a*b+n*e*b)*S,t[6]=(l*d*u-h*y*u-l*a*p+n*y*p+h*a*b-n*d*b)*S,t[7]=(h*e*u-c*d*u+c*a*p-n*e*p-h*a*s+n*d*s)*S,t[8]=T*S,t[9]=(l*o*u-c*g*u-l*r*s+n*g*s+c*r*b-n*o*b)*S,t[10]=(h*g*u-l*f*u+l*r*p-n*g*p-h*r*b+n*f*b)*S,t[11]=(c*f*u-h*o*u-c*r*p+n*o*p+h*r*s-n*f*s)*S,t[12]=w*S,t[13]=(c*g*a-l*o*a+l*r*e-n*g*e-c*r*y+n*o*y)*S,t[14]=(l*f*a-h*g*a-l*r*d+n*g*d+h*r*y-n*f*y)*S,t[15]=(h*o*a-c*f*a+c*r*d-n*o*d-h*r*e+n*f*e)*S,this}scale(t){const n=this.elements,r=t.x,a=t.y,u=t.z;return n[0]*=r,n[4]*=a,n[8]*=u,n[1]*=r,n[5]*=a,n[9]*=u,n[2]*=r,n[6]*=a,n[10]*=u,n[3]*=r,n[7]*=a,n[11]*=u,this}getMaxScaleOnAxis(){const t=this.elements,n=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],a=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(n,r,a))}makeTranslation(t,n,r){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(t){const n=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(t){const n=Math.cos(t),r=Math.sin(t);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(t){const n=Math.cos(t),r=Math.sin(t);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,n){const r=Math.cos(n),a=Math.sin(n),u=1-r,h=t.x,f=t.y,d=t.z,p=u*h,c=u*f;return this.set(p*h+r,p*f-a*d,p*d+a*f,0,p*f+a*d,c*f+r,c*d-a*h,0,p*d-a*f,c*d+a*h,u*d*d+r,0,0,0,0,1),this}makeScale(t,n,r){return this.set(t,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(t,n,r,a,u,h){return this.set(1,r,u,0,t,1,h,0,n,a,1,0,0,0,0,1),this}compose(t,n,r){const a=this.elements,u=n._x,h=n._y,f=n._z,d=n._w,p=u+u,c=h+h,o=f+f,e=u*p,s=u*c,l=u*o,g=h*c,y=h*o,b=f*o,_=d*p,v=d*c,T=d*o,w=r.x,A=r.y,S=r.z;return a[0]=(1-(g+b))*w,a[1]=(s+T)*w,a[2]=(l-v)*w,a[3]=0,a[4]=(s-T)*A,a[5]=(1-(e+b))*A,a[6]=(y+_)*A,a[7]=0,a[8]=(l+v)*S,a[9]=(y-_)*S,a[10]=(1-(e+g))*S,a[11]=0,a[12]=t.x,a[13]=t.y,a[14]=t.z,a[15]=1,this}decompose(t,n,r){const a=this.elements;let u=_v1$5.set(a[0],a[1],a[2]).length();const h=_v1$5.set(a[4],a[5],a[6]).length(),f=_v1$5.set(a[8],a[9],a[10]).length();this.determinant()<0&&(u=-u),t.x=a[12],t.y=a[13],t.z=a[14],_m1$2.copy(this);const p=1/u,c=1/h,o=1/f;return _m1$2.elements[0]*=p,_m1$2.elements[1]*=p,_m1$2.elements[2]*=p,_m1$2.elements[4]*=c,_m1$2.elements[5]*=c,_m1$2.elements[6]*=c,_m1$2.elements[8]*=o,_m1$2.elements[9]*=o,_m1$2.elements[10]*=o,n.setFromRotationMatrix(_m1$2),r.x=u,r.y=h,r.z=f,this}makePerspective(t,n,r,a,u,h,f=WebGLCoordinateSystem){const d=this.elements,p=2*u/(n-t),c=2*u/(r-a),o=(n+t)/(n-t),e=(r+a)/(r-a);let s,l;if(f===WebGLCoordinateSystem)s=-(h+u)/(h-u),l=-2*h*u/(h-u);else if(f===WebGPUCoordinateSystem)s=-h/(h-u),l=-h*u/(h-u);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+f);return d[0]=p,d[4]=0,d[8]=o,d[12]=0,d[1]=0,d[5]=c,d[9]=e,d[13]=0,d[2]=0,d[6]=0,d[10]=s,d[14]=l,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(t,n,r,a,u,h,f=WebGLCoordinateSystem){const d=this.elements,p=1/(n-t),c=1/(r-a),o=1/(h-u),e=(n+t)*p,s=(r+a)*c;let l,g;if(f===WebGLCoordinateSystem)l=(h+u)*o,g=-2*o;else if(f===WebGPUCoordinateSystem)l=u*o,g=-1*o;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+f);return d[0]=2*p,d[4]=0,d[8]=0,d[12]=-e,d[1]=0,d[5]=2*c,d[9]=0,d[13]=-s,d[2]=0,d[6]=0,d[10]=g,d[14]=-l,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(t){const n=this.elements,r=t.elements;for(let a=0;a<16;a++)if(n[a]!==r[a])return!1;return!0}fromArray(t,n=0){for(let r=0;r<16;r++)this.elements[r]=t[r+n];return this}toArray(t=[],n=0){const r=this.elements;return t[n]=r[0],t[n+1]=r[1],t[n+2]=r[2],t[n+3]=r[3],t[n+4]=r[4],t[n+5]=r[5],t[n+6]=r[6],t[n+7]=r[7],t[n+8]=r[8],t[n+9]=r[9],t[n+10]=r[10],t[n+11]=r[11],t[n+12]=r[12],t[n+13]=r[13],t[n+14]=r[14],t[n+15]=r[15],t}}const _v1$5=new Vector3,_m1$2=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix$1=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(t=0,n=0,r=0,a=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=a}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,a=this._order){return this._x=t,this._y=n,this._z=r,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const a=t.elements,u=a[0],h=a[4],f=a[8],d=a[1],p=a[5],c=a[9],o=a[2],e=a[6],s=a[10];switch(n){case"XYZ":this._y=Math.asin(clamp(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-c,s),this._z=Math.atan2(-h,u)):(this._x=Math.atan2(e,p),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(f,s),this._z=Math.atan2(d,p)):(this._y=Math.atan2(-o,u),this._z=0);break;case"ZXY":this._x=Math.asin(clamp(e,-1,1)),Math.abs(e)<.9999999?(this._y=Math.atan2(-o,s),this._z=Math.atan2(-h,p)):(this._y=0,this._z=Math.atan2(d,u));break;case"ZYX":this._y=Math.asin(-clamp(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(e,s),this._z=Math.atan2(d,u)):(this._x=0,this._z=Math.atan2(-h,p));break;case"YZX":this._z=Math.asin(clamp(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-c,p),this._y=Math.atan2(-o,u)):(this._x=0,this._y=Math.atan2(f,s));break;case"XZY":this._z=Math.asin(-clamp(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(e,p),this._y=Math.atan2(f,u)):(this._x=Math.atan2(-c,s),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return _matrix$1.makeRotationFromQuaternion(t),this.setFromRotationMatrix(_matrix$1,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$1=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const t=new Vector3,n=new Euler,r=new Quaternion,a=new Vector3(1,1,1);function u(){r.setFromEuler(n,!1)}function h(){n.setFromQuaternion(r,void 0,!1)}n._onChange(u),r._onChange(h),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return _q1.setFromAxisAngle(t,n),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(t,n){return _q1.setFromAxisAngle(t,n),this.quaternion.premultiply(_q1),this}rotateX(t){return this.rotateOnAxis(_xAxis,t)}rotateY(t){return this.rotateOnAxis(_yAxis,t)}rotateZ(t){return this.rotateOnAxis(_zAxis,t)}translateOnAxis(t,n){return _v1$4.copy(t).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(_xAxis,t)}translateY(t){return this.translateOnAxis(_yAxis,t)}translateZ(t){return this.translateOnAxis(_zAxis,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(_m1$1.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?_target.copy(t):_target.set(t,n,r);const a=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$1.lookAt(_position$3,_target,this.up):_m1$1.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$1),a&&(_m1$1.extractRotation(a.matrixWorld),_q1.setFromRotationMatrix(_m1$1),this.quaternion.premultiply(_q1.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(_addedEvent)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(t);return n!==-1&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(_removedEvent)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),_m1$1.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),_m1$1.multiply(t.parent.matrixWorld)),t.applyMatrix4(_m1$1),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,a=this.children.length;r<a;r++){const h=this.children[r].getObjectByProperty(t,n);if(h!==void 0)return h}}getObjectsByProperty(t,n,r=[]){this[t]===n&&r.push(this);const a=this.children;for(let u=0,h=a.length;u<h;u++)a[u].getObjectsByProperty(t,n,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,t,_scale$2),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let r=0,a=n.length;r<a;r++)n[r].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const n=this.children;for(let r=0,a=n.length;r<a;r++)n[r].traverseVisible(t)}traverseAncestors(t){const n=this.parent;n!==null&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let r=0,a=n.length;r<a;r++){const u=n[r];(u.matrixWorldAutoUpdate===!0||t===!0)&&u.updateMatrixWorld(t)}}updateWorldMatrix(t,n){const r=this.parent;if(t===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const a=this.children;for(let u=0,h=a.length;u<h;u++){const f=a[u];f.matrixWorldAutoUpdate===!0&&f.updateWorldMatrix(!1,!0)}}}toJSON(t){const n=t===void 0||typeof t=="string",r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const a={};a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.castShadow===!0&&(a.castShadow=!0),this.receiveShadow===!0&&(a.receiveShadow=!0),this.visible===!1&&(a.visible=!1),this.frustumCulled===!1&&(a.frustumCulled=!1),this.renderOrder!==0&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(a.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(a.type="BatchedMesh",a.perObjectFrustumCulled=this.perObjectFrustumCulled,a.sortObjects=this.sortObjects,a.drawRanges=this._drawRanges,a.reservedRanges=this._reservedRanges,a.visibility=this._visibility,a.active=this._active,a.bounds=this._bounds.map(f=>({boxInitialized:f.boxInitialized,boxMin:f.box.min.toArray(),boxMax:f.box.max.toArray(),sphereInitialized:f.sphereInitialized,sphereRadius:f.sphere.radius,sphereCenter:f.sphere.center.toArray()})),a.maxGeometryCount=this._maxGeometryCount,a.maxVertexCount=this._maxVertexCount,a.maxIndexCount=this._maxIndexCount,a.geometryInitialized=this._geometryInitialized,a.geometryCount=this._geometryCount,a.matricesTexture=this._matricesTexture.toJSON(t),this.boundingSphere!==null&&(a.boundingSphere={center:a.boundingSphere.center.toArray(),radius:a.boundingSphere.radius}),this.boundingBox!==null&&(a.boundingBox={min:a.boundingBox.min.toArray(),max:a.boundingBox.max.toArray()}));function u(f,d){return f[d.uuid]===void 0&&(f[d.uuid]=d.toJSON(t)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(a.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=u(t.geometries,this.geometry);const f=this.geometry.parameters;if(f!==void 0&&f.shapes!==void 0){const d=f.shapes;if(Array.isArray(d))for(let p=0,c=d.length;p<c;p++){const o=d[p];u(t.shapes,o)}else u(t.shapes,d)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(u(t.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const f=[];for(let d=0,p=this.material.length;d<p;d++)f.push(u(t.materials,this.material[d]));a.material=f}else a.material=u(t.materials,this.material);if(this.children.length>0){a.children=[];for(let f=0;f<this.children.length;f++)a.children.push(this.children[f].toJSON(t).object)}if(this.animations.length>0){a.animations=[];for(let f=0;f<this.animations.length;f++){const d=this.animations[f];a.animations.push(u(t.animations,d))}}if(n){const f=h(t.geometries),d=h(t.materials),p=h(t.textures),c=h(t.images),o=h(t.shapes),e=h(t.skeletons),s=h(t.animations),l=h(t.nodes);f.length>0&&(r.geometries=f),d.length>0&&(r.materials=d),p.length>0&&(r.textures=p),c.length>0&&(r.images=c),o.length>0&&(r.shapes=o),e.length>0&&(r.skeletons=e),s.length>0&&(r.animations=s),l.length>0&&(r.nodes=l)}return r.object=a,r;function h(f){const d=[];for(const p in f){const c=f[p];delete c.metadata,d.push(c)}return d}}clone(t){return new this.constructor().copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),n===!0)for(let r=0;r<t.children.length;r++){const a=t.children[r];this.add(a.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$1=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$1=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;let warnedGetUV=!1;class Triangle{constructor(t=new Vector3,n=new Vector3,r=new Vector3){this.a=t,this.b=n,this.c=r}static getNormal(t,n,r,a){a.subVectors(r,n),_v0$1.subVectors(t,n),a.cross(_v0$1);const u=a.lengthSq();return u>0?a.multiplyScalar(1/Math.sqrt(u)):a.set(0,0,0)}static getBarycoord(t,n,r,a,u){_v0$1.subVectors(a,n),_v1$3.subVectors(r,n),_v2$2.subVectors(t,n);const h=_v0$1.dot(_v0$1),f=_v0$1.dot(_v1$3),d=_v0$1.dot(_v2$2),p=_v1$3.dot(_v1$3),c=_v1$3.dot(_v2$2),o=h*p-f*f;if(o===0)return u.set(0,0,0),null;const e=1/o,s=(p*d-f*c)*e,l=(h*c-f*d)*e;return u.set(1-s-l,l,s)}static containsPoint(t,n,r,a){return this.getBarycoord(t,n,r,a,_v3$1)===null?!1:_v3$1.x>=0&&_v3$1.y>=0&&_v3$1.x+_v3$1.y<=1}static getUV(t,n,r,a,u,h,f,d){return warnedGetUV===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),warnedGetUV=!0),this.getInterpolation(t,n,r,a,u,h,f,d)}static getInterpolation(t,n,r,a,u,h,f,d){return this.getBarycoord(t,n,r,a,_v3$1)===null?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(u,_v3$1.x),d.addScaledVector(h,_v3$1.y),d.addScaledVector(f,_v3$1.z),d)}static isFrontFacing(t,n,r,a){return _v0$1.subVectors(r,n),_v1$3.subVectors(t,n),_v0$1.cross(_v1$3).dot(a)<0}set(t,n,r){return this.a.copy(t),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(t,n,r,a){return this.a.copy(t[n]),this.b.copy(t[r]),this.c.copy(t[a]),this}setFromAttributeAndIndices(t,n,r,a){return this.a.fromBufferAttribute(t,n),this.b.fromBufferAttribute(t,r),this.c.fromBufferAttribute(t,a),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Triangle.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,n){return Triangle.getBarycoord(t,this.a,this.b,this.c,n)}getUV(t,n,r,a,u){return warnedGetUV===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),warnedGetUV=!0),Triangle.getInterpolation(t,this.a,this.b,this.c,n,r,a,u)}getInterpolation(t,n,r,a,u){return Triangle.getInterpolation(t,this.a,this.b,this.c,n,r,a,u)}containsPoint(t){return Triangle.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Triangle.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,n){const r=this.a,a=this.b,u=this.c;let h,f;_vab.subVectors(a,r),_vac.subVectors(u,r),_vap.subVectors(t,r);const d=_vab.dot(_vap),p=_vac.dot(_vap);if(d<=0&&p<=0)return n.copy(r);_vbp.subVectors(t,a);const c=_vab.dot(_vbp),o=_vac.dot(_vbp);if(c>=0&&o<=c)return n.copy(a);const e=d*o-c*p;if(e<=0&&d>=0&&c<=0)return h=d/(d-c),n.copy(r).addScaledVector(_vab,h);_vcp.subVectors(t,u);const s=_vab.dot(_vcp),l=_vac.dot(_vcp);if(l>=0&&s<=l)return n.copy(u);const g=s*p-d*l;if(g<=0&&p>=0&&l<=0)return f=p/(p-l),n.copy(r).addScaledVector(_vac,f);const y=c*l-s*o;if(y<=0&&o-c>=0&&s-l>=0)return _vbc.subVectors(u,a),f=(o-c)/(o-c+(s-l)),n.copy(a).addScaledVector(_vbc,f);const b=1/(y+g+e);return h=g*b,f=e*b,n.copy(r).addScaledVector(_vab,h).addScaledVector(_vac,f)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(m,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?m+(t-m)*6*n:n<1/2?t:n<2/3?m+(t-m)*6*(2/3-n):m}class Color{constructor(t,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,n,r)}set(t,n,r){if(n===void 0&&r===void 0){const a=t;a&&a.isColor?this.copy(a):typeof a=="number"?this.setHex(a):typeof a=="string"&&this.setStyle(a)}else this.setRGB(t,n,r);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=SRGBColorSpace){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,ColorManagement.toWorkingColorSpace(this,n),this}setRGB(t,n,r,a=ColorManagement.workingColorSpace){return this.r=t,this.g=n,this.b=r,ColorManagement.toWorkingColorSpace(this,a),this}setHSL(t,n,r,a=ColorManagement.workingColorSpace){if(t=euclideanModulo(t,1),n=clamp(n,0,1),r=clamp(r,0,1),n===0)this.r=this.g=this.b=r;else{const u=r<=.5?r*(1+n):r+n-r*n,h=2*r-u;this.r=hue2rgb(h,u,t+1/3),this.g=hue2rgb(h,u,t),this.b=hue2rgb(h,u,t-1/3)}return ColorManagement.toWorkingColorSpace(this,a),this}setStyle(t,n=SRGBColorSpace){function r(u){u!==void 0&&parseFloat(u)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let a;if(a=/^(\w+)\(([^\)]*)\)/.exec(t)){let u;const h=a[1],f=a[2];switch(h){case"rgb":case"rgba":if(u=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return r(u[4]),this.setRGB(Math.min(255,parseInt(u[1],10))/255,Math.min(255,parseInt(u[2],10))/255,Math.min(255,parseInt(u[3],10))/255,n);if(u=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return r(u[4]),this.setRGB(Math.min(100,parseInt(u[1],10))/100,Math.min(100,parseInt(u[2],10))/100,Math.min(100,parseInt(u[3],10))/100,n);break;case"hsl":case"hsla":if(u=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return r(u[4]),this.setHSL(parseFloat(u[1])/360,parseFloat(u[2])/100,parseFloat(u[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(a=/^\#([A-Fa-f\d]+)$/.exec(t)){const u=a[1],h=u.length;if(h===3)return this.setRGB(parseInt(u.charAt(0),16)/15,parseInt(u.charAt(1),16)/15,parseInt(u.charAt(2),16)/15,n);if(h===6)return this.setHex(parseInt(u,16),n);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,n);return this}setColorName(t,n=SRGBColorSpace){const r=_colorKeywords[t.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=SRGBToLinear(t.r),this.g=SRGBToLinear(t.g),this.b=SRGBToLinear(t.b),this}copyLinearToSRGB(t){return this.r=LinearToSRGB(t.r),this.g=LinearToSRGB(t.g),this.b=LinearToSRGB(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=SRGBColorSpace){return ColorManagement.fromWorkingColorSpace(_color$1.copy(this),t),Math.round(clamp(_color$1.r*255,0,255))*65536+Math.round(clamp(_color$1.g*255,0,255))*256+Math.round(clamp(_color$1.b*255,0,255))}getHexString(t=SRGBColorSpace){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color$1.copy(this),n);const r=_color$1.r,a=_color$1.g,u=_color$1.b,h=Math.max(r,a,u),f=Math.min(r,a,u);let d,p;const c=(f+h)/2;if(f===h)d=0,p=0;else{const o=h-f;switch(p=c<=.5?o/(h+f):o/(2-h-f),h){case r:d=(a-u)/o+(a<u?6:0);break;case a:d=(u-r)/o+2;break;case u:d=(r-a)/o+4;break}d/=6}return t.h=d,t.s=p,t.l=c,t}getRGB(t,n=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color$1.copy(this),n),t.r=_color$1.r,t.g=_color$1.g,t.b=_color$1.b,t}getStyle(t=SRGBColorSpace){ColorManagement.fromWorkingColorSpace(_color$1.copy(this),t);const n=_color$1.r,r=_color$1.g,a=_color$1.b;return t!==SRGBColorSpace?`color(${t} ${n.toFixed(3)} ${r.toFixed(3)} ${a.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(a*255)})`}offsetHSL(t,n,r){return this.getHSL(_hslA),this.setHSL(_hslA.h+t,_hslA.s+n,_hslA.l+r)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,r){return this.r=t.r+(n.r-t.r)*r,this.g=t.g+(n.g-t.g)*r,this.b=t.b+(n.b-t.b)*r,this}lerpHSL(t,n){this.getHSL(_hslA),t.getHSL(_hslB);const r=lerp(_hslA.h,_hslB.h,n),a=lerp(_hslA.s,_hslB.s,n),u=lerp(_hslA.l,_hslB.l,n);return this.setHSL(r,a,u),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const n=this.r,r=this.g,a=this.b,u=t.elements;return this.r=u[0]*n+u[3]*r+u[6]*a,this.g=u[1]*n+u[4]*r+u[7]*a,this.b=u[2]*n+u[5]*r+u[8]*a,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const _color$1=new Color;Color.NAMES=_colorKeywords;let _materialId=0;class Material extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_materialId++}),this.uuid=generateUUID(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Color(0,0,0),this.blendAlpha=0,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const n in t){const r=t[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const a=this[n];if(a===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}a&&a.isColor?a.set(r):a&&a.isVector3&&r&&r.isVector3?a.copy(r):this[n]=r}}toJSON(t){const n=t===void 0||typeof t=="string";n&&(t={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(r.blending=this.blending),this.side!==FrontSide&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==SrcAlphaFactor&&(r.blendSrc=this.blendSrc),this.blendDst!==OneMinusSrcAlphaFactor&&(r.blendDst=this.blendDst),this.blendEquation!==AddEquation&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==LessEqualDepth&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AlwaysStencilFunc&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==KeepStencilOp&&(r.stencilFail=this.stencilFail),this.stencilZFail!==KeepStencilOp&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==KeepStencilOp&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function a(u){const h=[];for(const f in u){const d=u[f];delete d.metadata,h.push(d)}return h}if(n){const u=a(t.textures),h=a(t.images);u.length>0&&(r.textures=u),h.length>0&&(r.images=h)}return r}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const n=t.clippingPlanes;let r=null;if(n!==null){const a=n.length;r=new Array(a);for(let u=0;u!==a;++u)r[u]=n[u].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}class MeshBasicMaterial extends Material{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const _vector$9=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(t,n,r=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=n,this.count=t!==void 0?t.length/n:0,this.normalized=r,this.usage=StaticDrawUsage,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(t){return this.usage=t,this}addUpdateRange(t,n){this.updateRanges.push({start:t,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,n,r){t*=this.itemSize,r*=n.itemSize;for(let a=0,u=this.itemSize;a<u;a++)this.array[t+a]=n.array[r+a];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)_vector2$1.fromBufferAttribute(this,n),_vector2$1.applyMatrix3(t),this.setXY(n,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)_vector$9.fromBufferAttribute(this,n),_vector$9.applyMatrix3(t),this.setXYZ(n,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyMatrix4(t){for(let n=0,r=this.count;n<r;n++)_vector$9.fromBufferAttribute(this,n),_vector$9.applyMatrix4(t),this.setXYZ(n,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyNormalMatrix(t){for(let n=0,r=this.count;n<r;n++)_vector$9.fromBufferAttribute(this,n),_vector$9.applyNormalMatrix(t),this.setXYZ(n,_vector$9.x,_vector$9.y,_vector$9.z);return this}transformDirection(t){for(let n=0,r=this.count;n<r;n++)_vector$9.fromBufferAttribute(this,n),_vector$9.transformDirection(t),this.setXYZ(n,_vector$9.x,_vector$9.y,_vector$9.z);return this}set(t,n=0){return this.array.set(t,n),this}getComponent(t,n){let r=this.array[t*this.itemSize+n];return this.normalized&&(r=denormalize(r,this.array)),r}setComponent(t,n,r){return this.normalized&&(r=normalize(r,this.array)),this.array[t*this.itemSize+n]=r,this}getX(t){let n=this.array[t*this.itemSize];return this.normalized&&(n=denormalize(n,this.array)),n}setX(t,n){return this.normalized&&(n=normalize(n,this.array)),this.array[t*this.itemSize]=n,this}getY(t){let n=this.array[t*this.itemSize+1];return this.normalized&&(n=denormalize(n,this.array)),n}setY(t,n){return this.normalized&&(n=normalize(n,this.array)),this.array[t*this.itemSize+1]=n,this}getZ(t){let n=this.array[t*this.itemSize+2];return this.normalized&&(n=denormalize(n,this.array)),n}setZ(t,n){return this.normalized&&(n=normalize(n,this.array)),this.array[t*this.itemSize+2]=n,this}getW(t){let n=this.array[t*this.itemSize+3];return this.normalized&&(n=denormalize(n,this.array)),n}setW(t,n){return this.normalized&&(n=normalize(n,this.array)),this.array[t*this.itemSize+3]=n,this}setXY(t,n,r){return t*=this.itemSize,this.normalized&&(n=normalize(n,this.array),r=normalize(r,this.array)),this.array[t+0]=n,this.array[t+1]=r,this}setXYZ(t,n,r,a){return t*=this.itemSize,this.normalized&&(n=normalize(n,this.array),r=normalize(r,this.array),a=normalize(a,this.array)),this.array[t+0]=n,this.array[t+1]=r,this.array[t+2]=a,this}setXYZW(t,n,r,a,u){return t*=this.itemSize,this.normalized&&(n=normalize(n,this.array),r=normalize(r,this.array),a=normalize(a,this.array),u=normalize(u,this.array)),this.array[t+0]=n,this.array[t+1]=r,this.array[t+2]=a,this.array[t+3]=u,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==StaticDrawUsage&&(t.usage=this.usage),t}}class Uint16BufferAttribute extends BufferAttribute{constructor(t,n,r){super(new Uint16Array(t),n,r)}}class Uint32BufferAttribute extends BufferAttribute{constructor(t,n,r){super(new Uint32Array(t),n,r)}}class Float32BufferAttribute extends BufferAttribute{constructor(t,n,r){super(new Float32Array(t),n,r)}}let _id$2=0;const _m1=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$8=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$2++}),this.uuid=generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(arrayNeedsUint32(t)?Uint32BufferAttribute:Uint16BufferAttribute)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,n){return this.attributes[t]=n,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,n,r=0){this.groups.push({start:t,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(t,n){this.drawRange.start=t,this.drawRange.count=n}applyMatrix4(t){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(t),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const u=new Matrix3().getNormalMatrix(t);r.applyNormalMatrix(u),r.needsUpdate=!0}const a=this.attributes.tangent;return a!==void 0&&(a.transformDirection(t),a.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return _m1.makeRotationFromQuaternion(t),this.applyMatrix4(_m1),this}rotateX(t){return _m1.makeRotationX(t),this.applyMatrix4(_m1),this}rotateY(t){return _m1.makeRotationY(t),this.applyMatrix4(_m1),this}rotateZ(t){return _m1.makeRotationZ(t),this.applyMatrix4(_m1),this}translate(t,n,r){return _m1.makeTranslation(t,n,r),this.applyMatrix4(_m1),this}scale(t,n,r){return _m1.makeScale(t,n,r),this.applyMatrix4(_m1),this}lookAt(t){return _obj.lookAt(t),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(t){const n=[];for(let r=0,a=t.length;r<a;r++){const u=t[r];n.push(u.x,u.y,u.z||0)}return this.setAttribute("position",new Float32BufferAttribute(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const t=this.attributes.position,n=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),n)for(let r=0,a=n.length;r<a;r++){const u=n[r];_box$2.setFromBufferAttribute(u),this.morphTargetsRelative?(_vector$8.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$8),_vector$8.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$8)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const t=this.attributes.position,n=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Vector3,1/0);return}if(t){const r=this.boundingSphere.center;if(_box$2.setFromBufferAttribute(t),n)for(let u=0,h=n.length;u<h;u++){const f=n[u];_boxMorphTargets.setFromBufferAttribute(f),this.morphTargetsRelative?(_vector$8.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$8),_vector$8.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$8)):(_box$2.expandByPoint(_boxMorphTargets.min),_box$2.expandByPoint(_boxMorphTargets.max))}_box$2.getCenter(r);let a=0;for(let u=0,h=t.count;u<h;u++)_vector$8.fromBufferAttribute(t,u),a=Math.max(a,r.distanceToSquared(_vector$8));if(n)for(let u=0,h=n.length;u<h;u++){const f=n[u],d=this.morphTargetsRelative;for(let p=0,c=f.count;p<c;p++)_vector$8.fromBufferAttribute(f,p),d&&(_offset.fromBufferAttribute(t,p),_vector$8.add(_offset)),a=Math.max(a,r.distanceToSquared(_vector$8))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,n=this.attributes;if(t===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=t.array,a=n.position.array,u=n.normal.array,h=n.uv.array,f=a.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*f),4));const d=this.getAttribute("tangent").array,p=[],c=[];for(let D=0;D<f;D++)p[D]=new Vector3,c[D]=new Vector3;const o=new Vector3,e=new Vector3,s=new Vector3,l=new Vector2,g=new Vector2,y=new Vector2,b=new Vector3,_=new Vector3;function v(D,$,L){o.fromArray(a,D*3),e.fromArray(a,$*3),s.fromArray(a,L*3),l.fromArray(h,D*2),g.fromArray(h,$*2),y.fromArray(h,L*2),e.sub(o),s.sub(o),g.sub(l),y.sub(l);const P=1/(g.x*y.y-y.x*g.y);isFinite(P)&&(b.copy(e).multiplyScalar(y.y).addScaledVector(s,-g.y).multiplyScalar(P),_.copy(s).multiplyScalar(g.x).addScaledVector(e,-y.x).multiplyScalar(P),p[D].add(b),p[$].add(b),p[L].add(b),c[D].add(_),c[$].add(_),c[L].add(_))}let T=this.groups;T.length===0&&(T=[{start:0,count:r.length}]);for(let D=0,$=T.length;D<$;++D){const L=T[D],P=L.start,B=L.count;for(let I=P,M=P+B;I<M;I+=3)v(r[I+0],r[I+1],r[I+2])}const w=new Vector3,A=new Vector3,S=new Vector3,O=new Vector3;function C(D){S.fromArray(u,D*3),O.copy(S);const $=p[D];w.copy($),w.sub(S.multiplyScalar(S.dot($))).normalize(),A.crossVectors(O,$);const P=A.dot(c[D])<0?-1:1;d[D*4]=w.x,d[D*4+1]=w.y,d[D*4+2]=w.z,d[D*4+3]=P}for(let D=0,$=T.length;D<$;++D){const L=T[D],P=L.start,B=L.count;for(let I=P,M=P+B;I<M;I+=3)C(r[I+0]),C(r[I+1]),C(r[I+2])}}computeVertexNormals(){const t=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new BufferAttribute(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let e=0,s=r.count;e<s;e++)r.setXYZ(e,0,0,0);const a=new Vector3,u=new Vector3,h=new Vector3,f=new Vector3,d=new Vector3,p=new Vector3,c=new Vector3,o=new Vector3;if(t)for(let e=0,s=t.count;e<s;e+=3){const l=t.getX(e+0),g=t.getX(e+1),y=t.getX(e+2);a.fromBufferAttribute(n,l),u.fromBufferAttribute(n,g),h.fromBufferAttribute(n,y),c.subVectors(h,u),o.subVectors(a,u),c.cross(o),f.fromBufferAttribute(r,l),d.fromBufferAttribute(r,g),p.fromBufferAttribute(r,y),f.add(c),d.add(c),p.add(c),r.setXYZ(l,f.x,f.y,f.z),r.setXYZ(g,d.x,d.y,d.z),r.setXYZ(y,p.x,p.y,p.z)}else for(let e=0,s=n.count;e<s;e+=3)a.fromBufferAttribute(n,e+0),u.fromBufferAttribute(n,e+1),h.fromBufferAttribute(n,e+2),c.subVectors(h,u),o.subVectors(a,u),c.cross(o),r.setXYZ(e+0,c.x,c.y,c.z),r.setXYZ(e+1,c.x,c.y,c.z),r.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let n=0,r=t.count;n<r;n++)_vector$8.fromBufferAttribute(t,n),_vector$8.normalize(),t.setXYZ(n,_vector$8.x,_vector$8.y,_vector$8.z)}toNonIndexed(){function t(f,d){const p=f.array,c=f.itemSize,o=f.normalized,e=new p.constructor(d.length*c);let s=0,l=0;for(let g=0,y=d.length;g<y;g++){f.isInterleavedBufferAttribute?s=d[g]*f.data.stride+f.offset:s=d[g]*c;for(let b=0;b<c;b++)e[l++]=p[s++]}return new BufferAttribute(e,c,o)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new BufferGeometry,r=this.index.array,a=this.attributes;for(const f in a){const d=a[f],p=t(d,r);n.setAttribute(f,p)}const u=this.morphAttributes;for(const f in u){const d=[],p=u[f];for(let c=0,o=p.length;c<o;c++){const e=p[c],s=t(e,r);d.push(s)}n.morphAttributes[f]=d}n.morphTargetsRelative=this.morphTargetsRelative;const h=this.groups;for(let f=0,d=h.length;f<d;f++){const p=h[f];n.addGroup(p.start,p.count,p.materialIndex)}return n}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const d=this.parameters;for(const p in d)d[p]!==void 0&&(t[p]=d[p]);return t}t.data={attributes:{}};const n=this.index;n!==null&&(t.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const d in r){const p=r[d];t.data.attributes[d]=p.toJSON(t.data)}const a={};let u=!1;for(const d in this.morphAttributes){const p=this.morphAttributes[d],c=[];for(let o=0,e=p.length;o<e;o++){const s=p[o];c.push(s.toJSON(t.data))}c.length>0&&(a[d]=c,u=!0)}u&&(t.data.morphAttributes=a,t.data.morphTargetsRelative=this.morphTargetsRelative);const h=this.groups;h.length>0&&(t.data.groups=JSON.parse(JSON.stringify(h)));const f=this.boundingSphere;return f!==null&&(t.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=t.name;const r=t.index;r!==null&&this.setIndex(r.clone(n));const a=t.attributes;for(const p in a){const c=a[p];this.setAttribute(p,c.clone(n))}const u=t.morphAttributes;for(const p in u){const c=[],o=u[p];for(let e=0,s=o.length;e<s;e++)c.push(o[e].clone(n));this.morphAttributes[p]=c}this.morphTargetsRelative=t.morphTargetsRelative;const h=t.groups;for(let p=0,c=h.length;p<c;p++){const o=h[p];this.addGroup(o.start,o.count,o.materialIndex)}const f=t.boundingBox;f!==null&&(this.boundingBox=f.clone());const d=t.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray,_sphere$6=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2,_normalA=new Vector3,_normalB=new Vector3,_normalC=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(t=new BufferGeometry,n=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=n,this.updateMorphTargets()}copy(t,n){return super.copy(t,n),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const a=n[r[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,h=a.length;u<h;u++){const f=a[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=u}}}}getVertexPosition(t,n){const r=this.geometry,a=r.attributes.position,u=r.morphAttributes.position,h=r.morphTargetsRelative;n.fromBufferAttribute(a,t);const f=this.morphTargetInfluences;if(u&&f){_morphA.set(0,0,0);for(let d=0,p=u.length;d<p;d++){const c=f[d],o=u[d];c!==0&&(_tempA.fromBufferAttribute(o,t),h?_morphA.addScaledVector(_tempA,c):_morphA.addScaledVector(_tempA.sub(n),c))}n.add(_morphA)}return n}raycast(t,n){const r=this.geometry,a=this.material,u=this.matrixWorld;a!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),_sphere$6.copy(r.boundingSphere),_sphere$6.applyMatrix4(u),_ray$3.copy(t.ray).recast(t.near),!(_sphere$6.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$6,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(t.far-t.near)**2))&&(_inverseMatrix$3.copy(u).invert(),_ray$3.copy(t.ray).applyMatrix4(_inverseMatrix$3),!(r.boundingBox!==null&&_ray$3.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(t,n,_ray$3)))}_computeIntersections(t,n,r){let a;const u=this.geometry,h=this.material,f=u.index,d=u.attributes.position,p=u.attributes.uv,c=u.attributes.uv1,o=u.attributes.normal,e=u.groups,s=u.drawRange;if(f!==null)if(Array.isArray(h))for(let l=0,g=e.length;l<g;l++){const y=e[l],b=h[y.materialIndex],_=Math.max(y.start,s.start),v=Math.min(f.count,Math.min(y.start+y.count,s.start+s.count));for(let T=_,w=v;T<w;T+=3){const A=f.getX(T),S=f.getX(T+1),O=f.getX(T+2);a=checkGeometryIntersection(this,b,t,r,p,c,o,A,S,O),a&&(a.faceIndex=Math.floor(T/3),a.face.materialIndex=y.materialIndex,n.push(a))}}else{const l=Math.max(0,s.start),g=Math.min(f.count,s.start+s.count);for(let y=l,b=g;y<b;y+=3){const _=f.getX(y),v=f.getX(y+1),T=f.getX(y+2);a=checkGeometryIntersection(this,h,t,r,p,c,o,_,v,T),a&&(a.faceIndex=Math.floor(y/3),n.push(a))}}else if(d!==void 0)if(Array.isArray(h))for(let l=0,g=e.length;l<g;l++){const y=e[l],b=h[y.materialIndex],_=Math.max(y.start,s.start),v=Math.min(d.count,Math.min(y.start+y.count,s.start+s.count));for(let T=_,w=v;T<w;T+=3){const A=T,S=T+1,O=T+2;a=checkGeometryIntersection(this,b,t,r,p,c,o,A,S,O),a&&(a.faceIndex=Math.floor(T/3),a.face.materialIndex=y.materialIndex,n.push(a))}}else{const l=Math.max(0,s.start),g=Math.min(d.count,s.start+s.count);for(let y=l,b=g;y<b;y+=3){const _=y,v=y+1,T=y+2;a=checkGeometryIntersection(this,h,t,r,p,c,o,_,v,T),a&&(a.faceIndex=Math.floor(y/3),n.push(a))}}}}function checkIntersection(m,t,n,r,a,u,h,f){let d;if(t.side===BackSide?d=r.intersectTriangle(h,u,a,!0,f):d=r.intersectTriangle(a,u,h,t.side===FrontSide,f),d===null)return null;_intersectionPointWorld.copy(f),_intersectionPointWorld.applyMatrix4(m.matrixWorld);const p=n.ray.origin.distanceTo(_intersectionPointWorld);return p<n.near||p>n.far?null:{distance:p,point:_intersectionPointWorld.clone(),object:m}}function checkGeometryIntersection(m,t,n,r,a,u,h,f,d,p){m.getVertexPosition(f,_vA$1),m.getVertexPosition(d,_vB$1),m.getVertexPosition(p,_vC$1);const c=checkIntersection(m,t,n,r,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(c){a&&(_uvA$1.fromBufferAttribute(a,f),_uvB$1.fromBufferAttribute(a,d),_uvC$1.fromBufferAttribute(a,p),c.uv=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),u&&(_uvA$1.fromBufferAttribute(u,f),_uvB$1.fromBufferAttribute(u,d),_uvC$1.fromBufferAttribute(u,p),c.uv1=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2),c.uv2=c.uv1),h&&(_normalA.fromBufferAttribute(h,f),_normalB.fromBufferAttribute(h,d),_normalC.fromBufferAttribute(h,p),c.normal=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_normalA,_normalB,_normalC,new Vector3),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));const o={a:f,b:d,c:p,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,o.normal),c.face=o}return c}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(t,n){return super.copy(t,n),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,n){super.updateWorldMatrix(t,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class PerspectiveCamera extends Camera{constructor(t=50,n=1,r=.1,a=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=r,this.far=a,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,n){return super.copy(t,n),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const n=.5*this.getFilmHeight()/t;this.fov=RAD2DEG*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,n,r,a,u,h){this.aspect=t/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=a,this.view.width=u,this.view.height=h,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let n=t*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,r=2*n,a=this.aspect*r,u=-.5*a;const h=this.view;if(this.view!==null&&this.view.enabled){const d=h.fullWidth,p=h.fullHeight;u+=h.offsetX*a/d,n-=h.offsetY*r/p,a*=h.width/d,r*=h.height/p}const f=this.filmOffset;f!==0&&(u+=t*f/this.getFilmWidth()),this.projectionMatrix.makePerspective(u,u+a,n,n-r,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const n=super.toJSON(t);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(t=new Vector3(1,0,0),n=0){this.isPlane=!0,this.normal=t,this.constant=n}set(t,n){return this.normal.copy(t),this.constant=n,this}setComponents(t,n,r,a){return this.normal.set(t,n,r),this.constant=a,this}setFromNormalAndCoplanarPoint(t,n){return this.normal.copy(t),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(t,n,r){const a=_vector1.subVectors(r,n).cross(_vector2.subVectors(t,n)).normalize();return this.setFromNormalAndCoplanarPoint(a,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,n){return n.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,n){const r=t.delta(_vector1),a=this.normal.dot(r);if(a===0)return this.distanceToPoint(t.start)===0?n.copy(t.start):null;const u=-(t.start.dot(this.normal)+this.constant)/a;return u<0||u>1?null:n.copy(t.start).addScaledVector(r,u)}intersectsLine(t){const n=this.distanceToPoint(t.start),r=this.distanceToPoint(t.end);return n<0&&r>0||r<0&&n>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,n){const r=n||_normalMatrix.getNormalMatrix(t),a=this.coplanarPoint(_vector1).applyMatrix4(t),u=this.normal.applyMatrix3(r).normalize();return this.constant=-a.dot(u),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$5=new Sphere,_vector$7=new Vector3;class Frustum{constructor(t=new Plane,n=new Plane,r=new Plane,a=new Plane,u=new Plane,h=new Plane){this.planes=[t,n,r,a,u,h]}set(t,n,r,a,u,h){const f=this.planes;return f[0].copy(t),f[1].copy(n),f[2].copy(r),f[3].copy(a),f[4].copy(u),f[5].copy(h),this}copy(t){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(t.planes[r]);return this}setFromProjectionMatrix(t,n=WebGLCoordinateSystem){const r=this.planes,a=t.elements,u=a[0],h=a[1],f=a[2],d=a[3],p=a[4],c=a[5],o=a[6],e=a[7],s=a[8],l=a[9],g=a[10],y=a[11],b=a[12],_=a[13],v=a[14],T=a[15];if(r[0].setComponents(d-u,e-p,y-s,T-b).normalize(),r[1].setComponents(d+u,e+p,y+s,T+b).normalize(),r[2].setComponents(d+h,e+c,y+l,T+_).normalize(),r[3].setComponents(d-h,e-c,y-l,T-_).normalize(),r[4].setComponents(d-f,e-o,y-g,T-v).normalize(),n===WebGLCoordinateSystem)r[5].setComponents(d+f,e+o,y+g,T+v).normalize();else if(n===WebGPUCoordinateSystem)r[5].setComponents(f,o,g,v).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(t){if(t.boundingSphere!==void 0)t.boundingSphere===null&&t.computeBoundingSphere(),_sphere$5.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const n=t.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),_sphere$5.copy(n.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(_sphere$5)}intersectsSprite(t){return _sphere$5.center.set(0,0,0),_sphere$5.radius=.7071067811865476,_sphere$5.applyMatrix4(t.matrixWorld),this.intersectsSphere(_sphere$5)}intersectsSphere(t){const n=this.planes,r=t.center,a=-t.radius;for(let u=0;u<6;u++)if(n[u].distanceToPoint(r)<a)return!1;return!0}intersectsBox(t){const n=this.planes;for(let r=0;r<6;r++){const a=n[r];if(_vector$7.x=a.normal.x>0?t.max.x:t.min.x,_vector$7.y=a.normal.y>0?t.max.y:t.min.y,_vector$7.z=a.normal.z>0?t.max.z:t.min.z,a.distanceToPoint(_vector$7)<0)return!1}return!0}containsPoint(t){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class OrthographicCamera extends Camera{constructor(t=-1,n=1,r=1,a=-1,u=.1,h=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=n,this.top=r,this.bottom=a,this.near=u,this.far=h,this.updateProjectionMatrix()}copy(t,n){return super.copy(t,n),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,n,r,a,u,h){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=a,this.view.width=u,this.view.height=h,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,a=(this.top+this.bottom)/2;let u=r-t,h=r+t,f=a+n,d=a-n;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;u+=p*this.view.offsetX,h=u+p*this.view.width,f-=c*this.view.offsetY,d=f-c*this.view.height}this.projectionMatrix.makeOrthographic(u,h,f,d,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const n=super.toJSON(t);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class DepthTexture extends Texture{constructor(t,n,r,a,u,h,f,d,p,c){if(c=c!==void 0?c:DepthFormat,c!==DepthFormat&&c!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===DepthFormat&&(r=UnsignedIntType),r===void 0&&c===DepthStencilFormat&&(r=UnsignedInt248Type),super(null,a,u,h,f,d,c,r,p),this.isDepthTexture=!0,this.image={width:t,height:n},this.magFilter=f!==void 0?f:NearestFilter,this.minFilter=d!==void 0?d:NearestFilter,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.compareFunction=t.compareFunction,this}toJSON(t){const n=super.toJSON(t);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}const emptyShadowTexture=new DepthTexture(1,1);emptyShadowTexture.compareFunction=LessEqualCompare;class Group extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _basePosition=new Vector3,_skinIndex=new Vector4,_skinWeight=new Vector4,_vector3=new Vector3,_matrix4=new Matrix4,_vertex=new Vector3,_sphere$4=new Sphere,_inverseMatrix$2=new Matrix4,_ray$2=new Ray;class SkinnedMesh extends Mesh{constructor(t,n){super(t,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=AttachedBindMode,this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const t=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.makeEmpty();const n=t.getAttribute("position");for(let r=0;r<n.count;r++)this.getVertexPosition(r,_vertex),this.boundingBox.expandByPoint(_vertex)}computeBoundingSphere(){const t=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingSphere.makeEmpty();const n=t.getAttribute("position");for(let r=0;r<n.count;r++)this.getVertexPosition(r,_vertex),this.boundingSphere.expandByPoint(_vertex)}copy(t,n){return super.copy(t,n),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this}raycast(t,n){const r=this.material,a=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$4.copy(this.boundingSphere),_sphere$4.applyMatrix4(a),t.ray.intersectsSphere(_sphere$4)!==!1&&(_inverseMatrix$2.copy(a).invert(),_ray$2.copy(t.ray).applyMatrix4(_inverseMatrix$2),!(this.boundingBox!==null&&_ray$2.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(t,n,_ray$2)))}getVertexPosition(t,n){return super.getVertexPosition(t,n),this.applyBoneTransform(t,n),n}bind(t,n){this.skeleton=t,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Vector4,n=this.geometry.attributes.skinWeight;for(let r=0,a=n.count;r<a;r++){t.fromBufferAttribute(n,r);const u=1/t.manhattanLength();u!==1/0?t.multiplyScalar(u):t.set(1,0,0,0),n.setXYZW(r,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode===AttachedBindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===DetachedBindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(t,n){const r=this.skeleton,a=this.geometry;_skinIndex.fromBufferAttribute(a.attributes.skinIndex,t),_skinWeight.fromBufferAttribute(a.attributes.skinWeight,t),_basePosition.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let u=0;u<4;u++){const h=_skinWeight.getComponent(u);if(h!==0){const f=_skinIndex.getComponent(u);_matrix4.multiplyMatrices(r.bones[f].matrixWorld,r.boneInverses[f]),n.addScaledVector(_vector3.copy(_basePosition).applyMatrix4(_matrix4),h)}}return n.applyMatrix4(this.bindMatrixInverse)}boneTransform(t,n){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(t,n)}}class Bone extends Object3D{constructor(){super(),this.isBone=!0,this.type="Bone"}}class DataTexture extends Texture{constructor(t=null,n=1,r=1,a,u,h,f,d,p=NearestFilter,c=NearestFilter,o,e){super(null,h,f,d,p,c,a,u,o,e),this.isDataTexture=!0,this.image={data:t,width:n,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _offsetMatrix=new Matrix4,_identityMatrix$1=new Matrix4;class Skeleton{constructor(t=[],n=[]){this.uuid=generateUUID(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const t=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(t.length*16),n.length===0)this.calculateInverses();else if(t.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,a=this.bones.length;r<a;r++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,n=this.bones.length;t<n;t++){const r=new Matrix4;this.bones[t]&&r.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];r&&r.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const t=this.bones,n=this.boneInverses,r=this.boneMatrices,a=this.boneTexture;for(let u=0,h=t.length;u<h;u++){const f=t[u]?t[u].matrixWorld:_identityMatrix$1;_offsetMatrix.multiplyMatrices(f,n[u]),_offsetMatrix.toArray(r,u*16)}a!==null&&(a.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(this.bones.length*4);t=Math.ceil(t/4)*4,t=Math.max(t,4);const n=new Float32Array(t*t*4);n.set(this.boneMatrices);const r=new DataTexture(n,t,t,RGBAFormat,FloatType);return r.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=r,this}getBoneByName(t){for(let n=0,r=this.bones.length;n<r;n++){const a=this.bones[n];if(a.name===t)return a}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,n){this.uuid=t.uuid;for(let r=0,a=t.bones.length;r<a;r++){const u=t.bones[r];let h=n[u];h===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",u),h=new Bone),this.bones.push(h),this.boneInverses.push(new Matrix4().fromArray(t.boneInverses[r]))}return this.init(),this}toJSON(){const t={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const n=this.bones,r=this.boneInverses;for(let a=0,u=n.length;a<u;a++){const h=n[a];t.bones.push(h.uuid);const f=r[a];t.boneInverses.push(f.toArray())}return t}}class LineBasicMaterial extends Material{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const _start$1=new Vector3,_end$1=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1=new Ray,_sphere$1=new Sphere;class Line extends Object3D{constructor(t=new BufferGeometry,n=new LineBasicMaterial){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=n,this.updateMorphTargets()}copy(t,n){return super.copy(t,n),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.index===null){const n=t.attributes.position,r=[0];for(let a=1,u=n.count;a<u;a++)_start$1.fromBufferAttribute(n,a-1),_end$1.fromBufferAttribute(n,a),r[a]=r[a-1],r[a]+=_start$1.distanceTo(_end$1);t.setAttribute("lineDistance",new Float32BufferAttribute(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,n){const r=this.geometry,a=this.matrixWorld,u=t.params.Line.threshold,h=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),_sphere$1.copy(r.boundingSphere),_sphere$1.applyMatrix4(a),_sphere$1.radius+=u,t.ray.intersectsSphere(_sphere$1)===!1)return;_inverseMatrix$1.copy(a).invert(),_ray$1.copy(t.ray).applyMatrix4(_inverseMatrix$1);const f=u/((this.scale.x+this.scale.y+this.scale.z)/3),d=f*f,p=new Vector3,c=new Vector3,o=new Vector3,e=new Vector3,s=this.isLineSegments?2:1,l=r.index,y=r.attributes.position;if(l!==null){const b=Math.max(0,h.start),_=Math.min(l.count,h.start+h.count);for(let v=b,T=_-1;v<T;v+=s){const w=l.getX(v),A=l.getX(v+1);if(p.fromBufferAttribute(y,w),c.fromBufferAttribute(y,A),_ray$1.distanceSqToSegment(p,c,e,o)>d)continue;e.applyMatrix4(this.matrixWorld);const O=t.ray.origin.distanceTo(e);O<t.near||O>t.far||n.push({distance:O,point:o.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else{const b=Math.max(0,h.start),_=Math.min(y.count,h.start+h.count);for(let v=b,T=_-1;v<T;v+=s){if(p.fromBufferAttribute(y,v),c.fromBufferAttribute(y,v+1),_ray$1.distanceSqToSegment(p,c,e,o)>d)continue;e.applyMatrix4(this.matrixWorld);const A=t.ray.origin.distanceTo(e);A<t.near||A>t.far||n.push({distance:A,point:o.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const a=n[r[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,h=a.length;u<h;u++){const f=a[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=u}}}}}const _start=new Vector3,_end=new Vector3;class LineSegments extends Line{constructor(t,n){super(t,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.index===null){const n=t.attributes.position,r=[];for(let a=0,u=n.count;a<u;a+=2)_start.fromBufferAttribute(n,a),_end.fromBufferAttribute(n,a+1),r[a]=a===0?0:r[a-1],r[a+1]=r[a]+_start.distanceTo(_end);t.setAttribute("lineDistance",new Float32BufferAttribute(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class PointsMaterial extends Material{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const _inverseMatrix=new Matrix4,_ray=new Ray,_sphere=new Sphere,_position$2=new Vector3;class Points extends Object3D{constructor(t=new BufferGeometry,n=new PointsMaterial){super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=n,this.updateMorphTargets()}copy(t,n){return super.copy(t,n),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}raycast(t,n){const r=this.geometry,a=this.matrixWorld,u=t.params.Points.threshold,h=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),_sphere.copy(r.boundingSphere),_sphere.applyMatrix4(a),_sphere.radius+=u,t.ray.intersectsSphere(_sphere)===!1)return;_inverseMatrix.copy(a).invert(),_ray.copy(t.ray).applyMatrix4(_inverseMatrix);const f=u/((this.scale.x+this.scale.y+this.scale.z)/3),d=f*f,p=r.index,o=r.attributes.position;if(p!==null){const e=Math.max(0,h.start),s=Math.min(p.count,h.start+h.count);for(let l=e,g=s;l<g;l++){const y=p.getX(l);_position$2.fromBufferAttribute(o,y),testPoint(_position$2,y,d,a,t,n,this)}}else{const e=Math.max(0,h.start),s=Math.min(o.count,h.start+h.count);for(let l=e,g=s;l<g;l++)_position$2.fromBufferAttribute(o,l),testPoint(_position$2,l,d,a,t,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const a=n[r[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,h=a.length;u<h;u++){const f=a[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=u}}}}}function testPoint(m,t,n,r,a,u,h){const f=_ray.distanceSqToPoint(m);if(f<n){const d=new Vector3;_ray.closestPointToPoint(m,d),d.applyMatrix4(r);const p=a.ray.origin.distanceTo(d);if(p<a.near||p>a.far)return;u.push({distance:p,distanceToRay:Math.sqrt(f),point:d,index:t,face:null,object:h})}}class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,n){const r=this.getUtoTmapping(t);return this.getPoint(r,n)}getPoints(t=5){const n=[];for(let r=0;r<=t;r++)n.push(this.getPoint(r/t));return n}getSpacedPoints(t=5){const n=[];for(let r=0;r<=t;r++)n.push(this.getPointAt(r/t));return n}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let r,a=this.getPoint(0),u=0;n.push(0);for(let h=1;h<=t;h++)r=this.getPoint(h/t),u+=r.distanceTo(a),n.push(u),a=r;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,n){const r=this.getLengths();let a=0;const u=r.length;let h;n?h=n:h=t*r[u-1];let f=0,d=u-1,p;for(;f<=d;)if(a=Math.floor(f+(d-f)/2),p=r[a]-h,p<0)f=a+1;else if(p>0)d=a-1;else{d=a;break}if(a=d,r[a]===h)return a/(u-1);const c=r[a],e=r[a+1]-c,s=(h-c)/e;return(a+s)/(u-1)}getTangent(t,n){let a=t-1e-4,u=t+1e-4;a<0&&(a=0),u>1&&(u=1);const h=this.getPoint(a),f=this.getPoint(u),d=n||(h.isVector2?new Vector2:new Vector3);return d.copy(f).sub(h).normalize(),d}getTangentAt(t,n){const r=this.getUtoTmapping(t);return this.getTangent(r,n)}computeFrenetFrames(t,n){const r=new Vector3,a=[],u=[],h=[],f=new Vector3,d=new Matrix4;for(let s=0;s<=t;s++){const l=s/t;a[s]=this.getTangentAt(l,new Vector3)}u[0]=new Vector3,h[0]=new Vector3;let p=Number.MAX_VALUE;const c=Math.abs(a[0].x),o=Math.abs(a[0].y),e=Math.abs(a[0].z);c<=p&&(p=c,r.set(1,0,0)),o<=p&&(p=o,r.set(0,1,0)),e<=p&&r.set(0,0,1),f.crossVectors(a[0],r).normalize(),u[0].crossVectors(a[0],f),h[0].crossVectors(a[0],u[0]);for(let s=1;s<=t;s++){if(u[s]=u[s-1].clone(),h[s]=h[s-1].clone(),f.crossVectors(a[s-1],a[s]),f.length()>Number.EPSILON){f.normalize();const l=Math.acos(clamp(a[s-1].dot(a[s]),-1,1));u[s].applyMatrix4(d.makeRotationAxis(f,l))}h[s].crossVectors(a[s],u[s])}if(n===!0){let s=Math.acos(clamp(u[0].dot(u[t]),-1,1));s/=t,a[0].dot(f.crossVectors(u[0],u[t]))>0&&(s=-s);for(let l=1;l<=t;l++)u[l].applyMatrix4(d.makeRotationAxis(a[l],s*l)),h[l].crossVectors(a[l],u[l])}return{tangents:a,normals:u,binormals:h}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}const Earcut={triangulate:function(m,t,n=2){const r=t&&t.length,a=r?t[0]*n:m.length;let u=linkedList(m,0,a,n,!0);const h=[];if(!u||u.next===u.prev)return h;let f,d,p,c,o,e,s;if(r&&(u=eliminateHoles(m,t,u,n)),m.length>80*n){f=p=m[0],d=c=m[1];for(let l=n;l<a;l+=n)o=m[l],e=m[l+1],o<f&&(f=o),e<d&&(d=e),o>p&&(p=o),e>c&&(c=e);s=Math.max(p-f,c-d),s=s!==0?32767/s:0}return earcutLinked(u,h,n,f,d,s,0),h}};function linkedList(m,t,n,r,a){let u,h;if(a===signedArea(m,t,n,r)>0)for(u=t;u<n;u+=r)h=insertNode(u,m[u],m[u+1],h);else for(u=n-r;u>=t;u-=r)h=insertNode(u,m[u],m[u+1],h);return h&&equals(h,h.next)&&(removeNode(h),h=h.next),h}function filterPoints(m,t){if(!m)return m;t||(t=m);let n=m,r;do if(r=!1,!n.steiner&&(equals(n,n.next)||area(n.prev,n,n.next)===0)){if(removeNode(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function earcutLinked(m,t,n,r,a,u,h){if(!m)return;!h&&u&&indexCurve(m,r,a,u);let f=m,d,p;for(;m.prev!==m.next;){if(d=m.prev,p=m.next,u?isEarHashed(m,r,a,u):isEar(m)){t.push(d.i/n|0),t.push(m.i/n|0),t.push(p.i/n|0),removeNode(m),m=p.next,f=p.next;continue}if(m=p,m===f){h?h===1?(m=cureLocalIntersections(filterPoints(m),t,n),earcutLinked(m,t,n,r,a,u,2)):h===2&&splitEarcut(m,t,n,r,a,u):earcutLinked(filterPoints(m),t,n,r,a,u,1);break}}}function isEar(m){const t=m.prev,n=m,r=m.next;if(area(t,n,r)>=0)return!1;const a=t.x,u=n.x,h=r.x,f=t.y,d=n.y,p=r.y,c=a<u?a<h?a:h:u<h?u:h,o=f<d?f<p?f:p:d<p?d:p,e=a>u?a>h?a:h:u>h?u:h,s=f>d?f>p?f:p:d>p?d:p;let l=r.next;for(;l!==t;){if(l.x>=c&&l.x<=e&&l.y>=o&&l.y<=s&&pointInTriangle(a,f,u,d,h,p,l.x,l.y)&&area(l.prev,l,l.next)>=0)return!1;l=l.next}return!0}function isEarHashed(m,t,n,r){const a=m.prev,u=m,h=m.next;if(area(a,u,h)>=0)return!1;const f=a.x,d=u.x,p=h.x,c=a.y,o=u.y,e=h.y,s=f<d?f<p?f:p:d<p?d:p,l=c<o?c<e?c:e:o<e?o:e,g=f>d?f>p?f:p:d>p?d:p,y=c>o?c>e?c:e:o>e?o:e,b=zOrder(s,l,t,n,r),_=zOrder(g,y,t,n,r);let v=m.prevZ,T=m.nextZ;for(;v&&v.z>=b&&T&&T.z<=_;){if(v.x>=s&&v.x<=g&&v.y>=l&&v.y<=y&&v!==a&&v!==h&&pointInTriangle(f,c,d,o,p,e,v.x,v.y)&&area(v.prev,v,v.next)>=0||(v=v.prevZ,T.x>=s&&T.x<=g&&T.y>=l&&T.y<=y&&T!==a&&T!==h&&pointInTriangle(f,c,d,o,p,e,T.x,T.y)&&area(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;v&&v.z>=b;){if(v.x>=s&&v.x<=g&&v.y>=l&&v.y<=y&&v!==a&&v!==h&&pointInTriangle(f,c,d,o,p,e,v.x,v.y)&&area(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;T&&T.z<=_;){if(T.x>=s&&T.x<=g&&T.y>=l&&T.y<=y&&T!==a&&T!==h&&pointInTriangle(f,c,d,o,p,e,T.x,T.y)&&area(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function cureLocalIntersections(m,t,n){let r=m;do{const a=r.prev,u=r.next.next;!equals(a,u)&&intersects(a,r,r.next,u)&&locallyInside(a,u)&&locallyInside(u,a)&&(t.push(a.i/n|0),t.push(r.i/n|0),t.push(u.i/n|0),removeNode(r),removeNode(r.next),r=m=u),r=r.next}while(r!==m);return filterPoints(r)}function splitEarcut(m,t,n,r,a,u){let h=m;do{let f=h.next.next;for(;f!==h.prev;){if(h.i!==f.i&&isValidDiagonal(h,f)){let d=splitPolygon(h,f);h=filterPoints(h,h.next),d=filterPoints(d,d.next),earcutLinked(h,t,n,r,a,u,0),earcutLinked(d,t,n,r,a,u,0);return}f=f.next}h=h.next}while(h!==m)}function eliminateHoles(m,t,n,r){const a=[];let u,h,f,d,p;for(u=0,h=t.length;u<h;u++)f=t[u]*r,d=u<h-1?t[u+1]*r:m.length,p=linkedList(m,f,d,r,!1),p===p.next&&(p.steiner=!0),a.push(getLeftmost(p));for(a.sort(compareX),u=0;u<a.length;u++)n=eliminateHole(a[u],n);return n}function compareX(m,t){return m.x-t.x}function eliminateHole(m,t){const n=findHoleBridge(m,t);if(!n)return t;const r=splitPolygon(n,m);return filterPoints(r,r.next),filterPoints(n,n.next)}function findHoleBridge(m,t){let n=t,r=-1/0,a;const u=m.x,h=m.y;do{if(h<=n.y&&h>=n.next.y&&n.next.y!==n.y){const e=n.x+(h-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=u&&e>r&&(r=e,a=n.x<n.next.x?n:n.next,e===u))return a}n=n.next}while(n!==t);if(!a)return null;const f=a,d=a.x,p=a.y;let c=1/0,o;n=a;do u>=n.x&&n.x>=d&&u!==n.x&&pointInTriangle(h<p?u:r,h,d,p,h<p?r:u,h,n.x,n.y)&&(o=Math.abs(h-n.y)/(u-n.x),locallyInside(n,m)&&(o<c||o===c&&(n.x>a.x||n.x===a.x&&sectorContainsSector(a,n)))&&(a=n,c=o)),n=n.next;while(n!==f);return a}function sectorContainsSector(m,t){return area(m.prev,m,t.prev)<0&&area(t.next,m,m.next)<0}function indexCurve(m,t,n,r){let a=m;do a.z===0&&(a.z=zOrder(a.x,a.y,t,n,r)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==m);a.prevZ.nextZ=null,a.prevZ=null,sortLinked(a)}function sortLinked(m){let t,n,r,a,u,h,f,d,p=1;do{for(n=m,m=null,u=null,h=0;n;){for(h++,r=n,f=0,t=0;t<p&&(f++,r=r.nextZ,!!r);t++);for(d=p;f>0||d>0&&r;)f!==0&&(d===0||!r||n.z<=r.z)?(a=n,n=n.nextZ,f--):(a=r,r=r.nextZ,d--),u?u.nextZ=a:m=a,a.prevZ=u,u=a;n=r}u.nextZ=null,p*=2}while(h>1);return m}function zOrder(m,t,n,r,a){return m=(m-n)*a|0,t=(t-r)*a|0,m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,m|t<<1}function getLeftmost(m){let t=m,n=m;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==m);return n}function pointInTriangle(m,t,n,r,a,u,h,f){return(a-h)*(t-f)>=(m-h)*(u-f)&&(m-h)*(r-f)>=(n-h)*(t-f)&&(n-h)*(u-f)>=(a-h)*(r-f)}function isValidDiagonal(m,t){return m.next.i!==t.i&&m.prev.i!==t.i&&!intersectsPolygon(m,t)&&(locallyInside(m,t)&&locallyInside(t,m)&&middleInside(m,t)&&(area(m.prev,m,t.prev)||area(m,t.prev,t))||equals(m,t)&&area(m.prev,m,m.next)>0&&area(t.prev,t,t.next)>0)}function area(m,t,n){return(t.y-m.y)*(n.x-t.x)-(t.x-m.x)*(n.y-t.y)}function equals(m,t){return m.x===t.x&&m.y===t.y}function intersects(m,t,n,r){const a=sign(area(m,t,n)),u=sign(area(m,t,r)),h=sign(area(n,r,m)),f=sign(area(n,r,t));return!!(a!==u&&h!==f||a===0&&onSegment(m,n,t)||u===0&&onSegment(m,r,t)||h===0&&onSegment(n,m,r)||f===0&&onSegment(n,t,r))}function onSegment(m,t,n){return t.x<=Math.max(m.x,n.x)&&t.x>=Math.min(m.x,n.x)&&t.y<=Math.max(m.y,n.y)&&t.y>=Math.min(m.y,n.y)}function sign(m){return m>0?1:m<0?-1:0}function intersectsPolygon(m,t){let n=m;do{if(n.i!==m.i&&n.next.i!==m.i&&n.i!==t.i&&n.next.i!==t.i&&intersects(n,n.next,m,t))return!0;n=n.next}while(n!==m);return!1}function locallyInside(m,t){return area(m.prev,m,m.next)<0?area(m,t,m.next)>=0&&area(m,m.prev,t)>=0:area(m,t,m.prev)<0||area(m,m.next,t)<0}function middleInside(m,t){let n=m,r=!1;const a=(m.x+t.x)/2,u=(m.y+t.y)/2;do n.y>u!=n.next.y>u&&n.next.y!==n.y&&a<(n.next.x-n.x)*(u-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==m);return r}function splitPolygon(m,t){const n=new Node(m.i,m.x,m.y),r=new Node(t.i,t.x,t.y),a=m.next,u=t.prev;return m.next=t,t.prev=m,n.next=a,a.prev=n,r.next=n,n.prev=r,u.next=r,r.prev=u,r}function insertNode(m,t,n,r){const a=new Node(m,t,n);return r?(a.next=r.next,a.prev=r,r.next.prev=a,r.next=a):(a.prev=a,a.next=a),a}function removeNode(m){m.next.prev=m.prev,m.prev.next=m.next,m.prevZ&&(m.prevZ.nextZ=m.nextZ),m.nextZ&&(m.nextZ.prevZ=m.prevZ)}function Node(m,t,n){this.i=m,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(m,t,n,r){let a=0;for(let u=t,h=n-r;u<n;u+=r)a+=(m[h]-m[u])*(m[u+1]+m[h+1]),h=u;return a}class ShapeUtils{static area(t){const n=t.length;let r=0;for(let a=n-1,u=0;u<n;a=u++)r+=t[a].x*t[u].y-t[u].x*t[a].y;return r*.5}static isClockWise(t){return ShapeUtils.area(t)<0}static triangulateShape(t,n){const r=[],a=[],u=[];removeDupEndPts(t),addContour(r,t);let h=t.length;n.forEach(removeDupEndPts);for(let d=0;d<n.length;d++)a.push(h),h+=n[d].length,addContour(r,n[d]);const f=Earcut.triangulate(r,a);for(let d=0;d<f.length;d+=3)u.push(f.slice(d,d+3));return u}}function removeDupEndPts(m){const t=m.length;t>2&&m[t-1].equals(m[0])&&m.pop()}function addContour(m,t){for(let n=0;n<t.length;n++)m.push(t[n].x),m.push(t[n].y)}class MeshPhongMaterial extends Material{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class MeshLambertMaterial extends Material{constructor(t){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}function convertArray(m,t,n){return!m||!n&&m.constructor===t?m:typeof t.BYTES_PER_ELEMENT=="number"?new t(m):Array.prototype.slice.call(m)}function isTypedArray(m){return ArrayBuffer.isView(m)&&!(m instanceof DataView)}function getKeyframeOrder(m){function t(a,u){return m[a]-m[u]}const n=m.length,r=new Array(n);for(let a=0;a!==n;++a)r[a]=a;return r.sort(t),r}function sortedArray(m,t,n){const r=m.length,a=new m.constructor(r);for(let u=0,h=0;h!==r;++u){const f=n[u]*t;for(let d=0;d!==t;++d)a[h++]=m[f+d]}return a}function flattenJSON(m,t,n,r){let a=1,u=m[0];for(;u!==void 0&&u[r]===void 0;)u=m[a++];if(u===void 0)return;let h=u[r];if(h!==void 0)if(Array.isArray(h))do h=u[r],h!==void 0&&(t.push(u.time),n.push.apply(n,h)),u=m[a++];while(u!==void 0);else if(h.toArray!==void 0)do h=u[r],h!==void 0&&(t.push(u.time),h.toArray(n,n.length)),u=m[a++];while(u!==void 0);else do h=u[r],h!==void 0&&(t.push(u.time),n.push(h)),u=m[a++];while(u!==void 0)}class Interpolant{constructor(t,n,r,a){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=a!==void 0?a:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(t){const n=this.parameterPositions;let r=this._cachedIndex,a=n[r],u=n[r-1];t:{e:{let h;n:{r:if(!(t<a)){for(let f=r+2;;){if(a===void 0){if(t<u)break r;return r=n.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===f)break;if(u=a,a=n[++r],t<a)break e}h=n.length;break n}if(!(t>=u)){const f=n[1];t<f&&(r=2,u=f);for(let d=r-2;;){if(u===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===d)break;if(a=u,u=n[--r-1],t>=u)break e}h=r,r=0;break n}break t}for(;r<h;){const f=r+h>>>1;t<n[f]?h=f:r=f+1}if(a=n[r],u=n[r-1],u===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(a===void 0)return r=n.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,u,a)}return this.interpolate_(r,u,t,a)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const n=this.resultBuffer,r=this.sampleValues,a=this.valueSize,u=t*a;for(let h=0;h!==a;++h)n[h]=r[u+h];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(t,n,r,a){super(t,n,r,a),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(t,n,r){const a=this.parameterPositions;let u=t-2,h=t+1,f=a[u],d=a[h];if(f===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:u=t,f=2*n-r;break;case WrapAroundEnding:u=a.length-2,f=n+a[u]-a[u+1];break;default:u=t,f=r}if(d===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:h=t,d=2*r-n;break;case WrapAroundEnding:h=1,d=r+a[1]-a[0];break;default:h=t-1,d=n}const p=(r-n)*.5,c=this.valueSize;this._weightPrev=p/(n-f),this._weightNext=p/(d-r),this._offsetPrev=u*c,this._offsetNext=h*c}interpolate_(t,n,r,a){const u=this.resultBuffer,h=this.sampleValues,f=this.valueSize,d=t*f,p=d-f,c=this._offsetPrev,o=this._offsetNext,e=this._weightPrev,s=this._weightNext,l=(r-n)/(a-n),g=l*l,y=g*l,b=-e*y+2*e*g-e*l,_=(1+e)*y+(-1.5-2*e)*g+(-.5+e)*l+1,v=(-1-s)*y+(1.5+s)*g+.5*l,T=s*y-s*g;for(let w=0;w!==f;++w)u[w]=b*h[c+w]+_*h[p+w]+v*h[d+w]+T*h[o+w];return u}}class LinearInterpolant extends Interpolant{constructor(t,n,r,a){super(t,n,r,a)}interpolate_(t,n,r,a){const u=this.resultBuffer,h=this.sampleValues,f=this.valueSize,d=t*f,p=d-f,c=(r-n)/(a-n),o=1-c;for(let e=0;e!==f;++e)u[e]=h[p+e]*o+h[d+e]*c;return u}}class DiscreteInterpolant extends Interpolant{constructor(t,n,r,a){super(t,n,r,a)}interpolate_(t){return this.copySampleValue_(t-1)}}class KeyframeTrack{constructor(t,n,r,a){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=convertArray(n,this.TimeBufferType),this.values=convertArray(r,this.ValueBufferType),this.setInterpolation(a||this.DefaultInterpolation)}static toJSON(t){const n=t.constructor;let r;if(n.toJSON!==this.toJSON)r=n.toJSON(t);else{r={name:t.name,times:convertArray(t.times,Array),values:convertArray(t.values,Array)};const a=t.getInterpolation();a!==t.DefaultInterpolation&&(r.interpolation=a)}return r.type=t.ValueTypeName,r}InterpolantFactoryMethodDiscrete(t){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new LinearInterpolant(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new CubicInterpolant(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let n;switch(t){case InterpolateDiscrete:n=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:n=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const n=this.times;for(let r=0,a=n.length;r!==a;++r)n[r]+=t}return this}scale(t){if(t!==1){const n=this.times;for(let r=0,a=n.length;r!==a;++r)n[r]*=t}return this}trim(t,n){const r=this.times,a=r.length;let u=0,h=a-1;for(;u!==a&&r[u]<t;)++u;for(;h!==-1&&r[h]>n;)--h;if(++h,u!==0||h!==a){u>=h&&(h=Math.max(h,1),u=h-1);const f=this.getValueSize();this.times=r.slice(u,h),this.values=this.values.slice(u*f,h*f)}return this}validate(){let t=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const r=this.times,a=this.values,u=r.length;u===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let h=null;for(let f=0;f!==u;f++){const d=r[f];if(typeof d=="number"&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,d),t=!1;break}if(h!==null&&h>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,d,h),t=!1;break}h=d}if(a!==void 0&&isTypedArray(a))for(let f=0,d=a.length;f!==d;++f){const p=a[f];if(isNaN(p)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,p),t=!1;break}}return t}optimize(){const t=this.times.slice(),n=this.values.slice(),r=this.getValueSize(),a=this.getInterpolation()===InterpolateSmooth,u=t.length-1;let h=1;for(let f=1;f<u;++f){let d=!1;const p=t[f],c=t[f+1];if(p!==c&&(f!==1||p!==t[0]))if(a)d=!0;else{const o=f*r,e=o-r,s=o+r;for(let l=0;l!==r;++l){const g=n[o+l];if(g!==n[e+l]||g!==n[s+l]){d=!0;break}}}if(d){if(f!==h){t[h]=t[f];const o=f*r,e=h*r;for(let s=0;s!==r;++s)n[e+s]=n[o+s]}++h}}if(u>0){t[h]=t[u];for(let f=u*r,d=h*r,p=0;p!==r;++p)n[d+p]=n[f+p];++h}return h!==t.length?(this.times=t.slice(0,h),this.values=n.slice(0,h*r)):(this.times=t,this.values=n),this}clone(){const t=this.times.slice(),n=this.values.slice(),r=this.constructor,a=new r(this.name,t,n);return a.createInterpolant=this.createInterpolant,a}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(t,n,r,a){super(t,n,r,a)}interpolate_(t,n,r,a){const u=this.resultBuffer,h=this.sampleValues,f=this.valueSize,d=(r-n)/(a-n);let p=t*f;for(let c=p+f;p!==c;p+=4)Quaternion.slerpFlat(u,0,h,p-f,h,p,d);return u}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(t){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),t)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(t,n=-1,r,a=NormalAnimationBlendMode){this.name=t,this.tracks=r,this.duration=n,this.blendMode=a,this.uuid=generateUUID(),this.duration<0&&this.resetDuration()}static parse(t){const n=[],r=t.tracks,a=1/(t.fps||1);for(let h=0,f=r.length;h!==f;++h)n.push(parseKeyframeTrack(r[h]).scale(a));const u=new this(t.name,t.duration,n,t.blendMode);return u.uuid=t.uuid,u}static toJSON(t){const n=[],r=t.tracks,a={name:t.name,duration:t.duration,tracks:n,uuid:t.uuid,blendMode:t.blendMode};for(let u=0,h=r.length;u!==h;++u)n.push(KeyframeTrack.toJSON(r[u]));return a}static CreateFromMorphTargetSequence(t,n,r,a){const u=n.length,h=[];for(let f=0;f<u;f++){let d=[],p=[];d.push((f+u-1)%u,f,(f+1)%u),p.push(0,1,0);const c=getKeyframeOrder(d);d=sortedArray(d,1,c),p=sortedArray(p,1,c),!a&&d[0]===0&&(d.push(u),p.push(p[0])),h.push(new NumberKeyframeTrack(".morphTargetInfluences["+n[f].name+"]",d,p).scale(1/r))}return new this(t,-1,h)}static findByName(t,n){let r=t;if(!Array.isArray(t)){const a=t;r=a.geometry&&a.geometry.animations||a.animations}for(let a=0;a<r.length;a++)if(r[a].name===n)return r[a];return null}static CreateClipsFromMorphTargetSequences(t,n,r){const a={},u=/^([\w-]*?)([\d]+)$/;for(let f=0,d=t.length;f<d;f++){const p=t[f],c=p.name.match(u);if(c&&c.length>1){const o=c[1];let e=a[o];e||(a[o]=e=[]),e.push(p)}}const h=[];for(const f in a)h.push(this.CreateFromMorphTargetSequence(f,a[f],n,r));return h}static parseAnimation(t,n){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(o,e,s,l,g){if(s.length!==0){const y=[],b=[];flattenJSON(s,y,b,l),y.length!==0&&g.push(new o(e,y,b))}},a=[],u=t.name||"default",h=t.fps||30,f=t.blendMode;let d=t.length||-1;const p=t.hierarchy||[];for(let o=0;o<p.length;o++){const e=p[o].keys;if(!(!e||e.length===0))if(e[0].morphTargets){const s={};let l;for(l=0;l<e.length;l++)if(e[l].morphTargets)for(let g=0;g<e[l].morphTargets.length;g++)s[e[l].morphTargets[g]]=-1;for(const g in s){const y=[],b=[];for(let _=0;_!==e[l].morphTargets.length;++_){const v=e[l];y.push(v.time),b.push(v.morphTarget===g?1:0)}a.push(new NumberKeyframeTrack(".morphTargetInfluence["+g+"]",y,b))}d=s.length*h}else{const s=".bones["+n[o].name+"]";r(VectorKeyframeTrack,s+".position",e,"pos",a),r(QuaternionKeyframeTrack,s+".quaternion",e,"rot",a),r(VectorKeyframeTrack,s+".scale",e,"scl",a)}}return a.length===0?null:new this(u,d,a,f)}resetDuration(){const t=this.tracks;let n=0;for(let r=0,a=t.length;r!==a;++r){const u=this.tracks[r];n=Math.max(n,u.times[u.times.length-1])}return this.duration=n,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let n=0;n<this.tracks.length;n++)t=t&&this.tracks[n].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let n=0;n<this.tracks.length;n++)t.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(m){switch(m.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+m)}function parseKeyframeTrack(m){if(m.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=getTrackTypeForValueTypeName(m.type);if(m.times===void 0){const n=[],r=[];flattenJSON(m.keys,n,r,"value"),m.times=n,m.values=r}return t.parse!==void 0?t.parse(m):new t(m.name,m.times,m.values,m.interpolation)}const Cache={enabled:!1,files:{},add:function(m,t){this.enabled!==!1&&(this.files[m]=t)},get:function(m){if(this.enabled!==!1)return this.files[m]},remove:function(m){delete this.files[m]},clear:function(){this.files={}}};class LoadingManager{constructor(t,n,r){const a=this;let u=!1,h=0,f=0,d;const p=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(c){f++,u===!1&&a.onStart!==void 0&&a.onStart(c,h,f),u=!0},this.itemEnd=function(c){h++,a.onProgress!==void 0&&a.onProgress(c,h,f),h===f&&(u=!1,a.onLoad!==void 0&&a.onLoad())},this.itemError=function(c){a.onError!==void 0&&a.onError(c)},this.resolveURL=function(c){return d?d(c):c},this.setURLModifier=function(c){return d=c,this},this.addHandler=function(c,o){return p.push(c,o),this},this.removeHandler=function(c){const o=p.indexOf(c);return o!==-1&&p.splice(o,2),this},this.getHandler=function(c){for(let o=0,e=p.length;o<e;o+=2){const s=p[o],l=p[o+1];if(s.global&&(s.lastIndex=0),s.test(c))return l}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(t){this.manager=t!==void 0?t:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,n){const r=this;return new Promise(function(a,u){r.load(t,a,n,u)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}Loader.DEFAULT_MATERIAL_NAME="__DEFAULT";const loading={};class HttpError extends Error{constructor(t,n){super(t),this.response=n}}class FileLoader extends Loader{constructor(t){super(t)}load(t,n,r,a){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const u=Cache.get(t);if(u!==void 0)return this.manager.itemStart(t),setTimeout(()=>{n&&n(u),this.manager.itemEnd(t)},0),u;if(loading[t]!==void 0){loading[t].push({onLoad:n,onProgress:r,onError:a});return}loading[t]=[],loading[t].push({onLoad:n,onProgress:r,onError:a});const h=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),f=this.mimeType,d=this.responseType;fetch(h).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const c=loading[t],o=p.body.getReader(),e=p.headers.get("Content-Length")||p.headers.get("X-File-Size"),s=e?parseInt(e):0,l=s!==0;let g=0;const y=new ReadableStream({start(b){_();function _(){o.read().then(({done:v,value:T})=>{if(v)b.close();else{g+=T.byteLength;const w=new ProgressEvent("progress",{lengthComputable:l,loaded:g,total:s});for(let A=0,S=c.length;A<S;A++){const O=c[A];O.onProgress&&O.onProgress(w)}b.enqueue(T),_()}})}}});return new Response(y)}else throw new HttpError(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(d){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(c=>new DOMParser().parseFromString(c,f));case"json":return p.json();default:if(f===void 0)return p.text();{const o=/charset="?([^;"\s]*)"?/i.exec(f),e=o&&o[1]?o[1].toLowerCase():void 0,s=new TextDecoder(e);return p.arrayBuffer().then(l=>s.decode(l))}}}).then(p=>{Cache.add(t,p);const c=loading[t];delete loading[t];for(let o=0,e=c.length;o<e;o++){const s=c[o];s.onLoad&&s.onLoad(p)}}).catch(p=>{const c=loading[t];if(c===void 0)throw this.manager.itemError(t),p;delete loading[t];for(let o=0,e=c.length;o<e;o++){const s=c[o];s.onError&&s.onError(p)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class ImageLoader extends Loader{constructor(t){super(t)}load(t,n,r,a){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const u=this,h=Cache.get(t);if(h!==void 0)return u.manager.itemStart(t),setTimeout(function(){n&&n(h),u.manager.itemEnd(t)},0),h;const f=createElementNS("img");function d(){c(),Cache.add(t,this),n&&n(this),u.manager.itemEnd(t)}function p(o){c(),a&&a(o),u.manager.itemError(t),u.manager.itemEnd(t)}function c(){f.removeEventListener("load",d,!1),f.removeEventListener("error",p,!1)}return f.addEventListener("load",d,!1),f.addEventListener("error",p,!1),t.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(f.crossOrigin=this.crossOrigin),u.manager.itemStart(t),f.src=t,f}}class TextureLoader extends Loader{constructor(t){super(t)}load(t,n,r,a){const u=new Texture,h=new ImageLoader(this.manager);return h.setCrossOrigin(this.crossOrigin),h.setPath(this.path),h.load(t,function(f){u.image=f,u.needsUpdate=!0,n!==void 0&&n(u)},r,a),u}}class Light extends Object3D{constructor(t,n=1){super(),this.isLight=!0,this.type="Light",this.color=new Color(t),this.intensity=n}dispose(){}copy(t,n){return super.copy(t,n),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const n=super.toJSON(t);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const n=this.camera,r=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(t.matrixWorld),n.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(t.target.matrixWorld),n.lookAt(_lookTarget$1),n.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(_projScreenMatrix$1)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const n=this.camera,r=RAD2DEG*2*t.angle*this.focus,a=this.mapSize.width/this.mapSize.height,u=t.distance||n.far;(r!==n.fov||a!==n.aspect||u!==n.far)&&(n.fov=r,n.aspect=a,n.far=u,n.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class SpotLight extends Light{constructor(t,n,r=0,a=Math.PI/3,u=0,h=2){super(t,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=r,this.angle=a,this.penumbra=u,this.decay=h,this.map=null,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,n){return super.copy(t,n),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(t,n=0){const r=this.camera,a=this.matrix,u=t.distance||r.far;u!==r.far&&(r.far=u,r.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(t.matrixWorld),r.position.copy(_lightPositionWorld),_lookTarget.copy(r.position),_lookTarget.add(this._cubeDirections[n]),r.up.copy(this._cubeUps[n]),r.lookAt(_lookTarget),r.updateMatrixWorld(),a.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}class PointLight extends Light{constructor(t,n,r=0,a=2){super(t,n),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=a,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,n){return super.copy(t,n),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(t,n){super(t,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class AmbientLight extends Light{constructor(t,n){super(t,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class LoaderUtils{static decodeText(t){if(typeof TextDecoder<"u")return new TextDecoder().decode(t);let n="";for(let r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(t){const n=t.lastIndexOf("/");return n===-1?"./":t.slice(0,n+1)}static resolveURL(t,n){return typeof t!="string"||t===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(t)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:n+t)}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(t,n,r){const a=r||PropertyBinding.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,a)}getValue(t,n){this.bind();const r=this._targetGroup.nCachedObjects_,a=this._bindings[r];a!==void 0&&a.getValue(t,n)}setValue(t,n){const r=this._bindings;for(let a=this._targetGroup.nCachedObjects_,u=r.length;a!==u;++a)r[a].setValue(t,n)}bind(){const t=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=t.length;n!==r;++n)t[n].bind()}unbind(){const t=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=t.length;n!==r;++n)t[n].unbind()}}class PropertyBinding{constructor(t,n,r){this.path=n,this.parsedPath=r||PropertyBinding.parseTrackName(n),this.node=PropertyBinding.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new PropertyBinding.Composite(t,n,r):new PropertyBinding(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(t){const n=_trackRe.exec(t);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},a=r.nodeName&&r.nodeName.lastIndexOf(".");if(a!==void 0&&a!==-1){const u=r.nodeName.substring(a+1);_supportedObjectNames.indexOf(u)!==-1&&(r.nodeName=r.nodeName.substring(0,a),r.objectName=u)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(n===void 0||n===""||n==="."||n===-1||n===t.name||n===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(n);if(r!==void 0)return r}if(t.children){const r=function(u){for(let h=0;h<u.length;h++){const f=u[h];if(f.name===n||f.uuid===n)return f;const d=r(f.children);if(d)return d}return null},a=r(t.children);if(a)return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const r=this.resolvedProperty;for(let a=0,u=r.length;a!==u;++a)t[n++]=r[a]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const r=this.resolvedProperty;for(let a=0,u=r.length;a!==u;++a)r[a]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const r=this.resolvedProperty;for(let a=0,u=r.length;a!==u;++a)r[a]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const r=this.resolvedProperty;for(let a=0,u=r.length;a!==u;++a)r[a]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,r=n.objectName,a=n.propertyName;let u=n.propertyIndex;if(t||(t=PropertyBinding.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let p=n.objectIndex;switch(r){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let c=0;c<t.length;c++)if(t[c].name===p){p=c;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(p!==void 0){if(t[p]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[p]}}const h=t[a];if(h===void 0){const p=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+p+"."+a+" but it wasn't found.",t);return}let f=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?f=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(f=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(u!==void 0){if(a==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[u]!==void 0&&(u=t.morphTargetDictionary[u])}d=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=u}else h.fromArray!==void 0&&h.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(d=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=a;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][f]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var ort_min={exports:{}};/*!
* ONNX Runtime Web v1.16.3
* Copyright (c) Microsoft Corporation. All rights reserved.
* Licensed under the MIT License.
*/(function(module,exports){(function(m,t){module.exports=t()})(self,()=>(()=>{var __webpack_modules__={5716:(m,t,n)=>{t.R=void 0;const r=n(6027),a=n(1723);t.R=new class{async init(){}async createSessionHandler(u,h){const f=new r.Session(h);return await f.loadModel(u),new a.OnnxjsSessionHandler(f)}}},2818:(m,t,n)=>{t.c8=t.rX=void 0;const r=n(2235),a=n(5381),u=n(9544),h=n(6640);t.rX=()=>{if((typeof r.env.wasm.initTimeout!="number"||r.env.wasm.initTimeout<0)&&(r.env.wasm.initTimeout=0),typeof r.env.wasm.simd!="boolean"&&(r.env.wasm.simd=!0),typeof r.env.wasm.proxy!="boolean"&&(r.env.wasm.proxy=!1),typeof r.env.wasm.numThreads!="number"||!Number.isInteger(r.env.wasm.numThreads)||r.env.wasm.numThreads<=0){const f=typeof navigator>"u"?(0,a.cpus)().length:navigator.hardwareConcurrency;r.env.wasm.numThreads=Math.min(4,Math.ceil((f||1)/2))}},t.c8=new class{async init(){(0,t.rX)(),await(0,u.initializeWebAssemblyInstance)()}async createSessionHandler(f,d){const p=new h.OnnxruntimeWebAssemblySessionHandler;return await p.loadModel(f,d),Promise.resolve(p)}}},1057:function(m,t,n){var r=this&&this.__createBinding||(Object.create?function(f,d,p,c){c===void 0&&(c=p);var o=Object.getOwnPropertyDescriptor(d,p);o&&!("get"in o?!d.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return d[p]}}),Object.defineProperty(f,c,o)}:function(f,d,p,c){c===void 0&&(c=p),f[c]=d[p]}),a=this&&this.__exportStar||function(f,d){for(var p in f)p==="default"||Object.prototype.hasOwnProperty.call(d,p)||r(d,f,p)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(2235),t);const u=n(2235),h=n(8408);{const f=n(5716).R;(0,u.registerBackend)("webgl",f,-10)}{const f=n(2818).c8;(0,u.registerBackend)("cpu",f,10),(0,u.registerBackend)("wasm",f,10),(0,u.registerBackend)("xnnpack",f,9),(0,u.registerBackend)("webnn",f,9)}u.env.versions.web=h.version},4910:(m,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createAttributeWithCacheKey=void 0;class n{constructor(a){Object.assign(this,a)}get cacheKey(){return this._cacheKey||(this._cacheKey=Object.getOwnPropertyNames(this).sort().map(a=>`${this[a]}`).join(";")),this._cacheKey}}t.createAttributeWithCacheKey=r=>new n(r)},6874:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Attribute=void 0;const r=n(5127),a=n(2446),u=n(9240),h=n(7273);var f=r.onnxruntime.experimental.fbs;class d{constructor(c){if(this._attributes=new Map,c!=null){for(const o of c)o instanceof a.onnx.AttributeProto?this._attributes.set(o.name,[d.getValue(o),d.getType(o)]):o instanceof f.Attribute&&this._attributes.set(o.name(),[d.getValue(o),d.getType(o)]);if(this._attributes.size<c.length)throw new Error("duplicated attribute names")}}set(c,o,e){this._attributes.set(c,[e,o])}delete(c){this._attributes.delete(c)}getFloat(c,o){return this.get(c,"float",o)}getInt(c,o){return this.get(c,"int",o)}getString(c,o){return this.get(c,"string",o)}getTensor(c,o){return this.get(c,"tensor",o)}getFloats(c,o){return this.get(c,"floats",o)}getInts(c,o){return this.get(c,"ints",o)}getStrings(c,o){return this.get(c,"strings",o)}getTensors(c,o){return this.get(c,"tensors",o)}get(c,o,e){const s=this._attributes.get(c);if(s===void 0){if(e!==void 0)return e;throw new Error(`required attribute not found: ${c}`)}if(s[1]!==o)throw new Error(`type mismatch: expected ${o} but got ${s[1]}`);return s[0]}static getType(c){const o=c instanceof a.onnx.AttributeProto?c.type:c.type();switch(o){case a.onnx.AttributeProto.AttributeType.FLOAT:return"float";case a.onnx.AttributeProto.AttributeType.INT:return"int";case a.onnx.AttributeProto.AttributeType.STRING:return"string";case a.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case a.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case a.onnx.AttributeProto.AttributeType.INTS:return"ints";case a.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case a.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${a.onnx.AttributeProto.AttributeType[o]}`)}}static getValue(c){const o=c instanceof a.onnx.AttributeProto?c.type:c.type();if(o===a.onnx.AttributeProto.AttributeType.GRAPH||o===a.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");const e=this.getValueNoCheck(c);if(o===a.onnx.AttributeProto.AttributeType.INT&&h.LongUtil.isLong(e))return h.LongUtil.longToNumber(e);if(o===a.onnx.AttributeProto.AttributeType.INTS){const s=e,l=new Array(s.length);for(let g=0;g<s.length;g++){const y=s[g];l[g]=h.LongUtil.longToNumber(y)}return l}if(o===a.onnx.AttributeProto.AttributeType.TENSOR)return c instanceof a.onnx.AttributeProto?u.Tensor.fromProto(e):u.Tensor.fromOrtTensor(e);if(o===a.onnx.AttributeProto.AttributeType.TENSORS){if(c instanceof a.onnx.AttributeProto)return e.map(s=>u.Tensor.fromProto(s));if(c instanceof f.Attribute)return e.map(s=>u.Tensor.fromOrtTensor(s))}if(o===a.onnx.AttributeProto.AttributeType.STRING&&c instanceof a.onnx.AttributeProto){const s=e;return(0,h.decodeUtf8String)(s)}return o===a.onnx.AttributeProto.AttributeType.STRINGS&&c instanceof a.onnx.AttributeProto?e.map(h.decodeUtf8String):e}static getValueNoCheck(c){return c instanceof a.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(c):this.getValueNoCheckFromOrtFormat(c)}static getValueNoCheckFromOnnxFormat(c){switch(c.type){case a.onnx.AttributeProto.AttributeType.FLOAT:return c.f;case a.onnx.AttributeProto.AttributeType.INT:return c.i;case a.onnx.AttributeProto.AttributeType.STRING:return c.s;case a.onnx.AttributeProto.AttributeType.TENSOR:return c.t;case a.onnx.AttributeProto.AttributeType.GRAPH:return c.g;case a.onnx.AttributeProto.AttributeType.FLOATS:return c.floats;case a.onnx.AttributeProto.AttributeType.INTS:return c.ints;case a.onnx.AttributeProto.AttributeType.STRINGS:return c.strings;case a.onnx.AttributeProto.AttributeType.TENSORS:return c.tensors;case a.onnx.AttributeProto.AttributeType.GRAPHS:return c.graphs;default:throw new Error(`unsupported attribute type: ${a.onnx.AttributeProto.AttributeType[c.type]}`)}}static getValueNoCheckFromOrtFormat(c){switch(c.type()){case f.AttributeType.FLOAT:return c.f();case f.AttributeType.INT:return c.i();case f.AttributeType.STRING:return c.s();case f.AttributeType.TENSOR:return c.t();case f.AttributeType.GRAPH:return c.g();case f.AttributeType.FLOATS:return c.floatsArray();case f.AttributeType.INTS:{const o=[];for(let e=0;e<c.intsLength();e++)o.push(c.ints(e));return o}case f.AttributeType.STRINGS:{const o=[];for(let e=0;e<c.stringsLength();e++)o.push(c.strings(e));return o}case f.AttributeType.TENSORS:{const o=[];for(let e=0;e<c.tensorsLength();e++)o.push(c.tensors(e));return o}default:throw new Error(`unsupported attribute type: ${f.AttributeType[c.type()]}`)}}}t.Attribute=d},1975:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolveBackend=t.backend=void 0;const r=n(4418),a=new Map;async function u(h){const f=t.backend;if(f[h]!==void 0&&function(d){const p=d;return"initialize"in p&&typeof p.initialize=="function"&&"createSessionHandler"in p&&typeof p.createSessionHandler=="function"&&"dispose"in p&&typeof p.dispose=="function"}(f[h])){const d=f[h];let p=d.initialize();if(typeof p=="object"&&"then"in p&&(p=await p),p)return a.set(h,d),d}}t.backend={webgl:new r.WebGLBackend},t.resolveBackend=async function h(f){if(!f)return h(["webgl"]);{const d=typeof f=="string"?[f]:f;for(const p of d){const c=a.get(p);if(c)return c;const o=await u(p);if(o)return o}}throw new Error("no available backend to use")}},4418:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLBackend=void 0;const r=n(2235),a=n(1315),u=n(2171),h=n(3389);t.WebGLBackend=class{get contextId(){return r.env.webgl.contextId}set contextId(f){r.env.webgl.contextId=f}get matmulMaxBatchSize(){return r.env.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(f){r.env.webgl.matmulMaxBatchSize=f}get textureCacheMode(){return r.env.webgl.textureCacheMode}set textureCacheMode(f){r.env.webgl.textureCacheMode=f}get pack(){return r.env.webgl.pack}set pack(f){r.env.webgl.pack=f}get async(){return r.env.webgl.async}set async(f){r.env.webgl.async=f}initialize(){try{return this.glContext=(0,h.createWebGLContext)(this.contextId),typeof this.matmulMaxBatchSize!="number"&&(this.matmulMaxBatchSize=16),typeof this.textureCacheMode!="string"&&(this.textureCacheMode="full"),typeof this.pack!="boolean"&&(this.pack=!1),typeof this.async!="boolean"&&(this.async=!1),a.Logger.setWithEnv(r.env),a.Logger.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(f){return a.Logger.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${f}`),!1}}createSessionHandler(f){return new u.WebGLSessionHandler(this,f)}dispose(){this.glContext.dispose()}}},6859:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoordsGlslLib=void 0;const r=n(7273),a=n(1997),u=n(6757),h=n(7618),f=n(432);class d extends a.GlslLib{constructor(c){super(c)}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.offsetToCoords()),this.coordsToOffset()),this.toVec()),this.valueFrom()),this.getCommonUtilFuncs()),this.getInputsSamplingSnippets()),this.getOutputSamplingSnippet())}getCustomTypes(){return{}}offsetToCoords(){return{offsetToCoords:new a.GlslLibRoutine(`
      vec2 offsetToCoords(int offset, int width, int height) {
        int t = offset / width;
        int s = offset - t*width;
        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);
        return coords;
      }
      `)}}coordsToOffset(){return{coordsToOffset:new a.GlslLibRoutine(`
      int coordsToOffset(vec2 coords, int width, int height) {
        float s = coords.s * float(width);
        float t = coords.t * float(height);
        int offset = int(t) * width + int(s);
        return offset;
      }
      `)}}getOutputSamplingSnippet(){const c=this.context.outputTextureLayout;return c.isPacked?this.getPackedOutputSamplingSnippet(c):this.getUnpackedOutputSamplingSnippet(c)}getPackedOutputSamplingSnippet(c){const o=c.unpackedShape,e=[c.width,c.height],s={},l="getOutputCoords";switch(o.length){case 0:s[l]=this.getOutputScalarCoords();break;case 1:s[l]=this.getOutputPacked1DCoords(o,e);break;case 2:s[l]=this.getOutputPacked2DCoords(o,e);break;case 3:s[l]=this.getOutputPacked3DCoords(o,e);break;default:s[l]=this.getOutputPackedNDCoords(o,e)}const g=`
      void setOutput(vec4 val) {
        ${(0,u.getGlsl)(this.context.glContext.version).output} = val;
      }
    `;return s.floatTextureSetRGBA=new a.GlslLibRoutine(g),s}getUnpackedOutputSamplingSnippet(c){const o=c.unpackedShape,e=[c.width,c.height],s={},l="getOutputCoords";switch(o.length){case 0:s[l]=this.getOutputScalarCoords();break;case 1:s[l]=this.getOutputUnpacked1DCoords(o,e);break;case 2:s[l]=this.getOutputUnpacked2DCoords(o,e);break;case 3:s[l]=this.getOutputUnpacked3DCoords(o,e);break;case 4:s[l]=this.getOutputUnpacked4DCoords(o,e);break;case 5:s[l]=this.getOutputUnpacked5DCoords(o,e);break;case 6:s[l]=this.getOutputUnpacked6DCoords(o,e);break;default:throw new Error(`Unsupported output dimensionality: ${o.length}`)}const g=`
        void setOutput(float val) {
          ${(0,u.getGlsl)(this.context.glContext.version).output} = vec4(val, 0, 0, 0);
        }
    `;return s.floatTextureSetR=new a.GlslLibRoutine(g),s}getOutputScalarCoords(){return new a.GlslLibRoutine(`
      int getOutputCoords() {
        return 0;
      }
    `)}getOutputPacked1DCoords(c,o){const e=o;let s="";return e[0]===1?(s=`
          int getOutputCoords() {
            return 2 * int(TexCoords.y * ${e[1]}.0);
          }
        `,new a.GlslLibRoutine(s)):e[1]===1?(s=`
          int getOutputCoords() {
            return 2 * int(TexCoords.x * ${e[0]}.0);
          }
        `,new a.GlslLibRoutine(s)):(s=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                 vec2(${e[0]}, ${e[1]}));
          return 2 * (resTexRC.y * ${e[0]} + resTexRC.x);
        }
      `,new a.GlslLibRoutine(s))}getOutputPacked2DCoords(c,o){let e="";if(r.ArrayUtil.arraysEqual(c,o))return e=`
        ivec2 getOutputCoords() {
          return 2 * ivec2(TexCoords.xy * vec2(${o[0]}, ${o[1]}));
        }
      `,new a.GlslLibRoutine(e);const s=o,l=Math.ceil(c[1]/2);return e=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${s[0]}, ${s[1]}));

          int index = resTexRC.y * ${s[0]} + resTexRC.x;

          // reverse r and c order for packed texture
          int r = imod(index, ${l}) * 2;
          int c = 2 * (index / ${l});

          return ivec2(r, c);
        }
      `,new a.GlslLibRoutine(e)}getOutputPacked3DCoords(c,o){const e=[o[0],o[1]],s=Math.ceil(c[2]/2),l=s*Math.ceil(c[1]/2),g=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${e[0]}, ${e[1]}));
          int index = resTexRC.y * ${e[0]} + resTexRC.x;

          int b = index / ${l};
          index -= b * ${l};

          // reverse r and c order for packed texture
          int r = imod(index, ${s}) * 2;
          int c = 2 * (index / ${s});

          return ivec3(b, r, c);
        }
      `;return new a.GlslLibRoutine(g)}getOutputPackedNDCoords(c,o){const e=[o[0],o[1]],s=Math.ceil(c[c.length-1]/2),l=s*Math.ceil(c[c.length-2]/2);let g=l,y="",b="b, r, c";for(let v=2;v<c.length-1;v++)g*=c[c.length-v-1],y=`
      int b${v} = index / ${g};
      index -= b${v} * ${g};
    `+y,b=`b${v}, `+b;const _=`
      ivec${c.length} getOutputCoords() {
        ivec2 resTexRC = ivec2(TexCoords.xy *
                              vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.y * ${e[0]} + resTexRC.x;

        ${y}

        int b = index / ${l};
        index -= b * ${l};

        // reverse r and c order for packed texture
        int r = imod(index, ${s}) * 2;
        int c = 2 * (index / ${s});

        return ivec${c.length}(${b});
      }
    `;return new a.GlslLibRoutine(_)}getOutputUnpacked1DCoords(c,o){const e=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${o[0]}, ${o[1]}));
          return resTexRC.y * ${o[0]} + resTexRC.x;
        }
      `;return new a.GlslLibRoutine(e)}getOutputUnpacked2DCoords(c,o){const e=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${o[0]}, ${o[1]}));
          int index = resTexRC.y * ${o[0]} + resTexRC.x;
          int r = index / ${c[1]};
          int c = index - r * ${c[1]};
          return ivec2(r, c);
        }
      `;return new a.GlslLibRoutine(e)}getOutputUnpacked3DCoords(c,o){let e="";const s=c.length;let l=null;s<2&&(l=[]),l=new Array(s-1),l[s-2]=c[s-1];for(let b=s-3;b>=0;--b)l[b]=l[b+1]*c[b+1];const g=["r","c","d"],y=l.map((b,_)=>`int ${g[_]} = index / ${b}; ${_===l.length-1?`int ${g[_+1]} = index - ${g[_]} * ${b}`:`index -= ${g[_]} * ${b}`};`).join("");return e=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${o[0]}, ${o[1]}));
          int index = resTexRC.y * ${o[0]} + resTexRC.x;
          ${y}
          return ivec3(r, c, d);
        }
      `,new a.GlslLibRoutine(e)}getOutputUnpacked4DCoords(c,o){let e="";const s=c.length;let l=null;s<2&&(l=[]),l=new Array(s-1),l[s-2]=c[s-1];for(let b=s-3;b>=0;--b)l[b]=l[b+1]*c[b+1];const g=["r","c","d","d2"],y=l.map((b,_)=>`int ${g[_]} = index / ${b}; ${_===l.length-1?`int ${g[_+1]} = index - ${g[_]} * ${b}`:`index -= ${g[_]} * ${b}`};`).join("");return e=`
      ivec4 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${o[0]}, ${o[1]}));
          int index = resTexRC.y * ${o[0]} + resTexRC.x;
          ${y}
          return ivec4(r, c, d, d2);
        }
      `,new a.GlslLibRoutine(e)}getOutputUnpacked5DCoords(c,o){let e="";const s=c.length;let l=null;s<2&&(l=[]),l=new Array(s-1),l[s-2]=c[s-1];for(let b=s-3;b>=0;--b)l[b]=l[b+1]*c[b+1];const g=["r","c","d","d2","d3"],y=l.map((b,_)=>`int ${g[_]} = index / ${b}; ${_===l.length-1?`int ${g[_+1]} = index - ${g[_]} * ${b}`:`index -= ${g[_]} * ${b}`};`).join("");return e=`
      ivec5 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${o[0]}, ${o[1]}));
          int index = resTexRC.y * ${o[0]} + resTexRC.x;
          ${y}
          return ivec5(r, c, d, d2, d3);
        }
      `,new a.GlslLibRoutine(e)}getOutputUnpacked6DCoords(c,o){let e="";const s=c.length;let l=null;s<2&&(l=[]),l=new Array(s-1),l[s-2]=c[s-1];for(let b=s-3;b>=0;--b)l[b]=l[b+1]*c[b+1];const g=["r","c","d","d2","d3","d4"],y=l.map((b,_)=>`int ${g[_]} = index / ${b}; ${_===l.length-1?`int ${g[_+1]} = index - ${g[_]} * ${b}`:`index -= ${g[_]} * ${b}`};`).join("");return e=`
     ivec6 getOutputCoords() {
         ivec2 resTexRC = ivec2(TexCoords.xy *
                               vec2(${o[0]}, ${o[1]}));
         int index = resTexRC.y * ${o[0]} + resTexRC.x;
         ${y}
         return ivec6(r, c, d, d2, d3, d4);
       }
     `,new a.GlslLibRoutine(e)}getCommonUtilFuncs(){const c={};let o="uvFromFlat";c[o]=new a.GlslLibRoutine(`
    vec2 uvFromFlat(int texNumR, int texNumC, int index) {
      int texC = index / texNumR;
      int texR = index - texC * texNumR;
      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to
      //       v.
      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);
    }
    `),o="packedUVfrom1D",c[o]=new a.GlslLibRoutine(`
      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
        int texelIndex = index / 2;
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),o="packedUVfrom2D",c[o]=new a.GlslLibRoutine(`
      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {
        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),o="packedUVfrom3D",c[o]=new a.GlslLibRoutine(`
      vec2 packedUVfrom3D(int texNumR, int texNumC,
          int texelsInBatch, int texelsInLogicalRow, int b,
          int row, int col) {
        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = index / texNumC;
        int texC = index - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),o="sampleTexture";const e=(0,u.getGlsl)(this.context.glContext.version);return c[o]=new a.GlslLibRoutine(`
        float sampleTexture(sampler2D textureSampler, vec2 uv) {
            return ${e.texture2D}(textureSampler, uv).r;
        }`),c}getInputsSamplingSnippets(){const c={},o=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach((e,s)=>{const l=this.context.inputTextureLayouts[s],g=(0,f.generateShaderFuncNameFromInputSamplerName)(e);l.isPacked?c[g]=this.getPackedSamplerFromInput(g,e,l):c[g]=this.getUnpackedSamplerFromInput(g,e,l);const y=(0,f.generateShaderFuncNameFromInputSamplerNameAtOutCoords)(e);l.unpackedShape.length<=o.unpackedShape.length&&(l.isPacked?c[y]=this.getPackedSamplerAtOutputCoords(y,l,o,e):c[y]=this.getUnpackedSamplerAtOutputCoords(y,l,o,e))}),c}getPackedSamplerAtOutputCoords(c,o,e,s){const l=o.unpackedShape,g=e.unpackedShape,y=s,b=(0,f.generateShaderFuncNameFromInputSamplerName)(y),_=l.length,v=g.length,T=r.BroadcastUtil.getBroadcastDims(l,g),w=(0,f.getCoordsDataType)(v),A=v-_;let S;const O=(0,f.getGlChannels)();S=_===0?"":v<2&&T.length>=1?"coords = 0;":T.map(B=>`coords.${O[B+A]} = 0;`).join(`
`);let C="";C=v<2&&_>0?"coords":l.map((B,I)=>`coords.${O[I+A]}`).join(", ");let D="return outputValue;";const $=r.ShapeUtil.size(l)===1,L=r.ShapeUtil.size(g)===1;if(_!==1||$||L){if($&&!L)D=v===1?`
          return vec4(outputValue.x, outputValue.x, 0., 0.);
        `:`
          return vec4(outputValue.x);
        `;else if(T.length){const B=_-2,I=_-1;T.indexOf(B)>-1&&T.indexOf(I)>-1?D="return vec4(outputValue.x);":T.indexOf(B)>-1?D="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":T.indexOf(I)>-1&&(D="return vec4(outputValue.xx, outputValue.zz);")}}else D=`
        return vec4(outputValue.xy, outputValue.xy);
      `;const P=`
      vec4 ${c}() {
        ${w} coords = getOutputCoords();
        
        int lastDim = coords.${O[v-1]};
        coords.${O[v-1]} = coords.${O[v-2]};
        coords.${O[v-2]} = lastDim;
      
        ${S}
        vec4 outputValue = ${b}(${C});
        ${D}
      }
    `;return new a.GlslLibRoutine(P,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(c,o,e,s){const l=[e.width,e.height],g=[o.width,o.height],y=o.unpackedShape.length,b=e.unpackedShape.length,_=o.unpackedShape,v=e.unpackedShape,T=(0,f.generateShaderFuncNameFromInputSamplerName)(s);if(y===b&&r.ArrayUtil.arraysEqual(g,l)){const L=`
          float ${c}() {
            return sampleTexture(${s}, TexCoords);
          }
        `;return new a.GlslLibRoutine(L,["coordinates.sampleTexture"])}const w=(0,f.getCoordsDataType)(b),A=r.BroadcastUtil.getBroadcastDims(_,v),S=b-y;let O;const C=(0,f.getGlChannels)();O=y===0?"":b<2&&A.length>=1?"coords = 0;":A.map(L=>`coords.${C[L+S]} = 0;`).join(`
`);let D="";D=b<2&&y>0?"coords":o.unpackedShape.map((L,P)=>`coords.${C[P+S]}`).join(", ");const $=`
        float ${c}() {
          ${w} coords = getOutputCoords();
          ${O}
          return ${T}(${D});
        }
      `;return new a.GlslLibRoutine($,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(c,o,e){switch(e.unpackedShape.length){case 0:return this.getPackedSamplerScalar(c,o);case 1:return this.getPackedSampler1D(c,o,e);case 2:return this.getPackedSampler2D(c,o,e);case 3:return this.getPackedSampler3D(c,o,e);default:return this.getPackedSamplerND(c,o,e)}}getUnpackedSamplerFromInput(c,o,e){const s=e.unpackedShape;switch(s.length){case 0:return this.getUnpackedSamplerScalar(c,o,e);case 1:return this.getUnpackedSampler1D(c,o,e);case 2:return this.getUnpackedSampler2D(c,o,e);case 3:return this.getUnpackedSampler3D(c,o,e);case 4:return this.getUnpackedSampler4D(c,o,e);case 5:return this.getUnpackedSampler5D(c,o,e);case 6:return this.getUnpackedSampler6D(c,o,e);default:throw new Error(`Unsupported dimension ${s.length}-D`)}}getPackedSamplerScalar(c,o){const e=`
          vec4 ${c}() {
            return ${(0,u.getGlsl)(this.context.glContext.version).texture2D}(${o}, halfCR);
          }
        `;return new a.GlslLibRoutine(e)}getPackedSampler1D(c,o,e){const s=[e.width,e.height],l=[s[1],s[0]],g=(0,u.getGlsl)(this.context.glContext.version),y=`vec4 ${c}(int index) {
      vec2 uv = packedUVfrom1D(
      ${l[0]}, ${l[1]}, index);
      return ${g.texture2D}(${o}, uv);
    }`;return new a.GlslLibRoutine(y,["coordinates.packedUVfrom1D"])}getPackedSampler2D(c,o,e){const s=e.unpackedShape,l=[e.width,e.height],g=(0,u.getGlsl)(this.context.glContext.version),y=l[0],b=l[1];if(l!=null&&r.ArrayUtil.arraysEqual(s,l)){const w=`vec4 ${c}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${b}.0, ${y}.0);
        return ${g.texture2D}(${o}, uv);
      }`;return new a.GlslLibRoutine(w)}const _=l,v=Math.ceil(s[1]/2),T=`vec4 ${c}(int row, int col) {
      vec2 uv = packedUVfrom2D(${_[1]}, ${_[0]}, ${v}, row, col);
      return ${g.texture2D}(${o}, uv);
    }`;return new a.GlslLibRoutine(T,["coordinates.packedUVfrom2D"])}getPackedSampler3D(c,o,e){const s=e.unpackedShape,l=[e.width,e.height],g=[l[0],l[1]],y=(0,u.getGlsl)(this.context.glContext.version);if(s[0]===1){const w=s.slice(1),A=[1,2],S=(0,f.squeezeInputShape)(s,w),O=["b","row","col"],C=JSON.parse(JSON.stringify(e));C.unpackedShape=S;const D=this.getPackedSamplerFromInput(c,o,C),$=`${D.routineBody}
      vec4 ${c}(int b, int row, int col) {
        return ${c}(${(0,f.getSqueezedParams)(O,A)});
      } `;return new a.GlslLibRoutine($,D.dependencies)}const b=g[0],_=g[1],v=Math.ceil(s[2]/2),T=`vec4 ${c}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${_}, ${b}, ${v*Math.ceil(s[1]/2)}, ${v}, b, row, col);
      return ${y.texture2D}(${o}, uv);}`;return new a.GlslLibRoutine(T,["coordinates.packedUVfrom3D"])}getPackedSamplerND(c,o,e){const s=e.unpackedShape,l=s.length,g=[e.width,e.height],y=(0,u.getGlsl)(this.context.glContext.version),b=[g[0],g[1]],_=b[1],v=b[0],T=Math.ceil(s[l-1]/2);let w=T*Math.ceil(s[l-2]/2),A="int b, int row, int col",S=`b * ${w} + (row / 2) * ${T} + (col / 2)`;for(let C=2;C<l-1;C++)A=`int b${C}, `+A,w*=s[l-C-1],S=`b${C} * ${w} + `+S;const O=`vec4 ${c}(${A}) {
      int index = ${S};
      int texR = index / ${v};
      int texC = index - texR * ${v};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${v}, ${_});
      return ${y.texture2D}(${o}, uv);
    }`;return new a.GlslLibRoutine(O)}getUnpackedSamplerScalar(c,o,e){const[s,l]=[e.width,e.height];if(s===1&&l===1){const y=`
          float ${c}() {
            return sampleTexture(${o}, halfCR);
          }
        `;return new a.GlslLibRoutine(y,["coordinates.sampleTexture"])}const g=`
        float ${c}() {
          int offset_${o} = coordsToOffset(TexCoords, ${s}, ${l});
          vec2 uv = uvFromFlat(${s}, ${l}, offset_${o});
          return sampleTexture(${o}, uv);
        }
      `;return new a.GlslLibRoutine(g,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(c,o,e){const s=e.width,l=e.height;if(l===1&&s===1){const y=`
        float ${c}(int index) {
          return sampleTexture(${o}, halfCR);
        }
      `;return new a.GlslLibRoutine(y,["coordinates.sampleTexture"])}if(l===1){const y=`
          float ${c}(int index) {
            vec2 uv = vec2((float(index) + 0.5) / ${s}.0, 0.5);
            return sampleTexture(${o}, uv);
          }
        `;return new a.GlslLibRoutine(y,["coordinates.sampleTexture"])}if(s===1){const y=`
          float ${c}(int index) {
            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${l}.0);
            return sampleTexture(${o}, uv);
          }
        `;return new a.GlslLibRoutine(y,["coordinates.sampleTexture"])}const g=`
        float ${c}(int index) {
          vec2 uv = uvFromFlat(${s}, ${l}, index);
          return sampleTexture(${o}, uv);
        }
      `;return new a.GlslLibRoutine(g,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(c,o,e){const s=e.unpackedShape,l=[e.height,e.width];if(l!=null&&r.ArrayUtil.arraysEqual(s,l)){const w=`
          float ${c}(int row, int col) {
            vec2 uv = (vec2(row, col) + halfCR) / vec2(${l[1]}.0, ${l[0]}.0);
            return sampleTexture(${o}, uv);
          }
        `;return new a.GlslLibRoutine(w,["coordinates.sampleTexture"])}const{newShape:g,keptDims:y}=(0,h.squeezeShape)(s),b=g;if(b.length<s.length){const w=(0,f.squeezeInputShape)(s,b),A=JSON.parse(JSON.stringify(e));A.unpackedShape=w;const S=["col","row"],O=`
          ${this.getUnpackedSamplerFromInput(c,o,A).routineBody}
          float ${c}(int row, int col) {
            return ${c}(${(0,f.getSqueezedParams)(S,y)});
          }
        `;return new a.GlslLibRoutine(O,["coordinates.sampleTexture"])}const _=l[1],v=l[0];if(v===1){const w=`
          float ${c}(int row, int col) {
            int offset_${o} = coordsToOffset(TexCoords, ${_}, ${v});
            float index = dot(vec3(row, col, offset_${o}), vec3(${s[1]}, 1, 1));
            vec2 uv = vec2(0.5, (index + 0.5) / ${_}.0);
            return sampleTexture(${o}, uv);
          }
        `;return new a.GlslLibRoutine(w,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(_===1){const w=`
          float ${c}(int row, int col) {
            int offset_${o} = coordsToOffset(TexCoords, ${_}, ${v});
            float index = dot(vec3(row, col, offset_${o}), vec3(${s[1]}, 1, 1));
            vec2 uv = vec2((index + 0.5) / ${v}.0, 0.5);
            return sampleTexture(${o}, uv);
          }
        `;return new a.GlslLibRoutine(w,["coordinates.sampleTexture","coordinates.coordsToOffset"])}const T=`
        float ${c}(int row, int col) {
          int index = col * ${s[1]} + row;
          vec2 uv = uvFromFlat(${_}, ${v}, index);
          return sampleTexture(${o}, uv);
        }
      `;return new a.GlslLibRoutine(T,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(c,o,e){const s=e.unpackedShape,l=s[1]*s[2],g=s[2],{newShape:y,keptDims:b}=(0,h.squeezeShape)(s),_=y;if(_.length<s.length){const T=(0,f.squeezeInputShape)(s,_),w=["batch","col","row"],A=JSON.parse(JSON.stringify(e));A.unpackedShape=T;const S=this.getUnpackedSamplerFromInput(c,o,A),O=b.reverse(),C=`
          ${S.routineBody}
          float ${c}(int batch, int row, int col) {
            return ${c}(${(0,f.getSqueezedParams)(w,O)});
          }
        `;return new a.GlslLibRoutine(C,S.dependencies)}const v=`
          float ${c}(int depth, int row, int col) {
            // Explicitly use integer operations as dot() only works on floats.
            int index = depth * ${l} + col * ${g} + row;
            vec2 uv = uvFromFlat(${e.width}, ${e.height}, index);
            return sampleTexture(${o}, uv);
          }
      `;return new a.GlslLibRoutine(v,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(c,o,e){const s=e.unpackedShape,l=s[3],g=s[2]*l,y=`
        float ${c}(int row, int col, int depth, int depth2) {
          int index = row * ${s[1]*g} + col * ${g} +
              depth2 * ${l} + depth;
          vec2 uv = uvFromFlat(${e.width}, ${e.height}, index);
          return sampleTexture(${o}, uv);
        }
      `;return new a.GlslLibRoutine(y,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(c,o,e){const s=e.unpackedShape,l=s[4],g=s[3]*l,y=s[2]*g,b=s[1]*y,{newShape:_,keptDims:v}=(0,h.squeezeShape)(s);if(_.length<s.length){const w=(0,f.squeezeInputShape)(s,_),A=["row","col","depth","depth2","depth3"],S=JSON.parse(JSON.stringify(e));S.unpackedShape=w;const O=`
          ${this.getUnpackedSamplerFromInput(c,o,S).routineBody}
          float ${c}(int row, int col, int depth, int depth2, int depth3) {
            return ${c}(${(0,f.getSqueezedParams)(A,v)});
          }
        `;return new a.GlslLibRoutine(O,["coordinates.sampleTexture","coordinates.uvFromFlat"])}const T=`
        float ${c}(int row, int col, int depth, int depth2, int depth3) {
          int index = row * ${b} + col * ${y} + depth * ${g} +
          depth3 * ${l} + depth2;
          vec2 uv = uvFromFlat(${e.width}, ${e.height}, index);
          return sampleTexture(${o}, uv);
        }
      `;return new a.GlslLibRoutine(T,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(c,o,e){const s=e.unpackedShape,l=s[5],g=s[4]*l,y=s[3]*g,b=s[2]*y,_=s[1]*b,{newShape:v,keptDims:T}=(0,h.squeezeShape)(s);if(v.length<s.length){const A=(0,f.squeezeInputShape)(s,v),S=["row","col","depth","depth2","depth3","depth4"],O=JSON.parse(JSON.stringify(e));O.unpackedShape=A;const C=`
            ${this.getUnpackedSamplerFromInput(c,o,O).routineBody}
            float ${c}(int row, int col, int depth,
              int depth2, int depth3, int depth4) {
              return ${c}(${(0,f.getSqueezedParams)(S,T)});
            }
          `;return new a.GlslLibRoutine(C,["coordinates.sampleTexture","coordinates.uvFromFlat"])}const w=`
          float ${c}(int row, int col, int depth,
            int depth2, int depth3, int depth4) {
            int index = row * ${_} + col * ${b} + depth * ${y} +
            depth2 * ${g} + depth3 * ${l} + depth4;
            vec2 uv = uvFromFlat(${e.width}, ${e.height}, index);
            return sampleTexture(${o}, uv);
          }
        `;return new a.GlslLibRoutine(w,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){const c=this.context.outputTextureLayout,o=c.shape.length,e=c.strides,s=c.width,l=c.height,g=[];for(let b=0;b<o-1;++b)g.push(`
        c[${b}] = offset / ${e[b]};`),g.push(`
        offset -= c[${b}] * ${e[b]};`);g.push(`
        c[${o-1}] = offset;`);const y=`
      void toVec(vec2 texCoords, out int c[${o}]) {
        int offset = coordsToOffset(texCoords, ${s}, ${l});
        ${g.join("")}
      }
      void toVec(int offset, out int c[${o}]) {
        ${g.join("")}
      }
    `;return{toVec:new a.GlslLibRoutine(y,["coordinates.coordsToOffset"])}}valueFrom(){const c={};return this.context.programInfo.inputNames.forEach((o,e)=>{const s=this.context.inputTextureLayouts[e],l=(s.unpackedShape.length>0?s.unpackedShape:s.shape).length;let g=`_${o}`;c[g]=new a.GlslLibRoutine(this.getValueFromSingle(o,l,s.width,s.height,!1),[`shapeUtils.indicesToOffset${g}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),g+="_T",c[g]=new a.GlslLibRoutine(this.getValueFromSingle(o,l,s.width,s.height,!0),[`shapeUtils.indicesToOffset${g}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])}),c}getValueFromSingle(c,o,e,s,l){let g=`_${c}`;return l&&(g+="_T"),`
        float ${g}(int m[${o}]) {
          int offset = indicesToOffset${g}(m);
          vec2 coords = offsetToCoords(offset, ${e}, ${s});
          float value = getColorAsFloat(${(0,u.getGlsl)(this.context.glContext.version).texture2D}(${c}, coords));
          return value;
        }
        `}getPackedValueFrom(c,o,e,s,l){let g=`_${c}_Pack`;return l&&(g+="_T"),`
        vec4 ${g}(int m[${o}]) {
          int offset = indicesToOffset_${c}(m);
          vec2 coords = offsetToCoords(offset, ${e}, ${s});
          return ${(0,u.getGlsl)(this.context.glContext.version).texture2D}(${c}, coords);
        }
        `}}t.CoordsGlslLib=d},1997:(m,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TopologicalSortGlslRoutines=t.GlslLibRoutineNode=t.GlslLibRoutine=t.GlslLib=t.GlslContext=t.FunctionType=void 0,(n=t.FunctionType||(t.FunctionType={}))[n.ValueBased=0]="ValueBased",n[n.Positional=1]="Positional",t.GlslContext=class{constructor(r,a,u,h){this.glContext=r,this.programInfo=a,this.inputTextureLayouts=u,this.outputTextureLayout=h}},t.GlslLib=class{constructor(r){this.context=r}},t.GlslLibRoutine=class{constructor(r,a){this.routineBody=r,this.dependencies=a}},t.GlslLibRoutineNode=class{constructor(r,a,u){this.name=r,this.dependencies=u||[],a&&(this.routineBody=a)}addDependency(r){r&&this.dependencies.push(r)}},t.TopologicalSortGlslRoutines=class{static returnOrderedNodes(r){if(!r||r.length===0)return[];if(r.length===1)return r;const a=new Set,u=new Set,h=new Array;return this.createOrderedNodes(r,a,u,h),h}static createOrderedNodes(r,a,u,h){for(let f=0;f<r.length;++f)this.dfsTraverse(r[f],a,u,h)}static dfsTraverse(r,a,u,h){if(!r||u.has(r.name))return;if(a.has(r.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");a.add(r.name);const f=r.dependencies;if(f&&f.length>0)for(let d=0;d<f.length;++d)this.dfsTraverse(f[d],a,u,h);h.push(r),u.add(r.name),a.delete(r.name)}}},1371:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EncodingGlslLib=void 0;const r=n(1997);class a extends r.GlslLib{constructor(h){super(h)}getFunctions(){return Object.assign(Object.assign({},this.encodeFloat32()),this.decodeFloat32())}getCustomTypes(){return{}}encodeFloat32(){return{encode:new r.GlslLibRoutine(`highp vec4 encode(highp float f) {
        return vec4(f, 0.0, 0.0, 0.0);
      }
        `)}}decodeFloat32(){return{decode:new r.GlslLibRoutine(`highp float decode(highp vec4 rgba) {
        return rgba.r;
      }
        `)}}encodeUint8(){const h=a.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new r.GlslLibRoutine(`
      highp vec4 encode(highp float f) {
        highp float F = abs(f);
        highp float Sign = step(0.0,-f);
        highp float Exponent = floor(log2(F));
        highp float Mantissa = (exp2(- Exponent) * F);
        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));
        highp vec4 rgba;
        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));
        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);
        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));
        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));
        ${h}
        rgba = rgba / 255.0; // values need to be normalized to [0,1]
        return rgba;
    }
        `)}}decodeUint8(){const h=a.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new r.GlslLibRoutine(`
        highp float decode(highp vec4 rgba) {
          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]
          ${h}
          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;
          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;
          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);
          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));
          return Result;
      }
        `)}}static isLittleEndian(){const h=new ArrayBuffer(4),f=new Uint32Array(h),d=new Uint8Array(h);if(f[0]=3735928559,d[0]===239)return!0;if(d[0]===222)return!1;throw new Error("unknown endianness")}}t.EncodingGlslLib=a},2691:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FragColorGlslLib=void 0;const r=n(1997),a=n(6757);class u extends r.GlslLib{constructor(f){super(f)}getFunctions(){return Object.assign(Object.assign({},this.setFragColor()),this.getColorAsFloat())}getCustomTypes(){return{}}setFragColor(){const f=(0,a.getGlsl)(this.context.glContext.version);return{setFragColor:new r.GlslLibRoutine(`
        void setFragColor(float value) {
            ${f.output} = encode(value);
        }
        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new r.GlslLibRoutine(`
        float getColorAsFloat(vec4 color) {
            return decode(color);
        }
        `,["encoding.decode"])}}}t.FragColorGlslLib=u},3878:(m,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.replaceInlines=void 0;const n=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm;t.replaceInlines=function(r){const a={};let u;for(;(u=n.exec(r))!==null;){const h=u[3].split(",").map(f=>{const d=f.trim().split(" ");return d&&d.length===2?{type:d[0],name:d[1]}:null}).filter(f=>f!==null);a[u[2]]={params:h,body:u[4]}}for(const h in a){const f="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;".replace("__FUNC__",h),d=new RegExp(f,"gm");for(;(u=d.exec(r))!==null;){const p=u[1],c=u[2],o=u[3].split(","),e=p?`${p} ${c};`:"";let s=a[h].body,l="";a[h].params.forEach((y,b)=>{y&&(l+=`${y.type} ${y.name} = ${o[b]};
`)}),s=`${l}
 ${s}`,s=s.replace("return",`${c} = `);const g=`
      ${e}
      {
        ${s}
      }
      `;r=r.replace(u[0],g)}}return r.replace(n,"")}},8897:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlslPreprocessor=void 0;const r=n(1997),a=n(3878),u=n(1248),h=n(6757);t.GlslPreprocessor=class{constructor(f,d,p,c){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new r.GlslContext(f,d,p,c),Object.keys(u.glslRegistry).forEach(e=>{const s=new u.glslRegistry[e](this.context);this.libs[e]=s});const o=this.glslLibRoutineDependencyGraph;for(const e in this.libs){const s=this.libs[e].getFunctions();for(const l in s){const g=e+"."+l;let y;o[g]?(y=o[g],y.routineBody=s[l].routineBody):(y=new r.GlslLibRoutineNode(g,s[l].routineBody),o[g]=y);const b=s[l].dependencies;if(b)for(let _=0;_<b.length;++_)if(o[b[_]])y.addDependency(o[b[_]]);else{const v=new r.GlslLibRoutineNode(b[_]);o[b[_]]=v,y.addDependency(v)}}}}preprocess(){const f=this.context.programInfo;let d=f.shaderSource;return this.context.programInfo.hasMain||(d=`${d}
      ${(0,h.getDefaultFragShaderMain)(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),d=(0,a.replaceInlines)(d),`${(0,h.getFragShaderPreamble)(this.context.glContext.version)}
    ${this.getUniforms(f.inputNames,f.variables)}
    ${this.getImports(d)}
    ${d}`}getImports(f){const d=this.selectGlslLibRoutinesToBeIncluded(f);if(d.length===0)return"";let p="";for(let c=0;c<d.length;++c){if(!d[c].routineBody)throw new Error(`Missing body for the Glsl Library routine: ${d[c].name}`);p+=d[c].routineBody+`
`}return p}selectGlslLibRoutinesToBeIncluded(f){const d=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach(p=>{const c=p.split(".")[1];f.indexOf(c)!==-1&&d.push(this.glslLibRoutineDependencyGraph[p])}),r.TopologicalSortGlslRoutines.returnOrderedNodes(d)}getUniforms(f,d){const p=[];if(f)for(const c of f)p.push(`uniform sampler2D ${c};`);if(d)for(const c of d)p.push(`uniform ${c.type} ${c.name}${c.arrayLength?`[${c.arrayLength}]`:""};`);return p.join(`
`)}}},1248:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.glslRegistry=void 0;const r=n(6859),a=n(1371),u=n(2691),h=n(9183),f=n(9314);t.glslRegistry={encoding:a.EncodingGlslLib,fragcolor:u.FragColorGlslLib,vec:f.VecGlslLib,shapeUtils:h.ShapeUtilsGlslLib,coordinates:r.CoordsGlslLib}},9183:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeUtilsGlslLib=void 0;const r=n(1997);class a extends r.GlslLib{constructor(h){super(h)}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.bcastIndex()),this.bcastMatmulIndex()),this.offsetToIndices()),this.indicesToOffset()),this.incrementIndices())}getCustomTypes(){return{}}bcastIndex(){const h=this.context.outputTextureLayout.shape.length,f={};return this.context.programInfo.inputNames.forEach((d,p)=>{const c=this.context.inputTextureLayouts[p].unpackedShape;if(c.length<=h){const o=c.length,e=h-o,s=`bcastIndices_${d}`;let l="";for(let y=0;y<o;++y)l+=`
          realIndices[${y}] = int( mod(float(bcastedIndices[${e+y}]), ${c[y]}.0) );
          `;const g=`
        void ${s} (int bcastedIndices[${h}], out int realIndices[${o}]) {
          ${l}
        }
        `;f[s]=new r.GlslLibRoutine(g)}}),f}bcastMatmulIndex(){const h=this.context.outputTextureLayout.shape.length,f={};return this.context.programInfo.inputNames.forEach((d,p)=>{const c=this.context.inputTextureLayouts[p].shape;if(!(c.length<2||c.length>h)){const o=c.length,e=h-o,s=`bcastMatmulIndices_${d}`;let l="";for(let y=0;y<o-2;++y)l+=`
          realIndices[${y}] = int( mod(float(bcastedIndices[${e+y}]), ${c[y]}.0) );
          `;const g=`
        void ${s}(int bcastedIndices[${h}], out int realIndices[${o}]) {
          ${l}
          realIndices[${o-1}] = bcastedIndices[${h-1}];
          realIndices[${o-2}] = bcastedIndices[${h-2}];
        }
        `;f[s]=new r.GlslLibRoutine(g)}}),f}indicesToOffset(){const h={};return this.context.programInfo.inputNames.forEach((f,d)=>{const p=this.context.inputTextureLayouts[d].shape,c=this.context.inputTextureLayouts[d].strides,o=p.length;let e=`indicesToOffset_${f}`;h[e]=new r.GlslLibRoutine(a.indexToOffsetSingle(e,o,c)),e=`indicesToOffset_${f}_T`,h[e]=new r.GlslLibRoutine(a.indexToOffsetSingle(e,o,c.slice().reverse()))}),h}static indexToOffsetSingle(h,f,d){let p="";for(let c=f-1;c>=0;--c)p+=`
        offset += indices[${c}] * ${d[c]};
        `;return`
      int ${h}(int indices[${f}]) {
        int offset = 0;
        ${p}
        return offset;
      }
      `}offsetToIndices(){const h={};return this.context.programInfo.inputNames.forEach((f,d)=>{const p=this.context.inputTextureLayouts[d].shape,c=this.context.inputTextureLayouts[d].strides,o=p.length;let e=`offsetToIndices_${f}`;h[e]=new r.GlslLibRoutine(a.offsetToIndicesSingle(e,o,c)),e=`offsetToIndices_${f}_T`,h[e]=new r.GlslLibRoutine(a.offsetToIndicesSingle(e,o,c.slice().reverse()))}),h}static offsetToIndicesSingle(h,f,d){const p=[];for(let c=0;c<f-1;++c)p.push(`
      indices[${c}] = offset / ${d[c]};`),p.push(`
        offset -= indices[${c}] * ${d[c]};`);return p.push(`
      indices[${f-1}] = offset;`),`
      void ${h}(int offset, out int indices[${f}]) {
        ${p.join("")}
      }
      `}incrementIndices(){const h={};return this.context.programInfo.inputNames.forEach((f,d)=>{const p=this.context.inputTextureLayouts[d].shape,c=p.length,o=`incrementIndices_${f}`;let e="";for(let l=0;l<c;++l)e+=`
        shape[${l}] = ${p[l]};`;const s=`
        void ${o}(int axis, out int indices[${c}]) {
          int shape[${c}];
          ${e};
          for(int i = ${c} -1 ; i >= 0; --i) {
            if(i > axis) continue;
            indices[i] += 1;
            if(indices[i] < shape[i]) {
              break;
            }
            indices[i] = 0;
          }
        }
        `;h[o]=new r.GlslLibRoutine(s)}),h}}t.ShapeUtilsGlslLib=a},6757:(m,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultFragShaderMain=t.getFragShaderPreamble=t.getVertexShaderSource=t.getGlsl=void 0;const n={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},r={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"};function a(u){return u===1?n:r}t.getGlsl=a,t.getVertexShaderSource=function(u){const h=a(u);return`${h.version}
      precision highp float;
      ${h.attribute} vec3 position;
      ${h.attribute} vec2 textureCoord;

      ${h.varyingVertex} vec2 TexCoords;

      void main()
      {
          gl_Position = vec4(position, 1.0);
          TexCoords = textureCoord;
      }`},t.getFragShaderPreamble=function(u){const h=a(u);return`${h.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${h.varyingFrag} vec2 TexCoords;
    ${h.outputDeclaration}
    const vec2 halfCR = vec2(0.5, 0.5);

    // Custom vector types to handle higher dimenalities.
    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    `},t.getDefaultFragShaderMain=function(u,h){return`
  void main() {
    int indices[${h}];
    toVec(TexCoords, indices);
    vec4 result = vec4(process(indices));
    ${a(u).output} = result;
  }
  `}},9314:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VecGlslLib=void 0;const r=n(1997);class a extends r.GlslLib{constructor(h){super(h)}getCustomTypes(){return{}}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign({},this.binaryVecFunctions()),this.copyVec()),this.setVecItem()),this.getVecItem())}binaryVecFunctions(){const h=this.context.outputTextureLayout.shape.length,f={add:"+=",sub:"-=",mul:"*=",div:"/="},d={};for(const p in f){const c=`${p}Vec`;let o="";for(let s=0;s<h;++s)o+=`
          dest[${s}] ${f[p]} src[${s}];
          `;const e=`
        void ${c}(int src[${h}], out int dest[${h}]) {
          ${o}
        }
        `;d[c]=new r.GlslLibRoutine(e)}return d}copyVec(){const h=this.context.outputTextureLayout.shape.length;let f="";for(let p=0;p<h;++p)f+=`
        dest[${p}] = src[${p}];
        `;const d=`
      void copyVec(int src[${h}], out int dest[${h}]) {
        ${f}
      }
      `;return{copyVec:new r.GlslLibRoutine(d)}}setVecItem(){const h=this.context.outputTextureLayout.shape.length;let f=`
        if(index < 0)
            index =${h} + index;
        if (index == 0)
            m[0] = value;
        `;for(let p=1;p<h-1;++p)f+=`
        else if (index == ${p})
            m[${p}] = value;
            `;f+=`
        else
            m[${h-1}] = value;
        `;const d=`
      void setVecItem(out int m[${h}], int index, int value) {
        ${f}
      }
        `;return{setVecItem:new r.GlslLibRoutine(d)}}getVecItem(){const h=this.context.outputTextureLayout.shape.length;let f=`
        if(index < 0)
            index = ${h} + index;
        if (index == 0)
            return m[0];
      `;for(let p=1;p<h-1;++p)f+=`
        else if (index == ${p})
            return m[${p}];
      `;f+=`
        else
            return m[${h-1}];
        `;const d=`
      int getVecItem(int m[${h}], int index) {
        ${f}
      }
    `;return{getVecItem:new r.GlslLibRoutine(d)}}}t.VecGlslLib=a},7860:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLInferenceHandler=void 0;const r=n(1315),a=n(9240),u=n(7273),h=n(9),f=n(7379),d=n(2488),p=n(540),c=n(3314),o=n(5639);t.WebGLInferenceHandler=class{constructor(e){this.session=e,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(e,s){return(0,c.calculateTextureWidthAndHeight)(this.session.layoutStrategy,e,s)}executeProgram(e,s){if(s.length<e.inputNames.length)throw new Error(`Input size mustn't be less than ${e.inputNames.length}.`);if(e.inputNames.length!==e.inputTypes.length)throw new Error("input names size does not match input types");const l=[];for(let T=0;T<e.inputNames.length;++T)l[T]=this.getOrCreateTextureData(s[T],e.inputTypes[T]);const g=((T,w)=>{const A=w.map(O=>`${O.unpackedShape.join(",")};${O.width}x${O.height}`).join("_");let S=T.name;return T.cacheHint&&(S+="["+T.cacheHint+"]"),S+=":"+A,S})(e,l);let y=this.session.programManager.getArtifact(g);const b=y?y.programInfo:typeof e.get=="function"?e.get():e,_=(0,c.createTextureLayoutFromTextureType)(this.session.layoutStrategy,b.output.dims,b.output.textureType),v=this.createTextureData(_,b.output.type);return y||(y=this.session.programManager.build(b,l,v),this.session.programManager.setArtifact(g,y)),this.runProgram(y,l,v),v}run(e,s){return this.executeProgram(e,s).tensor}runProgram(e,s,l){for(let g=0;g<s.length;++g)if(!!s[g].isPacked!=(e.programInfo.inputTypes[g]===o.TextureType.packed))throw new Error(`input[${g}] property packed inconsistent`);if(!!l.isPacked!=(e.programInfo.output.textureType===o.TextureType.packed))throw new Error("output property packed inconsistent");this.session.programManager.run(e,s,l)}getOrCreateTextureData(e,s){let l=this.getTextureData(e.dataId,s===o.TextureType.packed);if(!l&&(l=this.getTextureData(e.dataId,s!==o.TextureType.packed),l))return s===o.TextureType.packed?this.pack(l):this.unpack(l);if(!l){const g=(0,c.createTextureLayoutFromTextureType)(this.session.layoutStrategy,e.dims,s);if(s===o.TextureType.packedLastDimension){const _=e.dims;if(_.length===4){const v=[_[0],Math.ceil(_[1]*_[2]*_[3]/4)],T=(0,c.createTextureLayoutFromTextureType)(this.session.layoutStrategy,v,s);let w=e.numberData;if(_[1]*_[2]*_[3]%4!=0){const A=_[0],S=_[1]*_[2]*_[3],O=Math.ceil(S*1/4)*4;w=new Float32Array(A*O);for(let C=0;C<A;++C){const D=C*S,$=C*O+C%1*S;w.set(e.numberData.subarray(D,D+S),$)}}return this.createTextureData(T,e.type,w,e,1)}}if(s===o.TextureType.packed){const y=(0,c.createTextureLayoutFromShape)(this.session.layoutStrategy,e.dims,1,[],{reverseWH:!0}),b=this.createTextureData(y,e.type,e.numberData,e,1);l=this.pack(b)}else l=this.createTextureData(g,e.type,e.numberData,e,1)}return l}createTextureDataFromLayoutBindTensor(e,s,l,g){return this.createTextureData(e,s,l,g,1)}createTextureData(e,s,l,g,y){r.Logger.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(e)}]`);const b=this.session.textureManager.createTextureFromLayout(s,e,l,y);return this.createTextureDataFromTexture(e,s,b,g)}reshapeUnpacked(e,s){const l=this.getOrCreateTextureData(e,o.TextureType.unpacked),g={channels:l.channels,height:l.height,width:l.width,shape:s.length!==0?s:[1],strides:u.ShapeUtil.computeStrides(s),unpackedShape:s};return this.createTextureDataFromTexture(g,e.type,l.texture).tensor}reshapePacked(e,s){const l=this.getOrCreateTextureData(e,o.TextureType.packed);if((0,f.isReshapeCheap)(e.dims,s)){const v={channels:l.channels,height:l.height,width:l.width,shape:s.length!==0?s:[1],strides:u.ShapeUtil.computeStrides(s),unpackedShape:s,isPacked:!0};return this.createTextureDataFromTexture(v,e.type,l.texture).tensor}const g=(0,f.processDims3D)(e.dims),y=(0,f.processDims3D)(s),b=this.reshapePacked(e,g),_=this.run((0,f.createPackedReshape3DProgramInfoLoader)(this,b,y),[b]);return this.reshapePacked(_,s)}cast(e,s){const l=this.getOrCreateTextureData(e,o.TextureType.unpacked);return this.createTextureDataFromTexture(l,s,l.texture).tensor}createTextureDataFromTexture(e,s,l,g,y){const b=Object.assign(Object.assign({},e),{tensor:g||new a.Tensor(e.unpackedShape,s,_=>this.readTexture(b),async _=>this.readTextureAsync(b),void 0,y),texture:l});return this.setTextureData(b.tensor.dataId,b,e.isPacked),b}getTextureData(e,s=!1){return this.session.isInitializer(e)?this.session.getTextureData(e,s):s?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,s,l=!1){this.session.isInitializer(e)?this.session.setTextureData(e,s,l):(l?this.packedTextureDataCache:this.unpackedTextureDataCache).set(e,s)}isTextureLayoutCached(e,s=!1){return!!this.getTextureData(e.dataId,s)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(e=>this.session.textureManager.releaseTexture(e)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(e=>this.session.textureManager.releaseTexture(e)),this.unpackedTextureDataCache=new Map}readTexture(e){return e.isPacked?this.readTexture(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat((0,d.encodeAsUint8)(this,e))}async readTextureAsync(e){return e.isPacked?this.readTextureAsync(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat((0,d.encodeAsUint8)(this,e))}pack(e){return this.executeProgram((0,h.createPackProgramInfoLoader)(this,e.tensor),[e.tensor])}unpack(e){return this.executeProgram((0,p.createUnpackProgramInfoLoader)(this,e.tensor),[e.tensor])}}},4110:function(m,t,n){var r=this&&this.__createBinding||(Object.create?function(J,Y,Q,tt){tt===void 0&&(tt=Q);var nt=Object.getOwnPropertyDescriptor(Y,Q);nt&&!("get"in nt?!Y.__esModule:nt.writable||nt.configurable)||(nt={enumerable:!0,get:function(){return Y[Q]}}),Object.defineProperty(J,tt,nt)}:function(J,Y,Q,tt){tt===void 0&&(tt=Q),J[tt]=Y[Q]}),a=this&&this.__setModuleDefault||(Object.create?function(J,Y){Object.defineProperty(J,"default",{enumerable:!0,value:Y})}:function(J,Y){J.default=Y}),u=this&&this.__importStar||function(J){if(J&&J.__esModule)return J;var Y={};if(J!=null)for(var Q in J)Q!=="default"&&Object.prototype.hasOwnProperty.call(J,Q)&&r(Y,J,Q);return a(Y,J),Y};Object.defineProperty(t,"__esModule",{value:!0}),t.WEBGL_OP_RESOLVE_RULES=void 0;const h=n(8817),f=u(n(5194)),d=n(4752),p=n(6668),c=n(9754),o=n(5042),e=n(6742),s=n(4125),l=n(6149),g=n(5378),y=n(6981),b=n(7413),_=n(7006),v=n(8276),T=n(5565),w=n(2834),A=n(1010),S=n(8126),O=n(2801),C=n(565),D=n(2444),$=n(815),L=n(564),P=n(5416),B=n(1240),I=n(5944),M=n(5707),k=u(n(9087)),X=n(7862),G=n(3980);t.WEBGL_OP_RESOLVE_RULES=[["Abs","","6+",k.abs],["Acos","","7+",k.acos],["Add","","7+",f.add],["And","","7+",f.and],["Asin","","7+",k.asin],["Atan","","7+",k.atan],["AveragePool","","7+",w.averagePool,w.parseAveragePoolAttributes],["BatchNormalization","","7+",h.batchNormalization,h.parseBatchNormalizationAttributes],["Cast","","6+",d.cast,d.parseCastAttributes],["Ceil","","6+",k.ceil],["Clip","","6-10",k.clip,k.parseClipAttributes],["Clip","","11+",k.clipV11],["Concat","","4+",p.concat,p.parseConcatAttributes],["Conv","","1+",c.conv,c.parseConvAttributes],["ConvTranspose","","1+",o.convTranspose,o.parseConvTransposeAttributes],["Cos","","7+",k.cos],["Div","","7+",f.div],["Dropout","","7+",k.identity],["DepthToSpace","","1+",e.depthToSpace,e.parseDepthToSpaceAttributes],["Equal","","7+",f.equal],["Elu","","6+",k.elu,k.parseEluAttributes],["Exp","","6+",k.exp],["Flatten","","1+",s.flatten,s.parseFlattenAttributes],["Floor","","6+",k.floor],["FusedConv","com.microsoft","1+",c.conv,c.parseConvAttributes],["Gather","","1+",l.gather,l.parseGatherAttributes],["Gemm","","7-10",g.gemm,g.parseGemmAttributesV7],["Gemm","","11+",g.gemm,g.parseGemmAttributesV11],["GlobalAveragePool","","1+",w.globalAveragePool,w.parseGlobalAveragePoolAttributes],["GlobalMaxPool","","1+",w.globalMaxPool],["Greater","","7+",f.greater],["Identity","","1+",k.identity],["ImageScaler","","1+",y.imageScaler,y.parseImageScalerAttributes],["InstanceNormalization","","6+",b.instanceNormalization,b.parseInstanceNormalizationAttributes],["LeakyRelu","","6+",k.leakyRelu,k.parseLeakyReluAttributes],["Less","","7+",f.less],["LRN","","1+",_.lrn,_.parseLrnAttributes],["Log","","6+",k.log],["MatMul","","1+",v.matMul,v.parseMatMulAttributes],["MaxPool","","1+",w.maxPool,w.parseMaxPoolAttributes],["Mul","","7+",f.mul],["Neg","","6+",k.neg],["Not","","1+",k.not],["Or","","7+",f.or],["Pad","","2-10",T.padV2,T.parsePadAttributesV2],["Pad","","11+",T.padV11,T.parsePadAttributesV11],["Pow","","7+",f.pow],["PRelu","","7+",f.pRelu],["ReduceLogSum","","1+",A.reduceLogSum,A.parseReduceAttributes],["ReduceMax","","1+",A.reduceMax,A.parseReduceAttributes],["ReduceMean","","1+",A.reduceMean,A.parseReduceAttributes],["ReduceMin","","1+",A.reduceMin,A.parseReduceAttributes],["ReduceProd","","1+",A.reduceProd,A.parseReduceAttributes],["ReduceSum","","1-12",A.reduceSum,A.parseReduceAttributes],["ReduceSumSquare","","1+",A.reduceLogSumSquare,A.parseReduceAttributes],["Relu","","6+",k.relu],["Reshape","","5+",S.reshape],["Resize","","10",O.resize,O.parseResizeAttributesV10],["Resize","","11+",O.resize,O.parseResizeAttributesV11],["Shape","","1+",C.shape],["Sigmoid","","6+",k.sigmoid],["Sin","","7+",k.sin],["Slice","","10+",D.sliceV10],["Slice","","1-9",D.slice,D.parseSliceAttributes],["Softmax","","1-12",$.softmax,$.parseSoftmaxAttributes],["Softmax","","13+",$.softmaxV13,$.parseSoftmaxAttributesV13],["Split","","2-12",L.split,L.parseSplitAttributes],["Sqrt","","6+",k.sqrt],["Squeeze","","1-12",P.squeeze,P.parseSqueezeAttributes],["Squeeze","","13+",P.squeezeV13],["Sub","","7+",f.sub],["Sum","","6+",B.sum],["Tan","","7+",k.tan],["Tanh","","6+",k.tanh],["Tile","","6+",I.tile],["Transpose","","1+",M.transpose,M.parseTransposeAttributes],["Upsample","","7-8",G.upsample,G.parseUpsampleAttributesV7],["Upsample","","9",G.upsample,G.parseUpsampleAttributesV9],["Unsqueeze","","1-12",X.unsqueeze,X.parseUnsqueezeAttributes],["Unsqueeze","","13+",X.unsqueezeV13],["Xor","","7+",f.xor]]},8817:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseBatchNormalizationAttributes=t.batchNormalization=void 0;const r=n(4910),a=n(6757),u=n(5639),h={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[u.TextureType.unpacked,u.TextureType.unpacked,u.TextureType.unpacked,u.TextureType.unpacked,u.TextureType.unpacked]};t.batchNormalization=(p,c,o)=>(d(c),[p.run(Object.assign(Object.assign({},h),{cacheHint:o.cacheKey,get:()=>f(p,c,o)}),c)]),t.parseBatchNormalizationAttributes=p=>{const c=p.attributes.getFloat("epsilon",1e-5),o=p.attributes.getFloat("momentum",.9),e=p.attributes.getInt("spatial",1);return(0,r.createAttributeWithCacheKey)({epsilon:c,momentum:o,spatial:e})};const f=(p,c,o)=>{const e=(0,a.getGlsl)(p.session.backend.glContext.version),s=c[0].dims.length,[l,g]=p.calculateTextureWidthAndHeight(c[1].dims,u.TextureType.unpacked),y=`
  float process(int[${s}] indices) {
    vec2 position = offsetToCoords(indices[1], ${l}, ${g});
    float scale = getColorAsFloat(${e.texture2D}(Scale, position));
    float mean = getColorAsFloat(${e.texture2D}(Mean, position));
    float variance = getColorAsFloat(${e.texture2D}(Variance, position));
    float b = getColorAsFloat(${e.texture2D}(B, position));

    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${o.epsilon})) ) + b;
  }`;return Object.assign(Object.assign({},h),{output:{dims:c[0].dims,type:c[0].type,textureType:u.TextureType.unpacked},shaderSource:y})},d=p=>{if(!p||p.length!==5)throw new Error("BatchNormalization requires 5 inputs.");const c=p[0],o=p[1],e=p[2],s=p[3],l=p[4];if(c.dims.length<3||o.dims.length!==1||e.dims.length!==1||s.dims.length!==1||l.dims.length!==1)throw new Error("invalid input shape.");if(o.dims[0]!==c.dims[1]||e.dims[0]!==c.dims[1]||s.dims[0]!==c.dims[1]||l.dims[0]!==c.dims[1])throw new Error("invalid input shape.");if(c.type!=="float32"&&c.type!=="float64"||o.type!=="float32"&&o.type!=="float64"||e.type!=="float32"&&e.type!=="float64"||s.type!=="float32"&&s.type!=="float64"||l.type!=="float32"&&l.type!=="float64")throw new Error("invalid input tensor types.")}},5194:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.xor=t.sub=t.pRelu=t.pow=t.or=t.mul=t.less=t.greater=t.equal=t.div=t.and=t.add=t.glslPRelu=t.glslPow=t.glslXor=t.glslOr=t.glslAnd=t.glslLess=t.glslGreater=t.glslEqual=t.glslSub=t.glslMul=t.glslDiv=t.glslAdd=void 0;const r=n(7273),a=n(1997),u=n(6757),h=n(5639);function f(){const w="add_";return{body:`
  float ${w}(float a, float b) {
    return a + b;
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return v1 + v2;
  }
  `,name:w,type:a.FunctionType.ValueBased}}function d(){const w="div_";return{body:`
  float ${w}(float a, float b) {
    return a / b;
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return v1 / v2;
  }
  `,name:w,type:a.FunctionType.ValueBased}}function p(){const w="mul_";return{body:`
  float ${w}(float a, float b) {
    return a * b;
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return v1 * v2;
  }
  `,name:w,type:a.FunctionType.ValueBased}}function c(){const w="sub_";return{body:`
  float ${w}(float a, float b) {
    return a - b;
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return v1 - v2;
  }
  `,name:w,type:a.FunctionType.ValueBased}}function o(){const w="equal_";return{body:`
  float ${w}(float a, float b) {
    return float(a == b);
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return vec4(equal(v1, v2));
  }
  `,name:w,type:a.FunctionType.ValueBased}}function e(){const w="greater_";return{body:`
  float ${w}(float a, float b) {
    return float(a > b);
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return vec4( v1.r > v2.r ,
      v1.g > v2.g,
      v1.b > v2.b,
      v1.a > v2.a );
  }
  `,name:w,type:a.FunctionType.ValueBased}}function s(){const w="less_";return{body:`
  float ${w}(float a, float b) {
    return float(a < b);
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return vec4( v1.r < v2.r ,
                v1.g < v2.g,
                v1.b < v2.b,
                v1.a < v2.a );
  }
  `,name:w,type:a.FunctionType.ValueBased}}function l(){const w="and_";return{body:`
  float ${w}(float a, float b) {
    return float( bool(a) && bool(b) );
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r && b2.r ,
                b1.g && b2.g,
                b1.b && b2.b,
                b1.a && b2.a );
  }
  `,name:w,type:a.FunctionType.ValueBased}}function g(){const w="or_";return{body:`
  float ${w}(float a, float b) {
    return float( bool(a) || bool(b) );
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r || b2.r ,
                b1.g || b2.g,
                b1.b || b2.b,
                b1.a || b2.a );
  }
  `,name:w,type:a.FunctionType.ValueBased}}function y(){const w="xor_";return{body:`
  float ${w}(float a, float b) {
    return float( bool(a) ^^ bool(b) );
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r ^^ b2.r ,
                b1.g ^^ b2.g,
                b1.b ^^ b2.b,
                b1.a ^^ b2.a );
  }
  `,name:w,type:a.FunctionType.ValueBased}}function b(){return function(w){const A=`${w}_`;return{body:`
  float ${A}(float a, float b) {
    return ${w}(a, b);
  }
  vec4 ${A}(vec4 v1, vec4 v2) {
    return ${w}(v1, v2);
  }
  `,name:A,type:a.FunctionType.ValueBased}}("pow")}function _(){const w="prelu_";return{body:`
  float ${w}(float a, float b) {
    return a < 0.0 ? a * b: a;
  }
  vec4 ${w}(vec4 v1, vec4 v2) {
    return vec4(
      v1.r < 0.0 ? v1.r * v2.r: v1.r,
      v1.g < 0.0 ? v1.g * v2.g: v1.g,
      v1.b < 0.0 ? v1.b * v2.b: v1.b,
      v1.a < 0.0 ? v1.a * v2.a: v1.a
      );
  }
  `,name:w,type:a.FunctionType.ValueBased}}t.glslAdd=f,t.glslDiv=d,t.glslMul=p,t.glslSub=c,t.glslEqual=o,t.glslGreater=e,t.glslLess=s,t.glslAnd=l,t.glslOr=g,t.glslXor=y,t.glslPow=b,t.glslPRelu=_;const v=(w,A,S,O=A[0].type,C)=>{const D=w.session.pack?h.TextureType.packed:h.TextureType.unpacked;return{name:S.name,inputNames:["A","B"],inputTypes:[D,D],cacheHint:C,get:()=>T(w,A,S,O)}},T=(w,A,S,O=A[0].type)=>{const C=w.session.pack?h.TextureType.packed:h.TextureType.unpacked,D=!r.ShapeUtil.areEqual(A[0].dims,A[1].dims);let $=A[0].dims;const L=w.session.pack;if(D){const I=r.BroadcastUtil.calcShape(A[0].dims,A[1].dims,!1);if(!I)throw new Error("Can't perform binary op on the given tensors");$=I;const M=$.length,k=A[0].dims.length!==0?A[0].dims.length:1,X=A[1].dims.length!==0?A[1].dims.length:1,G=A[0].dims.length!==0?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",J=A[1].dims.length!==0?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",Y=(0,u.getGlsl)(w.session.backend.glContext.version),Q=L?`
      ${S.body}
      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();
        vec4 result = ${S.name}(a, b);
        ${Y.output} = result;
      }`:`
      ${S.body}
      float process(int indices[${M}]) {
        int aindices[${k}];
        int bindices[${X}];
        ${G}
        ${J}
        return ${S.name}(_A(aindices), _B(bindices));
      }`;return{name:S.name,inputNames:["A","B"],inputTypes:[C,C],output:{dims:$,type:O,textureType:C},shaderSource:Q,hasMain:L}}const P=(0,u.getGlsl)(w.session.backend.glContext.version),B=`
    ${S.body}
    void main() {
      vec4 v1 = ${P.texture2D}(A, TexCoords);
      vec4 v2 = ${P.texture2D}(B, TexCoords);
      vec4 result = ${S.name}(v1, v2);
      ${P.output} = result;
    }
    `;return{name:S.name,inputNames:["A","B"],inputTypes:[C,C],output:{dims:A[0].dims,type:O,textureType:C},shaderSource:B,hasMain:!0}};t.add=(w,A)=>[w.run(v(w,A,f()),A)],t.and=(w,A)=>[w.run(v(w,A,l(),"bool"),A)],t.div=(w,A)=>[w.run(v(w,A,d()),A)],t.equal=(w,A)=>[w.run(v(w,A,o(),"bool"),A)],t.greater=(w,A)=>[w.run(v(w,A,e(),"bool"),A)],t.less=(w,A)=>[w.run(v(w,A,s(),"bool"),A)],t.mul=(w,A)=>[w.run(v(w,A,p()),A)],t.or=(w,A)=>[w.run(v(w,A,g(),"bool"),A)],t.pow=(w,A)=>[w.run(v(w,A,b()),A)],t.pRelu=(w,A)=>[w.run(v(w,A,_()),A)],t.sub=(w,A)=>[w.run(v(w,A,c()),A)],t.xor=(w,A)=>[w.run(v(w,A,y(),"bool"),A)]},4752:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseCastAttributes=t.cast=void 0;const r=n(7273);t.cast=(u,h,f)=>(a(h),[u.cast(h[0],f)]),t.parseCastAttributes=u=>r.ProtoUtil.tensorDataTypeFromProto(u.attributes.getInt("to"));const a=u=>{if(!u||u.length!==1)throw new Error("Cast requires 1 input.");if(u[0].type==="string")throw new Error("Invalid input type.")}},4595:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPackedConcatProgramInfoLoader=void 0;const r=n(6757),a=n(5639),u=n(432),h=n(5614);t.createPackedConcatProgramInfoLoader=(d,p,c)=>{const o=(e=p.length,s=c.cacheKey,{name:"Concat (packed)",inputNames:Array.from({length:e},(l,g)=>`X${g}`),inputTypes:Array(e).fill(a.TextureType.packed),cacheHint:s});var e,s;return Object.assign(Object.assign({},o),{get:()=>((l,g,y,b)=>{const _=y[0].dims.slice();if(b>=_.length||b<-1*_.length)throw new Error("axis specified for concat doesn't match input dimensionality");b<0&&(b=_.length+b);const v=_.slice(0);for(let G=1;G<y.length;G++){const J=y[G].dims.slice();for(let Y=0;Y<_.length;Y++)if(Y===b)v[b]+=J[Y];else if(_[Y]!==J[Y])throw new Error("non concat dimensions must match")}const T=v.length,w=(0,h.getChannels)("coords",T),A=(0,u.getCoordsDataType)(T),S=(0,h.unpackFromChannel)(),O=y.map(G=>G.dims),C=(0,u.getGlChannels)(T),D=new Array(O.length-1);D[0]=O[0][b];for(let G=1;G<D.length;G++)D[G]=D[G-1]+O[G][b];const $=C[b],L=C.slice(-2),P=C.join();let B=`if (${$} < ${D[0]}) {
        return getChannel(
            getX0(${P}), vec2(${L.join()}));
        }`;for(let G=1;G<D.length;G++){const J=D[G-1];B+=`
            if (${$} < ${D[G]}  && ${$} >= ${D[G-1]}) {
              return getChannel(
                getX${G}(${f(C,$,J)}),
                vec2(${f(L,$,J)}));
            }`}const I=D.length,M=D[D.length-1];B+=`
            return getChannel(
              getX${I}(${f(C,$,M)}),
              vec2(${f(L,$,M)}));`;const k=(0,r.getGlsl)(l.session.backend.glContext.version),X=`
          ${S}
          float getValue(${C.map(G=>"int "+G)}) {
            ${B}
          }

          void main() {
            ${A} coords = getOutputCoords();
            int lastDim = coords.${C[T-1]};
            coords.${C[T-1]} = coords.${C[T-2]};
            coords.${C[T-2]} = lastDim;

            vec4 result = vec4(getValue(${w}), 0., 0., 0.);

            ${w[T-1]} = ${w[T-1]} + 1;
            if (${w[T-1]} < ${v[T-1]}) {
              result.g = getValue(${w});
            }

            ${w[T-2]} = ${w[T-2]} + 1;
            if (${w[T-2]} < ${v[T-2]}) {
              result.a = getValue(${w});
            }

            ${w[T-1]} = ${w[T-1]} - 1;
            if (${w[T-2]} < ${v[T-2]} &&
                ${w[T-1]} < ${v[T-1]}) {
              result.b = getValue(${w});
            }
            ${k.output} = result;
          }
        `;return Object.assign(Object.assign({},g),{output:{dims:v,type:y[0].type,textureType:a.TextureType.packed},shaderSource:X,hasMain:!0})})(d,o,p,c.axis)})};const f=(d,p,c)=>{const o=d.indexOf(p);return d.map((e,s)=>s===o?`${e} - ${c}`:e).join()}},6668:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseConcatAttributes=t.concat=void 0;const r=n(4910),a=n(5639),u=n(4595);t.concat=(e,s,l)=>(o(s),e.session.pack&&s[0].dims.length>1?[e.run((0,u.createPackedConcatProgramInfoLoader)(e,s,l),s)]:[e.run(h(e,s,l),s)]);const h=(e,s,l)=>{const g=(y=s.length,b=l.cacheKey,{name:"Concat",inputNames:Array.from({length:y},(_,v)=>`X${v}`),inputTypes:Array(y).fill(a.TextureType.unpacked),cacheHint:b});var y,b;return Object.assign(Object.assign({},g),{get:()=>((_,v,T,w)=>{const A=T[0].dims.slice();if(w>=A.length||w<-1*A.length)throw new Error("axis specified for concat doesn't match input dimensionality");w<0&&(w=A.length+w);const S=A.slice(0);for(let P=1;P<T.length;P++){const B=T[P].dims.slice();for(let I=0;I<A.length;I++)if(I===w)S[w]+=B[I];else if(A[I]!==B[I])throw new Error("non concat dimensions must match")}const O=S.length,C=new Array(T.length);let D=0;for(let P=0;P<C.length;++P)D+=T[P].dims[w],C[P]=D;let $="";$=T.length<5?f(C):d(C);const L=`
        ${p(T.length,O)}
        ${c(C)}
        ${$}
        float process(int indices[${O}]) {
          int textureIndex = getTextureWhereDataResides (indices[${w}]);

          if(textureIndex != 0) {
            indices[${w}] = indices[${w}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));
          }

          return fetchDataFromCorrectTexture(textureIndex, indices);
        }`;return Object.assign(Object.assign({},v),{output:{dims:S,type:T[0].type,textureType:a.TextureType.unpacked},shaderSource:L})})(0,g,s,l.axis)})},f=e=>`int getTextureWhereDataResides(int index) {
      ${e.map((s,l)=>`if(index<${s}) {return ${l};}
`).join("")}
    }`,d=e=>f(e),p=(e,s)=>{const l=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${s}]) {`];for(let g=0;g<e;++g)g===0?l.push(`	if (textureIndex == ${g}) { return _X${g}(indices); }`):g===e-1?l.push(`	else { return _X${g}(indices); }`):l.push(`	else if (textureIndex == ${g}) { return _X${g}(indices); }`);return l.push("	}"),l.join(`
`)},c=e=>{const s=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let l=0;l<e.length;++l)l===0?s.push(`	if (index == ${l}) { return ${e[l]}; }`):l===e.length-1?s.push(`	else { return ${e[l]}; }`):s.push(`	else if (index == ${l}) { return ${e[l]}; }`);return s.push("	}"),s.join(`
`)};t.parseConcatAttributes=e=>(0,r.createAttributeWithCacheKey)({axis:e.attributes.getInt("axis")});const o=e=>{if(!e||e.length<1)throw new Error("too few inputs");const s=e[0].type,l=e[0].dims.length;if(s==="string")throw new Error("string tensor is not supported yet");for(const g of e){if(g.type!==s)throw new Error("input tensors should be one type");if(g.dims.length!==l)throw new Error("input tensors should have the same shape")}}},7825:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createUnpackedGroupedConvProgramInfoLoader=void 0;const r=n(1315),a=n(6757),u=n(5639),h=n(9754),f=n(2150);t.createUnpackedGroupedConvProgramInfoLoader=(d,p,c)=>{const o=(e=p.length>2,s=c.cacheKey,{name:"GroupedConv",inputNames:e?["X","W","Bias"]:["X","W"],inputTypes:e?[u.TextureType.unpacked,u.TextureType.unpacked,u.TextureType.unpacked]:[u.TextureType.unpacked,u.TextureType.unpacked],cacheHint:s});var e,s;return Object.assign(Object.assign({},o),{get:()=>((l,g,y,b)=>{const _=g.length>2?"value += getBias(output_channel);":"",v=g[0].dims.slice(),T=g[1].dims.slice(),w=T[0]/b.group;r.Logger.verbose("GroupedConv",`autpPad:${b.autoPad}, dilations:${b.dilations}, group:${b.group}, kernelShape:${b.kernelShape}, pads:${b.pads}, strides:${b.strides}`);const A=(0,h.calculateOutputShape)(v,T,b.dilations,b.pads,b.strides),S=(0,a.getGlsl)(l.session.backend.glContext.version),{activationFunction:O,applyActivation:C}=(0,f.getActivationSnippet)(b),D=`
  const ivec2 strides = ivec2(${b.strides[0]}, ${b.strides[1]});
  const ivec2 pads = ivec2(${b.pads[0]}, ${b.pads[1]});
  ${O}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;
    ivec2 xRCCorner = coords.zw * strides - pads;
    int group_id = output_channel / ${w};

    float value = 0.0;
    for (int wInChannel = 0; wInChannel < ${T[1]}; wInChannel++) {
      int input_channel = group_id * ${T[1]} + wInChannel;
      for (int wHeight = 0; wHeight < ${T[2]}; wHeight++) {
        int xHeight = xRCCorner.x + wHeight * ${b.dilations[0]};

        if (xHeight < 0 || xHeight >= ${v[2]}) {
          continue;
        }

        for (int wWidth = 0; wWidth < ${T[3]}; wWidth++) {
          int xWidth = xRCCorner.y + wWidth * ${b.dilations[1]};
          if (xWidth < 0 || xWidth >= ${v[3]}) {
            continue;
          }

          float xVal = getX(batch, input_channel, xWidth, xHeight);
          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);
          value += xVal*wVal;
        }
      }
    }
    ${_}
    ${C}
    ${S.output} = vec4(value, .0, .0, .0);
  }
`;return Object.assign(Object.assign({},y),{output:{dims:A,type:g[0].type,textureType:u.TextureType.unpacked},shaderSource:D,hasMain:!0})})(d,p,o,c)})}},7708:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.conv2DPacked=t.conv2DPackedPointwise=void 0;const r=n(9754),a=n(5950),u=n(5632);t.conv2DPackedPointwise=(h,f,d)=>{const p=f[0].dims,c=f[1].dims,o=(0,r.calculateOutputShape)(p,c,d.dilations,d.pads,d.strides),e=h.reshapePacked(f[0],[p[1],p[2]*p[3]]),s=h.reshapePacked(f[1],[c[0],c[1]]),l=f.length>2?[s,e,f[2]]:[s,e],g=h.run((0,u.createPackedMatmulProgramInfoLoader)(h,l,d),l);return h.reshapePacked(g,o)},t.conv2DPacked=(h,f,d)=>{const p=f[0].dims,c=f[1].dims,o=(0,r.calculateOutputShape)(p,c,d.dilations,d.pads,d.strides),e=h.run((0,a.createPackedIm2ColProgramInfoLoader)(h,f[0],f[1],o,d),[f[0]]),s=h.reshapePacked(f[1],[c[0],c[1]*c[2]*c[3]]),l=f.length===3?[s,e,f[2]]:[s,e],g=h.run((0,u.createPackedMatmulProgramInfoLoader)(h,l,d),l);return h.reshapePacked(g,o)}},5042:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseConvTransposeAttributes=t.convTranspose=void 0;const r=n(4910),a=n(6757),u=n(5639),h=n(2150),f=(s,l,g,y,b,_)=>(s-1)*l+g+(y-1)*b+1-_,d=(s,l,g,y,b)=>{const _=Math.floor(s/2);l==="SAME_UPPER"?(g[y]=_,g[b]=s-_):l==="SAME_LOWER"&&(g[y]=s-_,g[b]=_)};t.convTranspose=(s,l,g)=>(e(l,g),p(s,l,g));const p=(s,l,g)=>{const y=o(g,l);return[c(s,l,y)]},c=(s,l,g)=>s.run(((y,b,_)=>{const v=(T=b.length>2,w=_.cacheKey,{name:"ConvTranspose",inputNames:T?["X","W","B"]:["X","W"],inputTypes:T?[u.TextureType.unpacked,u.TextureType.unpacked,u.TextureType.unpacked]:[u.TextureType.unpacked,u.TextureType.unpacked],cacheHint:w});var T,w;return Object.assign(Object.assign({},v),{get:()=>((A,S,O,C)=>{const D=S.length>2?"getB(output_channel)":"0.0",$=S[0].dims,L=S[1].dims,P=L[1],B=L[0]/C.group,I=[S[0].dims[0],S[1].dims[1]*C.group,...C.outputShape],M=(0,a.getGlsl)(A.session.backend.glContext.version),{activationFunction:k,applyActivation:X}=(0,h.getActivationSnippet)(C),G=`
  const ivec2 strides = ivec2(${C.strides[0]}, ${C.strides[1]});
  const ivec2 pads = ivec2(${C.pads[0]}, ${C.pads[1]});
  ${k}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;

    ivec2 loc = coords.zw + pads;

    int group_id = output_channel / ${P};
    int wOutChannel = output_channel - group_id * ${P};

    float value = ${D};
    for (int inChannelOffset = 0; inChannelOffset < ${B}; inChannelOffset++) {
      int input_channel = group_id * ${B} + inChannelOffset;
      for (int wWOff = 0; wWOff < ${L[2]}; wWOff++) {
        for (int wHOff = 0; wHOff < ${L[3]}; wHOff++) {
          ivec2 wOff = ivec2(wWOff * ${C.dilations[0]}, wHOff * ${C.dilations[1]});
          ivec2 wLoc = loc - wOff;
          ivec2 wLocIn = wLoc / strides;
          if (
            wLocIn * strides == wLoc &&
            wLocIn.x >= 0 && wLocIn.x < ${$[2]} &&
            wLocIn.y >= 0 && wLocIn.y < ${$[3]}
          ) {
            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);
            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);
            value += xVal * wVal;
          }
        }
      }
    }
    ${X}
    ${M.output} = vec4(value, .0, .0, .0);
  }
`;return Object.assign(Object.assign({},O),{output:{dims:I,type:S[0].type,textureType:u.TextureType.unpacked},shaderSource:G,hasMain:!0})})(y,b,v,_)})})(s,l,g),l),o=(s,l)=>{const g=s.kernelShape.slice();if(s.kernelShape.length===0)for(let v=2;v<l[1].dims.length;++v)g.push(l[1].dims[v]);const y=s.pads.slice(),b=s.outputShape.slice();((v,T,w,A,S,O,C,D)=>{const $=v.length-2,L=D.length===0;for(let P=0;P<$;++P){const B=L?v[P+2]*O[P]:D[P],I=f(v[P+2],O[P],S[P],T[P],w[P],B);d(I,A,S,P,P+$),L&&D.push(O[P]*(v[P+2]-1)+C[P]+(T[P]-1)*w[P]+1-S[P]-S[P+$])}})(l[0].dims,g,s.dilations,s.autoPad,y,s.strides,s.outputPadding,b);const _=Object.assign({},s);return Object.assign(_,{kernelShape:g,pads:y,outputShape:b,cacheKey:s.cacheKey}),_};t.parseConvTransposeAttributes=s=>{const l=s.attributes,g=(0,h.parseInternalActivationAttributes)(l),y=l.getString("auto_pad","NOTSET"),b=l.getInts("dilations",[1,1]),_=l.getInt("group",1),v=l.getInts("kernel_shape",[]),T=l.getInts("output_padding",[0,0]),w=l.getInts("output_shape",[]),A=l.getInts("pads",[0,0,0,0]),S=l.getInts("strides",[1,1]);return(0,r.createAttributeWithCacheKey)(Object.assign({autoPad:y,dilations:b,group:_,kernelShape:v,outputPadding:T,outputShape:w,pads:A,strides:S},g))};const e=(s,l)=>{if(!s||s.length!==2&&s.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(s[0].dims.length!==4||s[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");if(s[0].dims[1]!==s[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");const g=s[1].dims[1]*l.group;if(s.length===3&&(s[2].dims.length!==1||s[2].dims[0]!==g))throw new Error("invalid bias");const y=s[0].dims.length-2;if(l.dilations.length!==y)throw new Error(`dilations should be ${y}D`);if(l.strides.length!==y)throw new Error(`strides should be ${y}D`);if(l.pads.length!==2*y)throw new Error(`pads should be ${2*y}D`);if(l.outputPadding.length!==y)throw new Error(`output_padding should be ${y}D`);if(l.kernelShape.length!==0&&l.kernelShape.length!==s[1].dims.length-2)throw new Error("invalid kernel shape");if(l.outputShape.length!==0&&l.outputShape.length!==s[0].dims.length-2)throw new Error("invalid output shape");if(s[0].type!=="float32"||s[1].type!=="float32")throw new Error("ConvTranspose input(X,W) should be float tensor");if(s.length===3&&s[2].type!=="float32")throw new Error("ConvTranspose input(bias) should be float tensor")}},9754:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseConvAttributes=t.conv=t.calculateOutputShape=void 0;const r=n(4910),a=n(7273),u=n(7825),h=n(7708),f=n(3281),d=n(2150),p=n(1625),c=n(8276);t.calculateOutputShape=(y,b,_,v,T)=>{const w=y[0],A=y.slice(2),S=A.length,O=b[0],C=b.slice(2).map(($,L)=>$+($-1)*(_[L]-1)),D=A.map(($,L)=>$+v[L]+v[L+S]).map(($,L)=>Math.floor(($-C[L]+T[L])/T[L]));return[w,O].concat(...D)},t.conv=(y,b,_)=>(g(b,_),o(y,b,_));const o=(y,b,_)=>{const v=l(_,b),T=y.session.pack,w=v.kernelShape[0]===1&&v.kernelShape[1]===1;return v.group>1?[y.run((0,u.createUnpackedGroupedConvProgramInfoLoader)(y,b,v),b)]:w&&T?[e(y,b,v)]:T&&b[0].dims.length===4&&b[0].dims[0]===1&&!w?[(0,h.conv2DPacked)(y,b,v)]:[s(y,b,v)]},e=(y,b,_)=>{const v=b[0].dims,T=b[1].dims,w=(0,t.calculateOutputShape)(v,T,_.dilations,_.pads,_.strides),A=y.reshapeUnpacked(b[0],[v[1],v[2]*v[3]]),S=y.reshapeUnpacked(b[1],[T[0],T[1]]),O=b.length>2?[S,A,b[2]]:[S,A],C=y.run((0,c.createMatmulProgramInfoLoader)(O,_),O);return y.reshapeUnpacked(C,w)},s=(y,b,_)=>{const v=b[0].dims,T=b[1].dims,w=(0,t.calculateOutputShape)(v,T,_.dilations,_.pads,_.strides),A=y.run((0,p.createIm2ColProgramInfoLoader)(y,b[0],b[1],w,_),[b[0]]),S=b.length===3?[A,b[1],b[2]]:[A,b[1]];return y.run((0,f.createDotProductProgramInfoLoader)(y,b,w,_),S)},l=(y,b)=>{const _=y.kernelShape.slice();if(y.kernelShape.length===0)for(let w=2;w<b[1].dims.length;++w)_.push(b[1].dims[w]);const v=y.pads.slice();a.PoolConvUtil.adjustPadsBasedOnAutoPad(b[0].dims,y.strides,y.dilations,_,v,y.autoPad);const T=Object.assign({},y);return Object.assign(T,{kernelShape:_,pads:v,cacheKey:y.cacheKey}),T};t.parseConvAttributes=y=>{const b=y.attributes,_=(0,d.parseInternalActivationAttributes)(b),v=b.getString("auto_pad","NOTSET"),T=b.getInts("dilations",[1,1]),w=b.getInt("group",1),A=b.getInts("kernel_shape",[]),S=b.getInts("pads",[0,0,0,0]),O=b.getInts("strides",[1,1]);return(0,r.createAttributeWithCacheKey)(Object.assign({autoPad:v,dilations:T,group:w,kernelShape:A,pads:S,strides:O},_))};const g=(y,b)=>{if(!y||y.length!==2&&y.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(y[0].dims.length!==4||y[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");if(y[0].dims[1]!==y[1].dims[1]*b.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(y.length===3&&(y[2].dims.length!==1||y[1].dims[0]!==y[2].dims[0]))throw new Error("invalid bias");const _=y[0].dims.length-2;if(b.dilations.length!==_)throw new Error(`dilations should be ${_}D`);if(b.strides.length!==_)throw new Error(`strides should be ${_}D`);if(b.pads.length!==2*_)throw new Error(`pads should be ${2*_}D`);if(b.kernelShape.length!==0&&b.kernelShape.length!==y[1].dims.length-2)throw new Error("invalid kernel shape");if(y[0].type!=="float32"||y[1].type!=="float32")throw new Error("Conv input(X,W) should be float tensor");if(y.length===3&&y[2].type!=="float32")throw new Error("Conv input(bias) should be float tensor")}},6742:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseDepthToSpaceAttributes=t.depthToSpace=void 0;const r=n(5707);t.depthToSpace=(u,h,f)=>{a(h);const d=f.blocksize,p=d*d,c=f.mode==="DCR"?[0,3,4,1,5,2]:[0,1,4,2,5,3],o=f.mode==="DCR"?[h[0].dims[0],d,d,h[0].dims[1]/p,h[0].dims[2],h[0].dims[3]]:[h[0].dims[0],h[0].dims[1]/p,d,d,h[0].dims[2],h[0].dims[3]],e=u.reshapeUnpacked(h[0],o),s={perm:c,cacheKey:`${c}`},[l]=(0,r.transpose)(u,[e],s),g=[h[0].dims[0],h[0].dims[1]/p,h[0].dims[2]*d,h[0].dims[3]*d];return[u.reshapeUnpacked(l,g)]},t.parseDepthToSpaceAttributes=u=>{const h=u.attributes.getInt("blocksize");if(h<1)throw new Error(`blocksize must be >= 1, but got : ${h} for DepthToSpace`);const f=u.attributes.getString("mode","DCR");if(f!=="DCR"&&f!=="CRD")throw new Error(`unrecognized mode: ${f} for DepthToSpace`);return{mode:f,blocksize:h}};const a=u=>{if(u.length!==1)throw new Error(`DepthToSpace expect 1 inputs, but got ${u.length}`);if(u[0].type==="string"||u[0].dims.length!==4)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}},3281:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDotProductProgramInfoLoader=void 0;const r=n(7273),a=n(6757),u=n(5639),h=n(2150),f=n(1625);t.createDotProductProgramInfoLoader=(d,p,c,o)=>{const e=((s,l)=>({name:"ConvDotProduct",inputNames:s?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:s?[u.TextureType.unpacked,u.TextureType.packedLastDimension,u.TextureType.unpacked]:[u.TextureType.unpacked,u.TextureType.packedLastDimension],cacheKey:l.activationCacheKey}))(p.length>2,o);return Object.assign(Object.assign({},e),{get:()=>((s,l,g,y,b)=>{const _=g[0].dims,v=g[1].dims,T=[v[0],Math.ceil(_[1]*v[2]*v[3]/4)],w=(0,f.calculateIm2ColDims)(_,v,y),[A,S]=s.calculateTextureWidthAndHeight(T,u.TextureType.packedLastDimension),O=r.ShapeUtil.computeStrides(w),[C,D]=s.calculateTextureWidthAndHeight(w,u.TextureType.packedLastDimension),$=y.length,L=g.length<3?"0.0":"_B(b)",P=Math.ceil(_[1]*v[2]*v[3]/4),{activationFunction:B,applyActivation:I}=(0,h.getActivationSnippet)(b),M=(0,a.getGlsl)(s.session.backend.glContext.version),k=`
${B}
float process(int indices[${$}]) {
  int b[1];
  b[0] = indices[1];
  int im2col[4];
  im2col[0] = indices[0];
  im2col[1] = indices[2];
  im2col[2] = indices[3];
  int im2colOffset = im2col[0] * ${O[0]} + im2col[1] * ${O[1]} + im2col[2] * ${O[2]};
  int kernelOffset = indices[1] * ${T[1]};
  float value = ${L};
  for (int i = 0; i < ${P}; ++i) {
    vec2 im2colCoords = offsetToCoords(im2colOffset, ${C}, ${D});
    vec2 kernelCoords = offsetToCoords(kernelOffset, ${A}, ${S});
    value += dot(${M.texture2D}(Im2Col, im2colCoords), ${M.texture2D}(K, kernelCoords));
    ++im2colOffset;
    ++kernelOffset;
  }
  ${I}
  return value;
}`;return Object.assign(Object.assign({},l),{output:{dims:y,type:g[0].type,textureType:u.TextureType.unpacked},shaderSource:k})})(d,e,p,c,o)})}},4125:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseFlattenAttributes=t.flatten=void 0;const r=n(7273);t.flatten=(u,h,f)=>{a(h,f);const d=r.ShapeUtil.flattenShape(h[0].dims,f);return[u.reshapeUnpacked(h[0],d)]},t.parseFlattenAttributes=u=>u.attributes.getInt("axis",1);const a=(u,h)=>{if(!u||u.length!==1)throw new Error("Flatten requires 1 input.");const f=u[0].dims.length;if(f===0)throw new Error("scalar tensor is not supported.");if(h<-f||h>f)throw new Error("Invalid axis");if(u[0].type==="string")throw new Error("string tensor is not supported.")}},2150:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseInternalActivationAttributes=t.getActivationSnippet=void 0;const r=n(7273),a=n(9087);t.getActivationSnippet=function(u){let h;switch(u.activation){case"Relu":h=(0,a.glslRelu)();break;case"Sigmoid":h=(0,a.glslSigmoid)();break;case"Clip":h=(0,a.glslClip)(u.clipMin,u.clipMax);break;default:return{activationFunction:"",applyActivation:""}}const f=h.name;return{activationFunction:h.body,applyActivation:`value = ${f}_(value);`}},t.parseInternalActivationAttributes=u=>{const h=u.getString("activation","");if(h==="Clip"){const[f,d]=u.getFloats("activation_params",[r.MIN_CLIP,r.MAX_CLIP]);return{activation:h,clipMax:d,clipMin:f,activationCacheKey:`${h}:${f},${d}`}}return{activation:h,activationCacheKey:h}}},6149:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseGatherAttributes=t.gather=void 0;const r=n(4910),a=n(6145),u=n(7273),h=n(5639);t.gather=(c,o,e)=>(p(o,e.axis),[c.run(d(c,o,e),o)]),t.parseGatherAttributes=c=>(0,r.createAttributeWithCacheKey)({axis:c.attributes.getInt("axis",0)});const f={name:"Gather",inputNames:["A","B"],inputTypes:[h.TextureType.unpacked,h.TextureType.unpacked]},d=(c,o,e)=>{const s=Object.assign(Object.assign({},f),{cacheHint:e.cacheKey});return Object.assign(Object.assign({},s),{get:()=>((l,g,y,b)=>{const _=y[0].dims.slice(),v=y[1].dims.slice(),T=new Array(_.length+v.length-1);b=u.ShapeUtil.normalizeAxis(b,_.length);const w=[];for(let S=0;S<T.length;S++)S<b?(T[S]=_[S],w.push(`inputIdx[${S}] = outputIdx[${S}];`)):S<b+v.length?(T[S]=v[S-b],w.push(`indexDataIdx[${S-b}] = outputIdx[${S}];`)):(T[S]=_[S-v.length+1],w.push(`inputIdx[${S-v.length+1}] = outputIdx[${S}];`));const A=`
      float process(int outputIdx[${T.length||1}]) {
        int inputIdx[${_.length}];
        int indexDataIdx[${v.length||1}];
        indexDataIdx[0] = 0;
        ${w.join(`
        `)}
        int idx = int(_B(indexDataIdx));
        inputIdx[${b}] = idx < 0 ? idx + ${_[b]} : idx;
        return _A(inputIdx);
      }`;return Object.assign(Object.assign({},g),{output:{dims:T,type:y[0].type,textureType:h.TextureType.unpacked},shaderSource:A})})(0,s,o,e.axis)})},p=(c,o)=>{if(!c||c.length!==2)throw new Error("Gather requires 2 inputs.");const e=c[0].dims.length;if(e<1)throw new Error("Invalid input shape.");if(o<-e||o>e-1)throw new Error("Invalid axis.");if(a.NUMBER_TYPES.indexOf(c[0].type)===-1)throw new Error("Invaid input type.");if(c[1].type!=="int32"&&c[1].type!=="int16")throw new Error("Invaid input type.")}},5378:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseGemmAttributesV11=t.parseGemmAttributesV7=t.gemm=void 0;const r=n(4910),a=n(7273),u=n(5639);t.gemm=(c,o,e)=>(p(o,e),[c.run(f(o,e),o)]);const h=(c,o)=>{const e=c.attributes.getInt("transA",0)!==0,s=c.attributes.getInt("transB",0)!==0,l=c.attributes.getFloat("alpha",1),g=c.attributes.getFloat("beta",1);return(0,r.createAttributeWithCacheKey)({transA:e,transB:s,alpha:l,beta:g,isOptionalC:o})};t.parseGemmAttributesV7=c=>h(c,!1),t.parseGemmAttributesV11=c=>h(c,!0);const f=(c,o)=>{const e={name:"Gemm",inputNames:c.length===3?["A","B","C"]:["A","B"],inputTypes:c.length===3?[u.TextureType.unpacked,u.TextureType.unpacked,u.TextureType.unpacked]:[u.TextureType.unpacked,u.TextureType.unpacked],key:o.cacheKey};return Object.assign(Object.assign({},e),{get:()=>d(e,c,o)})},d=(c,o,e)=>{const s=o[0].dims.slice(),l=o[1].dims.slice(),[g,y]=a.GemmUtil.getShapeOfGemmResult(s,e.transA,l,e.transB,o.length===3?o[2].dims:void 0),b=[g,y];if(!b)throw new Error("Can't use gemm on the given tensors");let _=s[s.length-1],v="";e.transA&&(_=s[0]),e.transA&&e.transB?v="value += _A_T(a) * _B_T(b);":e.transA&&!e.transB?v="value += _A_T(a) * _B(b);":!e.transA&&e.transB?v="value += _A(a) * _B_T(b);":e.transA||e.transB||(v="value += _A(a) * _B(b);");const T=b.length,w=`
      float process(int indices[${T}]) {
          int a[${T}];
          int b[${T}];
          ${o.length===3?`int c[${o[2].dims.length}];`:""}

          copyVec(indices, a);
          copyVec(indices, b);
          ${o.length===3?"bcastIndices_C(indices, c);":""}

          float value = 0.0;
          for (int k=0; k<${_}; ++k) {
              a[${T-1}] = k;
              b[${T-2}] = k;
              ${v}
          }

          value = value * alpha;
          ${o.length===3?"value += beta * _C(c);":""}
          return value;
      }`;return Object.assign(Object.assign({},c),{output:{dims:b,type:o[0].type,textureType:u.TextureType.unpacked},variables:[{name:"alpha",type:"float",data:e.alpha},{name:"beta",type:"float",data:e.beta}],shaderSource:w})},p=(c,o)=>{if(!c)throw new Error("Input is missing");if(o.isOptionalC&&(c.length<2||c.length>3))throw new Error("Invaid input shape.");if(!o.isOptionalC&&c.length!==3)throw new Error("Gemm requires 3 inputs");if(c.length===3&&c[2].dims.length!==1&&c[2].dims.length!==2)throw new Error("Invalid input shape of C");if(c[0].type!=="float32"&&c[0].type!=="float64"||c[1].type!=="float32"&&c[1].type!=="float64"||c.length===3&&c[2].type!=="float32"&&c[2].type!=="float64")throw new Error("Invalid input type.");if(c[0].type!==c[1].type||c.length===3&&c[0].type!==c[2].type)throw new Error("Input types are mismatched")}},5950:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPackedIm2ColProgramInfoLoader=void 0;const r=n(6757),a=n(5639),u=n(5614);t.createPackedIm2ColProgramInfoLoader=(h,f,d,p,c)=>{const o=(e=c.cacheKey,{name:"Im2Col (packed)",inputNames:["A"],inputTypes:[a.TextureType.packed],cacheHint:e});var e;return Object.assign(Object.assign({},o),{get:()=>((s,l,g,y,b,_)=>{const v=g.dims,T=y.dims,w=b.length,A=[T[1]*T[2]*T[3],b[2]*b[3]],S=T[2]*T[3],O=(0,u.unpackFromChannel)(),C=(0,r.getGlsl)(s.session.backend.glContext.version);let D="";for(let L=0;L<=1;L++)for(let P=0;P<=1;P++)D+=`
            blockIndex = rc.x + ${P};
            pos = rc.y + ${L};

            if(blockIndex < ${A[1]} && pos < ${A[0]}) {
              offsetY = int(blockIndex / (${b[w-1]})) * ${_.strides[0]} -
                ${_.pads[0]};
              d0 = offsetY + ${_.dilations[0]} * (imod(pos, ${S}) / ${T[2]});

              if(d0 < ${v[2]} && d0 >= 0) {
                offsetX = imod(blockIndex, ${b[w-1]}) * ${_.strides[1]} -
                  ${_.pads[1]};
                d1 = offsetX + ${_.dilations[1]} * imod(imod(pos, ${S}), ${T[2]});

                if(d1 < ${v[3]} && d1 >= 0) {

                  ch = int(float(pos)/ ${S}.);
                    innerDims = vec2(d0, d1);
                    result[${2*L+P}] = getChannel(
                      getA(0, ch, int(innerDims.x),
                      int(innerDims.y)), innerDims);
                }
              }
            }

          `;const $=`
      ${O}

      void main() {
        ivec2 rc = getOutputCoords();
          vec4 result = vec4(0.0);
          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
          vec2 innerDims;
          ${D}
          ${C.output} = result;
      }
            `;return Object.assign(Object.assign({},l),{output:{dims:A,type:g.type,textureType:a.TextureType.packed},shaderSource:$,hasMain:!0})})(h,o,f,d,p,c)})}},1625:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calculateIm2ColDims=t.createIm2ColProgramInfoLoader=void 0;const r=n(5639);t.createIm2ColProgramInfoLoader=(a,u,h,f,d)=>{const p=(c=d.cacheKey,{name:"Im2Col",inputNames:["X"],inputTypes:[r.TextureType.unpacked],cacheHint:c});var c;return Object.assign(Object.assign({},p),{get:()=>((o,e,s,l,g,y)=>{const b=s.dims,_=l.dims,v=g.length,T=(0,t.calculateIm2ColDims)(b,_,g,4),w=`
        const int XC = ${b[1]};
        const int XH = ${b[2]};
        const int XW = ${b[3]};
        const int KH = ${y.kernelShape[0]};
        const int KW = ${y.kernelShape[1]};
        const int dilationH = ${y.dilations[0]};
        const int dilationW = ${y.dilations[1]};
        const int strideH = ${y.strides[0]};
        const int strideW = ${y.strides[1]};
        const int padH = ${y.pads[0]};
        const int padW = ${y.pads[1]};
        const int KHKW = KH*KW;
        const int XCKHKW = XC * KHKW;
        const int outputChannels = 4;
        vec4 process(int indices[${v}]) {
          int b  = indices[0]; // batch size
          int oh = indices[1] * strideH - padH; //output height
          int ow = indices[2] * strideW - padW; //output width
          int p = indices[3] * outputChannels; //patch
          vec4 value = vec4(0.0);
          for(int i=0; i < outputChannels; ++i) {
            if(p < XCKHKW) {
              int patchC = p / KHKW;
              int patchH = (p - patchC*KHKW) / KW;
              int patchW = (p - patchC*KHKW) - patchH * KW;
              int xh2 = oh + patchH * dilationH;
              int xw2 = ow + patchW * dilationW;
              int x[${b.length}];
              x[0] = b;
              x[1] = patchC;
              x[2] = xh2;
              x[3] = xw2;
              if(xh2 >= 0 &&
                  xh2 < XH &&
                  xw2 >= 0 &&
                  xw2 < XW) {
                value[i] = _X(x);
              }
            }
            ++p;
          }
          return value;
        }
        `;return Object.assign(Object.assign({},e),{output:{dims:T,type:s.type,textureType:r.TextureType.packedLastDimension},shaderSource:w})})(0,p,u,h,f,d)})},t.calculateIm2ColDims=(a,u,h,f=4)=>[h[0],h[2],h[3],Math.ceil(a[1]*u[2]*u[3]/f)]},6981:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseImageScalerAttributes=t.imageScaler=void 0;const r=n(4910),a=n(5639);t.imageScaler=(p,c,o)=>(d(c),[p.run(h(p,c,o),c)]),t.parseImageScalerAttributes=p=>{const c=p.attributes.getFloat("scale"),o=p.attributes.getFloats("bias");return(0,r.createAttributeWithCacheKey)({scale:c,bias:o})};const u={name:"ImageScaler",inputNames:["X"],inputTypes:[a.TextureType.unpacked]},h=(p,c,o)=>{const e=Object.assign(Object.assign({},u),{cacheHint:o.cacheKey});return Object.assign(Object.assign({},e),{get:()=>((s,l,g,y)=>{const b=g[0].dims.slice(),_=b.length,v=`
      ${f(y.bias.length)}
      float process(int indices[${_}]) {
        return _X(indices) * scale + getBias(bias, indices[1]);
      }`;return Object.assign(Object.assign({},l),{output:{dims:b,type:g[0].type,textureType:a.TextureType.unpacked},variables:[{name:"bias",type:"float",arrayLength:y.bias.length,data:y.bias},{name:"scale",type:"float",data:y.scale}],shaderSource:v})})(0,e,c,o)})},f=p=>{const c=[`float getBias(float bias[${p}], int channel) {`];for(let o=0;o<p;++o)o===0?c.push(`	if (channel == ${o}) { return bias[${o}]; }`):o===p-1?c.push(`	else { return bias[${o}]; }`):c.push(`	else if (channel == ${o}) { return bias[${o}]; }`);return c.push("	}"),c.join(`
`)},d=p=>{if(!p||p.length!==1)throw new Error("ImageScaler requires 1 input.");if(p[0].dims.length!==4)throw new Error("Invalid input shape.");if(p[0].type!=="float32"&&p[0].type!=="float64")throw new Error("Invalid input type.")}},7413:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseInstanceNormalizationAttributes=t.instanceNormalization=void 0;const r=n(6757),a=n(5639);t.instanceNormalization=(c,o,e)=>{p(o);const s=c.run(h(o[0]),o);return[c.run(d(c,o[0],e,s.dims),[o[0],s,o[1],o[2]])]},t.parseInstanceNormalizationAttributes=c=>c.attributes.getFloat("epsilon",1e-5);const u={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[a.TextureType.unpacked]},h=c=>Object.assign(Object.assign({},u),{get:()=>((o,e)=>{const s=e.dims.slice(),l=s[1],g=s[2]*s[3],y=[s[0],l],b=`
      vec4 process(int[2] indices) {
        vec4 v = vec4(0.0);
        int a[4];
        a[0] = indices[0];
        a[1] = indices[1];
        float temp = 0.0;
        for(int a2=0; a2<${s[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${s[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += x;
          }
        }
        float mean = temp / float(${g});
        temp = 0.0;
        for(int a2=0; a2<${s[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${s[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += (x - mean) * (x - mean);
          }
        }
        v.r = mean;
        v.g = temp / float(${g});

        return v;
      }`;return Object.assign(Object.assign({},o),{output:{dims:y,type:e.type,textureType:a.TextureType.packedLastDimension},shaderSource:b})})(u,c)}),f={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[a.TextureType.unpacked,a.TextureType.packedLastDimension,a.TextureType.unpacked,a.TextureType.unpacked]},d=(c,o,e,s)=>{const l=Object.assign(Object.assign({},f),{cacheHint:`${e}`});return Object.assign(Object.assign({},l),{get:()=>((g,y,b,_,v)=>{const T=(0,r.getGlsl)(g.session.backend.glContext.version),[w,A]=g.calculateTextureWidthAndHeight(v,a.TextureType.packedLastDimension),[S,O]=[w/4,A],C=`
      vec4 get_MeanAndVariance(int[2] mv) {
        int offset = indicesToOffset_MeanAndVariance(mv);
        vec2 coords = offsetToCoords(offset, ${S}, ${O});
        return ${T.texture2D}(MeanAndVariance, coords);
      }

      float process(int[4] indices) {
        int mv[2];
        mv[0] = indices[0];
        mv[1] = indices[1];
        vec4 mean_and_variance = get_MeanAndVariance(mv);
        float mean = mean_and_variance.r;
        float variance = mean_and_variance.g;

        int sb[1];
        sb[0] = indices[1];
        float scale = _Scale(sb);
        float b = _B(sb);

        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;
      }`;return Object.assign(Object.assign({},y),{output:{dims:b.dims,type:b.type,textureType:a.TextureType.unpacked},variables:[{name:"epsilon",type:"float",data:_}],shaderSource:C})})(c,l,o,e,s)})},p=c=>{if(!c||c.length!==3)throw new Error("InstanceNormalization requires 3 inputs.");const o=c[0],e=c[1],s=c[2];if(o.dims.length<3||e.dims.length!==1||s.dims.length!==1)throw new Error("Invalid input shape.");if(e.dims[0]!==o.dims[1]||s.dims[0]!==o.dims[1])throw new Error("Input shapes are mismatched.");if(o.type!=="float32"&&o.type!=="float64"||e.type!=="float32"&&e.type!=="float64"||s.type!=="float32"&&s.type!=="float64")throw new Error("Invalid input type.");if(c[0].dims.length!==4)throw new Error("Only support 4-D input shape.")}},7006:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLrnProgramInfoLoader=t.parseLrnAttributes=t.lrn=void 0;const r=n(4910),a=n(5639);t.lrn=(d,p,c)=>(f(p),[d.run(h(p,c),p)]),t.parseLrnAttributes=d=>{const p=d.attributes.getFloat("alpha",1e-4),c=d.attributes.getFloat("beta",.75),o=d.attributes.getFloat("bias",1),e=d.attributes.getInt("size");return(0,r.createAttributeWithCacheKey)({alpha:p,beta:c,bias:o,size:e})};const u={name:"LRN",inputNames:["X"],inputTypes:[a.TextureType.unpacked]};function h(d,p){return Object.assign(Object.assign({},u),{cacheHint:p.cacheKey,get:()=>function(c,o){const e=c[0].dims[1],s=c[0].dims.length,l=-Math.floor((o.size-1)/2),g=Math.ceil((o.size-1)/2),y=`float(${o.alpha}) / float(${o.size})`,b=`
    float process(int indices[${s}]) {
        int c = indices[1];
        float x = _X(indices);
        float square_sum = 0.0;

        for (int i = ${l}; i <= ${g}; i++) {
          int idx = c + i;
          if (c >= 0 && c < ${e}) {
            indices[1] = idx;
            float j = _X(indices);
            square_sum += j * j;
          }
        }
        return x / pow(float(${o.bias}) + ${y} * square_sum, float(${o.beta}));
    }`;return Object.assign(Object.assign({},u),{cacheHint:o.cacheKey,output:{dims:c[0].dims,type:c[0].type,textureType:a.TextureType.unpacked},shaderSource:b})}(d,p)})}t.createLrnProgramInfoLoader=h;const f=d=>{if(!d||d.length!==1)throw new Error("LRN requires 1 input.");if(d[0].dims.length!==4)throw new Error('currently only support LRN for input with "NCHW" format');if(d[0].type!=="float32")throw new Error("input should be float type")}},5632:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPackedMatmulProgramInfoLoader=void 0;const r=n(7273),a=n(6757),u=n(5639),h=n(432),f=n(2150),d=n(8276);t.createPackedMatmulProgramInfoLoader=(p,c,o)=>{const e=(s=c.length>2,l=o.activationCacheKey,{name:"MatMul (packed)",inputNames:s?["A","B","Bias"]:["A","B"],inputTypes:s?[u.TextureType.packed,u.TextureType.packed,u.TextureType.packed]:[u.TextureType.packed,u.TextureType.packed],cacheHint:l});var s,l;return Object.assign(Object.assign({},e),{get:()=>((g,y,b,_)=>{const v=b.length>2,T=v?"value += getBiasForMatmul();":"",w=b[0].dims,A=b[1].dims,S=r.BroadcastUtil.calcShape(w,A,!0),O=!r.ShapeUtil.areEqual(b[0].dims,b[1].dims);if(!S)throw new Error("Can't use matmul on the given tensors");const C=w[w.length-1],D=Math.ceil(C/2),$=w.length,L=A.length,P=(0,a.getGlsl)(g.session.backend.glContext.version),B=(0,h.getCoordsDataType)(S.length),I=S.length,M=(0,h.getGlChannels)(),{activationFunction:k,applyActivation:X}=(0,f.getActivationSnippet)(_),G=v?`${(0,d.getBiasForMatmul)(B,M,b[2].dims,S,!0)}`:"",J=O?`${function(nt,ot,lt,ut){let gt=[],xt=[];const pt=lt[0].dims,vt=lt[1].dims,Ct=pt.length,ft=vt.length,Tt=ut.length,Pt=Tt-Ct,It=Tt-ft;gt=pt.map((Ot,Nt)=>`coords.${ot[Nt+Pt]}`),gt[Ct-1]="i*2",gt.join(", "),xt=vt.map((Ot,Nt)=>`coords.${ot[Nt+It]}`),xt[ft-2]="i*2",xt.join(", ");const Mt=r.BroadcastUtil.getBroadcastDims(pt,ut),Ft=r.BroadcastUtil.getBroadcastDims(vt,ut),Dt=Mt.map(Ot=>`coords.${ot[Ot+Pt]} = 0;`).join(`
`),Ut=Ft.map(Ot=>`coords.${ot[Ot+It]} = 0;`).join(`
`),Lt=`int lastDim = coords.${ot[Tt-1]};
  coords.${ot[Tt-1]} = coords.${ot[Tt-2]};
  coords.${ot[Tt-2]} = lastDim;`;return`
vec4 getAAtOutCoordsMatmul(int i) {
  ${nt} coords = getOutputCoords();
  ${Lt}
  ${Dt}
  vec4 outputValue = getA(${gt});
  return outputValue;
}

vec4 getBAtOutCoordsMatmul(int i) {
  ${nt} coords = getOutputCoords();
  ${Lt}
  ${Ut}
  vec4 outputValue = getB(${xt});
  return outputValue;
}`}(B,M,b,S)}`:"",Y=O?"getAAtOutCoordsMatmul(i)":`getA(${function(nt,ot){let lt="";for(let ut=0;ut<ot-2;ut++)lt+=`rc.${nt[ut]}, `;return lt+=`rc.${nt[ot-2]}, i*2`,lt}(M,$)})`,Q=O?"getBAtOutCoordsMatmul(i)":`getB(${function(nt,ot){let lt="";for(let ut=0;ut<ot-2;ut++)lt+=`rc.${nt[ut]}, `;return lt+=`i*2, rc.${nt[ot-1]}`,lt}(M,L)})`,tt=`
            ${J}
            ${G}
            ${k}
            void main() {
              ${O?"":`${B} rc =
          getOutputCoords(); int lastDim = rc.${M[I-1]}; rc.${M[I-1]} =
          rc.${M[I-2]}; rc.${M[I-2]} = lastDim;
      `}

              vec4 value = vec4(0);
              for (int i = 0; i < ${D}; i++) {
                vec4 a = ${Y};
                vec4 b = ${Q};

                value += (a.rrbb * b.rgrg);
                value += (a.ggaa * b.baba);
              }
              ${T}
              ${X}
              ${P.output} = value;
            }`;return Object.assign(Object.assign({},y),{output:{dims:S,type:b[0].type,textureType:u.TextureType.packed},shaderSource:tt,hasMain:!0})})(p,e,c,o)})}},8276:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBiasForMatmul=t.createMatmulProgramInfoLoader=t.parseMatMulAttributes=t.matMul=void 0;const r=n(7273),a=n(5639),u=n(432),h=n(2150),f=n(5632);t.matMul=(e,s,l)=>(c(s),e.session.pack?[e.run((0,f.createPackedMatmulProgramInfoLoader)(e,s,l),s)]:[e.run(p(s,l),s)]),t.parseMatMulAttributes=e=>(0,h.parseInternalActivationAttributes)(e.attributes);const d=(e,s)=>({name:"MatMul",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[a.TextureType.unpacked,a.TextureType.unpacked,a.TextureType.unpacked]:[a.TextureType.unpacked,a.TextureType.unpacked],cacheHint:s});function p(e,s){const l=d(e.length>2,s.activationCacheKey);return Object.assign(Object.assign({},l),{get:()=>function(g,y,b){const _=y[0].dims,v=y[1].dims,T=r.BroadcastUtil.calcShape(_,v,!0);if(!T)throw new Error("Can't use matmul on the given tensors");const w=(0,u.getCoordsDataType)(T.length),A=(0,u.getGlChannels)(),{activationFunction:S,applyActivation:O}=(0,h.getActivationSnippet)(b),C=y.length>2,D=C?"value += getBiasForMatmul();":"",$=C?`${o(w,A,y[2].dims,T,!1)}`:"",L=T.length,P=_.length,B=v.length,I=`
    ${S}
    ${$}
    float process(int indices[${L}]) {
        int a[${P}];
        int b[${B}];
        bcastMatmulIndices_A(indices, a);
        bcastMatmulIndices_B(indices, b);

        float value;
        for (int k=0; k<${_[_.length-1]}; ++k) {
            a[${P-1}] = k;
            b[${B-2}] = k;
            value += _A(a) * _B(b);
        }
        ${D}
        ${O}
        return value;
    }`;return Object.assign(Object.assign({},g),{output:{dims:T,type:y[0].type,textureType:a.TextureType.unpacked},shaderSource:I})}(l,e,s)})}t.createMatmulProgramInfoLoader=p;const c=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.");if(e[0].type!=="float32"&&e[0].type!=="float64"||e[1].type!=="float32"&&e[1].type!=="float64")throw new Error("inputs should be float type");if(e[0].type!==e[1].type)throw new Error("inputs types should match")};function o(e,s,l,g,y){let b="";const _=l.length,v=g.length,T=v-_;b=v<2&&_>0?"coords":l.map((S,O)=>`coords.${s[O+T]}`).join(", ");const w=r.BroadcastUtil.getBroadcastDims(l,g).map(S=>`coords.${s[S+T]} = 0;`).join(`
`);let A="vec4(outputValue.xx, outputValue.yy)";return r.ShapeUtil.size(l)===1&&(A="vec4(outputValue.x)"),y?`
vec4 getBiasForMatmul() {
  ${e} coords = getOutputCoords();
  ${w}
  vec4 outputValue = getBias(${b});
  return ${A};
}`:`
float getBiasForMatmul() {
  ${e} coords = getOutputCoords();
  ${w}
  return getBias(coords.x);
}`}t.getBiasForMatmul=o},9:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPackProgramInfoLoader=void 0;const r=n(6757),a=n(5639),u=n(432),h=n(5614),f={name:"pack",inputNames:["A"],inputTypes:[a.TextureType.unpackedReversed]};t.createPackProgramInfoLoader=(d,p)=>Object.assign(Object.assign({},f),{get:()=>((c,o)=>{const e=(0,r.getGlsl)(c.session.backend.glContext.version),s=o.dims,l=s.length,g=o.dims.length,y=(0,u.getCoordsDataType)(g),b=(0,h.getChannels)("rc",g),_=(v=g,T=b,w=s[s.length-2],A=s[s.length-1],v===0||v===1?"":`
    int r = ${T[v-2]};
    int c = ${T[v-1]};
    int rp1 = ${T[v-2]} + 1;
    int cp1 = ${T[v-1]} + 1;
    bool rEdge = rp1 >= ${A};
    bool cEdge = cp1 >= ${w};
    `);var v,T,w,A;let S;S=l===0?[1,1]:l===1?[s[0],1]:[s[g-1],s[g-2]];const O=function($,L,P){if($===0)return"false";if($===1)return`rc > ${L[0]}`;let B="";for(let I=$-2;I<$;I++)B+=`${P[I]} >= ${L[I-$+2]}`,I<$-1&&(B+="||");return B}(g,S,b),C=function($,L){const P=$.length;if(P===0)return"getA(), 0, 0, 0";if(P===1)return`getA(rc),
            rc + 1 >= ${$[0]} ? 0. : getA(rc + 1),
            0, 0`;let B="";if(P>2)for(let I=0;I<P-2;++I)B+=`${L[I]},`;return`getA(${B}r, c),
          rEdge ? 0. : getA(${B}rp1, c),
          cEdge ? 0. : getA(${B}r, cp1),
          rEdge || cEdge ? 0. : getA(${B}rp1, cp1)`}(s,b),D=`
        void main() {
          ${y} rc = getOutputCoords();

          if(${O}) {
            ${e.output} = vec4(0);
          } else {
            ${_}

            ${e.output} = vec4(${C});
          }
        }
      `;return Object.assign(Object.assign({},f),{hasMain:!0,output:{dims:o.dims,type:o.type,textureType:a.TextureType.packed},shaderSource:D})})(d,p)})},5614:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unpackFromChannel=t.getChannels=t.getVecChannels=void 0;const r=n(432);function a(u,h){return(0,r.getGlChannels)(h).map(f=>`${u}.${f}`)}t.getVecChannels=a,t.getChannels=function(u,h){return h===1?[u]:a(u,h)},t.unpackFromChannel=function(){return`
    float getChannel(vec4 frag, int dim) {
      int modCoord = imod(dim, 2);
      return modCoord == 0 ? frag.r : frag.g;
    }

    float getChannel(vec4 frag, vec2 innerDims) {
      vec2 modCoord = mod(innerDims, 2.);
      return modCoord.x == 0. ?
        (modCoord.y == 0. ? frag.r : frag.g) :
        (modCoord.y == 0. ? frag.b : frag.a);
    }
  `}},5565:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parsePadAttributesV11=t.padV11=t.parsePadAttributesV2=t.padV2=void 0;const r=n(4910),a=n(7273),u=n(6757),h=n(5639),f={name:"Pad",inputNames:["A"],inputTypes:[h.TextureType.unpacked]};t.padV2=(y,b,_)=>(c(b),[y.run(Object.assign(Object.assign({},f),{cacheHint:_.cacheKey,get:()=>p(y,b[0],_)}),b)]),t.parsePadAttributesV2=y=>{const b=y.attributes.getString("mode","constant"),_=y.attributes.getFloat("value",0),v=y.attributes.getInts("pads");return(0,r.createAttributeWithCacheKey)({mode:b,value:_,pads:v})},t.padV11=(y,b,_)=>{o(b);const v=d(y,b,_);return(0,t.padV2)(y,[b[0]],v)},t.parsePadAttributesV11=y=>y.attributes.getString("mode","constant");const d=(y,b,_)=>{if(!y.session.isInitializer(b[1].dataId)||b.length>=3&&!y.session.isInitializer(b[2].dataId))throw new Error("dynamic pad attributes are not allowed");const v=Array.from(b[1].integerData),T=b.length>=3?b[2].floatData[0]:0;return(0,r.createAttributeWithCacheKey)({mode:_,pads:v,value:T})},p=(y,b,_)=>{const v=a.ShapeUtil.padShape(b.dims.slice(),_.pads),T=v.length,w=`
      ${e(y,b,_)}
      float process(int[${T}] indices) {
          return padA(indices);
      }`;return{name:"Pad",inputNames:["A"],inputTypes:[h.TextureType.unpacked],output:{dims:v,type:b.type,textureType:h.TextureType.unpacked},shaderSource:w}},c=y=>{if(!y||y.length!==1)throw new Error("Pad requires 1 input");if(y[0].type!=="float32"&&y[0].type!=="float64")throw new Error("Invalid input type.")},o=y=>{if(!y||y.length!==2&&y.length!==3)throw new Error("Pad requires 2 or 3 inputs");if(y[1].type!=="int32")throw new Error("Invalid input type.");if(y.length>=3&&y[2].type==="string")throw new Error("Invalid input type.")},e=(y,b,_)=>{const v=(0,u.getGlsl)(y.session.backend.glContext.version),[T,w]=y.calculateTextureWidthAndHeight(b.dims,h.TextureType.unpacked),A=a.ShapeUtil.computeStrides(b.dims);switch(_.mode){case"constant":return s(v,b.dims,A,T,w,_.pads,_.value);case"reflect":return l(v,b.dims,A,T,w,_.pads);case"edge":return g(v,b.dims,A,T,w,_.pads);default:throw new Error("Invalid mode")}},s=(y,b,_,v,T,w,A)=>{const S=b.length;let O="";for(let C=S-1;C>=0;--C)O+=`
        k = m[${C}] - ${w[C]};
        if (k < 0)  return constant;
        if (k >= ${b[C]}) return constant;
        offset += k * ${_[C]};
        `;return`
      float padA(int m[${S}]) {
        const float constant = float(${A});
        int offset = 0;
        int k = 0;
        ${O}
        vec2 coords = offsetToCoords(offset, ${v}, ${T});
        float value = getColorAsFloat(${y.texture2D}(A, coords));
        return value;
      }
      `},l=(y,b,_,v,T,w)=>{const A=b.length;let S="";for(let O=A-1;O>=0;--O)S+=`
        k = m[${O}] - ${w[O]};
        if (k < 0) { k = -k; }
        {
          const int _2n_1 = ${2*(b[O]-1)};
          k = int( mod( float(k), float(_2n_1) ) ) ;
          if(k >= ${b[O]}) { k = _2n_1 - k; }
        }
        offset += k * ${_[O]};
        `;return`
      float padA(int m[${A}]) {
        int offset = 0;
        int k = 0;
        ${S}
        vec2 coords = offsetToCoords(offset, ${v}, ${T});
        float value = getColorAsFloat(${y.texture2D}(A, coords));
        return value;
      }
      `},g=(y,b,_,v,T,w)=>{const A=b.length;let S="";for(let O=A-1;O>=0;--O)S+=`
        k = m[${O}] - ${w[O]};
        if (k < 0)  k = 0;
        if (k >= ${b[O]}) k = ${b[O]-1};
        offset += k * ${_[O]};
      `;return`
      float padA(int m[${A}]) {
        int offset = 0;
        int k = 0;
        ${S}
        vec2 coords = offsetToCoords(offset, ${v}, ${T});
        float value = getColorAsFloat(${y.texture2D}(A, coords));
        return value;
      }
      `}},2834:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalMaxPool=t.parseMaxPoolAttributes=t.maxPool=t.parseGlobalAveragePoolAttributes=t.globalAveragePool=t.parseAveragePoolAttributes=t.averagePool=void 0;const r=n(4910),a=n(7273),u=n(5639);t.averagePool=(g,y,b)=>{o(y);const _={name:"AveragePool",inputNames:["X"],inputTypes:[u.TextureType.unpacked],cacheHint:b.cacheKey};return[g.run(Object.assign(Object.assign({},_),{get:()=>h(y,_,!1,b)}),y)]},t.parseAveragePoolAttributes=g=>{const y=g.attributes.getString("auto_pad","NOTSET"),b=g.attributes.getInt("ceil_mode",0),_=g.attributes.getInt("count_include_pad",0)!==0,v=g.attributes.getInts("kernel_shape"),T=g.attributes.getInts("strides",[]),w=g.attributes.getInts("pads",[]);if(b!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return(0,r.createAttributeWithCacheKey)({autoPad:y,ceilMode:b,countIncludePad:_,kernelShape:v,strides:T,pads:w})};const h=(g,y,b,_)=>{const[v,T]=d(g,_,b),w=a.ShapeUtil.size(v.kernelShape);let A="";v.countIncludePad?A+=`value /= float(${w});`:A+=`value /= float(${w} - pad);`;const S=`
        ${e(g[0].dims,v,"value += _X(x);",A,"0.0")}
      `;return Object.assign(Object.assign({},y),{output:{dims:T,type:g[0].type,textureType:u.TextureType.unpacked},shaderSource:S})};t.globalAveragePool=(g,y,b)=>{o(y);const _={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[u.TextureType.unpacked],cacheHint:`${b.countIncludePad}`};return[g.run(Object.assign(Object.assign({},_),{get:()=>h(y,_,!0,b)}),y)]},t.parseGlobalAveragePoolAttributes=g=>{const y=g.attributes.getInt("count_include_pad",0)!==0;return(0,r.createAttributeWithCacheKey)({autoPad:"",ceilMode:0,countIncludePad:y,kernelShape:[],strides:[],pads:[]})},t.maxPool=(g,y,b)=>{o(y);const _={name:"MaxPool",inputNames:["X"],inputTypes:[u.TextureType.unpacked],cacheHint:b.cacheKey};return[g.run(Object.assign(Object.assign({},_),{get:()=>f(y,_,!1,b)}),y)]},t.parseMaxPoolAttributes=g=>{const y=g.attributes.getString("auto_pad","NOTSET"),b=g.attributes.getInt("ceil_mode",0),_=g.attributes.getInts("kernel_shape"),v=g.attributes.getInts("strides",[]),T=g.attributes.getInts("pads",[]),w=g.attributes.getInt("storage_order",0),A=g.attributes.getInts("dilations",[]);if(w!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(b!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return(0,r.createAttributeWithCacheKey)({autoPad:y,ceilMode:b,countIncludePad:!1,kernelShape:_,strides:v,pads:T,storageOrder:w,dilations:A})};const f=(g,y,b,_)=>{const[v,T]=d(g,_,b),w=`
      ${e(g[0].dims,v,`
      value = max(_X(x), value);
    `,"","-1e5")}
    `;return Object.assign(Object.assign({},y),{output:{dims:T,type:g[0].type,textureType:u.TextureType.unpacked},shaderSource:w})},d=(g,y,b)=>{const _=g[0].dims.slice(),v=Object.hasOwnProperty.call(y,"dilations"),T=y.kernelShape.slice(),w=y.strides.slice(),A=v?y.dilations.slice():[],S=y.pads.slice();a.PoolConvUtil.adjustPoolAttributes(b,_,T,w,A,S);const O=a.PoolConvUtil.computePoolOutputShape(b,_,w,A,T,S,y.autoPad),C=Object.assign({},y);return v?Object.assign(C,{kernelShape:T,strides:w,pads:S,dilations:A,cacheKey:y.cacheKey}):Object.assign(C,{kernelShape:T,strides:w,pads:S,cacheKey:y.cacheKey}),[C,O]},p={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},c={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[u.TextureType.unpacked]};t.globalMaxPool=(g,y)=>(o(y),[g.run(Object.assign(Object.assign({},c),{get:()=>f(y,c,!0,p)}),y)]);const o=g=>{if(!g||g.length!==1)throw new Error("Pool ops requires 1 input.");if(g[0].type!=="float32"&&g[0].type!=="float64")throw new Error("Invalid input type.")},e=(g,y,b,_,v)=>{const T=g.length;if(y.kernelShape.length<=2){const w=y.kernelShape[y.kernelShape.length-1],A=y.strides[y.strides.length-1],S=y.pads[y.pads.length/2-1],O=y.pads[y.pads.length-1],C=g[T-1];let D="",$="",L="";if(D=S+O!==0?`
          for (int i = 0; i < ${w}; i++) {
            x[${T} - 1] = indices[${T} - 1] * ${A} - ${S} + i;
            if (x[${T} - 1] < 0 || x[${T} - 1] >= ${C}) {
              pad++;
              continue;
            }
            ${b}
          }`:`
          for (int i = 0; i < ${w}; i++) {
            x[${T} - 1] = indices[${T} - 1] * ${A} - ${S} + i;
            ${b}
          }`,y.kernelShape.length===2){const P=y.kernelShape[y.kernelShape.length-2],B=y.strides[y.strides.length-2],I=y.pads[y.pads.length/2-2],M=y.pads[y.pads.length-2],k=g[T-2];$=I+M!==0?`
            for (int j = 0; j < ${P}; j++) {
              x[${T} - 2] = indices[${T} - 2] * ${B} - ${I} + j;
              if (x[${T} - 2] < 0 || x[${T} - 2] >= ${k}) {
                pad+= ${w};
                continue;
              }
          `:`
            for (int j = 0; j < ${P}; j++) {
              x[${T} - 2] = indices[${T} - 2] * ${B} - ${I} + j;
            `,L=`
          }
        `}return`
        float process(int indices[${T}]) {
          int x[${T}];
          copyVec(indices, x);

          float value = ${v};
          int pad = 0;
          ${$}
          ${D}
          ${L}
          ${_}
          return value;
        }
      `}{const w=a.ShapeUtil.size(y.kernelShape),A=a.ShapeUtil.computeStrides(y.kernelShape),S=A.length,O=y.pads.length,C=l(S),D=s(g,"inputDims"),$=s(y.pads,"pads"),L=s(A,"kernelStrides"),P=s(y.strides,"strides");let B="";return B=y.pads.reduce((I,M)=>I+M)?`
            if (x[j] >= inputDims[j] || x[j] < 0) {
              pad++;
              isPad = true;
              break;
            }
          }
          if (!isPad) {
            ${b}
          }`:`
          }
          ${b}
        `,`
        ${C}
        float process(int indices[${T}]) {
          int x[${T}];
          copyVec(indices, x);
          int offset[${S}];
          int pads[${O}];
          int inputDims[${T}];
          int kernelStrides[${S}];
          int strides[${S}];
          ${$}
          ${D}
          ${P}
          ${L}

          float value = ${v};
          int pad = 0;
          bool isPad = false;
          for (int i = 0; i < ${w}; i++) {
            offsetToIndices(i, kernelStrides, offset);
            isPad = false;
            for (int j = ${T} - ${S}; j < ${T}; j++) {
              x[j] = indices[j] * strides[j - ${T} + ${S}]
                + offset[j - ${T} + ${S}] - pads[j - 2];
              ${B}
          }
          ${_}

          return value;
        }
      `}},s=(g,y)=>{let b="";for(let _=0;_<g.length;_++)b+=`
      ${y}[${_}] = ${g[_]};
    `;return b},l=g=>`
  void offsetToIndices(int offset, int[${g}] strides, out int[${g}] indices) {
    if (${g} == 0) {
      return;
    }
    for (int i = 0; i < ${g} - 1; ++i) {
      indices[i] = offset / strides[i];
      offset -= indices[i] * strides[i];
    }
    indices[${g} - 1] = offset;
  }`},1010:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reduceLogSumSquare=t.reduceLogSum=t.reduceProd=t.reduceMin=t.reduceMax=t.reduceMean=t.reduceSum=t.parseReduceAttributes=void 0;const r=n(4910),a=n(6145),u=n(7273),h=n(5639),f=(c,o,e,s,l)=>{p(o);const g={name:s,inputNames:["A"],inputTypes:[h.TextureType.unpacked]};return[c.run(Object.assign(Object.assign({},g),{cacheHint:e.cacheKey,get:()=>d(c,o,e,s,l,g)}),o)]};t.parseReduceAttributes=c=>{const o=c.attributes.getInts("axes",[]),e=c.attributes.getInt("keepdims",1)===1;return(0,r.createAttributeWithCacheKey)({axes:o,keepDims:e})};const d=(c,o,e,s,l,g)=>{const y=[],b=o[0].dims.length||1,_=[],v=u.ShapeUtil.normalizeAxes(e.axes,o[0].dims.length),T=l(o,v);let w=T[1];for(let S=0;S<o[0].dims.length;S++)v.indexOf(S)>=0||v.length===0?(e.keepDims&&y.push(1),w=`
          for(int j${S} = 0; j${S} < ${o[0].dims[S]}; j${S}++) {
            inputIdx[${S}] = j${S};
            ${w}
          }`):(_.push(`inputIdx[${S}] = outputIdx[${y.length}];`),y.push(o[0].dims[S]));const A=`
      float process(int outputIdx[${y.length||1}]) {
        float value;                 // final result
        int inputIdx[${b}];      // addressing input data
        ${_.join(`
`)}
        ${T[0]}       // init ops for reduce max/min
        ${w}
        ${T[2]}       // final computation for reduce mean
        return value;
      }`;return Object.assign(Object.assign({},g),{output:{dims:y,type:o[0].type,textureType:h.TextureType.unpacked},shaderSource:A})},p=c=>{if(!c||c.length!==1)throw new Error("Reduce op requires 1 input.");if(a.NUMBER_TYPES.indexOf(c[0].type)===-1)throw new Error("Invalid input type.")};t.reduceSum=(c,o,e)=>f(c,o,e,"ReduceSum",()=>["value = 0.0;","value += _A(inputIdx);",""]),t.reduceMean=(c,o,e)=>f(c,o,e,"ReduceMean",(s,l)=>{let g=1;for(let y=0;y<s[0].dims.length;y++)(l.indexOf(y)>=0||l.length===0)&&(g*=s[0].dims[y]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${g}.;`]}),t.reduceMax=(c,o,e)=>f(c,o,e,"ReduceMax",(s,l)=>{const g=[];for(let y=0;y<s[0].dims.length;y++)(l.indexOf(y)>=0||l.length===0)&&g.push(`inputIdx[${y}] = 0;`);return[`${g.join(`
`)}
value = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]}),t.reduceMin=(c,o,e)=>f(c,o,e,"ReduceMin",(s,l)=>{const g=[];for(let y=0;y<s[0].dims.length;y++)(l.indexOf(y)>=0||l.length===0)&&g.push(`inputIdx[${y}] = 0;`);return[`${g.join(`
`)}
value = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]}),t.reduceProd=(c,o,e)=>f(c,o,e,"ReduceProd",()=>["value = 1.0;","value *= _A(inputIdx);",""]),t.reduceLogSum=(c,o,e)=>f(c,o,e,"ReduceLogSum",()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"]),t.reduceLogSumSquare=(c,o,e)=>f(c,o,e,"ReduceLogSumSquare",()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""])},7379:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isReshapeCheap=t.processDims3D=t.createPackedReshape3DProgramInfoLoader=void 0;const r=n(7273),a=n(6757),u=n(5639),h=n(5614);t.createPackedReshape3DProgramInfoLoader=(f,d,p)=>{const c=(o=>({name:"Reshape (packed)",inputTypes:[u.TextureType.packed],inputNames:["A"],cacheHint:`${o}`}))(p);return Object.assign(Object.assign({},c),{get:()=>((o,e,s,l)=>{const g=e.dims,y=l;let b="";for(let T=0;T<4;T++){let w="";switch(T){case 0:w="outputCoords = rc;";break;case 1:w="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:w="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:w="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}b+=`
        ${w}
        ${T>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}
          int flattenedIndex = getFlattenedIndex(outputCoords);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);
          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${T}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);

        ${T>0?"}":""}
      `}const _=(0,a.getGlsl)(o.session.backend.glContext.version),v=`
      ${function(T){const w=r.ShapeUtil.computeStrides(T),A=["b","r","c"],S="index";return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${w.map((O,C)=>`int ${A[C]} = ${S} / ${O}; ${C===w.length-1?`int ${A[C+1]} = ${S} - ${A[C]} * ${O}`:`index -= ${A[C]} * ${O}`};`).join("")}
      return ivec3(b, r, c);
    }
  `}(g)}
      ${function(T){const w=r.ShapeUtil.computeStrides(T);return`
  int getFlattenedIndex(ivec3 coords) {
    // reverse y, z order
    return coords.x * ${w[0]} + coords.z * ${w[1]} + coords.y;
  }
`}(y)}
      ${(0,h.unpackFromChannel)()}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.0);

        ivec3 outputCoords;
        int rows = ${y[2]};
        int cols = ${y[1]};

        ${b}
        ${_.output} = result;
      }
    `;return Object.assign(Object.assign({},s),{output:{dims:y,type:e.type,textureType:u.TextureType.packed},shaderSource:v,hasMain:!0})})(f,d,c,p)})},t.processDims3D=function(f){if(f.length===0)return[1,1,1];let d=1;for(let p=0;p<f.length-2;++p)d*=f[p];return[d,f.length>1?f[f.length-2]:1,f[f.length-1]]},t.isReshapeCheap=function(f,d){let p=!1;return p=f.length===0||d.length===0||(f.length<2||d.length<2?f[f.length-1]===d[d.length-1]:f[f.length-1]===d[d.length-1]&&f[f.length-2]===d[d.length-2]),p}},8126:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reshape=void 0;const r=n(7273);t.reshape=(a,u)=>{const h=r.ShapeUtil.calculateReshapedDims(u[0].dims,u[1].integerData);return a.session.pack?[a.reshapePacked(u[0],h)]:[a.reshapeUnpacked(u[0],h)]}},2801:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseResizeAttributesV11=t.parseResizeAttributesV10=t.resize=void 0;const r=n(6757),a=n(5639),u=n(432),h=n(5614),f=n(3980),d={name:"Resize",inputNames:["A"],inputTypes:[a.TextureType.packed]};t.resize=(s,l,g)=>((0,f.validateInputs)(l,g),[s.run(Object.assign(Object.assign({},d),{cacheHint:g.cacheKey,get:()=>p(s,l,g)}),l)]),t.parseResizeAttributesV10=s=>(0,f.parseUpsampleAttributes)(s,10),t.parseResizeAttributesV11=s=>(0,f.parseUpsampleAttributes)(s,11);const p=(s,l,g)=>{const y=(0,r.getGlsl)(s.session.backend.glContext.version),[b,_]=c(l,g);if(b.every(B=>B===1)&&g.coordinateTransformMode!=="tf_crop_and_resize")return Object.assign(Object.assign({},d),{output:{dims:_,type:l[0].type,textureType:a.TextureType.packed},hasMain:!0,shaderSource:`void main() {
                    vec4 v = ${y.texture2D}(X, TexCoords);
                    ${y.output} = v;
                }`});const v=_.length;if(v<2)throw new Error(`output dimension should be at least 2, but got ${v}`);const T=_[v-2],w=_[v-1],A=l[0].dims;if(v!==A.length)throw new Error(`output dimension should match input ${A.length}, but got ${v}`);const S=A[v-2],O=A[v-1],C=b[v-2],D=b[v-1];let $="";if(g.mode!=="linear")throw new Error(`resize (packed) does not support mode: '${g.mode}'`);switch(g.coordinateTransformMode){case"asymmetric":$=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return vec4(coords) / scaleWHWH;
                    }
                `;break;case"half_pixel":$=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;
                    }
                `;break;case"pytorch_half_pixel":$=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 fcoords = vec4(coords);
                        return vec4(
                            ${w}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,
                            ${T}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,
                            ${w}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,
                            ${T}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0
                          );
                    }
                `;break;case"align_corners":$=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 resized = vec4(${w}.0 - 1.0, ${T}.0 - 1.0, ${w}.0 - 1.0,
                            ${T}.0 - 1.0);
                        vec4 original = vec4(${O}.0 - 1.0, ${S}.0 - 1.0, ${O}.0 - 1.0,
                            ${S}.0 - 1.0);
                        vec4 new_scale = original / resized;
                        return vec4(coords) * new_scale;
                    }
                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${g.coordinateTransformMode}'`)}const L=(0,u.getCoordsDataType)(v),P=`
            const vec2 inputWH = vec2(${S}.0, ${O}.0);
            const vec4 scaleWHWH = vec4(float(${C}), float(${D}), float(${C}), float(${D}));
            ${(0,h.unpackFromChannel)()}
            ${$}
            float getAValue(int x10, int r, int c, int d) {
                return getChannel(getA(x10, r, c, d), vec2(c, d));
            }
            void main() {
                ${L} rc = getOutputCoords();

                int batch = rc[0];
                int depth = rc[1];

                // retrieve the 4 coordinates that is used in the 4 packed output values.
                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);

                // calculate the source index in fraction
                vec4 sourceFrac = getSourceFracIndex(coords);

                // get the lower and upper bound of the 4 values that will be packed into one texel.
                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));
                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));
                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));
                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));

                bool hasNextRow = rc.w < ${T-1};
                bool hasNextCol = rc.z < ${w-1};

                // pack x00, x01, x10, x11's top-left corner into one vec4 structure
                vec4 topLeft = vec4(
                    getAValue(batch, depth, x00.x, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);

                // pack x00, x01, x10, x11's top-right corner into one vec4 structure
                vec4 topRight = vec4(
                    getAValue(batch, depth, x00.x, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);

                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure
                vec4 bottomLeft = vec4(
                    getAValue(batch, depth, x00.z, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);

                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure
                vec4 bottomRight = vec4(
                    getAValue(batch, depth, x00.z, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);

                // calculate the interpolation fraction on u and v direction
                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);
                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));

                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);
                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);
                vec4 newValue = mix(top, bottom, clampFrac.xxzz);

                ${y.output} = vec4(newValue);
            }
        `;return Object.assign(Object.assign({},d),{output:{dims:_,type:l[0].type,textureType:a.TextureType.packed},hasMain:!0,shaderSource:P})},c=(s,l)=>{const g=s[0].dims;let y,b=l.scales;if(b.length===0){const v=s[l.scalesInputIdx];if(v&&v.size!==0){if(s[l.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");b=o(v,l.mode,l.isResize)}else{const T=s[l.sizesInputIdx];if(!T||T.size===0)throw new Error("Either scales or sizes MUST be provided as input.");y=Array.from(T.integerData),b=e(y,g,l.mode,l.isResize)}}else if(s[l.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");const _=y||g.map((v,T)=>Math.floor(v*b[T]));return[b,_]},o=(s,l,g)=>{const y=Array.from(s.floatData);return(0,f.scalesValidation)(y,l,g),y},e=(s,l,g,y)=>{const b=l.length,_=new Array(b);for(let v=0,T=b;v<T;v++)if(l[v]===0){if(s[v]!==0)throw new Error("Input dim is zero but required output dim is non-zero.");_[v]=1}else _[v]=s[v]/l[v];return(0,f.scalesValidation)(_,g,y),_}},565:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shape=void 0;const r=n(9240);t.shape=(u,h)=>(a(h),[new r.Tensor([h[0].dims.length],"int32",void 0,void 0,new Int32Array(h[0].dims))]);const a=u=>{if(!u||u.length!==1)throw new Error("Shape requires 1 input.")}},2444:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sliceV10=t.parseSliceAttributes=t.slice=void 0;const r=n(4910),a=n(6145),u=n(7273),h=n(5639),f={name:"Slice",inputNames:["A"],inputTypes:[h.TextureType.unpacked]};t.slice=(e,s,l)=>(p(s),[e.run(Object.assign(Object.assign({},f),{cacheHint:l.cacheKey,get:()=>d(e,s[0],l)}),s)]),t.parseSliceAttributes=e=>{const s=e.attributes.getInts("starts"),l=e.attributes.getInts("ends"),g=e.attributes.getInts("axes",[]);return(0,r.createAttributeWithCacheKey)({starts:s,ends:l,axes:g})};const d=(e,s,l)=>{const g=l.axes.length===0?s.dims.slice(0).map((A,S)=>S):l.axes,y=u.ShapeUtil.normalizeAxes(g,s.dims.length),b=l.starts.map((A,S)=>A>s.dims[y[S]]-1?s.dims[y[S]]:u.ShapeUtil.normalizeAxis(A,s.dims[y[S]])),_=l.ends.map((A,S)=>A>s.dims[y[S]]-1?s.dims[y[S]]:u.ShapeUtil.normalizeAxis(A,s.dims[y[S]])),v=s.dims.slice(),T=[];for(let A=0;A<y.length;A++)v[y[A]]=_[A]-b[A],b[A]>0&&T.push(`outputIdx[${y[A]}] += ${b[A]};`);const w=`
      float process(int outputIdx[${v.length}]) {
        ${T.join(`
      `)}
        return _A(outputIdx);
      }`;return Object.assign(Object.assign({},f),{output:{dims:v,type:s.type,textureType:h.TextureType.unpacked},shaderSource:w})},p=e=>{if(!e||e.length!==1)throw new Error("Slice requires 1 input.");if(a.NUMBER_TYPES.indexOf(e[0].type)===-1)throw new Error("Invalid input type.")};t.sliceV10=(e,s)=>{o(s);const l=c(e,s);return[e.run(Object.assign(Object.assign({},f),{cacheHint:l.cacheKey,get:()=>d(e,s[0],l)}),[s[0]])]};const c=(e,s)=>{if(!e.session.isInitializer(s[1].dataId)||!e.session.isInitializer(s[2].dataId)||s.length>=4&&!e.session.isInitializer(s[3].dataId)||s.length>=5&&!e.session.isInitializer(s[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(s.length>=5&&s[4].integerData.some(b=>b!==1))throw new Error("currently non-1 steps is not supported for Slice");const l=Array.from(s[1].integerData),g=Array.from(s[2].integerData),y=s.length>=4?Array.from(s[3].integerData):[];return{starts:l,ends:g,axes:y,cacheKey:`${y};${l};${g}`}},o=e=>{if(!e||e.length<3||e.length>5)throw new Error("Invalid input number.");if(e[1].type!=="int32"||e[1].dims.length!==1)throw new Error("Invalid input type.");if(e[2].type!=="int32"||e[2].dims.length!==1)throw new Error("Invalid input type.");if(e.length>=4&&(e[3].type!=="int32"||e[3].dims.length!==1))throw new Error("Invalid input type.");if(e.length>=5&&(e[4].type!=="int32"||e[4].dims.length!==1))throw new Error("Invalid input type.")}},815:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.softmaxV13=t.parseSoftmaxAttributesV13=t.parseSoftmaxAttributes=t.softmax=void 0;const r=n(4910),a=n(7273),u=n(6757),h=n(5639),f=n(5707),d={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[h.TextureType.unpacked]},p={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[h.TextureType.unpacked,h.TextureType.unpacked]},c={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[h.TextureType.unpacked,h.TextureType.unpacked,h.TextureType.unpacked]};t.softmax=(y,b,_)=>{g(b);const v=b[0].dims.slice(),T=a.ShapeUtil.normalizeAxis(_.axis,v.length),w=a.ShapeUtil.sizeToDimension(v,T),A=a.ShapeUtil.sizeFromDimension(v,T);return o(y,b,_,w,A)},t.parseSoftmaxAttributes=y=>(0,r.createAttributeWithCacheKey)({axis:y.attributes.getInt("axis",1)}),t.parseSoftmaxAttributesV13=y=>(0,r.createAttributeWithCacheKey)({axis:y.attributes.getInt("axis",-1)}),t.softmaxV13=(y,b,_)=>{g(b);const v=b[0].dims.slice(),T=a.ShapeUtil.normalizeAxis(_.axis,v.length),w=v.length,A=T!==w-1,S=[];let O,C=[],D=[];A&&(C=Array.from({length:w}).map((B,I)=>I),C[T]=w-1,C[w-1]=T,C.map(B=>S.push(v[B])),O=(0,r.createAttributeWithCacheKey)({perm:C}),D=(0,f.transpose)(y,b,O));const $=A?a.ShapeUtil.sizeToDimension(S,w-1):a.ShapeUtil.sizeToDimension(v,w-1),L=A?a.ShapeUtil.sizeFromDimension(S,w-1):a.ShapeUtil.sizeFromDimension(v,w-1),P=o(y,A?D:b,_,$,L);return A?(0,f.transpose)(y,P,O):P};const o=(y,b,_,v,T)=>{const w=e(y,b[0],v,T,[v]),A=y.run(Object.assign(Object.assign({},d),{cacheHint:_.cacheKey,get:()=>w}),b),S=s(y,b[0],v,T,w.output.dims,[v]),O=y.run(Object.assign(Object.assign({},p),{cacheHint:_.cacheKey,get:()=>S}),[b[0],A]),C=l(y,b[0],v,T,w.output.dims,S.output.dims);return[y.run(Object.assign(Object.assign({},c),{cacheHint:_.cacheKey,get:()=>C}),[b[0],A,O])]},e=(y,b,_,v,T)=>{const[w,A]=y.calculateTextureWidthAndHeight(b.dims,h.TextureType.unpacked),S=T.length;if(_<1||v<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(T.length!==1)throw new Error("Dimensionality of the output should be 1");if(T[0]!==_)throw new Error("Shape of the output should be equal to logical row count");const O=(0,u.getGlsl)(y.session.backend.glContext.version),C=`
      float process(int[${S}] indices) {
        int logical_row_start_offset = indices[0] * ${v};

        float max = getColorAsFloat(${O.texture2D}(A, offsetToCoords(logical_row_start_offset, ${w},
        ${A} )));
        for(int i=1; i<${v}; ++i)
        {
          float current = getColorAsFloat(${O.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${w}, ${A})));
          if(current > max)
          max = current;
        }

        return max;
      }`;return Object.assign(Object.assign({},d),{output:{dims:T,type:b.type,textureType:h.TextureType.unpacked},shaderSource:C})},s=(y,b,_,v,T,w)=>{const[A,S]=y.calculateTextureWidthAndHeight(b.dims,h.TextureType.unpacked),O=w.length;if(_<1||v<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(w.length!==1)throw new Error("Dimensionality of the output should be 1");if(w[0]!==_)throw new Error("Shape of the output should be equal to logical row count");if(T.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(T[0]!==_)throw new Error("Shape of the intermediate results should be equal to logical row count");const C=`
      float process(int[${O}] indices) {
        int logical_row_start_offset = indices[0] * ${v};

        float norm_factor = 0.0;
        float max = _Max(indices);
        for(int i=0; i<${v}; ++i)
        {
          norm_factor += exp(getColorAsFloat(${(0,u.getGlsl)(y.session.backend.glContext.version).texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${A}, ${S}))) - max);
        }

        return norm_factor;
      }`;return Object.assign(Object.assign({},p),{output:{dims:w,type:b.type,textureType:h.TextureType.unpacked},shaderSource:C})},l=(y,b,_,v,T,w)=>{const[A,S]=y.calculateTextureWidthAndHeight(b.dims,h.TextureType.unpacked),O=b.dims.length;if(_<1||v<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(T.length!==1||w.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(T[0]!==_||w[0]!==_)throw new Error("Shape of the intermediate results should be equal to logical row count");const C=`
      float process(int[${O}] indices) {

      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)
      int offset = coordsToOffset(TexCoords, ${A}, ${S});

      //determine the logical row for this index
      int logical_row_index[1];
      logical_row_index[0] = offset / ${v};

      float norm_factor = _Norm(logical_row_index);

      // avoid possible division by 0
      // if norm_facor is 0, all elements are zero
      // if so, return 0
      if(norm_factor == 0.0)
        return 0.0;

      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;
    }`;return Object.assign(Object.assign({},c),{output:{dims:b.dims,type:b.type,textureType:h.TextureType.unpacked},shaderSource:C})},g=y=>{if(!y||y.length!==1)throw new Error("Softmax requires 1 input.");if(y[0].type!=="float32"&&y[0].type!=="float64")throw new Error("Invalid input type")}},564:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseSplitAttributes=t.split=void 0;const r=n(4910),a=n(7273),u=n(5639),h={name:"Split",inputNames:["A"],inputTypes:[u.TextureType.unpacked]};t.split=(c,o,e)=>{p(o);const s=a.ShapeUtil.normalizeAxis(e.axis,o[0].dims.length),l=f(c,o,s,e),g=[];for(let y=0;y<l;++y)g.push(c.run(Object.assign(Object.assign({},h),{cacheHint:`${e.cacheKey};${y}`,get:()=>d(c,o[0],e,s,y)}),o));return g},t.parseSplitAttributes=c=>{const o=c.attributes.getInt("axis",0),e=c.attributes.getInts("split",[]),s=c.outputs.length;return(0,r.createAttributeWithCacheKey)({axis:o,split:e,numOutputs:s})};const f=(c,o,e,s)=>{const[,l]=a.SplitUtil.splitShape(o[0].dims,e,s.split,s.numOutputs);return l.length},d=(c,o,e,s,l)=>{const[g,y]=a.SplitUtil.splitShape(o.dims,s,e.split,e.numOutputs),b=y[l],_=g[l],v=`
      float process(int indices[${_.length}]) {
        indices[${s}] += ${b};
        return _A(indices);
      }
    `;return Object.assign(Object.assign({},h),{cacheHint:`${e.cacheKey}:${l}`,output:{dims:_,type:o.type,textureType:u.TextureType.unpacked},shaderSource:v})},p=c=>{if(!c||c.length!==1)throw new Error("Split requires one input.");if(c[0].type!=="int8"&&c[0].type!=="uint8"&&c[0].type!=="int16"&&c[0].type!=="uint16"&&c[0].type!=="int32"&&c[0].type!=="uint32"&&c[0].type!=="float32"&&c[0].type!=="float64"&&c[0].type!=="bool")throw new Error("Invalid input type.")}},5416:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseSqueezeAttributes=t.squeezeV13=t.squeeze=void 0;const r=n(7273);t.squeeze=(h,f,d)=>{a(f);const p=r.ShapeUtil.squeezeShape(f[0].dims,d);return[h.reshapeUnpacked(f[0],p)]},t.squeezeV13=(h,f)=>(u(f),(0,t.squeeze)(h,[f[0]],Array.from(f[1].integerData))),t.parseSqueezeAttributes=h=>h.attributes.getInts("axes");const a=h=>{if(!h||h.length!==1)throw new Error("Squeeze requires 1 input.");if(h[0].type==="string")throw new Error("invalid input tensor types.")},u=h=>{if(!h||h.length!==2)throw new Error("Squeeze requires 2 inputs.");if(h[1].type!=="int32")throw new Error("Invalid input type.")}},1240:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sum=void 0;const r=n(6757),a=n(5639);t.sum=(f,d)=>{h(d);const p={name:"Sum",inputNames:d.map((c,o)=>`X${o}`),inputTypes:new Array(d.length).fill(a.TextureType.unpacked)};return[f.run(Object.assign(Object.assign({},p),{get:()=>u(f,d,p)}),d)]};const u=(f,d,p)=>{const c=(0,r.getGlsl)(f.session.backend.glContext.version),o=d[0].dims.slice(),e=`
      void main() {
        vec4 result = ${d.map((s,l)=>`${c.texture2D}(X${l},TexCoords)`).join(" + ")};
        ${c.output} = result;
      }
    `;return Object.assign(Object.assign({},p),{output:{dims:o,type:d[0].type,textureType:a.TextureType.unpacked},hasMain:!0,shaderSource:e})},h=f=>{if(!f||f.length===0)throw new Error("Sum requires inputs.");const d=f[0].dims.length;for(let p=1;p<f.length;p++){if(d!==f[p].dims.length)throw new Error("Input shapes are mismatched.");for(let c=0;c<d;c++)if(f[0].dims[c]!==f[p].dims[c])throw new Error("Input shapes are not matched.")}if(f[0].type!=="float32"&&f[0].type!=="float64")throw new Error("Invalid input type.");for(let p=1;p<f.length;p++)if(f[0].type!==f[p].type)throw new Error("Input types are not matched.")}},5944:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tile=void 0;const r=n(6145),a=n(5639);t.tile=(f,d)=>{h(d);const p={name:"Tile",inputNames:["A"],inputTypes:[a.TextureType.unpacked]};return[f.run(Object.assign(Object.assign({},p),{get:()=>u(f,d,p)}),d)]};const u=(f,d,p)=>{const c=d[0].dims.slice(),o=new Array(c.length),e=[];for(let g=0;g<c.length;g++)o[g]=c[g]*d[1].numberData[g],e.push(`inputIdx[${g}] = int(mod(float(outputIdx[${g}]), ${c[g]}.));`);const s=o.length,l=`
      float process(int outputIdx[${s}]) {
        int inputIdx[${s}];
        ${e.join(`
`)}
        return _A(inputIdx);
      }
    `;return Object.assign(Object.assign({},p),{output:{dims:o,type:d[0].type,textureType:a.TextureType.unpacked},shaderSource:l})},h=f=>{if(!f||f.length!==2)throw new Error("Tile requires 2 input.");if(f[1].dims.length!==1)throw new Error("The second input shape must 1 dimension.");if(f[1].dims[0]!==f[0].dims.length)throw new Error("Invalid input shape.");if(r.NUMBER_TYPES.indexOf(f[0].type)===-1)throw new Error("Invalid input type.");if(f[1].type!=="int32"&&f[1].type!=="int16")throw new Error("Invalid repeat type.")}},5707:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseTransposeAttributes=t.transpose=void 0;const r=n(4910),a=n(7273),u=n(5639),h={name:"Transpose",inputNames:["A"],inputTypes:[u.TextureType.unpacked]};t.transpose=(e,s,l)=>(o(s),[e.run(Object.assign(Object.assign({},h),{cacheHint:l.cacheKey,get:()=>f(e,s[0],l.perm)}),s)]),t.parseTransposeAttributes=e=>(0,r.createAttributeWithCacheKey)({perm:e.attributes.getInts("perm",[])});const f=(e,s,l)=>{const g=s.dims;l=d(g,l);const y=p(g,l),b=g.length,_=`
      ${c("perm",l,b)}
      float process(int indices[${b}]) {
        int a[${b}];
        perm(a, indices);
        return _A(a);
      }`;return Object.assign(Object.assign({},h),{output:{dims:y,type:s.type,textureType:u.TextureType.unpacked},shaderSource:_})},d=(e,s)=>(s&&s.length!==e.length&&(s=[...e.keys()].reverse()),s),p=(e,s)=>(s=d(e,s),a.ShapeUtil.sortBasedOnPerm(e,s)),c=(e,s,l)=>{const g=[];g.push(`void ${e}(out int a[${l}], int src[${l}]) {`);for(let y=0;y<l;++y)g.push(`	a[${s[y]}]=src[${y}];`);return g.push("	}"),g.join(`
`)},o=e=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.");if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("input should be float tensor")}},2488:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encodeAsUint8=void 0;const r=n(6757),a=n(5639);t.encodeAsUint8=(u,h)=>{const f=h.shape,d=(0,r.getGlsl)(u.session.backend.glContext.version),p=`
    const float FLOAT_MAX = 1.70141184e38;
    const float FLOAT_MIN = 1.17549435e-38;

    bool isNaN(float val) {
      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;
    }

    highp vec4 encodeAsUint8(highp float v) {
      if (isNaN(v)) {
        return vec4(255, 255, 255, 255);
      }

      highp float av = abs(v);

      if(av < FLOAT_MIN) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      } else if(v > FLOAT_MAX) {
        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
      } else if(v < -FLOAT_MAX) {
        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
      }

      highp vec4 c = vec4(0,0,0,0);

      highp float e = floor(log2(av));
      highp float m = exp2(fract(log2(av))) - 1.0;

      c[2] = floor(128.0 * m);
      m -= c[2] / 128.0;
      c[1] = floor(32768.0 * m);
      m -= c[1] / 32768.0;
      c[0] = floor(8388608.0 * m);

      highp float ebias = e + 127.0;
      c[3] = floor(ebias / 2.0);
      ebias -= c[3] * 2.0;
      c[2] += floor(ebias) * 128.0;

      c[3] += 128.0 * step(0.0, -v);

      return c / 255.0;
    }

    void main() {
      float value = ${d.texture2D}(X,TexCoords).r;
      ${d.output} = encodeAsUint8(value);
    }`,c={name:"Uint8Encode",inputTypes:[a.TextureType.unpacked],inputNames:["X"],output:{dims:f,type:h.tensor.type,textureType:a.TextureType.downloadUint8AsFloat},shaderSource:p,hasMain:!0};return u.executeProgram(c,[h.tensor])}},9087:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tanh=t.tan=t.sqrt=t.sin=t.sigmoid=t.relu=t.not=t.neg=t.log=t.parseLeakyReluAttributes=t.leakyRelu=t.identity=t.floor=t.exp=t.parseEluAttributes=t.elu=t.cos=t.ceil=t.clipV11=t.parseClipAttributes=t.clip=t.atan=t.asin=t.acos=t.abs=t.glslTanh=t.glslTan=t.glslSqrt=t.glslSigmoid=t.glslRelu=t.glslSin=t.glslNot=t.glslNeg=t.glslLog=t.glslLeakyRelu=t.glslIdentity=t.glslClip=t.glslFloor=t.glslExp=t.glslElu=t.glslCos=t.glslCeil=t.glslAtan=t.glslAsin=t.glslAcos=t.glslAbs=void 0;const r=n(4910),a=n(7273),u=n(1997),h=n(6757),f=n(5639);function d(){return P("abs")}function p(){return P("acos")}function c(){return P("asin")}function o(){return P("atan")}function e(){return P("ceil")}function s(){return P("cos")}function l(M){const k="elu";return{body:`
  const float alpha = float(${M});

  float ${k}_(float a) {
    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;
  }
  vec4 ${k}_(vec4 v) {
    return vec4(${k}_(v.x), ${k}_(v.y), ${k}_(v.z), ${k}_(v.w));
  }
  `,name:k,type:u.FunctionType.ValueBased}}function g(){return P("exp")}function y(){return P("floor")}function b(M,k){const X="clip";return{body:`
  const float min = float(${M});
  const float max = float(${k});

  float ${X}_(float a) {
    return clamp(a, min, max);
  }
  vec4 ${X}_(vec4 v) {
    return clamp(v, min, max);
  }
  `,name:X,type:u.FunctionType.ValueBased}}function _(){const M="indentity";return{body:`
  float ${M}_(float a) {
    return a;
  }
  vec4 ${M}_(vec4 v) {
    return v;
  }
  `,name:M,type:u.FunctionType.ValueBased}}function v(M){const k="leakyRelu";return{body:`
  const float alpha = float(${M});

  float ${k}_(float a) {
    return a < 0.0 ? a * alpha : a;
  }
  vec4 ${k}_(vec4 v) {
    return vec4(${k}_(v.x), ${k}_(v.y), ${k}_(v.z), ${k}_(v.w));
  }
  `,name:k,type:u.FunctionType.ValueBased}}function T(){return P("log")}function w(){const M="neg";return{body:`
  float ${M}_(float a) {
    return -a;
  }
  vec4 ${M}_(vec4 v) {
    return -v;
  }
  `,name:M,type:u.FunctionType.ValueBased}}function A(){const M="not";return{body:`
  float ${M}_(float a) {
    return float( ! bool(a) );
  }
  bool ${M}_(bool a) {
    return !a;
  }
  vec4 ${M}_(vec4 v) {
    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));
  }
  bvec4 ${M}_(bvec4 v) {
    return bvec4(!v.x, !v.y, !v.z, !v.w);
  }
  `,name:M,type:u.FunctionType.ValueBased}}function S(){return P("sin")}function O(){const M="relu";return{body:`
  float ${M}_(float a) {
    return max( a, 0.0 );
  }
  vec4 ${M}_(vec4 v) {
    return max( v, 0.0 );
  }
  `,name:M,type:u.FunctionType.ValueBased}}function C(){const M="sigmoid";return{body:`
  float ${M}_(float a) {
    return 1.0 / (1.0 + exp(-a));
  }
  vec4 ${M}_(vec4 v) {
    return 1.0 / (1.0 + exp(-v));
  }
  `,name:M,type:u.FunctionType.ValueBased}}function D(){return P("sqrt")}function $(){return P("tan")}function L(){const M="tanh";return{body:`
  float ${M}_(float a) {
    a = clamp(a, -10., 10.);
    a = exp(2.*a);
    return (a - 1.) / (a + 1.);
  }
  vec4 ${M}_(vec4 v) {
    v = clamp(v, -10., 10.);
    v = exp(2.*v);
    return (v - 1.) / (v + 1.);
  }
  `,name:M,type:u.FunctionType.ValueBased}}function P(M){return{body:`
  float ${M}_(float a) {
    return ${M}(a);
  }
  vec4 ${M}_(vec4 v) {
    return ${M}(v);
  }
  `,name:M,type:u.FunctionType.ValueBased}}t.glslAbs=d,t.glslAcos=p,t.glslAsin=c,t.glslAtan=o,t.glslCeil=e,t.glslCos=s,t.glslElu=l,t.glslExp=g,t.glslFloor=y,t.glslClip=b,t.glslIdentity=_,t.glslLeakyRelu=v,t.glslLog=T,t.glslNeg=w,t.glslNot=A,t.glslSin=S,t.glslRelu=O,t.glslSigmoid=C,t.glslSqrt=D,t.glslTan=$,t.glslTanh=L;const B=(M,k,X,G)=>{const J=M.session.pack?f.TextureType.packed:f.TextureType.unpacked,Y={name:X.name,inputTypes:[J],inputNames:["A"],cacheHint:G};return Object.assign(Object.assign({},Y),{get:()=>((Q,tt,nt,ot)=>{const lt=Q.session.pack?f.TextureType.packed:f.TextureType.unpacked,ut=(0,h.getGlsl)(Q.session.backend.glContext.version);return Object.assign(Object.assign({},tt),{output:{dims:nt.dims,type:nt.type,textureType:lt},shaderSource:`
     ${ot.body}
     void main() {
       vec4 v = ${ut.texture2D}(A, TexCoords);
       v = ${ot.name}_(v);
       ${ut.output} = v;
     }
     `,hasMain:!0})})(M,Y,k,X)})};t.abs=(M,k)=>[M.run(B(M,k[0],d()),k)],t.acos=(M,k)=>[M.run(B(M,k[0],p()),k)],t.asin=(M,k)=>[M.run(B(M,k[0],c()),k)],t.atan=(M,k)=>[M.run(B(M,k[0],o()),k)],t.clip=(M,k,X)=>[M.run(B(M,k[0],b(X.min,X.max),X.cacheKey),k)],t.parseClipAttributes=M=>(0,r.createAttributeWithCacheKey)({min:M.attributes.getFloat("min",a.MIN_CLIP),max:M.attributes.getFloat("max",a.MAX_CLIP)}),t.clipV11=(M,k)=>{const X=I(M,k);return(0,t.clip)(M,[k[0]],X)};const I=(M,k)=>{if(k.length>=3&&(!M.session.isInitializer(k[1].dataId)||!M.session.isInitializer(k[2].dataId)))throw new Error("dynamic clip attributes are not allowed");const X=k.length>=3?k[1].numberData[0]:a.MIN_CLIP,G=k.length>=3?k[2].numberData[0]:a.MAX_CLIP;return(0,r.createAttributeWithCacheKey)({min:X,max:G})};t.ceil=(M,k)=>[M.run(B(M,k[0],e()),k)],t.cos=(M,k)=>[M.run(B(M,k[0],s()),k)],t.elu=(M,k,X)=>[M.run(B(M,k[0],l(X.alpha),X.cacheKey),k)],t.parseEluAttributes=M=>(0,r.createAttributeWithCacheKey)({alpha:M.attributes.getFloat("alpha",1)}),t.exp=(M,k)=>[M.run(B(M,k[0],g()),k)],t.floor=(M,k)=>[M.run(B(M,k[0],y()),k)],t.identity=(M,k)=>[M.run(B(M,k[0],_()),k)],t.leakyRelu=(M,k,X)=>[M.run(B(M,k[0],v(X.alpha),X.cacheKey),k)],t.parseLeakyReluAttributes=M=>(0,r.createAttributeWithCacheKey)({alpha:M.attributes.getFloat("alpha",.01)}),t.log=(M,k)=>[M.run(B(M,k[0],T()),k)],t.neg=(M,k)=>[M.run(B(M,k[0],w()),k)],t.not=(M,k)=>[M.run(B(M,k[0],A()),k)],t.relu=(M,k)=>[M.run(B(M,k[0],O()),k)],t.sigmoid=(M,k)=>[M.run(B(M,k[0],C()),k)],t.sin=(M,k)=>[M.run(B(M,k[0],S()),k)],t.sqrt=(M,k)=>[M.run(B(M,k[0],D()),k)],t.tan=(M,k)=>[M.run(B(M,k[0],$()),k)],t.tanh=(M,k)=>[M.run(B(M,k[0],L()),k)]},540:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createUnpackProgramInfoLoader=t.createUnpackProgramInfo=void 0;const r=n(6757),a=n(5639),u=n(432),h=n(5614),f={name:"unpack",inputNames:["A"],inputTypes:[a.TextureType.packed]};t.createUnpackProgramInfo=(d,p)=>{const c=p.dims.length,o=(0,h.getChannels)("rc",c),e=o.slice(-2),s=(0,u.getCoordsDataType)(c),l=(0,h.unpackFromChannel)(),g=p.dims.length===0?"":function(_,v){if(_===1)return"rc";let T="";for(let w=0;w<_;w++)T+=v[w],w<_-1&&(T+=",");return T}(c,o),y=c<=1?"rc":`vec2(${e.join(",")})`,b=`
    ${l}
    void main() {
      ${s} rc = getOutputCoords();

       // Sample the texture with the coords to get the rgba channel value.
       vec4 packedInput = getA(${g});

       ${(0,r.getGlsl)(d.session.backend.glContext.version).output} = vec4(getChannel(packedInput, ${y}), 0, 0, 0);
     }
   `;return Object.assign(Object.assign({},f),{hasMain:!0,output:{dims:p.dims,type:p.type,textureType:a.TextureType.unpacked},shaderSource:b})},t.createUnpackProgramInfoLoader=(d,p)=>Object.assign(Object.assign({},f),{get:()=>(0,t.createUnpackProgramInfo)(d,p)})},7862:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseUnsqueezeAttributes=t.unsqueezeV13=t.unsqueeze=void 0;const r=n(7273);t.unsqueeze=(h,f,d)=>{a(f);const p=r.ShapeUtil.unsqueezeShape(f[0].dims,d);return[h.reshapeUnpacked(f[0],p)]},t.unsqueezeV13=(h,f)=>(u(f),(0,t.unsqueeze)(h,[f[0]],Array.from(f[1].integerData))),t.parseUnsqueezeAttributes=h=>h.attributes.getInts("axes");const a=h=>{if(!h||h.length!==1)throw new Error("Unsqueeze requires 1 input.");if(h[0].type==="string")throw new Error("invalid input tensor types.")},u=h=>{if(!h||h.length!==2)throw new Error("Unsqueeze requires 2 inputs.");if(h[1].type!=="int32")throw new Error("Invalid input type.")}},3980:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.scalesValidation=t.validateInputs=t.parseUpsampleAttributes=t.parseUpsampleAttributesV9=t.parseUpsampleAttributesV7=t.upsample=void 0;const r=n(4910),a=n(6757),u=n(5639),h={name:"Upsample",inputNames:["X"],inputTypes:[u.TextureType.unpacked]};t.upsample=(d,p,c)=>((0,t.validateInputs)(p,c),[d.run(Object.assign(Object.assign({},h),{cacheHint:c.cacheKey,get:()=>f(d,p,c)}),p)]),t.parseUpsampleAttributesV7=d=>(0,t.parseUpsampleAttributes)(d,7),t.parseUpsampleAttributesV9=d=>(0,t.parseUpsampleAttributes)(d,9),t.parseUpsampleAttributes=(d,p)=>{const c=p>=10,o=d.attributes.getString("mode","nearest");if(o!=="nearest"&&o!=="linear"&&(p<11||o!=="cubic"))throw new Error(`unrecognized mode: ${o}`);let e=[];p<9&&(e=d.attributes.getFloats("scales"),(0,t.scalesValidation)(e,o,c));const s=d.attributes.getFloat("extrapolation_value",0),l=p>10?d.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(l)===-1)throw new Error(`coordinate_transform_mode '${l}' is not supported`);const g=l==="tf_crop_and_resize",y=g,b=o==="nearest"&&p>=11?d.attributes.getString("nearest_mode","round_prefer_floor"):"";if(["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(b)===-1)throw new Error(`nearest_mode '${b}' is not supported`);const _=d.attributes.getFloat("cubic_coeff_a",-.75),v=d.attributes.getInt("exclude_outside",0)!==0;if(v&&o!=="cubic")throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");const T=p<11||o==="nearest"&&l==="asymmetric"&&b==="floor";let w=0,A=0,S=0;return p>10?d.inputs.length>2?(w=1,A=2,S=3):(A=1,S=2):p===9&&(A=1),(0,r.createAttributeWithCacheKey)({opset:p,isResize:c,mode:o,scales:e,extrapolationValue:s,coordinateTransformMode:l,useExtrapolation:y,needRoiInput:g,nearestMode:b,cubicCoefficientA:_,excludeOutside:v,useNearest2xOptimization:T,roiInputIdx:w,scalesInputIdx:A,sizesInputIdx:S})};const f=(d,p,c)=>{const o=(0,a.getGlsl)(d.session.backend.glContext.version),[e,s]=d.calculateTextureWidthAndHeight(p[0].dims,u.TextureType.unpacked),l=p[0].dims.map((S,O)=>Math.floor(S*c.scales[O])),[g,y]=d.calculateTextureWidthAndHeight(l,u.TextureType.unpacked),b=l.length,_=new Array(b),v=new Array(b);let T=`
      int output_pitches[${b}];
      int input_pitches[${b}];
      `;for(let S=b-1;S>=0;S--)_[S]=S===b-1?1:_[S+1]*l[S+1],v[S]=S===b-1?1:v[S+1]*p[0].dims[S+1],T+=`
        output_pitches[${S}] = ${_[S]};
        input_pitches[${S}] = ${v[S]};
        `;const w=`
      float getInputFloat(int index) {
        vec2 coords = offsetToCoords(index, ${e}, ${s});
        float value = getColorAsFloat(${o.texture2D}(X, coords));
        return value;
      }
      `,A=c.mode==="nearest"?`
    ${w}
    float process(int indices[${b}]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${g}, ${y});

      ${T}

      int d, m;
      for (int dim = 0; dim < ${b}; ++dim) {
        d = output_index / output_pitches[dim];
        m = output_index - d * output_pitches[dim];
        output_index = m;

        if (scales[dim] != 1 && d > 0) {
          int d2 = d / scales[dim];
          m = d - d2 * scales[dim];
          d = d2;
        }
        input_index += input_pitches[dim] * d;
      }

      return getInputFloat(input_index);
    }`:b===4?`
    ${w}
    float process(int indices[4]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${g}, ${y});

      ${T}

      int m;
      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m / output_pitches[1];
      m = m - index_of_dim1 * output_pitches[1];
      index_of_dim2 = m / output_pitches[2];
      m = m - index_of_dim2 * output_pitches[2];
      index_of_dim3 = m;

      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;
      index_of_input_dim2 = index_of_dim2 / scales[2];
      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];
      index_of_input_dim3 = index_of_dim3 / scales[3];
      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];

      input_index = index_of_dim0 * input_pitches[0] +
            index_of_dim1 * input_pitches[1] +
            index_of_input_dim2 * input_pitches[2] +
            index_of_input_dim3;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim2 = false;
      if (index_of_input_dim2 == (${p[0].dims[2]} - 1)) {
        // It's the end in dimension 2
        x01 = x00;
        end_of_dim2 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[2]);
      }

      if (index_of_input_dim3 == (input_pitches[2] - 1)) {
        // It's the end in dimension 3
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);
    }`:`
    ${w}
    float process(int indices[2]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${g}, ${y});

      ${T}

      int m;
      int index_of_dim0, index_of_dim1;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m;

      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;
      index_of_input_dim0 = index_of_dim0 / scales[0];
      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];
      index_of_input_dim1 = index_of_dim1 / scales[1];
      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];

      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim0 = false;
      if (index_of_input_dim0 == (${p[0].dims[0]} - 1)) {
        // It's the end in dimension 0
        x01 = x00;
        end_of_dim0 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[0]);
      }

      if (index_of_input_dim1 == (input_pitches[0] - 1)) {
        // It's the end in dimension 1
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);
    }`;return Object.assign(Object.assign({},h),{output:{dims:l,type:p[0].type,textureType:u.TextureType.unpacked},shaderSource:A,variables:[{name:"scales",type:"int",arrayLength:c.scales.length,data:c.scales.map(S=>Math.ceil(S))}]})};t.validateInputs=(d,p)=>{if(!d||p.opset<9&&d.length!==1||p.opset>=9&&p.opset<11&&d.length!==2||p.opset>=11&&d.length<2)throw new Error("invalid inputs.");if(p.scales.length>0&&d[0].dims.length!==p.scales.length)throw new Error("Invalid input shape.");if(d[0].type==="string")throw new Error("Invalid input tensor types.")},t.scalesValidation=(d,p,c)=>{if(c){for(const o of d)if(o<=0)throw new Error("Scale value should be greater than 0.")}else for(const o of d)if(o<1)throw new Error("Scale value should be greater than or equal to 1.");if(!(p!=="linear"&&p!=="cubic"||d.length===2||d.length===4&&d[0]===1&&d[1]===1))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${c?"Resize":"Upsample"} opeartor.`)}},2757:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProgramManager=void 0;const r=n(2235),a=n(1315),u=n(8897),h=n(6757);t.ProgramManager=class{constructor(f,d,p){this.profiler=f,this.glContext=d,this.textureLayoutStrategy=p,this.repo=new Map,this.attributesBound=!1}getArtifact(f){return this.repo.get(f)}setArtifact(f,d){this.repo.set(f,d)}run(f,d,p){var c;this.profiler.event("op",`ProgramManager.run ${(c=f.programInfo.name)!==null&&c!==void 0?c:"unknown kernel"}`,()=>{var o;const e=this.glContext.gl,s=f.program;e.useProgram(s);try{this.bindOutput(p),this.attributesBound||this.bindAttributes(f.attribLocations),this.bindUniforms(f.uniformLocations,(o=f.programInfo.variables)!==null&&o!==void 0?o:[],d)}catch(l){throw a.Logger.error("ProgramManager",f.programInfo.shaderSource),l}this.profiler.event("backend","GlContext.draw()",()=>{this.glContext.draw()})},this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach(f=>this.glContext.deleteProgram(f.program))}build(f,d,p){return this.profiler.event("backend","ProgramManager.build",()=>{const c=new u.GlslPreprocessor(this.glContext,f,d,p),o=c.preprocess(),e=this.compile(o);return{programInfo:f,program:e,uniformLocations:this.getUniformLocations(e,c.context.programInfo.inputNames,c.context.programInfo.variables),attribLocations:this.getAttribLocations(e)}})}compile(f){if(!this.vertexShader){a.Logger.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");const c=(0,h.getVertexShaderSource)(this.glContext.version);this.vertexShader=this.glContext.compileShader(c,this.glContext.gl.VERTEX_SHADER)}r.env.debug&&a.Logger.verbose("ProrgramManager",`FragShader:
${f}
`);const d=this.glContext.compileShader(f,this.glContext.gl.FRAGMENT_SHADER),p=this.glContext.createProgram(this.vertexShader,d);return this.glContext.deleteShader(d),p}bindOutput(f){const d=f.width,p=f.height;a.Logger.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${d}/${p}, shape=${f.shape}, type=${f.tensor.type}`),this.glContext.attachFramebuffer(f.texture,d,p)}bindAttributes(f){const d=f.position,p=f.textureCoord;this.glContext.setVertexAttributes(d,p),this.attributesBound=!0}bindUniforms(f,d,p){var c;const o=this.glContext.gl;let e=0;for(const{name:s,type:l,location:g,arrayLength:y}of f){const b=(c=d.find(_=>_.name===s))===null||c===void 0?void 0:c.data;if(l!=="sampler2D"&&!b)throw new Error(`variable '${s}' does not have data defined in program info`);switch(l){case"sampler2D":this.bindTexture(p[e],g,e),e++;break;case"float":y?o.uniform1fv(g,b):o.uniform1f(g,b);break;case"int":y?o.uniform1iv(g,b):o.uniform1i(g,b);break;default:throw new Error(`Uniform not implemented: ${l}`)}}}bindTexture(f,d,p){this.glContext.bindTextureToUniform(f.texture,p,d)}getAttribLocations(f){return{position:this.getAttribLocation(f,"position"),textureCoord:this.getAttribLocation(f,"textureCoord")}}getUniformLocations(f,d,p){const c=[];if(d)for(const o of d)c.push({name:o,type:"sampler2D",location:this.getUniformLocation(f,o)});if(p)for(const o of p)c.push(Object.assign(Object.assign({},o),{location:this.getUniformLocation(f,o.name)}));return c}getUniformLocation(f,d){const p=this.glContext.gl.getUniformLocation(f,d);if(p===null)throw new Error(`Uniform ${d} not found.`);return p}getAttribLocation(f,d){return this.glContext.gl.getAttribLocation(f,d)}}},2171:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLSessionHandler=void 0;const r=n(1315),a=n(5881),u=n(7860),h=n(4110),f=n(2757),d=n(7618),p=n(5243);t.WebGLSessionHandler=class{constructor(c,o){this.backend=c,this.context=o,this.layoutStrategy=new d.PreferLogicalStrategy(c.glContext.maxTextureSize),this.programManager=new f.ProgramManager(this.context.profiler,c.glContext,this.layoutStrategy),this.textureManager=new p.TextureManager(c.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:c.textureCacheMode==="full"}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=c.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new u.WebGLInferenceHandler(this)}onGraphInitialized(c){const o=c.getValues().filter(e=>e.from===-1&&e.tensor).map(e=>e.tensor.dataId);this.initializers=new Set(o)}isInitializer(c){return!!this.initializers&&this.initializers.has(c)}addInitializer(c){this.initializers.add(c)}getTextureData(c,o){return o?this.packedTextureDataCache.get(c):this.unpackedTextureDataCache.get(c)}setTextureData(c,o,e=!1){r.Logger.verbose("WebGLSessionHandler","Storing Texture data in cache"),e?this.packedTextureDataCache.set(c,o):this.unpackedTextureDataCache.set(c,o)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(c=>this.textureManager.releaseTexture(c,!0)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(c=>this.textureManager.releaseTexture(c,!0)),this.unpackedTextureDataCache=new Map}resolve(c,o,e){const s=(0,a.resolveOperator)(c,o,h.WEBGL_OP_RESOLVE_RULES);return{impl:s.opImpl,context:s.opInit?s.opInit(c,e):c}}}},9622:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Uint8DataEncoder=t.RGBAFloatDataEncoder=t.RedFloat32DataEncoder=void 0;const r=n(1315);t.RedFloat32DataEncoder=class{constructor(a,u=1){if(u===1)this.internalFormat=a.R32F,this.format=a.RED,this.textureType=a.FLOAT,this.channelSize=u;else{if(u!==4)throw new Error(`Invalid number of channels: ${u}`);this.internalFormat=a.RGBA32F,this.format=a.RGBA,this.textureType=a.FLOAT,this.channelSize=u}}encode(a,u){let h,f;return a.constructor!==Float32Array&&(r.Logger.warning("Encoder","data was not of type Float32; creating new Float32Array"),f=new Float32Array(a)),u*this.channelSize>a.length?(r.Logger.warning("Encoder","Source data too small. Allocating larger array"),f=a,h=this.allocate(u*this.channelSize),f.forEach((d,p)=>h[p]=d)):(f=a,h=f),h}allocate(a){return new Float32Array(4*a)}decode(a,u){return this.channelSize===1?a.filter((h,f)=>f%4==0).subarray(0,u):a.subarray(0,u)}},t.RGBAFloatDataEncoder=class{constructor(a,u=1,h){if(u!==1&&u!==4)throw new Error(`Invalid number of channels: ${u}`);this.internalFormat=a.RGBA,this.format=a.RGBA,this.channelSize=u,this.textureType=h||a.FLOAT}encode(a,u){let h=a;return this.channelSize===1&&(r.Logger.verbose("Encoder","Exploding into a larger array"),h=this.allocate(u),a.forEach((f,d)=>h[4*d]=f)),h}allocate(a){return new Float32Array(4*a)}decode(a,u){return this.channelSize===1?a.filter((h,f)=>f%4==0).subarray(0,u):a.subarray(0,u)}},t.Uint8DataEncoder=class{constructor(a,u=1){if(this.channelSize=4,u===1)this.internalFormat=a.ALPHA,this.format=a.ALPHA,this.textureType=a.UNSIGNED_BYTE,this.channelSize=u;else{if(u!==4)throw new Error(`Invalid number of channels: ${u}`);this.internalFormat=a.RGBA,this.format=a.RGBA,this.textureType=a.UNSIGNED_BYTE,this.channelSize=u}}encode(a,u){return new Uint8Array(a.buffer,a.byteOffset,a.byteLength)}allocate(a){return new Uint8Array(a*this.channelSize)}decode(a,u){if(a instanceof Uint8Array)return a.subarray(0,u);throw new Error(`Invalid array type: ${a.constructor}`)}}},7618:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBatchDim=t.sizeToSquarishShape=t.getRowsCols=t.sizeFromShape=t.isInt=t.parseAxisParam=t.squeezeShape=t.PreferLogicalStrategy=t.AlwaysKeepOriginalSizeStrategy=void 0;const r=n(1315),a=n(7273);function u(c,o){const e=[],s=[],l=o!=null&&Array.isArray(o)&&o.length===0,g=o==null||l?null:h(o,c).sort();let y=0;for(let b=0;b<c.length;++b){if(g!=null){if(g[y]===b&&c[b]!==1)throw new Error(`Can't squeeze axis ${b} since its dim '${c[b]}' is not 1`);(g[y]==null||g[y]>b)&&c[b]===1&&(e.push(c[b]),s.push(b)),g[y]<=b&&y++}c[b]!==1&&(e.push(c[b]),s.push(b))}return{newShape:e,keptDims:s}}function h(c,o){const e=o.length;return c=c==null?o.map((s,l)=>l):[].concat(c),(0,a.assert)(c.every(s=>s>=-e&&s<e),()=>`All values in axis param must be in range [-${e}, ${e}) but got axis ${c}`),(0,a.assert)(c.every(f),()=>`All values in axis param must be integers but got axis ${c}`),c.map(s=>s<0?e+s:s)}function f(c){return c%1==0}function d(c){if(c.length===0)return 1;let o=c[0];for(let e=1;e<c.length;e++)o*=c[e];return o}function p(c){const o=Math.ceil(Math.sqrt(c));return[o,Math.ceil(c/o)]}t.AlwaysKeepOriginalSizeStrategy=class{constructor(c){this.maxTextureSize=c}computeTextureWH(c,o){if(c.length===0)return[1,1];const e=this.maxTextureSize;if(o&&o.breakAxis!==void 0){const g=o.breakAxis>=c.length?1:c.slice(o.breakAxis).reduce((b,_)=>b*_),y=o.breakAxis<=0?1:c.slice(0,o.breakAxis).reduce((b,_)=>b*_);if(!(g>e||y>e))return[g,y];r.Logger.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${c}, breakAxis:${o.breakAxis}`)}const s=c.reduce((g,y)=>g*y);let l=Math.floor(Math.sqrt(s));for(;l<e&&l<s&&s%l!=0;l++);if(l>=e||s%l!=0)throw new Error(`The given dimensions are outside this GPU's boundaries: ${c}`);return[l,s/l]}},t.PreferLogicalStrategy=class{constructor(c){this.maxTextureSize=c}computeTextureWH(c,o){const e=this.computeTexture(c,o);return o&&o.isPacked&&(e[0]/=2,e[1]/=2),o&&o.reverseWH?[e[1],e[0]]:e}computeTexture(c,o){const e=o&&o.isPacked;if(c.length===0)return e?[2,2]:[1,1];let s=this.maxTextureSize;if(o&&o.breakAxis!==void 0){const y=o.breakAxis>=c.length?1:c.slice(o.breakAxis).reduce((_,v)=>_*v),b=o.breakAxis<=0?1:c.slice(0,o.breakAxis).reduce((_,v)=>_*v);if(!(y>s||b>s))return[y,b];r.Logger.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${c}, breakAxis:${o.breakAxis}`)}let l=c.slice(0);e&&(s*=2,l=l.map((y,b)=>b>=l.length-2?l[b]%2==0?l[b]:l[b]+1:l[b]),l.length===1&&(l=[2,l[0]])),l.length!==2&&(l=u(l).newShape);const g=d(l);return l.length<=1&&g<=s?[1,g]:l.length===2&&l[0]<=s&&l[1]<=s?l:l.length===3&&l[0]*l[1]<=s&&l[2]<=s?[l[0]*l[1],l[2]]:l.length===3&&l[0]<=s&&l[1]*l[2]<=s?[l[0],l[1]*l[2]]:l.length===4&&l[0]*l[1]*l[2]<=s&&l[3]<=s?[l[0]*l[1]*l[2],l[3]]:l.length===4&&l[0]<=s&&l[1]*l[2]*l[3]<=s?[l[0],l[1]*l[2]*l[3]]:e?p(g/4).map(y=>2*y):p(g)}},t.squeezeShape=u,t.parseAxisParam=h,t.isInt=f,t.sizeFromShape=d,t.getRowsCols=function(c){if(c.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[c.length>1?c[c.length-2]:1,c[c.length-1]]},t.sizeToSquarishShape=p,t.getBatchDim=function(c,o=2){return d(c.slice(0,c.length-o))}},3314:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTextureLayoutFromShape=t.calculateTextureWidthAndHeight=t.createTextureLayoutFromTextureType=void 0;const r=n(7273),a=n(5639);t.createTextureLayoutFromTextureType=(u,h,f)=>{const d=f===a.TextureType.unpacked||f===a.TextureType.unpackedReversed?1:4,p=f===a.TextureType.packed,c=f===a.TextureType.unpackedReversed||f===a.TextureType.packed,o=f===a.TextureType.packedLastDimension?h.length-1:void 0,e=f===a.TextureType.packedLastDimension?h.map((s,l)=>l===h.length-1?4*s:s):void 0;return(0,t.createTextureLayoutFromShape)(u,h,d,e,{isPacked:p,reverseWH:c,breakAxis:o})},t.calculateTextureWidthAndHeight=(u,h,f)=>{const d=(0,t.createTextureLayoutFromTextureType)(u,h,f);return[d.width,d.height]},t.createTextureLayoutFromShape=(u,h,f=1,d,p)=>{const c=!(!p||!p.isPacked),[o,e]=u.computeTextureWH(c&&d||h,p),s=h.length;let l=h.slice(0);if(s===0&&(l=[1]),f===1)d=h;else if(c){if(f!==4)throw new Error("a packed texture must be 4-channel");d=h,s>0&&(l[s-1]=Math.ceil(l[s-1]/2)),s>1&&(l[s-2]=Math.ceil(l[s-2]/2))}else if(!d)throw new Error("Unpacked shape is needed when using channels > 1");return{width:o,height:e,channels:f,isPacked:c,shape:l,strides:r.ShapeUtil.computeStrides(l),unpackedShape:d,reversedWH:p&&p.reverseWH}}},5243:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextureManager=void 0;const r=n(1315);t.TextureManager=class{constructor(a,u,h,f){this.glContext=a,this.layoutStrategy=u,this.profiler=h,this.config=f,this.pendingRead=new Map,f.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(a,u,h,f){const d=this.toEncoderType(a),p=this.glContext.getEncoder(d,u.channels||1,f);if(u.isPacked&&f===1)throw new Error("not implemented");const c=u.width,o=u.height;let e,s;if(this.config.reuseTextures){e=`${c}x${o}_${p.format}_${p.internalFormat}_${p.textureType}`,s=this.inUseTextures.get(e),s||(s=[],this.inUseTextures.set(e,s));const g=this.idleTextures.get(e);if(g&&g.length>0){const y=g.pop();return s.push(y),f===1&&this.glContext.updateTexture(y,c,o,p,this.toTextureData(a,h)),y}}r.Logger.verbose("TextureManager",`Creating new texture of size ${u.width}x${u.height}`);const l=this.glContext.allocateTexture(c,o,p,this.toTextureData(a,h));return this.config.reuseTextures&&(s.push(l),this.textureLookup.set(l,e)),l}readTexture(a,u,h){return h||(h=1),this.profiler.event("backend","TextureManager.readTexture",()=>{const f=a.shape.reduce((p,c)=>p*c)*h,d=this.glContext.readTexture(a.texture,a.width,a.height,f,this.toEncoderType(u),h);return this.toTensorData(u,d)})}async readTextureAsync(a,u,h){const f=a.tensor.dataId;if(h||(h=1),this.pendingRead.has(f)){const d=this.pendingRead.get(f);return new Promise(p=>d==null?void 0:d.push(p))}return this.profiler.event("backend","TextureManager.readTextureAsync",async()=>{this.pendingRead.set(f,[]);const d=a.shape.reduce((e,s)=>e*s)*h;await this.glContext.createAndWaitForFence();const p=this.glContext.readTexture(a.texture,a.width,a.height,d,this.toEncoderType(u),h),c=this.toTensorData(u,p),o=this.pendingRead.get(f);return this.pendingRead.delete(f),o==null||o.forEach(e=>e(c)),c})}readUint8TextureAsFloat(a){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",()=>{const u=a.shape.reduce((f,d)=>f*d),h=this.glContext.readTexture(a.texture,a.width,a.height,4*u,"byte",4);return new Float32Array(h.buffer,h.byteOffset,u)})}releaseTexture(a,u){let h;if(this.config.reuseTextures&&(h=this.textureLookup.get(a.texture),h)){u&&this.textureLookup.delete(h);const f=this.inUseTextures.get(h);if(f){const d=f.indexOf(a.texture);if(d!==-1){f.splice(d,1);let p=this.idleTextures.get(h);p||(p=[],this.idleTextures.set(h,p)),p.push(a.texture)}}}h&&!u||(r.Logger.verbose("TextureManager",`Deleting texture of size ${a.width}x${a.height}`),this.glContext.deleteTexture(a.texture))}toTensorData(a,u){switch(a){case"int16":return u instanceof Int16Array?u:Int16Array.from(u);case"int32":return u instanceof Int32Array?u:Int32Array.from(u);case"int8":return u instanceof Int8Array?u:Int8Array.from(u);case"uint16":return u instanceof Uint16Array?u:Uint16Array.from(u);case"uint32":return u instanceof Uint32Array?u:Uint32Array.from(u);case"uint8":case"bool":return u instanceof Uint8Array?u:Uint8Array.from(u);case"float32":return u instanceof Float32Array?u:Float32Array.from(u);case"float64":return u instanceof Float64Array?u:Float64Array.from(u);default:throw new Error(`TensorData type ${a} is not supported`)}}toTextureData(a,u){if(u)return u instanceof Float32Array?u:new Float32Array(u)}toEncoderType(a){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}},5639:(m,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TextureType=void 0,(n=t.TextureType||(t.TextureType={}))[n.unpacked=0]="unpacked",n[n.unpackedReversed=1]="unpackedReversed",n[n.packed=2]="packed",n[n.downloadUint8AsFloat=3]="downloadUint8AsFloat",n[n.packedLastDimension=4]="packedLastDimension"},432:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGlChannels=t.getCoordsDataType=t.getSqueezedParams=t.squeezeInputShape=t.generateShaderFuncNameFromInputSamplerNameAtOutCoords=t.generateShaderFuncNameFromInputSamplerName=t.repeatedTry=t.getPackedShape=void 0;const r=n(7273);t.getPackedShape=function(a){const u=a.length;return a.slice(0,u-1).concat(a[u-1]/4)},t.repeatedTry=async function(a,u=f=>0,h){return new Promise((f,d)=>{let p=0;const c=()=>{if(a())return void f();p++;const o=u(p);h!=null&&p>=h?d():setTimeout(c,o)};c()})},t.generateShaderFuncNameFromInputSamplerName=function(a){return(0,r.assert)(a!==void 0&&a.length!==0,()=>"empty string found for sampler name"),"get"+a.charAt(0).toUpperCase()+a.slice(1)},t.generateShaderFuncNameFromInputSamplerNameAtOutCoords=function(a){return(0,r.assert)(a!==void 0&&a.length!==0,()=>"empty string found for sampler name"),"get"+a.charAt(0).toUpperCase()+a.slice(1)+"AtOutCoords"},t.squeezeInputShape=function(a,u){let h=JSON.parse(JSON.stringify(a));return h=u,h},t.getSqueezedParams=function(a,u){return u.map(h=>a[h]).join(", ")},t.getCoordsDataType=function(a){if(a<=1)return"int";if(a===2)return"ivec2";if(a===3)return"ivec3";if(a===4)return"ivec4";if(a===5)return"ivec5";if(a===6)return"ivec6";throw Error(`GPU for rank ${a} is not yet supported`)},t.getGlChannels=function(a=6){return["x","y","z","w","u","v"].slice(0,a)}},3389:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNewWebGLContext=t.createWebGLContext=void 0;const r=n(1315),a=n(3524),u={};function h(f,d){let p;const c={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1};if((!d||d==="webgl2")&&(p=f.getContext("webgl2",c),p))try{return new a.WebGLContext(p,2)}catch(o){r.Logger.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${o}`)}if((!d||d==="webgl")&&(p=f.getContext("webgl",c)||f.getContext("experimental-webgl",c),p))try{return new a.WebGLContext(p,1)}catch(o){r.Logger.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${o}`)}throw new Error("WebGL is not supported")}t.createWebGLContext=function f(d){let p;if(d&&d!=="webgl2"||!("webgl2"in u)?d&&d!=="webgl"||!("webgl"in u)||(p=u.webgl):p=u.webgl2,!p)try{p=h(function(){if(typeof OffscreenCanvas>"u")throw new TypeError("failed to create offscreen canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}(),d)}catch{p=h(function(){if(typeof document>"u")throw new TypeError("failed to create canvas: document is not supported");const e=document.createElement("canvas");return e.width=1,e.height=1,e}(),d)}d=d||p.version===1?"webgl":"webgl2";const c=p.gl;return u[d]=p,c.isContextLost()?(delete u[d],f(d)):(c.disable(c.DEPTH_TEST),c.disable(c.STENCIL_TEST),c.disable(c.BLEND),c.disable(c.DITHER),c.disable(c.POLYGON_OFFSET_FILL),c.disable(c.SAMPLE_COVERAGE),c.enable(c.SCISSOR_TEST),c.enable(c.CULL_FACE),c.cullFace(c.BACK),p)},t.createNewWebGLContext=h},3524:function(m,t,n){var r=this&&this.__createBinding||(Object.create?function(c,o,e,s){s===void 0&&(s=e);var l=Object.getOwnPropertyDescriptor(o,e);l&&!("get"in l?!o.__esModule:l.writable||l.configurable)||(l={enumerable:!0,get:function(){return o[e]}}),Object.defineProperty(c,s,l)}:function(c,o,e,s){s===void 0&&(s=e),c[s]=o[e]}),a=this&&this.__setModuleDefault||(Object.create?function(c,o){Object.defineProperty(c,"default",{enumerable:!0,value:o})}:function(c,o){c.default=o}),u=this&&this.__importStar||function(c){if(c&&c.__esModule)return c;var o={};if(c!=null)for(var e in c)e!=="default"&&Object.prototype.hasOwnProperty.call(c,e)&&r(o,c,e);return a(o,c),o};Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLContext=t.linearSearchLastTrue=void 0;const h=n(2235),f=u(n(9622)),d=n(432);function p(c){let o=0;for(;o<c.length&&c[o]();++o);return o-1}t.linearSearchLastTrue=p,t.WebGLContext=class{constructor(c,o){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=c,this.version=o,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(c,o,e,s){const l=this.gl,g=l.createTexture();l.bindTexture(l.TEXTURE_2D,g),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE);const y=s?e.encode(s,c*o):null;return l.texImage2D(l.TEXTURE_2D,0,e.internalFormat,c,o,0,e.format,e.textureType,y),this.checkError(),g}updateTexture(c,o,e,s,l){const g=this.gl;g.bindTexture(g.TEXTURE_2D,c);const y=s.encode(l,o*e);g.texSubImage2D(g.TEXTURE_2D,0,0,0,o,e,s.format,s.textureType,y),this.checkError()}attachFramebuffer(c,o,e){const s=this.gl;s.bindTexture(s.TEXTURE_2D,c),s.bindFramebuffer(s.FRAMEBUFFER,this.framebuffer),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,c,0),this.checkError(),s.viewport(0,0,o,e),s.scissor(0,0,o,e)}readTexture(c,o,e,s,l,g){const y=this.gl;g||(g=1),this.frameBufferBound||this.attachFramebuffer(c,o,e);const b=this.getEncoder(l,g),_=b.allocate(o*e);return y.bindTexture(y.TEXTURE_2D,c),y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,c,0),y.readPixels(0,0,o,e,y.RGBA,b.textureType,_),this.checkError(),b.decode(_,s)}isFramebufferReady(){return!0}getActiveTexture(){const c=this.gl;return"TEXTURE"+(c.getParameter(this.gl.ACTIVE_TEXTURE)-c.TEXTURE0)}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(c,o){const e=this.gl;e.vertexAttribPointer(c,3,e.FLOAT,!1,20,0),e.enableVertexAttribArray(c),o!==-1&&(e.vertexAttribPointer(o,2,e.FLOAT,!1,20,12),e.enableVertexAttribArray(o)),this.checkError()}createProgram(c,o){const e=this.gl,s=e.createProgram();return e.attachShader(s,c),e.attachShader(s,o),e.linkProgram(s),s}compileShader(c,o){const e=this.gl,s=e.createShader(o);if(!s)throw new Error(`createShader() returned null with type ${o}`);if(e.shaderSource(s,c),e.compileShader(s),e.getShaderParameter(s,e.COMPILE_STATUS)===!1)throw new Error(`Failed to compile shader: ${e.getShaderInfoLog(s)}
Shader source:
${c}`);return s}deleteShader(c){this.gl.deleteShader(c)}bindTextureToUniform(c,o,e){const s=this.gl;s.activeTexture(s.TEXTURE0+o),this.checkError(),s.bindTexture(s.TEXTURE_2D,c),this.checkError(),s.uniform1i(e,o),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(h.env.debug){const c=this.gl,o=c.getError();let e="";switch(o){case c.NO_ERROR:return;case c.INVALID_ENUM:e="INVALID_ENUM";break;case c.INVALID_VALUE:e="INVALID_VALUE";break;case c.INVALID_OPERATION:e="INVALID_OPERATION";break;case c.INVALID_FRAMEBUFFER_OPERATION:e="INVALID_FRAMEBUFFER_OPERATION";break;case c.OUT_OF_MEMORY:e="OUT_OF_MEMORY";break;case c.CONTEXT_LOST_WEBGL:e="CONTEXT_LOST_WEBGL";break;default:e=`Unknown WebGL Error: ${o.toString(16)}`}throw new Error(e)}}deleteTexture(c){this.gl.deleteTexture(c)}deleteProgram(c){this.gl.deleteProgram(c)}getEncoder(c,o,e=0){if(this.version===2)return new f.RedFloat32DataEncoder(this.gl,o);switch(c){case"float":return e===1||this.isRenderFloat32Supported?new f.RGBAFloatDataEncoder(this.gl,o):new f.RGBAFloatDataEncoder(this.gl,o,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new f.Uint8DataEncoder(this.gl,o);default:throw new Error(`Invalid dataType: ${c}`)}}clearActiveTextures(){const c=this.gl;for(let o=0;o<this.maxTextureImageUnits;++o)c.activeTexture(c.TEXTURE0+o),c.bindTexture(c.TEXTURE_2D,null)}dispose(){if(this.disposed)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,null),c.deleteFramebuffer(this.framebuffer),c.bindBuffer(c.ARRAY_BUFFER,null),c.deleteBuffer(this.vertexbuffer),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,null),c.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){const c=this.gl,o=c.createBuffer();if(!o)throw new Error("createBuffer() returned null");const e=this.createDefaultGeometry();return c.bindBuffer(c.ARRAY_BUFFER,o),c.bufferData(c.ARRAY_BUFFER,e,c.STATIC_DRAW),this.checkError(),o}createFramebuffer(){const c=this.gl.createFramebuffer();if(!c)throw new Error("createFramebuffer returned null");return c}queryVitalParameters(){const c=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),this.version===1&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){this.version===2?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){const c=this.gl,o=c.createTexture();c.bindTexture(c.TEXTURE_2D,o);const e=this.version===2?c.RGBA32F:c.RGBA;c.texImage2D(c.TEXTURE_2D,0,e,1,1,0,c.RGBA,c.FLOAT,null);const s=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,s),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o,0);const l=c.checkFramebufferStatus(c.FRAMEBUFFER)===c.FRAMEBUFFER_COMPLETE;return c.bindTexture(c.TEXTURE_2D,null),c.bindFramebuffer(c.FRAMEBUFFER,null),c.deleteTexture(o),c.deleteFramebuffer(s),l}checkRenderFloat32(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){const c=this.gl;let o,e,s,l,g;try{o=c.createTexture(),e=c.createFramebuffer(),c.bindTexture(c.TEXTURE_2D,o);const y=this.version===2?c.RGBA32F:c.RGBA;return c.texImage2D(c.TEXTURE_2D,0,y,1,1,0,c.RGBA,c.FLOAT,null),c.bindFramebuffer(c.FRAMEBUFFER,e),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o,0),c.enable(c.BLEND),s=c.createShader(c.VERTEX_SHADER),!!s&&(c.shaderSource(s,"void main(){}"),c.compileShader(s),l=c.createShader(c.FRAGMENT_SHADER),!!l&&(c.shaderSource(l,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),c.compileShader(l),g=c.createProgram(),!!g&&(c.attachShader(g,s),c.attachShader(g,l),c.linkProgram(g),c.useProgram(g),c.drawArrays(c.POINTS,0,1),c.getError()===c.NO_ERROR)))}finally{c.disable(c.BLEND),g&&c.deleteProgram(g),s&&c.deleteShader(s),l&&c.deleteShader(l),e&&(c.bindFramebuffer(c.FRAMEBUFFER,null),c.deleteFramebuffer(e)),o&&(c.bindTexture(c.TEXTURE_2D,null),c.deleteTexture(o))}}beginTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){const c=this.gl,o=this.disjointTimerQueryWebgl2Extension,e=c.createQuery();return c.beginQuery(o.TIME_ELAPSED_EXT,e),e}throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(this.version!==2||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{const c=this.gl,o=this.disjointTimerQueryWebgl2Extension;c.endQuery(o.TIME_ELAPSED_EXT)}}isTimerResultAvailable(c){let o=!1,e=!1;if(this.version!==2||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{const s=this.gl,l=this.disjointTimerQueryWebgl2Extension;o=s.getQueryParameter(c,s.QUERY_RESULT_AVAILABLE),e=s.getParameter(l.GPU_DISJOINT_EXT)}return o&&!e}getTimerResult(c){let o=0;if(this.version!==2)throw new Error("WebGL1 profiling currently not supported");{const e=this.gl;o=e.getQueryParameter(c,e.QUERY_RESULT),e.deleteQuery(c)}return o/1e6}async waitForQueryAndGetTime(c){return await(0,d.repeatedTry)(()=>this.isTimerResultAvailable(c)),this.getTimerResult(c)}async createAndWaitForFence(){const c=this.createFence(this.gl);return this.pollFence(c)}createFence(c){let o;const e=c,s=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return c.flush(),o=s===null?()=>!0:()=>{const l=e.clientWaitSync(s,0,0);return l===e.ALREADY_SIGNALED||l===e.CONDITION_SATISFIED},{query:s,isFencePassed:o}}async pollFence(c){return new Promise(o=>{this.addItemToPoll(()=>c.isFencePassed(),()=>o())})}pollItems(){const c=p(this.itemsToPoll.map(o=>o.isDoneFn));for(let o=0;o<=c;++o){const{resolveFn:e}=this.itemsToPoll[o];e()}this.itemsToPoll=this.itemsToPoll.slice(c+1)}async addItemToPoll(c,o){this.itemsToPoll.push({isDoneFn:c,resolveFn:o}),this.itemsToPoll.length>1||await(0,d.repeatedTry)(()=>(this.pollItems(),this.itemsToPoll.length===0))}}},6496:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExecutionPlan=void 0;const r=n(1315);class a{constructor(h,f){this.op=h,this.node=f}}t.ExecutionPlan=class{constructor(u,h,f){this.graph=u,this.profiler=f,this.initialize(h)}initialize(u){this.profiler.event("session","ExecutionPlan.initialize",()=>{const h=this.graph.getNodes();if(h.length!==u.length)throw new Error("The size of nodes and OPs do not match.");this._ops=u.map((f,d)=>new a(f,h[d])),this.reset(),this._starter=[],this._ops.forEach((f,d)=>{let p=!0;for(const c of f.node.inputs)if(!this._values[c]&&this.graph.getInputIndices().indexOf(c)===-1){p=!1;break}p&&this._starter.push(d)})})}reset(){this._values=this.graph.getValues().map(u=>u.tensor)}async execute(u,h){return this.profiler.event("session","ExecutionPlan.execute",async()=>{this.reset();const f=u.createInferenceHandler(),d=this.graph.getInputIndices();if(h.length!==d.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${h.length} expected: ${d.length}`);h.forEach((l,g)=>{const y=d[g];this._values[y]=l});const p=this._starter.slice(0),c=this.graph.getValues(),o=this.graph.getNodes();let e=0;for(;e<p.length;){const l=p[e++],g=this._ops[l],y=g.node.inputs.map(T=>this._values[T]);if(y.indexOf(void 0)!==-1)throw new Error(`unresolved input detected: op: ${g.node}`);const b=y;r.Logger.verbose("ExecPlan",`Runing op:${g.node.name} (${b.map((T,w)=>`'${g.node.inputs[w]}': ${T.type}[${T.dims.join(",")}]`).join(", ")})`);const _=await this.profiler.event("node",g.node.name,async()=>g.op.impl(f,b,g.op.context));if(_.length!==g.node.outputs.length)throw new Error("the size of output does not match model definition.");_.forEach((T,w)=>{const A=g.node.outputs[w];if(this._values[A])throw new Error(`output [${A}] already has value: op:${g.node.name}`);this._values[A]=T});const v=new Set;_.forEach((T,w)=>{const A=g.node.outputs[w];for(const S of c[A].to){const O=o[S];let C=!0;for(const D of O.inputs)if(!this._values[D]){C=!1;break}C&&v.add(S)}}),p.push(...v)}const s=[];for(let l=0;l<this.graph.getOutputIndices().length;l++){const g=this.graph.getOutputIndices()[l],y=this._values[g];if(y===void 0)throw new Error(`required output [${g}] does not have value`);g===0?await y.getData():y.data,s.push(y)}return r.Logger.verbose("ExecPlan","disposing of inferenceHandler"),f.dispose(),s})}}},4662:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Graph=void 0;const r=n(6874),a=n(5127),u=n(2446),h=n(9240),f=n(7273);var d=a.onnxruntime.experimental.fbs;t.Graph={from:(e,s)=>new o(e,s)};class p{constructor(s){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,s&&(this.type=f.ProtoUtil.tensorValueTypeFromProto(s.type.tensorType))}get from(){return this._from}get to(){return this._to}}class c{constructor(s,l){s instanceof u.onnx.NodeProto?(this.name=s.name,this.opType=s.opType,this.attributes=new r.Attribute(s.attribute)):s instanceof d.Node&&(this.name=l??s.name(),this.opType=s.opType(),this.attributes=new r.Attribute(f.ProtoUtil.tensorAttributesFromORTFormat(s))),this.inputs=[],this.outputs=[],this.executeNode=!0}}class o{constructor(s,l){if(!s)throw new TypeError("graph is empty");this.buildGraph(s),this.transformGraph(l),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(s){if(s instanceof u.onnx.GraphProto)this.buildGraphFromOnnxFormat(s);else{if(!(s instanceof d.Graph))throw new TypeError("Graph type is not supported.");this.buildGraphFromOrtFormat(s)}}buildGraphFromOnnxFormat(s){const l=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];const g=new Map;if(!s.input)throw new Error("missing information in graph: input");const y=[];for(const b of s.input){if(l.has(b.name))throw new Error(`duplicated input name: ${b.name}`);const _=this._allData.push(new p(b))-1;l.set(b.name,_),y.push(b.name)}if(!s.initializer)throw new Error("missing information in graph: initializer");for(const b of s.initializer){let _=l.get(b.name);if(_===void 0){const v=new p;v.type={shape:{dims:f.ProtoUtil.tensorDimsFromProto(b.dims)},tensorType:f.ProtoUtil.tensorDataTypeFromProto(b.dataType)},_=this._allData.push(v)-1,l.set(b.name,_)}this._allData[_]._from=-1,this._allData[_].tensor=h.Tensor.fromProto(b)}for(let b=0;b<this._allData.length;b++)this._allData[b].tensor||(this._allInputIndices.push(b),this._allInputNames.push(y[b]));if(!s.output)throw new Error("missing information in graph: output");for(const b of s.output){if(l.has(b.name))throw new Error(`duplicated output name: ${b.name}`);const _=this._allData.push(new p(b))-1;l.set(b.name,_),this._allOutputIndices.push(_),this._allOutputNames.push(b.name)}if(!s.node)throw new Error("missing information in graph: node");for(const b of s.node){if(!b.name)for(let v=0;;v++){const T=`unnamed_${b.opType}_${v}`;if(!g.has(T)){b.name=T;break}}if(g.has(b.name))throw new Error(`duplicated node name: ${b.name}`);const _=this._nodes.push(new c(b))-1;g.set(b.name,_)}for(let b=0;b<this._nodes.length;b++){const _=this._nodes[b],v=s.node[b];if(!v.output)throw new Error(`missing output for node: ${v.name}`);for(const T of v.output){let w=l.get(T);if(w===void 0&&(w=this._allData.push(new p)-1,l.set(T,w)),_.outputs.push(w),this._allData[w]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${w}`);if(this._allData[w]._from=b,v.opType==="Constant"){if(!v.attribute||v.attribute.length!==1||!v.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!v.output||v.output.length!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");_.outputs.pop(),_.executeNode=!1,this._allData[w]._from=-1,this._allData[w].tensor=h.Tensor.fromProto(v.attribute[0].t)}}}for(let b=0;b<this._nodes.length;b++){const _=this._nodes[b],v=s.node[b];if(!v.input)throw new Error(`missing input for node: ${v.name}`);for(const T of v.input){const w=l.get(T);if(w===void 0){if(T===""&&(v.input.length===3||v.input.length===4)&&v.opType==="Resize")continue;throw new Error(`unrecognized input '${T}' for node: ${v.name}`)}_.inputs.push(w),this._allData[w]._to.push(b)}}return!0}buildGraphFromOrtFormat(s){var l,g,y;const b=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];const _=new Map,v=[];for(let T=0;T<s.inputsLength();T++){const w=s.inputs(T);if(b.has(w))throw new Error(`duplicated input name: ${w}`);for(let A=0;A<s.nodeArgsLength();A++)if(((l=s.nodeArgs(A))===null||l===void 0?void 0:l.name())===w){const S=new p;if(((y=(g=s.nodeArgs(A))===null||g===void 0?void 0:g.type())===null||y===void 0?void 0:y.valueType())!==d.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");const O=s.nodeArgs(A).type().value(new d.TensorTypeAndShape),C=f.ProtoUtil.tensorDataTypeFromProto(O.elemType()),D=O.shape(),$=[];for(let P=0;P<D.dimLength();P++)$.push(f.LongUtil.longToNumber(D.dim(P).value().dimValue()));S.type={shape:{dims:$},tensorType:C};const L=this._allData.push(S)-1;b.set(w,L),v.push(w)}}for(let T=0;T<s.initializersLength();T++){const w=s.initializers(T);let A=b.get(w.name());if(A===void 0){const S=new p,O=f.ProtoUtil.tensorDimsFromORTFormat(w),C=f.ProtoUtil.tensorDataTypeFromProto(w.dataType());S.type={shape:{dims:O},tensorType:C},A=this._allData.push(S)-1,b.set(w.name(),A)}this._allData[A]._from=-1,this._allData[A].tensor=h.Tensor.fromOrtTensor(w)}for(let T=0;T<this._allData.length;T++)this._allData[T].tensor||(this._allInputIndices.push(T),this._allInputNames.push(v[T]));for(let T=0;T<s.outputsLength();T++){const w=s.outputs(T);if(b.has(w))throw new Error(`duplicated output name: ${w}`);const A=this._allData.push(new p)-1;b.set(w,A),this._allOutputIndices.push(A),this._allOutputNames.push(w)}if(!s.nodes)throw new Error("missing information in graph: node");for(let T=0;T<s.nodesLength();T++){const w=s.nodes(T);let A=w.name();if(!A)for(let O=0;A=`unnamed_${w.opType()}_${O}`,_.has(A);O++);if(_.has(A))throw new Error(`duplicated node name: ${A}`);const S=this._nodes.push(new c(w,A))-1;_.set(A,S)}for(let T=0;T<this._nodes.length;T++){const w=this._nodes[T],A=s.nodes(T);if(A==null)throw new Error(`No node exists at index ${T}`);if((A==null?void 0:A.outputsLength())===0)throw new Error(`missing output for node: ${A.name}`);for(let S=0;S<(A==null?void 0:A.outputsLength());S++){const O=A==null?void 0:A.outputs(S);let C=b.get(O);if(C===void 0&&(C=this._allData.push(new p)-1,b.set(O,C)),w.outputs.push(C),this._allData[C]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${C}`);if(this._allData[C]._from=T,A.opType()==="Constant"){if(A.attributesLength()!==1||!A.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(A.outputsLength()!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");w.outputs.pop(),w.executeNode=!1,this._allData[C]._from=-1,this._allData[C].tensor=h.Tensor.fromOrtTensor(A.attributes(0).t())}}}for(let T=0;T<this._nodes.length;T++){const w=this._nodes[T],A=s.nodes(T);if(A.inputsLength()===0)throw new Error(`missing input for node: ${A.name}`);for(let S=0;S<A.inputsLength();S++){const O=A.inputs(S),C=b.get(O);if(C===void 0)throw new Error(`unrecognized input '${O}' for node: ${A.name()}`);w.inputs.push(C),this._allData[C]._to.push(T)}}}checkIsAcyclic(){const s=new Set;this._allInputIndices.forEach(y=>{this._allData[y]._to.forEach(b=>{s.add(b)})});const l=Array.from(s),g=new Array(this._nodes.length).fill("white");for(;l.length>0;){const y=l.pop();g[y]==="gray"?g[y]="black":(l.push(y),g[y]="gray",this._nodes[y].outputs.forEach(b=>{const _=this._allData[b];if(_.tensor!==void 0)throw new Error("node outputs should not be initialized");if(_._from!==y)throw new Error("from property of the Value object doesn't match index of Node being processed");_._to.forEach(v=>{if(g[v]==="gray")throw new Error("model graph is cyclic");g[v]==="white"&&l.push(v)})}))}}transformGraph(s){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),s&&s.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let s=0;const l=new Array(this._nodes.length,0);let g=0;for(let y=0;y<this._nodes.length;y++)l[y]=g,this._nodes[y].executeNode?(g!==y&&(this._nodes[g]=this._nodes[y]),g++):this._nodes[y].outputs.forEach(b=>{this._allData[b]._from=-2});this._nodes.splice(g,this._nodes.length-g);for(let y=0;y<this._allData.length;y++){const b=this._allData[y];b._from!==void 0&&b._from!==-1&&b._from!==-2&&(b._from=l[b._from]);for(let _=0;_<b._to.length;_++){if(!(b._to[_]>=0))throw new Error("Trying to update a removed node");b._to[_]=l[b._to[_]]}}s=0;for(let y=0;y<this._allData.length;y++)if(this._allData[y].from!==-2||this._allOutputIndices.indexOf(y+s)!==-1){if(s>0){let b=-1;this._allData[y].from!==void 0&&this._allData[y].from!==-1?(b=this._nodes[this._allData[y].from].outputs.indexOf(y+s),b!==-1&&(this._nodes[this._allData[y].from].outputs[b]=y)):(b=this._allInputIndices.indexOf(y+s),b!==-1&&(this._allInputIndices[b]=y)),this._allData[y].to.forEach(_=>{b=this._nodes[_].inputs.indexOf(y+s),b!==-1&&(this._nodes[_].inputs[b]=y)}),this._allData[y].to.length===0&&(b=this._allOutputIndices.indexOf(y+s),b!==-1&&(this._allOutputIndices[b]=y))}}else s++,this._allData.splice(y,1),y--}deleteNode(s){const l=this._nodes[s];if(l.outputs.length>1){for(let v=1;v<l.outputs.length;v++)if(this._allData[l.outputs[v]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ")}l.executeNode=!1;const g=l.inputs[0],y=l.outputs[0],b=this._allData[y].to;for(let v=0;v<l.inputs.length;v++){const T=this._allData[l.inputs[v]].to.indexOf(s);if(T===-1)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[l.inputs[v]].to.splice(T,1)}this._allData[y]._to=[];const _=this._allOutputIndices.indexOf(y);if(_!==-1&&(this._allOutputIndices[_]=g),b&&b.length>0)for(const v of b){const T=this._nodes[v].inputs.indexOf(y);if(T===-1)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[v].inputs[T]=g,this._allData[g].to.push(v)}}removeAllDropoutNodes(){let s=0;for(const l of this._nodes){if(l.opType==="Dropout"){if(l.inputs.length!==1)throw new Error("Dropout nodes should only contain one input. ");if(l.outputs.length!==1&&l.outputs.length!==2)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(l.outputs.length===2&&this._allData[l.outputs[1]]._to.length!==0)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(s)}s++}}removeAllIdentityNodes(){let s=0;for(const l of this._nodes)l.opType==="Identity"&&this.deleteNode(s),s++}isActivation(s){switch(s.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(const s of this._nodes)if(s.opType==="Conv"){const l=this._allData[s.outputs[0]]._to;if(l.length===1&&this.isActivation(this._nodes[l[0]])){const g=this._nodes[l[0]];if(g.opType==="Clip")if(g.inputs.length===1)try{s.attributes.set("activation_params","floats",[g.attributes.getFloat("min"),g.attributes.getFloat("max")])}catch{s.attributes.set("activation_params","floats",[f.MIN_CLIP,f.MAX_CLIP])}else{if(!(g.inputs.length>=3&&this._allData[g.inputs[1]].tensor!==void 0&&this._allData[g.inputs[2]].tensor!==void 0))continue;s.attributes.set("activation_params","floats",[this._allData[g.inputs[1]].tensor.floatData[0],this._allData[g.inputs[2]].tensor.floatData[0]])}s.attributes.set("activation","string",g.opType),this.deleteNode(l[0])}}}}},1315:(m,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.Profiler=t.Logger=void 0;const n={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},r={none:new class{log(c,o,e){}},console:new class{log(c,o,e){console.log(`${this.color(c)} ${e?"\x1B[35m"+e+"\x1B[0m ":""}${o}`)}color(c){switch(c){case"verbose":return"\x1B[34;40mv\x1B[0m";case"info":return"\x1B[32mi\x1B[0m";case"warning":return"\x1B[30;43mw\x1B[0m";case"error":return"\x1B[31;40me\x1B[0m";case"fatal":return"\x1B[101mf\x1B[0m";default:throw new Error(`unsupported severity: ${c}`)}}}},a={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1};let u={"":a};function h(c,o,e,s){if(o===void 0)return l=c,{verbose:h.verbose.bind(null,l),info:h.info.bind(null,l),warning:h.warning.bind(null,l),error:h.error.bind(null,l),fatal:h.fatal.bind(null,l)};if(e===void 0)f(c,o);else if(typeof e=="number"&&s===void 0)f(c,o);else if(typeof e=="string"&&s===void 0)f(c,e,0,o);else{if(typeof e!="string"||typeof s!="number")throw new TypeError("input is valid");f(c,e,0,o)}var l}function f(c,o,e,s){const l=u[s||""]||u[""];n[c]<n[l.minimalSeverity]||(l.logDateTime&&(o=`${new Date().toISOString()}|${o}`),l.logSourceLocation,r[l.provider].log(c,o,s))}(function(c){function o(s){u={},e("",s||{})}function e(s,l){if(s==="*")o(l);else{const g=u[s]||a;u[s]={provider:l.provider||g.provider,minimalSeverity:l.minimalSeverity||g.minimalSeverity,logDateTime:l.logDateTime===void 0?g.logDateTime:l.logDateTime,logSourceLocation:l.logSourceLocation===void 0?g.logSourceLocation:l.logSourceLocation}}}c.verbose=function(s,l){c("verbose",s,l)},c.info=function(s,l){c("info",s,l)},c.warning=function(s,l){c("warning",s,l)},c.error=function(s,l){c("error",s,l)},c.fatal=function(s,l){c("fatal",s,l)},c.reset=o,c.set=e,c.setWithEnv=function(s){const l={};s.logLevel&&(l.minimalSeverity=s.logLevel),e("",l)}})(h||(h={})),t.Logger=h;class d{constructor(o,e,s,l,g,y){this.category=o,this.name=e,this.startTime=s,this.endCallback=l,this.timer=g,this.ctx=y}async end(){return this.endCallback(this)}async checkTimer(){if(this.ctx===void 0||this.timer===void 0)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)}}class p{constructor(o,e,s,l){this.category=o,this.name=e,this.startTime=s,this.endTime=l}}t.Profiler=class{static create(c){return c===void 0?new this:new this(c.maxNumberEvents,c.flushBatchSize,c.flushIntervalInMilliseconds)}constructor(c,o,e){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=c===void 0?1e4:c,this._flushBatchSize=o===void 0?10:o,this._flushIntervalInMilliseconds=e===void 0?5e3:e}start(){this._started=!0,this._timingEvents=[],this._flushTime=(0,t.now)(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(c,o,e,s){const l=this._started?this.begin(c,o,s):void 0;let g=!1;const y=e();if(y&&typeof y.then=="function")return g=!0,new Promise((b,_)=>{y.then(async v=>{l&&await l.end(),b(v)},async v=>{l&&await l.end(),_(v)})});if(!g&&l){const b=l.end();if(b&&typeof b.then=="function")return new Promise((_,v)=>{b.then(()=>{_(y)},T=>{v(T)})})}return y}begin(c,o,e){if(!this._started)throw new Error("profiler is not started yet");if(e===void 0){const s=(0,t.now)();return this.flush(s),new d(c,o,s,l=>this.endSync(l))}{const s=e.beginTimer();return new d(c,o,0,async l=>this.end(l),s,e)}}async end(c){const o=await c.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new p(c.category,c.name,c.startTime,o)),this.flush(o))}endSync(c){const o=(0,t.now)();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new p(c.category,c.name,c.startTime,o)),this.flush(o))}logOneEvent(c){t.Logger.verbose(`Profiler.${c.category}`,`${(c.endTime-c.startTime).toFixed(2)}ms on event '${c.name}' at ${c.endTime.toFixed(2)}`)}flush(c){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||c-this._flushTime>=this._flushIntervalInMilliseconds){for(const o=this._flushPointer;this._flushPointer<o+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=(0,t.now)()}}get started(){return this._started}},t.now=typeof performance<"u"&&performance.now?()=>performance.now():Date.now},1745:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Model=void 0;const r=n(5686),a=n(4662),u=n(5127),h=n(2446),f=n(7273);var d=u.onnxruntime.experimental.fbs;t.Model=class{constructor(){}load(p,c,o){if(!o)try{return void this.loadFromOnnxFormat(p,c)}catch(e){if(o!==void 0)throw e}this.loadFromOrtFormat(p,c)}loadFromOnnxFormat(p,c){const o=h.onnx.ModelProto.decode(p);if(f.LongUtil.longToNumber(o.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=o.opsetImport.map(e=>({domain:e.domain,version:f.LongUtil.longToNumber(e.version)})),this._graph=a.Graph.from(o.graph,c)}loadFromOrtFormat(p,c){const o=new r.flatbuffers.ByteBuffer(p),e=d.InferenceSession.getRootAsInferenceSession(o).model();if(f.LongUtil.longToNumber(e.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let s=0;s<e.opsetImportLength();s++){const l=e.opsetImport(s);this._opsets.push({domain:l==null?void 0:l.domain(),version:f.LongUtil.longToNumber(l.version())})}this._graph=a.Graph.from(e.graph(),c)}get graph(){return this._graph}get opsets(){return this._opsets}}},6145:(m,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FLOAT_TYPES=t.INT_TYPES=t.NUMBER_TYPES=void 0,t.NUMBER_TYPES=["float32","float64","int32","int16","int8","uint16","uint32","uint8"],t.INT_TYPES=["int32","int16","int8","uint16","uint32","uint8"],t.FLOAT_TYPES=["float32","float64"]},5881:(m,t)=>{function n(r,a){if(a.endsWith("+")){const u=Number.parseInt(a.substring(0,a.length-1),10);return!isNaN(u)&&u<=r}if(a.split("-").length===2){const u=a.split("-"),h=Number.parseInt(u[0],10),f=Number.parseInt(u[1],10);return!isNaN(h)&&!isNaN(f)&&h<=r&&r<=f}return Number.parseInt(a,10)===r}Object.defineProperty(t,"__esModule",{value:!0}),t.resolveOperator=void 0,t.resolveOperator=function(r,a,u){for(const h of u){const f=h[0],d=h[1],p=h[2],c=h[3],o=h[4];if(r.opType===f){for(const e of a)if((e.domain===d||e.domain==="ai.onnx"&&d==="")&&n(e.version,p))return{opImpl:c,opInit:o}}}throw new TypeError(`cannot resolve operator '${r.opType}' with opsets: ${a.map(h=>`${h.domain||"ai.onnx"} v${h.version}`).join(", ")}`)}},5127:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.onnxruntime=void 0;const r=n(5686);var a,u;a=t.onnxruntime||(t.onnxruntime={}),function(h){(function(f){f[f.UNDEFINED=0]="UNDEFINED",f[f.FLOAT=1]="FLOAT",f[f.INT=2]="INT",f[f.STRING=3]="STRING",f[f.TENSOR=4]="TENSOR",f[f.GRAPH=5]="GRAPH",f[f.FLOATS=6]="FLOATS",f[f.INTS=7]="INTS",f[f.STRINGS=8]="STRINGS",f[f.TENSORS=9]="TENSORS",f[f.GRAPHS=10]="GRAPHS",f[f.SPARSE_TENSOR=11]="SPARSE_TENSOR",f[f.SPARSE_TENSORS=12]="SPARSE_TENSORS"})(h.AttributeType||(h.AttributeType={}))}((u=a.experimental||(a.experimental={})).fbs||(u.fbs={})),function(h){(function(f){(function(d){(function(p){p[p.UNKNOWN=0]="UNKNOWN",p[p.VALUE=1]="VALUE",p[p.PARAM=2]="PARAM"})(d.DimensionValueType||(d.DimensionValueType={}))})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){(function(p){p[p.UNDEFINED=0]="UNDEFINED",p[p.FLOAT=1]="FLOAT",p[p.UINT8=2]="UINT8",p[p.INT8=3]="INT8",p[p.UINT16=4]="UINT16",p[p.INT16=5]="INT16",p[p.INT32=6]="INT32",p[p.INT64=7]="INT64",p[p.STRING=8]="STRING",p[p.BOOL=9]="BOOL",p[p.FLOAT16=10]="FLOAT16",p[p.DOUBLE=11]="DOUBLE",p[p.UINT32=12]="UINT32",p[p.UINT64=13]="UINT64",p[p.COMPLEX64=14]="COMPLEX64",p[p.COMPLEX128=15]="COMPLEX128",p[p.BFLOAT16=16]="BFLOAT16",p[p.FLOAT8E4M3FN=17]="FLOAT8E4M3FN",p[p.FLOAT8E4M3FNUZ=18]="FLOAT8E4M3FNUZ",p[p.FLOAT8E5M2=19]="FLOAT8E5M2",p[p.FLOAT8E5M2FNUZ=20]="FLOAT8E5M2FNUZ"})(d.TensorDataType||(d.TensorDataType={}))})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){(function(p){p[p.Primitive=0]="Primitive",p[p.Fused=1]="Fused"})(d.NodeType||(d.NodeType={}))})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){(function(p){p[p.NONE=0]="NONE",p[p.tensor_type=1]="tensor_type",p[p.sequence_type=2]="sequence_type",p[p.map_type=3]="map_type"})(d.TypeInfoValue||(d.TypeInfoValue={}))})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsShape(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsShape(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}dim(o,e){let s=this.bb.__offset(this.bb_pos,4);return s?(e||new h.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+4*o),this.bb):null}dimLength(){let o=this.bb.__offset(this.bb_pos,4);return o?this.bb.__vector_len(this.bb_pos+o):0}static startShape(o){o.startObject(1)}static addDim(o,e){o.addFieldOffset(0,e,0)}static createDimVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startDimVector(o,e){o.startVector(4,e,4)}static endShape(o){return o.endObject()}static createShape(o,e){return p.startShape(o),p.addDim(o,e),p.endShape(o)}}d.Shape=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsDimension(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsDimension(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}value(o){let e=this.bb.__offset(this.bb_pos,4);return e?(o||new h.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}denotation(o){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,o):null}static startDimension(o){o.startObject(2)}static addValue(o,e){o.addFieldOffset(0,e,0)}static addDenotation(o,e){o.addFieldOffset(1,e,0)}static endDimension(o){return o.endObject()}static createDimension(o,e,s){return p.startDimension(o),p.addValue(o,e),p.addDenotation(o,s),p.endDimension(o)}}d.Dimension=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsDimensionValue(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsDimensionValue(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}dimType(){let o=this.bb.__offset(this.bb_pos,4);return o?this.bb.readInt8(this.bb_pos+o):h.experimental.fbs.DimensionValueType.UNKNOWN}dimValue(){let o=this.bb.__offset(this.bb_pos,6);return o?this.bb.readInt64(this.bb_pos+o):this.bb.createLong(0,0)}dimParam(o){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,o):null}static startDimensionValue(o){o.startObject(3)}static addDimType(o,e){o.addFieldInt8(0,e,h.experimental.fbs.DimensionValueType.UNKNOWN)}static addDimValue(o,e){o.addFieldInt64(1,e,o.createLong(0,0))}static addDimParam(o,e){o.addFieldOffset(2,e,0)}static endDimensionValue(o){return o.endObject()}static createDimensionValue(o,e,s,l){return p.startDimensionValue(o),p.addDimType(o,e),p.addDimValue(o,s),p.addDimParam(o,l),p.endDimensionValue(o)}}d.DimensionValue=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsTensorTypeAndShape(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsTensorTypeAndShape(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}elemType(){let o=this.bb.__offset(this.bb_pos,4);return o?this.bb.readInt32(this.bb_pos+o):h.experimental.fbs.TensorDataType.UNDEFINED}shape(o){let e=this.bb.__offset(this.bb_pos,6);return e?(o||new h.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startTensorTypeAndShape(o){o.startObject(2)}static addElemType(o,e){o.addFieldInt32(0,e,h.experimental.fbs.TensorDataType.UNDEFINED)}static addShape(o,e){o.addFieldOffset(1,e,0)}static endTensorTypeAndShape(o){return o.endObject()}static createTensorTypeAndShape(o,e,s){return p.startTensorTypeAndShape(o),p.addElemType(o,e),p.addShape(o,s),p.endTensorTypeAndShape(o)}}d.TensorTypeAndShape=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsMapType(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsMapType(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}keyType(){let o=this.bb.__offset(this.bb_pos,4);return o?this.bb.readInt32(this.bb_pos+o):h.experimental.fbs.TensorDataType.UNDEFINED}valueType(o){let e=this.bb.__offset(this.bb_pos,6);return e?(o||new h.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startMapType(o){o.startObject(2)}static addKeyType(o,e){o.addFieldInt32(0,e,h.experimental.fbs.TensorDataType.UNDEFINED)}static addValueType(o,e){o.addFieldOffset(1,e,0)}static endMapType(o){return o.endObject()}static createMapType(o,e,s){return p.startMapType(o),p.addKeyType(o,e),p.addValueType(o,s),p.endMapType(o)}}d.MapType=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsSequenceType(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsSequenceType(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}elemType(o){let e=this.bb.__offset(this.bb_pos,4);return e?(o||new h.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startSequenceType(o){o.startObject(1)}static addElemType(o,e){o.addFieldOffset(0,e,0)}static endSequenceType(o){return o.endObject()}static createSequenceType(o,e){return p.startSequenceType(o),p.addElemType(o,e),p.endSequenceType(o)}}d.SequenceType=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(f.fbs||(f.fbs={})).EdgeEnd=class{constructor(){this.bb=null,this.bb_pos=0}__init(d,p){return this.bb_pos=d,this.bb=p,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(d,p,c,o){return d.prep(4,12),d.writeInt32(o),d.writeInt32(c),d.writeInt32(p),d.offset()}}})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsNodeEdge(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsNodeEdge(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}nodeIndex(){let o=this.bb.__offset(this.bb_pos,4);return o?this.bb.readUint32(this.bb_pos+o):0}inputEdges(o,e){let s=this.bb.__offset(this.bb_pos,6);return s?(e||new h.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+s)+12*o,this.bb):null}inputEdgesLength(){let o=this.bb.__offset(this.bb_pos,6);return o?this.bb.__vector_len(this.bb_pos+o):0}outputEdges(o,e){let s=this.bb.__offset(this.bb_pos,8);return s?(e||new h.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+s)+12*o,this.bb):null}outputEdgesLength(){let o=this.bb.__offset(this.bb_pos,8);return o?this.bb.__vector_len(this.bb_pos+o):0}static startNodeEdge(o){o.startObject(3)}static addNodeIndex(o,e){o.addFieldInt32(0,e,0)}static addInputEdges(o,e){o.addFieldOffset(1,e,0)}static startInputEdgesVector(o,e){o.startVector(12,e,4)}static addOutputEdges(o,e){o.addFieldOffset(2,e,0)}static startOutputEdgesVector(o,e){o.startVector(12,e,4)}static endNodeEdge(o){return o.endObject()}static createNodeEdge(o,e,s,l){return p.startNodeEdge(o),p.addNodeIndex(o,e),p.addInputEdges(o,s),p.addOutputEdges(o,l),p.endNodeEdge(o)}}d.NodeEdge=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsNode(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsNode(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}name(o){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,o):null}docString(o){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,o):null}domain(o){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,o):null}sinceVersion(){let o=this.bb.__offset(this.bb_pos,10);return o?this.bb.readInt32(this.bb_pos+o):0}index(){let o=this.bb.__offset(this.bb_pos,12);return o?this.bb.readUint32(this.bb_pos+o):0}opType(o){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__string(this.bb_pos+e,o):null}type(){let o=this.bb.__offset(this.bb_pos,16);return o?this.bb.readInt32(this.bb_pos+o):h.experimental.fbs.NodeType.Primitive}executionProviderType(o){let e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__string(this.bb_pos+e,o):null}inputs(o,e){let s=this.bb.__offset(this.bb_pos,20);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+4*o,e):null}inputsLength(){let o=this.bb.__offset(this.bb_pos,20);return o?this.bb.__vector_len(this.bb_pos+o):0}outputs(o,e){let s=this.bb.__offset(this.bb_pos,22);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+4*o,e):null}outputsLength(){let o=this.bb.__offset(this.bb_pos,22);return o?this.bb.__vector_len(this.bb_pos+o):0}attributes(o,e){let s=this.bb.__offset(this.bb_pos,24);return s?(e||new h.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+4*o),this.bb):null}attributesLength(){let o=this.bb.__offset(this.bb_pos,24);return o?this.bb.__vector_len(this.bb_pos+o):0}inputArgCounts(o){let e=this.bb.__offset(this.bb_pos,26);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+4*o):0}inputArgCountsLength(){let o=this.bb.__offset(this.bb_pos,26);return o?this.bb.__vector_len(this.bb_pos+o):0}inputArgCountsArray(){let o=this.bb.__offset(this.bb_pos,26);return o?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+o),this.bb.__vector_len(this.bb_pos+o)):null}implicitInputs(o,e){let s=this.bb.__offset(this.bb_pos,28);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+4*o,e):null}implicitInputsLength(){let o=this.bb.__offset(this.bb_pos,28);return o?this.bb.__vector_len(this.bb_pos+o):0}static startNode(o){o.startObject(13)}static addName(o,e){o.addFieldOffset(0,e,0)}static addDocString(o,e){o.addFieldOffset(1,e,0)}static addDomain(o,e){o.addFieldOffset(2,e,0)}static addSinceVersion(o,e){o.addFieldInt32(3,e,0)}static addIndex(o,e){o.addFieldInt32(4,e,0)}static addOpType(o,e){o.addFieldOffset(5,e,0)}static addType(o,e){o.addFieldInt32(6,e,h.experimental.fbs.NodeType.Primitive)}static addExecutionProviderType(o,e){o.addFieldOffset(7,e,0)}static addInputs(o,e){o.addFieldOffset(8,e,0)}static createInputsVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startInputsVector(o,e){o.startVector(4,e,4)}static addOutputs(o,e){o.addFieldOffset(9,e,0)}static createOutputsVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startOutputsVector(o,e){o.startVector(4,e,4)}static addAttributes(o,e){o.addFieldOffset(10,e,0)}static createAttributesVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startAttributesVector(o,e){o.startVector(4,e,4)}static addInputArgCounts(o,e){o.addFieldOffset(11,e,0)}static createInputArgCountsVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addInt32(e[s]);return o.endVector()}static startInputArgCountsVector(o,e){o.startVector(4,e,4)}static addImplicitInputs(o,e){o.addFieldOffset(12,e,0)}static createImplicitInputsVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startImplicitInputsVector(o,e){o.startVector(4,e,4)}static endNode(o){return o.endObject()}static createNode(o,e,s,l,g,y,b,_,v,T,w,A,S,O){return p.startNode(o),p.addName(o,e),p.addDocString(o,s),p.addDomain(o,l),p.addSinceVersion(o,g),p.addIndex(o,y),p.addOpType(o,b),p.addType(o,_),p.addExecutionProviderType(o,v),p.addInputs(o,T),p.addOutputs(o,w),p.addAttributes(o,A),p.addInputArgCounts(o,S),p.addImplicitInputs(o,O),p.endNode(o)}}d.Node=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsValueInfo(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsValueInfo(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}name(o){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,o):null}docString(o){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,o):null}type(o){let e=this.bb.__offset(this.bb_pos,8);return e?(o||new h.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startValueInfo(o){o.startObject(3)}static addName(o,e){o.addFieldOffset(0,e,0)}static addDocString(o,e){o.addFieldOffset(1,e,0)}static addType(o,e){o.addFieldOffset(2,e,0)}static endValueInfo(o){return o.endObject()}static createValueInfo(o,e,s,l){return p.startValueInfo(o),p.addName(o,e),p.addDocString(o,s),p.addType(o,l),p.endValueInfo(o)}}d.ValueInfo=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsTypeInfo(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsTypeInfo(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}denotation(o){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,o):null}valueType(){let o=this.bb.__offset(this.bb_pos,6);return o?this.bb.readUint8(this.bb_pos+o):h.experimental.fbs.TypeInfoValue.NONE}value(o){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(o,this.bb_pos+e):null}static startTypeInfo(o){o.startObject(3)}static addDenotation(o,e){o.addFieldOffset(0,e,0)}static addValueType(o,e){o.addFieldInt8(1,e,h.experimental.fbs.TypeInfoValue.NONE)}static addValue(o,e){o.addFieldOffset(2,e,0)}static endTypeInfo(o){return o.endObject()}static createTypeInfo(o,e,s,l){return p.startTypeInfo(o),p.addDenotation(o,e),p.addValueType(o,s),p.addValue(o,l),p.endTypeInfo(o)}}d.TypeInfo=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsOperatorSetId(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsOperatorSetId(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}domain(o){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,o):null}version(){let o=this.bb.__offset(this.bb_pos,6);return o?this.bb.readInt64(this.bb_pos+o):this.bb.createLong(0,0)}static startOperatorSetId(o){o.startObject(2)}static addDomain(o,e){o.addFieldOffset(0,e,0)}static addVersion(o,e){o.addFieldInt64(1,e,o.createLong(0,0))}static endOperatorSetId(o){return o.endObject()}static createOperatorSetId(o,e,s){return p.startOperatorSetId(o),p.addDomain(o,e),p.addVersion(o,s),p.endOperatorSetId(o)}}d.OperatorSetId=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsTensor(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsTensor(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}name(o){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,o):null}docString(o){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,o):null}dims(o){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*o):this.bb.createLong(0,0)}dimsLength(){let o=this.bb.__offset(this.bb_pos,8);return o?this.bb.__vector_len(this.bb_pos+o):0}dataType(){let o=this.bb.__offset(this.bb_pos,10);return o?this.bb.readInt32(this.bb_pos+o):h.experimental.fbs.TensorDataType.UNDEFINED}rawData(o){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+o):0}rawDataLength(){let o=this.bb.__offset(this.bb_pos,12);return o?this.bb.__vector_len(this.bb_pos+o):0}rawDataArray(){let o=this.bb.__offset(this.bb_pos,12);return o?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+o),this.bb.__vector_len(this.bb_pos+o)):null}stringData(o,e){let s=this.bb.__offset(this.bb_pos,14);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+4*o,e):null}stringDataLength(){let o=this.bb.__offset(this.bb_pos,14);return o?this.bb.__vector_len(this.bb_pos+o):0}static startTensor(o){o.startObject(6)}static addName(o,e){o.addFieldOffset(0,e,0)}static addDocString(o,e){o.addFieldOffset(1,e,0)}static addDims(o,e){o.addFieldOffset(2,e,0)}static createDimsVector(o,e){o.startVector(8,e.length,8);for(let s=e.length-1;s>=0;s--)o.addInt64(e[s]);return o.endVector()}static startDimsVector(o,e){o.startVector(8,e,8)}static addDataType(o,e){o.addFieldInt32(3,e,h.experimental.fbs.TensorDataType.UNDEFINED)}static addRawData(o,e){o.addFieldOffset(4,e,0)}static createRawDataVector(o,e){o.startVector(1,e.length,1);for(let s=e.length-1;s>=0;s--)o.addInt8(e[s]);return o.endVector()}static startRawDataVector(o,e){o.startVector(1,e,1)}static addStringData(o,e){o.addFieldOffset(5,e,0)}static createStringDataVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startStringDataVector(o,e){o.startVector(4,e,4)}static endTensor(o){return o.endObject()}static createTensor(o,e,s,l,g,y,b){return p.startTensor(o),p.addName(o,e),p.addDocString(o,s),p.addDims(o,l),p.addDataType(o,g),p.addRawData(o,y),p.addStringData(o,b),p.endTensor(o)}}d.Tensor=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsSparseTensor(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsSparseTensor(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}values(o){let e=this.bb.__offset(this.bb_pos,4);return e?(o||new h.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}indices(o){let e=this.bb.__offset(this.bb_pos,6);return e?(o||new h.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dims(o){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*o):this.bb.createLong(0,0)}dimsLength(){let o=this.bb.__offset(this.bb_pos,8);return o?this.bb.__vector_len(this.bb_pos+o):0}static startSparseTensor(o){o.startObject(3)}static addValues(o,e){o.addFieldOffset(0,e,0)}static addIndices(o,e){o.addFieldOffset(1,e,0)}static addDims(o,e){o.addFieldOffset(2,e,0)}static createDimsVector(o,e){o.startVector(8,e.length,8);for(let s=e.length-1;s>=0;s--)o.addInt64(e[s]);return o.endVector()}static startDimsVector(o,e){o.startVector(8,e,8)}static endSparseTensor(o){return o.endObject()}static createSparseTensor(o,e,s,l){return p.startSparseTensor(o),p.addValues(o,e),p.addIndices(o,s),p.addDims(o,l),p.endSparseTensor(o)}}d.SparseTensor=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsAttribute(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsAttribute(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}name(o){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,o):null}docString(o){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,o):null}type(){let o=this.bb.__offset(this.bb_pos,8);return o?this.bb.readInt32(this.bb_pos+o):h.experimental.fbs.AttributeType.UNDEFINED}f(){let o=this.bb.__offset(this.bb_pos,10);return o?this.bb.readFloat32(this.bb_pos+o):0}i(){let o=this.bb.__offset(this.bb_pos,12);return o?this.bb.readInt64(this.bb_pos+o):this.bb.createLong(0,0)}s(o){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__string(this.bb_pos+e,o):null}t(o){let e=this.bb.__offset(this.bb_pos,16);return e?(o||new h.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}g(o){let e=this.bb.__offset(this.bb_pos,18);return e?(o||new h.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}floats(o){let e=this.bb.__offset(this.bb_pos,20);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+4*o):0}floatsLength(){let o=this.bb.__offset(this.bb_pos,20);return o?this.bb.__vector_len(this.bb_pos+o):0}floatsArray(){let o=this.bb.__offset(this.bb_pos,20);return o?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+o),this.bb.__vector_len(this.bb_pos+o)):null}ints(o){let e=this.bb.__offset(this.bb_pos,22);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*o):this.bb.createLong(0,0)}intsLength(){let o=this.bb.__offset(this.bb_pos,22);return o?this.bb.__vector_len(this.bb_pos+o):0}strings(o,e){let s=this.bb.__offset(this.bb_pos,24);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+4*o,e):null}stringsLength(){let o=this.bb.__offset(this.bb_pos,24);return o?this.bb.__vector_len(this.bb_pos+o):0}tensors(o,e){let s=this.bb.__offset(this.bb_pos,26);return s?(e||new h.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+4*o),this.bb):null}tensorsLength(){let o=this.bb.__offset(this.bb_pos,26);return o?this.bb.__vector_len(this.bb_pos+o):0}graphs(o,e){let s=this.bb.__offset(this.bb_pos,28);return s?(e||new h.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+4*o),this.bb):null}graphsLength(){let o=this.bb.__offset(this.bb_pos,28);return o?this.bb.__vector_len(this.bb_pos+o):0}static startAttribute(o){o.startObject(13)}static addName(o,e){o.addFieldOffset(0,e,0)}static addDocString(o,e){o.addFieldOffset(1,e,0)}static addType(o,e){o.addFieldInt32(2,e,h.experimental.fbs.AttributeType.UNDEFINED)}static addF(o,e){o.addFieldFloat32(3,e,0)}static addI(o,e){o.addFieldInt64(4,e,o.createLong(0,0))}static addS(o,e){o.addFieldOffset(5,e,0)}static addT(o,e){o.addFieldOffset(6,e,0)}static addG(o,e){o.addFieldOffset(7,e,0)}static addFloats(o,e){o.addFieldOffset(8,e,0)}static createFloatsVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addFloat32(e[s]);return o.endVector()}static startFloatsVector(o,e){o.startVector(4,e,4)}static addInts(o,e){o.addFieldOffset(9,e,0)}static createIntsVector(o,e){o.startVector(8,e.length,8);for(let s=e.length-1;s>=0;s--)o.addInt64(e[s]);return o.endVector()}static startIntsVector(o,e){o.startVector(8,e,8)}static addStrings(o,e){o.addFieldOffset(10,e,0)}static createStringsVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startStringsVector(o,e){o.startVector(4,e,4)}static addTensors(o,e){o.addFieldOffset(11,e,0)}static createTensorsVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startTensorsVector(o,e){o.startVector(4,e,4)}static addGraphs(o,e){o.addFieldOffset(12,e,0)}static createGraphsVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startGraphsVector(o,e){o.startVector(4,e,4)}static endAttribute(o){return o.endObject()}static createAttribute(o,e,s,l,g,y,b,_,v,T,w,A,S,O){return p.startAttribute(o),p.addName(o,e),p.addDocString(o,s),p.addType(o,l),p.addF(o,g),p.addI(o,y),p.addS(o,b),p.addT(o,_),p.addG(o,v),p.addFloats(o,T),p.addInts(o,w),p.addStrings(o,A),p.addTensors(o,S),p.addGraphs(o,O),p.endAttribute(o)}}d.Attribute=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsGraph(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsGraph(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}initializers(o,e){let s=this.bb.__offset(this.bb_pos,4);return s?(e||new h.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+4*o),this.bb):null}initializersLength(){let o=this.bb.__offset(this.bb_pos,4);return o?this.bb.__vector_len(this.bb_pos+o):0}nodeArgs(o,e){let s=this.bb.__offset(this.bb_pos,6);return s?(e||new h.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+4*o),this.bb):null}nodeArgsLength(){let o=this.bb.__offset(this.bb_pos,6);return o?this.bb.__vector_len(this.bb_pos+o):0}nodes(o,e){let s=this.bb.__offset(this.bb_pos,8);return s?(e||new h.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+4*o),this.bb):null}nodesLength(){let o=this.bb.__offset(this.bb_pos,8);return o?this.bb.__vector_len(this.bb_pos+o):0}maxNodeIndex(){let o=this.bb.__offset(this.bb_pos,10);return o?this.bb.readUint32(this.bb_pos+o):0}nodeEdges(o,e){let s=this.bb.__offset(this.bb_pos,12);return s?(e||new h.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+4*o),this.bb):null}nodeEdgesLength(){let o=this.bb.__offset(this.bb_pos,12);return o?this.bb.__vector_len(this.bb_pos+o):0}inputs(o,e){let s=this.bb.__offset(this.bb_pos,14);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+4*o,e):null}inputsLength(){let o=this.bb.__offset(this.bb_pos,14);return o?this.bb.__vector_len(this.bb_pos+o):0}outputs(o,e){let s=this.bb.__offset(this.bb_pos,16);return s?this.bb.__string(this.bb.__vector(this.bb_pos+s)+4*o,e):null}outputsLength(){let o=this.bb.__offset(this.bb_pos,16);return o?this.bb.__vector_len(this.bb_pos+o):0}sparseInitializers(o,e){let s=this.bb.__offset(this.bb_pos,18);return s?(e||new h.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+4*o),this.bb):null}sparseInitializersLength(){let o=this.bb.__offset(this.bb_pos,18);return o?this.bb.__vector_len(this.bb_pos+o):0}static startGraph(o){o.startObject(8)}static addInitializers(o,e){o.addFieldOffset(0,e,0)}static createInitializersVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startInitializersVector(o,e){o.startVector(4,e,4)}static addNodeArgs(o,e){o.addFieldOffset(1,e,0)}static createNodeArgsVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startNodeArgsVector(o,e){o.startVector(4,e,4)}static addNodes(o,e){o.addFieldOffset(2,e,0)}static createNodesVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startNodesVector(o,e){o.startVector(4,e,4)}static addMaxNodeIndex(o,e){o.addFieldInt32(3,e,0)}static addNodeEdges(o,e){o.addFieldOffset(4,e,0)}static createNodeEdgesVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startNodeEdgesVector(o,e){o.startVector(4,e,4)}static addInputs(o,e){o.addFieldOffset(5,e,0)}static createInputsVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startInputsVector(o,e){o.startVector(4,e,4)}static addOutputs(o,e){o.addFieldOffset(6,e,0)}static createOutputsVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startOutputsVector(o,e){o.startVector(4,e,4)}static addSparseInitializers(o,e){o.addFieldOffset(7,e,0)}static createSparseInitializersVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startSparseInitializersVector(o,e){o.startVector(4,e,4)}static endGraph(o){return o.endObject()}static createGraph(o,e,s,l,g,y,b,_,v){return p.startGraph(o),p.addInitializers(o,e),p.addNodeArgs(o,s),p.addNodes(o,l),p.addMaxNodeIndex(o,g),p.addNodeEdges(o,y),p.addInputs(o,b),p.addOutputs(o,_),p.addSparseInitializers(o,v),p.endGraph(o)}}d.Graph=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsModel(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsModel(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}irVersion(){let o=this.bb.__offset(this.bb_pos,4);return o?this.bb.readInt64(this.bb_pos+o):this.bb.createLong(0,0)}opsetImport(o,e){let s=this.bb.__offset(this.bb_pos,6);return s?(e||new h.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+4*o),this.bb):null}opsetImportLength(){let o=this.bb.__offset(this.bb_pos,6);return o?this.bb.__vector_len(this.bb_pos+o):0}producerName(o){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,o):null}producerVersion(o){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,o):null}domain(o){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__string(this.bb_pos+e,o):null}modelVersion(){let o=this.bb.__offset(this.bb_pos,14);return o?this.bb.readInt64(this.bb_pos+o):this.bb.createLong(0,0)}docString(o){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__string(this.bb_pos+e,o):null}graph(o){let e=this.bb.__offset(this.bb_pos,18);return e?(o||new h.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}graphDocString(o){let e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__string(this.bb_pos+e,o):null}static startModel(o){o.startObject(9)}static addIrVersion(o,e){o.addFieldInt64(0,e,o.createLong(0,0))}static addOpsetImport(o,e){o.addFieldOffset(1,e,0)}static createOpsetImportVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startOpsetImportVector(o,e){o.startVector(4,e,4)}static addProducerName(o,e){o.addFieldOffset(2,e,0)}static addProducerVersion(o,e){o.addFieldOffset(3,e,0)}static addDomain(o,e){o.addFieldOffset(4,e,0)}static addModelVersion(o,e){o.addFieldInt64(5,e,o.createLong(0,0))}static addDocString(o,e){o.addFieldOffset(6,e,0)}static addGraph(o,e){o.addFieldOffset(7,e,0)}static addGraphDocString(o,e){o.addFieldOffset(8,e,0)}static endModel(o){return o.endObject()}static createModel(o,e,s,l,g,y,b,_,v,T){return p.startModel(o),p.addIrVersion(o,e),p.addOpsetImport(o,s),p.addProducerName(o,l),p.addProducerVersion(o,g),p.addDomain(o,y),p.addModelVersion(o,b),p.addDocString(o,_),p.addGraph(o,v),p.addGraphDocString(o,T),p.endModel(o)}}d.Model=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsKernelCreateInfos(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsKernelCreateInfos(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}nodeIndices(o){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+4*o):0}nodeIndicesLength(){let o=this.bb.__offset(this.bb_pos,4);return o?this.bb.__vector_len(this.bb_pos+o):0}nodeIndicesArray(){let o=this.bb.__offset(this.bb_pos,4);return o?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+o),this.bb.__vector_len(this.bb_pos+o)):null}kernelDefHashes(o){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint64(this.bb.__vector(this.bb_pos+e)+8*o):this.bb.createLong(0,0)}kernelDefHashesLength(){let o=this.bb.__offset(this.bb_pos,6);return o?this.bb.__vector_len(this.bb_pos+o):0}static startKernelCreateInfos(o){o.startObject(2)}static addNodeIndices(o,e){o.addFieldOffset(0,e,0)}static createNodeIndicesVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addInt32(e[s]);return o.endVector()}static startNodeIndicesVector(o,e){o.startVector(4,e,4)}static addKernelDefHashes(o,e){o.addFieldOffset(1,e,0)}static createKernelDefHashesVector(o,e){o.startVector(8,e.length,8);for(let s=e.length-1;s>=0;s--)o.addInt64(e[s]);return o.endVector()}static startKernelDefHashesVector(o,e){o.startVector(8,e,8)}static endKernelCreateInfos(o){return o.endObject()}static createKernelCreateInfos(o,e,s){return p.startKernelCreateInfos(o),p.addNodeIndices(o,e),p.addKernelDefHashes(o,s),p.endKernelCreateInfos(o)}}d.KernelCreateInfos=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsSubGraphSessionState(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsSubGraphSessionState(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}graphId(o){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,o):null}sessionState(o){let e=this.bb.__offset(this.bb_pos,6);return e?(o||new h.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startSubGraphSessionState(o){o.startObject(2)}static addGraphId(o,e){o.addFieldOffset(0,e,0)}static addSessionState(o,e){o.addFieldOffset(1,e,0)}static endSubGraphSessionState(o){let e=o.endObject();return o.requiredField(e,4),e}static createSubGraphSessionState(o,e,s){return p.startSubGraphSessionState(o),p.addGraphId(o,e),p.addSessionState(o,s),p.endSubGraphSessionState(o)}}d.SubGraphSessionState=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsSessionState(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsSessionState(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}kernels(o){let e=this.bb.__offset(this.bb_pos,4);return e?(o||new h.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}subGraphSessionStates(o,e){let s=this.bb.__offset(this.bb_pos,6);return s?(e||new h.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+s)+4*o),this.bb):null}subGraphSessionStatesLength(){let o=this.bb.__offset(this.bb_pos,6);return o?this.bb.__vector_len(this.bb_pos+o):0}static startSessionState(o){o.startObject(2)}static addKernels(o,e){o.addFieldOffset(0,e,0)}static addSubGraphSessionStates(o,e){o.addFieldOffset(1,e,0)}static createSubGraphSessionStatesVector(o,e){o.startVector(4,e.length,4);for(let s=e.length-1;s>=0;s--)o.addOffset(e[s]);return o.endVector()}static startSubGraphSessionStatesVector(o,e){o.startVector(4,e,4)}static endSessionState(o){return o.endObject()}static createSessionState(o,e,s){return p.startSessionState(o),p.addKernels(o,e),p.addSubGraphSessionStates(o,s),p.endSessionState(o)}}d.SessionState=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(h){(function(f){(function(d){class p{constructor(){this.bb=null,this.bb_pos=0}__init(o,e){return this.bb_pos=o,this.bb=e,this}static getRootAsInferenceSession(o,e){return(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static getSizePrefixedRootAsInferenceSession(o,e){return o.setPosition(o.position()+r.flatbuffers.SIZE_PREFIX_LENGTH),(e||new p).__init(o.readInt32(o.position())+o.position(),o)}static bufferHasIdentifier(o){return o.__has_identifier("ORTM")}ortVersion(o){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,o):null}model(o){let e=this.bb.__offset(this.bb_pos,6);return e?(o||new h.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}sessionState(o){let e=this.bb.__offset(this.bb_pos,8);return e?(o||new h.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startInferenceSession(o){o.startObject(3)}static addOrtVersion(o,e){o.addFieldOffset(0,e,0)}static addModel(o,e){o.addFieldOffset(1,e,0)}static addSessionState(o,e){o.addFieldOffset(2,e,0)}static endInferenceSession(o){return o.endObject()}static finishInferenceSessionBuffer(o,e){o.finish(e,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(o,e){o.finish(e,"ORTM",!0)}static createInferenceSession(o,e,s,l){return p.startInferenceSession(o),p.addOrtVersion(o,e),p.addModel(o,s),p.addSessionState(o,l),p.endInferenceSession(o)}}d.InferenceSession=p})(f.fbs||(f.fbs={}))})(h.experimental||(h.experimental={}))}(t.onnxruntime||(t.onnxruntime={}))},1723:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OnnxjsSessionHandler=void 0;const r=n(2235),a=n(9240);t.OnnxjsSessionHandler=class{constructor(u){this.session=u,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}async dispose(){}async run(u,h,f){const d=new Map;for(const o in u)if(Object.hasOwnProperty.call(u,o)){const e=u[o];d.set(o,new a.Tensor(e.dims,e.type,void 0,void 0,e.data))}const p=await this.session.run(d),c={};return p.forEach((o,e)=>{c[e]=new r.Tensor(o.type,o.data,o.dims)}),c}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}},6027:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;const r=n(7067),a=n(1296),u=n(1975),h=n(6496),f=n(1315),d=n(1745);t.Session=class{constructor(p={}){this._initialized=!1,this.backendHint=p.backendHint,this.profiler=f.Profiler.create(p.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}async loadModel(p,c,o){await this.profiler.event("session","Session.loadModel",async()=>{const e=await(0,u.resolveBackend)(this.backendHint);if(this.sessionHandler=e.createSessionHandler(this.context),this._model=new d.Model,typeof p=="string"){const s=p.endsWith(".ort");if(typeof process<"u"&&process.versions&&process.versions.node){const l=await(0,a.promisify)(r.readFile)(p);this.initialize(l,s)}else{const l=await fetch(p),g=await l.arrayBuffer();this.initialize(new Uint8Array(g),s)}}else if(ArrayBuffer.isView(p))this.initialize(p);else{const s=new Uint8Array(p,c||0,o||p.byteLength);this.initialize(s)}})}initialize(p,c){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",()=>{const o=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(p,o,c),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new h.ExecutionPlan(this._model.graph,this._ops,this.profiler)}),this._initialized=!0}async run(p){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",async()=>{const c=this.normalizeAndValidateInputs(p),o=await this._executionPlan.execute(this.sessionHandler,c);return this.createOutput(o)})}normalizeAndValidateInputs(p){const c=this._model.graph.getInputNames();if(Array.isArray(p)){if(p.length!==c.length)throw new Error(`incorrect input array length: expected ${c.length} but got ${p.length}`)}else{if(p.size!==c.length)throw new Error(`incorrect input map size: expected ${c.length} but got ${p.size}`);const o=new Array(p.size);let e=0;for(let s=0;s<c.length;++s){const l=p.get(c[s]);if(!l)throw new Error(`missing input tensor for: '${name}'`);o[e++]=l}p=o}if(this.context.graphInputTypes&&this.context.graphInputTypes.length!==0&&this.context.graphInputDims&&this.context.graphInputDims.length!==0)this.validateInputTensorDims(this.context.graphInputDims,p,!1);else{const o=this._model.graph.getInputIndices(),e=this._model.graph.getValues(),s=new Array(o.length);for(let l=0;l<o.length;++l){const g=e[o[l]];s[l]=g.type.shape.dims,this.context.graphInputTypes.push(g.type.tensorType),this.context.graphInputDims.push(p[l].dims)}this.validateInputTensorDims(s,p,!0)}return this.validateInputTensorTypes(this.context.graphInputTypes,p),p}validateInputTensorTypes(p,c){for(let o=0;o<c.length;o++){const e=p[o],s=c[o].type;if(e!==s)throw new Error(`input tensor[${o}] check failed: expected type '${e}' but got ${s}`)}}validateInputTensorDims(p,c,o){for(let e=0;e<c.length;e++){const s=p[e],l=c[e].dims;if(!this.compareTensorDims(s,l,o))throw new Error(`input tensor[${e}] check failed: expected shape '[${s.join(",")}]' but got [${l.join(",")}]`)}}compareTensorDims(p,c,o){if(p.length!==c.length)return!1;for(let e=0;e<p.length;++e)if(p[e]!==c[e]&&(!o||p[e]!==0))return!1;return!0}createOutput(p){const c=this._model.graph.getOutputNames();if(p.length!==c.length)throw new Error("expected number of outputs do not match number of generated outputs");const o=new Map;for(let e=0;e<c.length;++e)o.set(c[e],p[e]);return o}initializeOps(p){const c=p.getNodes();this._ops=new Array(c.length);for(let o=0;o<c.length;o++)this._ops[o]=this.sessionHandler.resolve(c[o],this._model.opsets,p)}}},9240:function(m,t,n){var r=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(t,"__esModule",{value:!0}),t.Tensor=void 0;const a=n(3442),u=r(n(1583)),h=n(5127),f=n(2446),d=n(7273);var p=h.onnxruntime.experimental.fbs;class c{get data(){if(this.cache===void 0){const y=this.dataProvider(this.dataId);if(y.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=y}return this.cache}get stringData(){if(this.type!=="string")throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if(this.type!=="string")return this.data;throw new TypeError("type cannot be non-number (string)")}get(y){return this.data[d.ShapeUtil.indicesToOffset(y,this.strides)]}set(y,b){this.data[d.ShapeUtil.indicesToOffset(y,this.strides)]=b}async getData(){return this.cache===void 0&&(this.cache=await this.asyncDataProvider(this.dataId)),this.cache}get strides(){return this._strides||(this._strides=d.ShapeUtil.computeStrides(this.dims)),this._strides}constructor(y,b,_,v,T,w=a.Guid.create()){this.dims=y,this.type=b,this.dataProvider=_,this.asyncDataProvider=v,this.cache=T,this.dataId=w,this.size=d.ShapeUtil.validateDimsAndCalcSize(y);const A=this.size,S=_===void 0&&v===void 0&&T===void 0;if(T!==void 0&&T.length!==A)throw new RangeError("Input dims doesn't match data length.");if(b==="string"){if(!(T===void 0||Array.isArray(T)&&T.every(O=>typeof O=="string")))throw new TypeError("cache should be a string array");S&&(this.cache=new Array(A))}else{if(T!==void 0){const O=e(b);if(!(T instanceof O))throw new TypeError(`cache should be type ${O.name}`)}if(S){const O=new ArrayBuffer(A*function(C){switch(C){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${C}`)}}(b));this.cache=function(C,D){return new(e(D))(C)}(O,b)}}}static fromProto(y){if(!y)throw new Error("cannot construct Value from an empty tensor");const b=d.ProtoUtil.tensorDataTypeFromProto(y.dataType),_=d.ProtoUtil.tensorDimsFromProto(y.dims),v=new c(_,b);if(b==="string")y.stringData.forEach((T,w)=>{v.data[w]=(0,d.decodeUtf8String)(T)});else if(y.rawData&&typeof y.rawData.byteLength=="number"&&y.rawData.byteLength>0){const T=v.data,w=new DataView(y.rawData.buffer,y.rawData.byteOffset,y.rawData.byteLength),A=o(y.dataType),S=y.rawData.byteLength/A;if(y.rawData.byteLength%A!=0)throw new Error("invalid buffer length");if(T.length!==S)throw new Error("buffer length mismatch");for(let O=0;O<S;O++){const C=l(w,y.dataType,O*A);T[O]=C}}else{let T;switch(y.dataType){case f.onnx.TensorProto.DataType.FLOAT:T=y.floatData;break;case f.onnx.TensorProto.DataType.INT32:case f.onnx.TensorProto.DataType.INT16:case f.onnx.TensorProto.DataType.UINT16:case f.onnx.TensorProto.DataType.INT8:case f.onnx.TensorProto.DataType.UINT8:case f.onnx.TensorProto.DataType.BOOL:T=y.int32Data;break;case f.onnx.TensorProto.DataType.INT64:T=y.int64Data;break;case f.onnx.TensorProto.DataType.DOUBLE:T=y.doubleData;break;case f.onnx.TensorProto.DataType.UINT32:case f.onnx.TensorProto.DataType.UINT64:T=y.uint64Data;break;default:throw new Error("unspecific error")}if(T==null)throw new Error("failed to populate data from a tensorproto value");const w=v.data;if(w.length!==T.length)throw new Error("array length mismatch");for(let A=0;A<T.length;A++){const S=T[A];u.default.isLong(S)?w[A]=s(S,y.dataType):w[A]=S}}return v}static fromData(y,b,_){return new c(b,_,void 0,void 0,y)}static fromOrtTensor(y){if(!y)throw new Error("cannot construct Value from an empty tensor");const b=d.ProtoUtil.tensorDimsFromORTFormat(y),_=d.ProtoUtil.tensorDataTypeFromProto(y.dataType()),v=new c(b,_);if(_==="string")for(let T=0;T<y.stringDataLength();T++)v.data[T]=y.stringData(T);else if(y.rawDataArray()&&typeof y.rawDataLength()=="number"&&y.rawDataLength()>0){const T=v.data,w=new DataView(y.rawDataArray().buffer,y.rawDataArray().byteOffset,y.rawDataLength()),A=o(y.dataType()),S=y.rawDataLength()/A;if(y.rawDataLength()%A!=0)throw new Error("invalid buffer length");if(T.length!==S)throw new Error("buffer length mismatch");for(let O=0;O<S;O++){const C=l(w,y.dataType(),O*A);T[O]=C}}return v}}function o(g){switch(g){case f.onnx.TensorProto.DataType.UINT8:case f.onnx.TensorProto.DataType.INT8:case f.onnx.TensorProto.DataType.BOOL:return 1;case f.onnx.TensorProto.DataType.UINT16:case f.onnx.TensorProto.DataType.INT16:return 2;case f.onnx.TensorProto.DataType.FLOAT:case f.onnx.TensorProto.DataType.INT32:case f.onnx.TensorProto.DataType.UINT32:return 4;case f.onnx.TensorProto.DataType.INT64:case f.onnx.TensorProto.DataType.DOUBLE:case f.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${f.onnx.TensorProto.DataType[g]}`)}}function e(g){switch(g){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function s(g,y){if(y===f.onnx.TensorProto.DataType.INT64||y===p.TensorDataType.INT64){if(g.greaterThanOrEqual(2147483648)||g.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else{if(y!==f.onnx.TensorProto.DataType.UINT32&&y!==p.TensorDataType.UINT32&&y!==f.onnx.TensorProto.DataType.UINT64&&y!==p.TensorDataType.UINT64)throw new TypeError(`not a LONG type: ${f.onnx.TensorProto.DataType[y]}`);if(g.greaterThanOrEqual(4294967296)||g.lessThan(0))throw new TypeError("uint64 is not supported")}return g.toNumber()}function l(g,y,b){switch(y){case f.onnx.TensorProto.DataType.BOOL:case f.onnx.TensorProto.DataType.UINT8:return g.getUint8(b);case f.onnx.TensorProto.DataType.INT8:return g.getInt8(b);case f.onnx.TensorProto.DataType.UINT16:return g.getUint16(b,!0);case f.onnx.TensorProto.DataType.INT16:return g.getInt16(b,!0);case f.onnx.TensorProto.DataType.FLOAT:return g.getFloat32(b,!0);case f.onnx.TensorProto.DataType.INT32:return g.getInt32(b,!0);case f.onnx.TensorProto.DataType.UINT32:return g.getUint32(b,!0);case f.onnx.TensorProto.DataType.INT64:return s(u.default.fromBits(g.getUint32(b,!0),g.getUint32(b+4,!0),!1),y);case f.onnx.TensorProto.DataType.DOUBLE:return g.getFloat64(b,!0);case f.onnx.TensorProto.DataType.UINT64:return s(u.default.fromBits(g.getUint32(b,!0),g.getUint32(b+4,!0),!0),y);default:throw new Error(`cannot read from DataView for type ${f.onnx.TensorProto.DataType[y]}`)}}t.Tensor=c},7273:function(m,t,n){var r=this&&this.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeUtf8String=t.MAX_CLIP=t.MIN_CLIP=t.PoolConvUtil=t.ReduceUtil=t.SplitUtil=t.MathUtil=t.ShapeUtil=t.LongUtil=t.ProtoUtil=t.GemmUtil=t.arrayCopyHelper=t.BroadcastUtil=t.MatMulUtil=t.ArrayUtil=t.assert=t.checkInputsShape=void 0;const a=n(5686),u=r(n(1583)),h=n(2446),f=n(9240);t.checkInputsShape=function(y,...b){if(!y||y.length!==b.length)return!1;for(let _=0;_<y.length;_++)if(!y[_].dims||y[_].dims.length!==b[_])return!1;return!0},t.assert=function(y,b){if(!y)throw new Error(typeof b=="string"?b:b())},t.ArrayUtil=class{static arraysEqual(y,b){if(y.length!==b.length)return!1;for(let _=0;_<y.length;_++)if(y[_]!==b[_])return!1;return!0}};class d{static preprocessInputShapes(b,_){return[b.length===1?[1,b[0]]:b,_.length===1?[_[0],1]:_]}static postprocessOutputShape(b,_,v){_===1&&b.splice(b.length-2,1),v===1&&b.pop()}static calcMatMulShape(b,_){return b[1]!==_[0]?void 0:[b[0],_[1]]}}t.MatMulUtil=d;class p{static calcShape(b,_,v=!1){const T=b.length,w=_.length;if(T===0)return _;if(w===0)return b;const A=Math.max(b.length,_.length),S=new Array(A);if(v){if(T<2||w<2)return;const O=d.calcMatMulShape([b[T-2],b[T-1]],[_[w-2],_[w-1]]);if(O===void 0)return;[S[A-2],S[A-1]]=O}for(let O=v?3:1;O<=A;O++){const C=T-O<0?1:b[T-O],D=w-O<0?1:_[w-O];if(C!==D&&C>1&&D>1)return;S[A-O]=Math.max(C,D)}return S}static index(b,_){const v=new Array(_.length);return p.fillIndex(b,_,v),v}static fillIndex(b,_,v){const T=b.length-_.length;for(let w=0;w<_.length;w++)v[w]=b[T+w]%_[w]}static calc(b,_,v,T,w){const A=p.calcShape(b.dims,_.dims);if(A){if(T&&!e.areEqual(A,b.dims))return;const S=e.size(A),O=T?b:new f.Tensor(A,w||b.type);if(A.length===0)O.set([],v(b.get([]),_.get([])));else{const C=new Array(A.length),D=new Array(b.dims.length),$=new Array(_.dims.length);let L,P=0,B=0,I=!1,M=!1;b.dims.length===0&&(P=b.get([]),I=!0),_.dims.length===0&&(B=_.get([]),M=!0);for(let k=0;k<S;k++){L=k;for(let X=A.length-1;X>=0;X--)C[X]=L%A[X],L=Math.floor(L/A[X]);I||(p.fillIndex(C,b.dims,D),P=b.get(D)),M||(p.fillIndex(C,_.dims,$),B=_.get($)),O.set(C,v(P,B))}}return O}}static isValidBroadcast(b,_){const v=b.length,T=_.length;if(v>T)return!1;for(let w=1;w<=v;w++)if(b[v-w]!==1&&b[v-w]!==_[T-w])return!1;return!0}static getBroadcastDims(b,_){const v=b.length,T=[];for(let w=0;w<v;w++){const A=v-1-w,S=b[A]||1;(_[_.length-1-w]||1)>1&&S===1&&T.unshift(A)}return T}}t.BroadcastUtil=p,t.arrayCopyHelper=function(y,b,_,v,T){if(v<0||v>=b.length)throw new Error("sourceIndex out of bounds");if(_<0||_>=y.length)throw new Error("targetIndex out of bounds");if(v+T>b.length)throw new Error("source indices to be copied are outside bounds");if(_+T>y.length)throw new Error("target array is too small to hold result");for(let w=0;w<T;w++)y[_+w]=b[v+w]},t.GemmUtil=class{static getShapeOfGemmResult(y,b,_,v,T){if(y.length!==2||_.length!==2)throw new Error("shape need to be of size 2");let w,A,S;b?(w=y[1],A=y[0]):(w=y[0],A=y[1]);let O=-1;if(v?(S=_[0],O=1):(S=_[1],O=0),_[O]!==A)throw new Error("dimension mismatch");if(w<=0||S<=0||A<=0)throw new Error("invalid shape specified");if(T&&!p.isValidBroadcast(T,[w,S]))throw new Error("gemm: invalid bias shape for broadcast");return[w,S,A]}};class c{static tensorDataTypeFromProto(b){switch(b){case h.onnx.TensorProto.DataType.INT8:return"int8";case h.onnx.TensorProto.DataType.UINT8:return"uint8";case h.onnx.TensorProto.DataType.BOOL:return"bool";case h.onnx.TensorProto.DataType.INT16:return"int16";case h.onnx.TensorProto.DataType.UINT16:return"uint16";case h.onnx.TensorProto.DataType.INT32:return"int32";case h.onnx.TensorProto.DataType.UINT32:return"uint32";case h.onnx.TensorProto.DataType.FLOAT:return"float32";case h.onnx.TensorProto.DataType.DOUBLE:return"float64";case h.onnx.TensorProto.DataType.STRING:return"string";case h.onnx.TensorProto.DataType.INT64:return"int32";case h.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${h.onnx.TensorProto.DataType[b]}`)}}static tensorDataTypeStringToEnum(b){switch(b){case"int8":return h.onnx.TensorProto.DataType.INT8;case"uint8":return h.onnx.TensorProto.DataType.UINT8;case"bool":return h.onnx.TensorProto.DataType.BOOL;case"int16":return h.onnx.TensorProto.DataType.INT16;case"uint16":return h.onnx.TensorProto.DataType.UINT16;case"int32":return h.onnx.TensorProto.DataType.INT32;case"uint32":return h.onnx.TensorProto.DataType.UINT32;case"float32":return h.onnx.TensorProto.DataType.FLOAT;case"float64":return h.onnx.TensorProto.DataType.DOUBLE;case"string":return h.onnx.TensorProto.DataType.STRING;case"int64":return h.onnx.TensorProto.DataType.INT64;case"uint64":return h.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${b}`)}}static tensorDimsFromProto(b){return b.map(_=>u.default.isLong(_)?_.toNumber():_)}static tensorValueTypeFromProto(b){return{tensorType:c.tensorDataTypeFromProto(b.elemType),shape:{dims:c.tensorDimsFromProto(b.shape.dim.map(_=>_.dimValue))}}}static tensorDimsFromORTFormat(b){const _=[];for(let v=0;v<b.dimsLength();v++)_.push(o.longToNumber(b.dims(v)));return _}static tensorAttributesFromORTFormat(b){const _=[];for(let v=0;v<b.attributesLength();v++)_.push(b.attributes(v));return _}}t.ProtoUtil=c;class o{static longToNumber(b,_){return u.default.isLong(b)?b.toNumber():b instanceof a.flatbuffers.Long?u.default.fromValue({low:b.low,high:b.high,unsigned:_!=null&&_}).toNumber():b}static isLong(b){return u.default.isLong(b)||b instanceof a.flatbuffers.Long}}t.LongUtil=o;class e{static size(b){return e.getSizeFromDimensionRange(b,0,b.length)}static sizeFromDimension(b,_){if(_<0||_>b.length)throw new Error(`invalid dimension of ${_} for sizeFromDimension as Tensor has ${b.length} dimensions.`);return e.getSizeFromDimensionRange(b,_,b.length)}static sizeToDimension(b,_){if(_<0||_>b.length)throw new Error(`invalid dimension of ${_} for sizeToDimension as Tensor has ${b.length} dimensions.`);return e.getSizeFromDimensionRange(b,0,_)}static getSizeFromDimensionRange(b,_,v){let T=1;for(let w=_;w<v;w++){if(b[w]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");T*=b[w]}return T}static computeStrides(b){const _=b.length;if(_===0)return[];if(_===1)return[1];const v=new Array(_);v[_-1]=1,v[_-2]=b[_-1];for(let T=_-3;T>=0;--T)v[T]=v[T+1]*b[T+1];return v}static transpose(b){return b.slice().reverse()}static indicesToOffset(b,_,v){v===void 0&&(v=b.length);let T=0;for(let w=0;w<v;++w)T+=_[w]*b[w];return T}static offsetToIndices(b,_){const v=_.length;if(v===0)return[];if(v===1)return[b*_[0]];const T=new Array(_.length);for(let w=0;w<T.length-1;++w)T[w]=Math.floor(b/_[w]),b-=T[w]*_[w];return T[T.length-1]=b,T}static normalizeAxis(b,_){if(b<-_&&b>=_)throw new Error("unsupported axis for this operation.");return b<0?b+_:b}static normalizeAxes(b,_){return b.map(v=>this.normalizeAxis(v,_))}static incrementIndex(b,_,v){if(_.length===0||b.length===0)throw new Error("Index incrementing unsupported for scalar Tensor");if(v===void 0)v=_.length;else if(v<=0||v>_.length)throw new Error("Incorrect axis to increment on");for(let T=v-1;T>=0&&(b[T]++,!(b[T]<_[T]));--T)b[T]=0}static calculateReshapedDims(b,_){if(_.length===0){if(b.length===0||e.size(b)===1)return[];throw new Error("cannot reshape to a scalar Tensor")}const v=_.length,T=new Array(v);let w=-1,A=1;for(let O=0;O<v;O++){if(_[O]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(_[O]===-1){if(w!==-1)throw new Error("at most one dimension in shape hints can be -1");w=O}else{if(_[O]===0){if(O>=b.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");T[O]=b[O]}else T[O]=_[O];A*=T[O]}}const S=e.size(b);if(w!==-1){if(S%A!=0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${b}] Output shape: [${_}]`);T[w]=S/A}else if(A!==S)throw new Error("reshapedDims and originalDims don't have matching sizes");return T}static sortBasedOnPerm(b,_){return _?_.map(v=>b[v]):b.slice().reverse()}static padShape(b,_){const v=b.length;return b.map((T,w)=>T+_[w]+_[w+v])}static areEqual(b,_){return b.length===_.length&&b.every((v,T)=>v===_[T])}static validateDimsAndCalcSize(b){if(b.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let _=1;for(const v of b){if(!Number.isInteger(v))throw new TypeError(`Invalid shape: ${v} is not an integer`);if(v<0||v>2147483647)throw new TypeError(`Invalid shape: length ${v} is not allowed`);_*=v}return _}static flattenShape(b,_){_<0&&(_+=b.length);const v=b.reduce((w,A)=>w*A,1),T=b.slice(_).reduce((w,A)=>w*A,1);return[v/T,T]}static squeezeShape(b,_){const v=new Array;_=e.normalizeAxes(_,b.length);for(let T=0;T<b.length;T++){const w=_.indexOf(T)>=0;if(w&&b[T]!==1)throw new Error("squeeze an axis of size different than 1");(_.length===0&&b[T]>1||_.length>0&&!w)&&v.push(b[T])}return v}static unsqueezeShape(b,_){const v=new Array(b.length+_.length);v.fill(0);for(let w=0;w<_.length;w++){const A=e.normalizeAxis(_[w],v.length);if(A>=v.length)throw new Error("'axes' has an out of range axis");if(v[A]!==0)throw new Error("'axes' has a duplicate axis");v[A]=1}let T=0;for(let w=0;w<v.length;w++)v[w]===0&&(v[w]=b[T++]);if(T!==b.length)throw new Error("the unsqueezed dimension could not be established");return v}}t.ShapeUtil=e,t.MathUtil=class{static sqr(y,b,_,v,T){if(v<0||v>=b.length)throw new Error("sourceIndex out of bounds");if(_<0||_>=y.length)throw new Error("targetIndex out of bounds");if(v+T>b.length)throw new Error("source indices to be copied are outside bounds");if(_+T>y.length)throw new Error("target array is too small to hold result");for(let w=0;w<T;w++)y[_+w]+=Math.pow(b[v+w],2)}static axpy(y,b,_,v,T,w){if(v<0||v>=b.length)throw new Error("sourceIndex out of bounds");if(_<0||_>=y.length)throw new Error("targetIndex out of bounds");if(v+T>b.length)throw new Error("source indices to be copied are outside bounds");if(_+T>y.length)throw new Error("target array is too small to hold result");for(let A=0;A<T;A++)y[_+A]+=w*b[v+A]}static powx(y,b,_,v,T,w){if(v<0||v>=b.length)throw new Error("sourceIndex out of bounds");if(_<0||_>=y.length)throw new Error("targetIndex out of bounds");if(v+T>b.length)throw new Error("source indices to be copied are outside bounds");if(_+T>y.length)throw new Error("target array is too small to hold result");for(let A=0;A<T;A++)y[_+A]=Math.pow(b[v+A],w)}static mul(y,b,_,v,T){if(v<0||v>=b.length)throw new Error("sourceIndex out of bounds");if(_<0||_>=y.length)throw new Error("targetIndex out of bounds");if(v+T>b.length)throw new Error("source indices to be copied are outside bounds");if(_+T>y.length)throw new Error("target array is too small to hold result");for(let w=0;w<T;w++)y[_+w]=b[v+w]*y[_+w]}};class s{static splitShape(b,_,v,T){if(v.length===0){if(!T)throw new Error("need to know number of outputs when the 'split' attribute is not specified");s.determineSplit(b[_],T,v)}const w=[],A=[0];for(let S=0;S<v.length;++S){S!==0&&A.push(A[S-1]+v[S-1]);const O=b.slice();O[_]=v[S],w.push(O)}return[w,A]}static determineSplit(b,_,v){if(b%_!=0)throw new Error("cannot split tensor to equal sized parts");for(let T=0;T<_;++T)v.push(b/_)}}t.SplitUtil=s;class l{static calcReduce(b,_,v,T,w){const A=b.dims.slice(0);_.length===0&&A.forEach((P,B)=>_.push(B));const S=l.calcReduceShape(A,_,!0),O=e.size(S),C=new f.Tensor(S,b.type),D=e.computeStrides(S),$=e.computeStrides(A),L=new Array(A.length);for(let P=0;P<O;P++){const B=e.offsetToIndices(P,D);p.fillIndex(B,A,L),C.set(B,l.calcReduceByAxis(b.numberData,_,A,0,e.indicesToOffset(L,$),T,w))}return v?C:new f.Tensor(l.calcReduceShape(A,_,v),C.type,void 0,void 0,C.data,C.dataId)}static calcReduceByAxis(b,_,v,T,w,A,S){let O=0;if(T>=_.length)return A(b[w]);const C=_[T],D=C>=v.length?1:e.size(v.slice(C+1));for(let $=0;$<v[C];$++)O=$===0?l.calcReduceByAxis(b,_,v,T+1,w,A,S):S(O,l.calcReduceByAxis(b,_,v,T+1,w,A,S)),w+=D;return O}static calcReduceShape(b,_,v){const T=b.slice();for(let w=0;w<_.length;w++)T[_[w]]=v?1:0;return T.filter(w=>w!==0)}}t.ReduceUtil=l;class g{static adjustPoolAttributes(b,_,v,T,w,A){if(!b&&v.length!==_.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(b)for(let S=0;S<_.length-2;S++)S>=v.length?v.push(_[S+2]):v[S]=_[S+2];for(let S=0;S<v.length;S++)if(S<T.length){if(T[S]<0)throw new Error("strides should be greater than or equal to 1")}else T.push(1);for(let S=0;S<v.length;S++)if(S<w.length){if(w[S]<0)throw new Error("dilations should be greater than or equal to 1")}else w.push(1);for(let S=0;S<2*v.length;S++)if(S<A.length){if(A[S]<0)throw new Error("pad should be greater than or equal to 1")}else A.push(0);for(let S=0;S<v.length;S++){if(v[S]<=0)throw new Error("kernel shapes need to be greater than 0");if(A[S]>=v[S]||A[S+v.length]>=v[S])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(b,_,v,T,w,A){if(A){if(w.length!==2*(b.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(_.length!==b.length-2)throw new Error("length of strides should be the length of data dimensions");if(T.length!==b.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let S=0;S<b.length-2;S++)g.adjustPadAndReturnShape(b[S+2],_[S],v[S],T[S],w,S,S+b.length-2,A)}}static computePoolOutputShape(b,_,v,T,w,A,S){if(_.length<=0)throw new Error("input shape must be of size greater than 0");const O=[_[0],_[1]];return g.computeShapeHelper(b,_,O,v,T,w,A,S),O}static computeConvOutputShape(b,_,v,T,w,A,S){if(b.length<=0||_.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");const O=[b[0],_[0]];return g.computeShapeHelper(!1,b,O,v,T,w,A,S),O}static computeShapeHelper(b,_,v,T,w,A,S,O){if(b)for(let C=0;C<_.length-2;C++)v.push(1);else for(let C=0;C<_.length-2;C++)v.push(g.adjustPadAndReturnShape(_[C+2],T[C],w[C],A[C],S,C,C+_.length-2,O))}static adjustPadAndReturnShape(b,_,v,T,w,A,S,O){const C=v*(T-1)+1;if(!O||O==="NOTSET")return Math.floor((b+w[A]+w[S]-C)/_+1);switch(O){case"VALID":return w[A]=0,w[S]=0,Math.floor((b-C)/_+1);case"SAME_LOWER":case"SAME_UPPER":if(v!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{const D=((b+_-1)/_-1)*_+T-b;return w[A]=Math.floor(O==="SAME_LOWER"?(D+1)/2:D/2),w[S]=D-w[A],Math.floor((b+D-T)/_+1)}default:throw new Error("Unsupported AutoPad type")}}}t.PoolConvUtil=g,t.MIN_CLIP=-34028234663852886e22,t.MAX_CLIP=34028234663852886e22,t.decodeUtf8String=function(y){return new TextDecoder().decode(y)}},8408:(m,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="1.16.3"},9544:function(m,t,n){var r,a=this&&this.__createBinding||(Object.create?function(D,$,L,P){P===void 0&&(P=L);var B=Object.getOwnPropertyDescriptor($,L);B&&!("get"in B?!$.__esModule:B.writable||B.configurable)||(B={enumerable:!0,get:function(){return $[L]}}),Object.defineProperty(D,P,B)}:function(D,$,L,P){P===void 0&&(P=L),D[P]=$[L]}),u=this&&this.__setModuleDefault||(Object.create?function(D,$){Object.defineProperty(D,"default",{enumerable:!0,value:$})}:function(D,$){D.default=$}),h=this&&this.__importStar||function(D){if(D&&D.__esModule)return D;var $={};if(D!=null)for(var L in D)L!=="default"&&Object.prototype.hasOwnProperty.call(D,L)&&a($,D,L);return u($,D),$};Object.defineProperty(t,"__esModule",{value:!0}),t.endProfiling=t.run=t.releaseSession=t.createSession=t.createSessionFinalize=t.createSessionAllocate=t.initializeRuntime=t.initializeWebAssemblyInstance=void 0;const f=n(2235),d=h(n(1259)),p=n(263),c=()=>!!f.env.wasm.proxy&&typeof document<"u";let o,e,s,l=!1,g=!1,y=!1;const b=[],_=[],v=[],T=[],w=[],A=[],S=()=>{if(l||!g||y||!o)throw new Error("worker not ready")},O=D=>{switch(D.data.type){case"init-wasm":l=!1,D.data.err?(y=!0,e[1](D.data.err)):(g=!0,e[0]());break;case"init-ort":D.data.err?s[1](D.data.err):s[0]();break;case"create_allocate":D.data.err?b.shift()[1](D.data.err):b.shift()[0](D.data.out);break;case"create_finalize":D.data.err?_.shift()[1](D.data.err):_.shift()[0](D.data.out);break;case"create":D.data.err?v.shift()[1](D.data.err):v.shift()[0](D.data.out);break;case"release":D.data.err?T.shift()[1](D.data.err):T.shift()[0]();break;case"run":D.data.err?w.shift()[1](D.data.err):w.shift()[0](D.data.out);break;case"end-profiling":D.data.err?A.shift()[1](D.data.err):A.shift()[0]()}},C=typeof document<"u"?(r=document==null?void 0:document.currentScript)===null||r===void 0?void 0:r.src:void 0;t.initializeWebAssemblyInstance=async()=>{if(c()){if(g)return;if(l)throw new Error("multiple calls to 'initWasm()' detected.");if(y)throw new Error("previous call to 'initWasm()' failed.");return l=!0,f.env.wasm.wasmPaths===void 0&&C&&C.indexOf("blob:")!==0&&(f.env.wasm.wasmPaths=C.substr(0,+C.lastIndexOf("/")+1)),new Promise((D,$)=>{o==null||o.terminate(),o=n(8050).Z(),o.onmessage=O,e=[D,$];const L={type:"init-wasm",in:f.env.wasm};o.postMessage(L)})}return(0,p.initializeWebAssembly)(f.env.wasm)},t.initializeRuntime=async D=>{if(c())return S(),new Promise(($,L)=>{s=[$,L];const P={type:"init-ort",in:D};o.postMessage(P)});await d.initRuntime(D)},t.createSessionAllocate=async D=>c()?(S(),new Promise(($,L)=>{b.push([$,L]);const P={type:"create_allocate",in:{model:D}};o.postMessage(P,[D.buffer])})):d.createSessionAllocate(D),t.createSessionFinalize=async(D,$)=>c()?(S(),new Promise((L,P)=>{_.push([L,P]);const B={type:"create_finalize",in:{modeldata:D,options:$}};o.postMessage(B)})):d.createSessionFinalize(D,$),t.createSession=async(D,$)=>c()?(S(),new Promise((L,P)=>{v.push([L,P]);const B={type:"create",in:{model:D,options:$}};o.postMessage(B,[D.buffer])})):d.createSession(D,$),t.releaseSession=async D=>{if(c())return S(),new Promise(($,L)=>{T.push([$,L]);const P={type:"release",in:D};o.postMessage(P)});d.releaseSession(D)},t.run=async(D,$,L,P,B)=>c()?(S(),new Promise((I,M)=>{w.push([I,M]);const k={type:"run",in:{sessionId:D,inputIndices:$,inputs:L,outputIndices:P,options:B}};o.postMessage(k,d.extractTransferableBuffers(L))})):d.run(D,$,L,P,B),t.endProfiling=async D=>{if(c())return S(),new Promise(($,L)=>{A.push([$,L]);const P={type:"end-profiling",in:D};o.postMessage(P)});d.endProfiling(D)}},7918:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setRunOptions=void 0;const r=n(263),a=n(1497);t.setRunOptions=u=>{const h=(0,r.getInstance)();let f=0;const d=[],p=u||{};try{if((u==null?void 0:u.logSeverityLevel)===void 0)p.logSeverityLevel=2;else if(typeof u.logSeverityLevel!="number"||!Number.isInteger(u.logSeverityLevel)||u.logSeverityLevel<0||u.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${u.logSeverityLevel}`);if((u==null?void 0:u.logVerbosityLevel)===void 0)p.logVerbosityLevel=0;else if(typeof u.logVerbosityLevel!="number"||!Number.isInteger(u.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${u.logVerbosityLevel}`);(u==null?void 0:u.terminate)===void 0&&(p.terminate=!1);let c=0;return(u==null?void 0:u.tag)!==void 0&&(c=(0,a.allocWasmString)(u.tag,d)),f=h._OrtCreateRunOptions(p.logSeverityLevel,p.logVerbosityLevel,!!p.terminate,c),f===0&&(0,a.checkLastError)("Can't create run options."),(u==null?void 0:u.extra)!==void 0&&(0,a.iterateExtraOptions)(u.extra,"",new WeakSet,(o,e)=>{const s=(0,a.allocWasmString)(o,d),l=(0,a.allocWasmString)(e,d);h._OrtAddRunConfigEntry(f,s,l)!==0&&(0,a.checkLastError)(`Can't set a run config entry: ${o} - ${e}.`)}),[f,d]}catch(c){throw f!==0&&h._OrtReleaseRunOptions(f),d.forEach(o=>h._free(o)),c}}},6640:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OnnxruntimeWebAssemblySessionHandler=void 0;const r=n(2806),a=n(2235),u=n(2850),h=n(9544);let f;t.OnnxruntimeWebAssemblySessionHandler=class{async createSessionAllocate(d){const p=await fetch(d);if(p.status!==200)throw new Error(`failed to load model: ${d}`);const c=await p.arrayBuffer();return(0,h.createSessionAllocate)(new Uint8Array(c))}async loadModel(d,p){if(f||(await(0,h.initializeRuntime)(a.env),f=!0),typeof d=="string")if(typeof process<"u"&&process.versions&&process.versions.node){const c=await(0,u.promisify)(r.readFile)(d);[this.sessionId,this.inputNames,this.outputNames]=await(0,h.createSession)(c,p)}else{const c=await this.createSessionAllocate(d);[this.sessionId,this.inputNames,this.outputNames]=await(0,h.createSessionFinalize)(c,p)}else[this.sessionId,this.inputNames,this.outputNames]=await(0,h.createSession)(d,p)}async dispose(){return(0,h.releaseSession)(this.sessionId)}async run(d,p,c){const o=[],e=[];Object.entries(d).forEach(y=>{const b=y[0],_=y[1],v=this.inputNames.indexOf(b);if(v===-1)throw new Error(`invalid input '${b}'`);o.push(_),e.push(v)});const s=[];Object.entries(p).forEach(y=>{const b=y[0],_=this.outputNames.indexOf(b);if(_===-1)throw new Error(`invalid output '${b}'`);s.push(_)});const l=await(0,h.run)(this.sessionId,e,o.map(y=>[y.type,y.dims,y.data]),s,c),g={};for(let y=0;y<l.length;y++)g[this.outputNames[s[y]]]=new a.Tensor(l[y][0],l[y][2],l[y][1]);return g}startProfiling(){}endProfiling(){(0,h.endProfiling)(this.sessionId)}}},7622:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setSessionOptions=void 0;const r=n(263),a=n(1497);t.setSessionOptions=u=>{var h,f,d,p;const c=(0,r.getInstance)();let o=0;const e=[],s=u||{};(l=>{l.extra||(l.extra={}),l.extra.session||(l.extra.session={});const g=l.extra.session;g.use_ort_model_bytes_directly||(g.use_ort_model_bytes_directly="1"),l.executionProviders&&l.executionProviders.some(y=>(typeof y=="string"?y:y.name)==="webgpu")&&(l.enableMemPattern=!1)})(s);try{const l=(T=>{switch(T){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${T}`)}})((h=s.graphOptimizationLevel)!==null&&h!==void 0?h:"all"),g=(T=>{switch(T){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${T}`)}})((f=s.executionMode)!==null&&f!==void 0?f:"sequential"),y=typeof s.logId=="string"?(0,a.allocWasmString)(s.logId,e):0,b=(d=s.logSeverityLevel)!==null&&d!==void 0?d:2;if(!Number.isInteger(b)||b<0||b>4)throw new Error(`log serverity level is not valid: ${b}`);const _=(p=s.logVerbosityLevel)!==null&&p!==void 0?p:0;if(!Number.isInteger(_)||_<0||_>4)throw new Error(`log verbosity level is not valid: ${_}`);const v=typeof s.optimizedModelFilePath=="string"?(0,a.allocWasmString)(s.optimizedModelFilePath,e):0;return o=c._OrtCreateSessionOptions(l,!!s.enableCpuMemArena,!!s.enableMemPattern,g,!!s.enableProfiling,0,y,b,_,v),o===0&&(0,a.checkLastError)("Can't create session options."),s.executionProviders&&((T,w,A)=>{for(const S of w){let O=typeof S=="string"?S:S.name;switch(O){case"xnnpack":O="XNNPACK";break;case"webnn":if(O="WEBNN",typeof S!="string"){const D=S;if(D!=null&&D.deviceType){const $=(0,a.allocWasmString)("deviceType",A),L=(0,a.allocWasmString)(D.deviceType,A);(0,r.getInstance)()._OrtAddSessionConfigEntry(T,$,L)!==0&&(0,a.checkLastError)(`Can't set a session config entry: 'deviceType' - ${D.deviceType}.`)}if(D!=null&&D.powerPreference){const $=(0,a.allocWasmString)("powerPreference",A),L=(0,a.allocWasmString)(D.powerPreference,A);(0,r.getInstance)()._OrtAddSessionConfigEntry(T,$,L)!==0&&(0,a.checkLastError)(`Can't set a session config entry: 'powerPreference' - ${D.powerPreference}.`)}}break;case"webgpu":O="JS";break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${O}`)}const C=(0,a.allocWasmString)(O,A);(0,r.getInstance)()._OrtAppendExecutionProvider(T,C)!==0&&(0,a.checkLastError)(`Can't append execution provider: ${O}.`)}})(o,s.executionProviders,e),s.extra!==void 0&&(0,a.iterateExtraOptions)(s.extra,"",new WeakSet,(T,w)=>{const A=(0,a.allocWasmString)(T,e),S=(0,a.allocWasmString)(w,e);c._OrtAddSessionConfigEntry(o,A,S)!==0&&(0,a.checkLastError)(`Can't set a session config entry: ${T} - ${w}.`)}),[o,e]}catch(l){throw o!==0&&c._OrtReleaseSessionOptions(o),e.forEach(g=>c._free(g)),l}}},7917:(m,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logLevelStringToEnum=t.tensorTypeToTypedArrayConstructor=t.getTensorElementSize=t.tensorDataTypeEnumToString=t.tensorDataTypeStringToEnum=void 0,t.tensorDataTypeStringToEnum=n=>{switch(n){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${n}`)}},t.tensorDataTypeEnumToString=n=>{switch(n){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${n}`)}},t.getTensorElementSize=n=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][n],t.tensorTypeToTypedArrayConstructor=n=>{switch(n){case"float16":case"uint16":return Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${n}`)}},t.logLevelStringToEnum=n=>{switch(n){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${n}`)}}},1259:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.extractTransferableBuffers=t.endProfiling=t.run=t.releaseSession=t.createSession=t.createSessionFinalize=t.createSessionAllocate=t.initRuntime=void 0;const r=n(7918),a=n(7622),u=n(7917),h=n(263),f=n(1497);t.initRuntime=async p=>{var c,o;c=p.wasm.numThreads,o=(0,u.logLevelStringToEnum)(p.logLevel),(0,h.getInstance)()._OrtInit(c,o)!==0&&(0,f.checkLastError)("Can't initialize onnxruntime.")};const d=new Map;t.createSessionAllocate=p=>{const c=(0,h.getInstance)(),o=c._malloc(p.byteLength);if(o===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${p.byteLength}.`);return c.HEAPU8.set(p,o),[o,p.byteLength]},t.createSessionFinalize=(p,c)=>{const o=(0,h.getInstance)();let e=0,s=0,l=[];const g=[],y=[];try{[s,l]=(0,a.setSessionOptions)(c),e=o._OrtCreateSession(p[0],p[1],s),e===0&&(0,f.checkLastError)("Can't create a session.");const[b,_]=(w=>{const A=(0,h.getInstance)(),S=A.stackSave();try{const O=A.stackAlloc(8);return A._OrtGetInputOutputCount(w,O,O+4)!==0&&(0,f.checkLastError)("Can't get session input/output count."),[A.HEAP32[O/4],A.HEAP32[O/4+1]]}finally{A.stackRestore(S)}})(e),v=[],T=[];for(let w=0;w<b;w++){const A=o._OrtGetInputName(e,w);A===0&&(0,f.checkLastError)("Can't get an input name."),g.push(A),v.push(o.UTF8ToString(A))}for(let w=0;w<_;w++){const A=o._OrtGetOutputName(e,w);A===0&&(0,f.checkLastError)("Can't get an output name."),y.push(A),T.push(o.UTF8ToString(A))}return d.set(e,[e,g,y]),[e,v,T]}catch(b){throw g.forEach(_=>o._OrtFree(_)),y.forEach(_=>o._OrtFree(_)),e!==0&&o._OrtReleaseSession(e),b}finally{o._free(p[0]),s!==0&&o._OrtReleaseSessionOptions(s),l.forEach(b=>o._free(b))}},t.createSession=(p,c)=>{const o=(0,t.createSessionAllocate)(p);return(0,t.createSessionFinalize)(o,c)},t.releaseSession=p=>{const c=(0,h.getInstance)(),o=d.get(p);if(!o)throw new Error(`cannot release session. invalid session id: ${p}`);const[e,s,l]=o;s.forEach(g=>c._OrtFree(g)),l.forEach(g=>c._OrtFree(g)),c._OrtReleaseSession(e),d.delete(p)},t.run=async(p,c,o,e,s)=>{const l=(0,h.getInstance)(),g=d.get(p);if(!g)throw new Error(`cannot run inference. invalid session id: ${p}`);const[y,b,_]=g,v=c.length,T=e.length;let w=0,A=[];const S=[],O=[];try{[w,A]=(0,r.setRunOptions)(s);for(let B=0;B<v;B++){const I=o[B][0],M=o[B][1],k=o[B][2];let X,G;if(Array.isArray(k)){G=4*k.length,X=l._malloc(G),O.push(X);let Q=X/4;for(let tt=0;tt<k.length;tt++){if(typeof k[tt]!="string")throw new TypeError(`tensor data at index ${tt} is not a string`);l.HEAPU32[Q++]=(0,f.allocWasmString)(k[tt],O)}}else G=k.byteLength,X=l._malloc(G),O.push(X),l.HEAPU8.set(new Uint8Array(k.buffer,k.byteOffset,G),X);const J=l.stackSave(),Y=l.stackAlloc(4*M.length);try{let Q=Y/4;M.forEach(nt=>l.HEAP32[Q++]=nt);const tt=l._OrtCreateTensor((0,u.tensorDataTypeStringToEnum)(I),X,G,Y,M.length);tt===0&&(0,f.checkLastError)(`Can't create tensor for input[${B}].`),S.push(tt)}finally{l.stackRestore(J)}}const C=l.stackSave(),D=l.stackAlloc(4*v),$=l.stackAlloc(4*v),L=l.stackAlloc(4*T),P=l.stackAlloc(4*T);try{let B=D/4,I=$/4,M=L/4,k=P/4;for(let Y=0;Y<v;Y++)l.HEAPU32[B++]=S[Y],l.HEAPU32[I++]=b[c[Y]];for(let Y=0;Y<T;Y++)l.HEAPU32[M++]=0,l.HEAPU32[k++]=_[e[Y]];let X=l._OrtRun(y,$,D,v,P,T,L,w);const G=l.jsepRunPromise;G&&G.then!==void 0&&(X=await G);const J=[];X!==0&&(0,f.checkLastError)("failed to call OrtRun().");for(let Y=0;Y<T;Y++){const Q=l.HEAPU32[L/4+Y],tt=l.stackSave(),nt=l.stackAlloc(16);let ot,lt=0;try{X=l._OrtGetTensorData(Q,nt,nt+4,nt+8,nt+12),X!==0&&(0,f.checkLastError)(`Can't access output tensor data on index ${Y}.`);let ut=nt/4;const gt=l.HEAPU32[ut++];lt=l.HEAPU32[ut++];const xt=l.HEAPU32[ut++],pt=l.HEAPU32[ut++],vt=[];for(let ft=0;ft<pt;ft++)vt.push(l.HEAPU32[xt/4+ft]);l._OrtFree(xt);const Ct=vt.length===0?1:vt.reduce((ft,Tt)=>ft*Tt);if(ot=(0,u.tensorDataTypeEnumToString)(gt),ot==="string"){const ft=[];let Tt=lt/4;for(let Pt=0;Pt<Ct;Pt++){const It=l.HEAPU32[Tt++],Mt=Pt===Ct-1?void 0:l.HEAPU32[Tt]-It;ft.push(l.UTF8ToString(It,Mt))}J.push([ot,vt,ft])}else{const ft=new((0,u.tensorTypeToTypedArrayConstructor)(ot))(Ct);new Uint8Array(ft.buffer,ft.byteOffset,ft.byteLength).set(l.HEAPU8.subarray(lt,lt+ft.byteLength)),J.push([ot,vt,ft])}}finally{l.stackRestore(tt),ot==="string"&&lt&&l._free(lt),l._OrtReleaseTensor(Q)}}return J}finally{l.stackRestore(C)}}finally{S.forEach(C=>l._OrtReleaseTensor(C)),O.forEach(C=>l._free(C)),w!==0&&l._OrtReleaseRunOptions(w),A.forEach(C=>l._free(C))}},t.endProfiling=p=>{const c=(0,h.getInstance)(),o=d.get(p);if(!o)throw new Error("invalid session id");const e=o[0],s=c._OrtEndProfiling(e);s===0&&(0,f.checkLastError)("Can't get an profile file name."),c._OrtFree(s)},t.extractTransferableBuffers=p=>{const c=[];for(const o of p){const e=o[2];!Array.isArray(e)&&e.buffer&&c.push(e.buffer)}return c}},263:function(m,t,n){var r=this&&this.__createBinding||(Object.create?function(s,l,g,y){y===void 0&&(y=g);var b=Object.getOwnPropertyDescriptor(l,g);b&&!("get"in b?!l.__esModule:b.writable||b.configurable)||(b={enumerable:!0,get:function(){return l[g]}}),Object.defineProperty(s,y,b)}:function(s,l,g,y){y===void 0&&(y=g),s[y]=l[g]}),a=this&&this.__setModuleDefault||(Object.create?function(s,l){Object.defineProperty(s,"default",{enumerable:!0,value:l})}:function(s,l){s.default=l}),u=this&&this.__importStar||function(s){if(s&&s.__esModule)return s;var l={};if(s!=null)for(var g in s)g!=="default"&&Object.prototype.hasOwnProperty.call(s,g)&&r(l,s,g);return a(l,s),l};Object.defineProperty(t,"__esModule",{value:!0}),t.dispose=t.getInstance=t.initializeWebAssembly=void 0;const h=u(n(6449)),f=n(932),d=n(3474);let p,c=!1,o=!1,e=!1;t.initializeWebAssembly=async s=>{if(c)return Promise.resolve();if(o)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(e)throw new Error("previous call to 'initializeWebAssembly()' failed.");o=!0;const l=s.initTimeout,g=s.numThreads,y=s.simd,b=g>1&&(()=>{try{return typeof SharedArrayBuffer<"u"&&(typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch{return!1}})(),_=y&&(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}})(),v=s.wasmPaths,T=typeof v=="string"?v:void 0,w=((C,D)=>D?C?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":C?"ort-wasm-simd.wasm":"ort-wasm.wasm")(_,b),A=typeof v=="object"?v[w]:void 0;let S=!1;const O=[];if(l>0&&O.push(new Promise(C=>{setTimeout(()=>{S=!0,C()},l)})),O.push(new Promise((C,D)=>{const $=b?d:f,L={locateFile:(P,B)=>b&&P.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([n(4154)],{type:"text/javascript"})):P.endsWith(".wasm")?A||(T??B)+w:B+P};if(b)if(typeof Blob>"u")L.mainScriptUrlOrBlob=h.join(__dirname,"ort-wasm-threaded.js");else{const P=`var ortWasmThreaded=(function(){var _scriptDir;return ${$.toString()}})();`;L.mainScriptUrlOrBlob=new Blob([P],{type:"text/javascript"})}$(L).then(P=>{o=!1,c=!0,p=P,C()},P=>{o=!1,e=!0,D(P)})})),await Promise.race(O),S)throw new Error(`WebAssembly backend initializing failed due to timeout: ${l}ms`)},t.getInstance=()=>{if(c&&p)return p;throw new Error("WebAssembly is not initialized yet.")},t.dispose=()=>{var s;!c||o||e||(o=!0,(s=p.PThread)===null||s===void 0||s.terminateAllThreads(),p=void 0,o=!1,c=!1,e=!0)}},1497:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkLastError=t.iterateExtraOptions=t.allocWasmString=void 0;const r=n(263);t.allocWasmString=(a,u)=>{const h=(0,r.getInstance)(),f=h.lengthBytesUTF8(a)+1,d=h._malloc(f);return h.stringToUTF8(a,d,f),u.push(d),d},t.iterateExtraOptions=(a,u,h,f)=>{if(typeof a=="object"&&a!==null){if(h.has(a))throw new Error("Circular reference in options");h.add(a)}Object.entries(a).forEach(([d,p])=>{const c=u?u+d:d;if(typeof p=="object")(0,t.iterateExtraOptions)(p,c+".",h,f);else if(typeof p=="string"||typeof p=="number")f(c,p.toString());else{if(typeof p!="boolean")throw new Error("Can't handle extra config type: "+typeof p);f(c,p?"1":"0")}})},t.checkLastError=a=>{const u=(0,r.getInstance)(),h=u.stackSave();try{const f=u.stackAlloc(8);u._OrtGetLastError(f,f+4);const d=u.HEAP32[f/4],p=u.HEAPU32[f/4+1],c=p?u.UTF8ToString(p):"";throw new Error(`${a} ERROR_CODE: ${d}, ERROR_MESSAGE: ${c}`)}finally{u.stackRestore(h)}}},8050:(m,t,n)=>{n.d(t,{Z:()=>u});var r=n(6614),a=n.n(r);function u(){return a()('/*!\n* ONNX Runtime Web v1.16.3\n* Copyright (c) Microsoft Corporation. All rights reserved.\n* Licensed under the MIT License.\n*/\n(()=>{var e={918:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setRunOptions=void 0;const n=r(263),a=r(497);t.setRunOptions=e=>{const t=(0,n.getInstance)();let r=0;const o=[],i=e||{};try{if(void 0===(null==e?void 0:e.logSeverityLevel))i.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(void 0===(null==e?void 0:e.logVerbosityLevel))i.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);void 0===(null==e?void 0:e.terminate)&&(i.terminate=!1);let n=0;return void 0!==(null==e?void 0:e.tag)&&(n=(0,a.allocWasmString)(e.tag,o)),r=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,n),0===r&&(0,a.checkLastError)("Can\'t create run options."),void 0!==(null==e?void 0:e.extra)&&(0,a.iterateExtraOptions)(e.extra,"",new WeakSet,((e,n)=>{const i=(0,a.allocWasmString)(e,o),s=(0,a.allocWasmString)(n,o);0!==t._OrtAddRunConfigEntry(r,i,s)&&(0,a.checkLastError)(`Can\'t set a run config entry: ${e} - ${n}.`)})),[r,o]}catch(e){throw 0!==r&&t._OrtReleaseRunOptions(r),o.forEach((e=>t._free(e))),e}}},622:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSessionOptions=void 0;const n=r(263),a=r(497);t.setSessionOptions=e=>{var t,r,o,i;const s=(0,n.getInstance)();let u=0;const c=[],l=e||{};(e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});const t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some((e=>"webgpu"===("string"==typeof e?e:e.name)))&&(e.enableMemPattern=!1)})(l);try{const e=(e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}})(null!==(t=l.graphOptimizationLevel)&&void 0!==t?t:"all"),f=(e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}})(null!==(r=l.executionMode)&&void 0!==r?r:"sequential"),d="string"==typeof l.logId?(0,a.allocWasmString)(l.logId,c):0,p=null!==(o=l.logSeverityLevel)&&void 0!==o?o:2;if(!Number.isInteger(p)||p<0||p>4)throw new Error(`log serverity level is not valid: ${p}`);const g=null!==(i=l.logVerbosityLevel)&&void 0!==i?i:0;if(!Number.isInteger(g)||g<0||g>4)throw new Error(`log verbosity level is not valid: ${g}`);const h="string"==typeof l.optimizedModelFilePath?(0,a.allocWasmString)(l.optimizedModelFilePath,c):0;return u=s._OrtCreateSessionOptions(e,!!l.enableCpuMemArena,!!l.enableMemPattern,f,!!l.enableProfiling,0,d,p,g,h),0===u&&(0,a.checkLastError)("Can\'t create session options."),l.executionProviders&&((e,t,r)=>{for(const o of t){let t="string"==typeof o?o:o.name;switch(t){case"xnnpack":t="XNNPACK";break;case"webnn":if(t="WEBNN","string"!=typeof o){const t=o;if(null==t?void 0:t.deviceType){const o=(0,a.allocWasmString)("deviceType",r),i=(0,a.allocWasmString)(t.deviceType,r);0!==(0,n.getInstance)()._OrtAddSessionConfigEntry(e,o,i)&&(0,a.checkLastError)(`Can\'t set a session config entry: \'deviceType\' - ${t.deviceType}.`)}if(null==t?void 0:t.powerPreference){const o=(0,a.allocWasmString)("powerPreference",r),i=(0,a.allocWasmString)(t.powerPreference,r);0!==(0,n.getInstance)()._OrtAddSessionConfigEntry(e,o,i)&&(0,a.checkLastError)(`Can\'t set a session config entry: \'powerPreference\' - ${t.powerPreference}.`)}}break;case"webgpu":t="JS";break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${t}`)}const i=(0,a.allocWasmString)(t,r);0!==(0,n.getInstance)()._OrtAppendExecutionProvider(e,i)&&(0,a.checkLastError)(`Can\'t append execution provider: ${t}.`)}})(u,l.executionProviders,c),void 0!==l.extra&&(0,a.iterateExtraOptions)(l.extra,"",new WeakSet,((e,t)=>{const r=(0,a.allocWasmString)(e,c),n=(0,a.allocWasmString)(t,c);0!==s._OrtAddSessionConfigEntry(u,r,n)&&(0,a.checkLastError)(`Can\'t set a session config entry: ${e} - ${t}.`)})),[u,c]}catch(e){throw 0!==u&&s._OrtReleaseSessionOptions(u),c.forEach((e=>s._free(e))),e}}},917:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logLevelStringToEnum=t.tensorTypeToTypedArrayConstructor=t.getTensorElementSize=t.tensorDataTypeEnumToString=t.tensorDataTypeStringToEnum=void 0,t.tensorDataTypeStringToEnum=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},t.tensorDataTypeEnumToString=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},t.getTensorElementSize=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],t.tensorTypeToTypedArrayConstructor=e=>{switch(e){case"float16":case"uint16":return Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},t.logLevelStringToEnum=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}}},259:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractTransferableBuffers=t.endProfiling=t.run=t.releaseSession=t.createSession=t.createSessionFinalize=t.createSessionAllocate=t.initRuntime=void 0;const n=r(918),a=r(622),o=r(917),i=r(263),s=r(497);t.initRuntime=async e=>{var t,r;t=e.wasm.numThreads,r=(0,o.logLevelStringToEnum)(e.logLevel),0!==(0,i.getInstance)()._OrtInit(t,r)&&(0,s.checkLastError)("Can\'t initialize onnxruntime.")};const u=new Map;t.createSessionAllocate=e=>{const t=(0,i.getInstance)(),r=t._malloc(e.byteLength);if(0===r)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},t.createSessionFinalize=(e,t)=>{const r=(0,i.getInstance)();let n=0,o=0,c=[];const l=[],f=[];try{[o,c]=(0,a.setSessionOptions)(t),n=r._OrtCreateSession(e[0],e[1],o),0===n&&(0,s.checkLastError)("Can\'t create a session.");const[d,p]=(e=>{const t=(0,i.getInstance)(),r=t.stackSave();try{const r=t.stackAlloc(8);return 0!==t._OrtGetInputOutputCount(e,r,r+4)&&(0,s.checkLastError)("Can\'t get session input/output count."),[t.HEAP32[r/4],t.HEAP32[r/4+1]]}finally{t.stackRestore(r)}})(n),g=[],h=[];for(let e=0;e<d;e++){const t=r._OrtGetInputName(n,e);0===t&&(0,s.checkLastError)("Can\'t get an input name."),l.push(t),g.push(r.UTF8ToString(t))}for(let e=0;e<p;e++){const t=r._OrtGetOutputName(n,e);0===t&&(0,s.checkLastError)("Can\'t get an output name."),f.push(t),h.push(r.UTF8ToString(t))}return u.set(n,[n,l,f]),[n,g,h]}catch(e){throw l.forEach((e=>r._OrtFree(e))),f.forEach((e=>r._OrtFree(e))),0!==n&&r._OrtReleaseSession(n),e}finally{r._free(e[0]),0!==o&&r._OrtReleaseSessionOptions(o),c.forEach((e=>r._free(e)))}},t.createSession=(e,r)=>{const n=(0,t.createSessionAllocate)(e);return(0,t.createSessionFinalize)(n,r)},t.releaseSession=e=>{const t=(0,i.getInstance)(),r=u.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);const[n,a,o]=r;a.forEach((e=>t._OrtFree(e))),o.forEach((e=>t._OrtFree(e))),t._OrtReleaseSession(n),u.delete(e)},t.run=async(e,t,r,a,c)=>{const l=(0,i.getInstance)(),f=u.get(e);if(!f)throw new Error(`cannot run inference. invalid session id: ${e}`);const[d,p,g]=f,h=t.length,m=a.length;let y=0,v=[];const b=[],w=[];try{[y,v]=(0,n.setRunOptions)(c);for(let e=0;e<h;e++){const t=r[e][0],n=r[e][1],a=r[e][2];let i,u;if(Array.isArray(a)){u=4*a.length,i=l._malloc(u),w.push(i);let e=i/4;for(let t=0;t<a.length;t++){if("string"!=typeof a[t])throw new TypeError(`tensor data at index ${t} is not a string`);l.HEAPU32[e++]=(0,s.allocWasmString)(a[t],w)}}else u=a.byteLength,i=l._malloc(u),w.push(i),l.HEAPU8.set(new Uint8Array(a.buffer,a.byteOffset,u),i);const c=l.stackSave(),f=l.stackAlloc(4*n.length);try{let r=f/4;n.forEach((e=>l.HEAP32[r++]=e));const a=l._OrtCreateTensor((0,o.tensorDataTypeStringToEnum)(t),i,u,f,n.length);0===a&&(0,s.checkLastError)(`Can\'t create tensor for input[${e}].`),b.push(a)}finally{l.stackRestore(c)}}const e=l.stackSave(),i=l.stackAlloc(4*h),u=l.stackAlloc(4*h),f=l.stackAlloc(4*m),_=l.stackAlloc(4*m);try{let e=i/4,r=u/4,n=f/4,c=_/4;for(let n=0;n<h;n++)l.HEAPU32[e++]=b[n],l.HEAPU32[r++]=p[t[n]];for(let e=0;e<m;e++)l.HEAPU32[n++]=0,l.HEAPU32[c++]=g[a[e]];let v=l._OrtRun(d,u,i,h,_,m,f,y);const w=l.jsepRunPromise;w&&void 0!==w.then&&(v=await w);const O=[];0!==v&&(0,s.checkLastError)("failed to call OrtRun().");for(let e=0;e<m;e++){const t=l.HEAPU32[f/4+e],r=l.stackSave(),n=l.stackAlloc(16);let a,i=0;try{v=l._OrtGetTensorData(t,n,n+4,n+8,n+12),0!==v&&(0,s.checkLastError)(`Can\'t access output tensor data on index ${e}.`);let r=n/4;const u=l.HEAPU32[r++];i=l.HEAPU32[r++];const c=l.HEAPU32[r++],f=l.HEAPU32[r++],d=[];for(let e=0;e<f;e++)d.push(l.HEAPU32[c/4+e]);l._OrtFree(c);const p=0===d.length?1:d.reduce(((e,t)=>e*t));if(a=(0,o.tensorDataTypeEnumToString)(u),"string"===a){const e=[];let t=i/4;for(let r=0;r<p;r++){const n=l.HEAPU32[t++],a=r===p-1?void 0:l.HEAPU32[t]-n;e.push(l.UTF8ToString(n,a))}O.push([a,d,e])}else{const e=new((0,o.tensorTypeToTypedArrayConstructor)(a))(p);new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(l.HEAPU8.subarray(i,i+e.byteLength)),O.push([a,d,e])}}finally{l.stackRestore(r),"string"===a&&i&&l._free(i),l._OrtReleaseTensor(t)}}return O}finally{l.stackRestore(e)}}finally{b.forEach((e=>l._OrtReleaseTensor(e))),w.forEach((e=>l._free(e))),0!==y&&l._OrtReleaseRunOptions(y),v.forEach((e=>l._free(e)))}},t.endProfiling=e=>{const t=(0,i.getInstance)(),r=u.get(e);if(!r)throw new Error("invalid session id");const n=r[0],a=t._OrtEndProfiling(n);0===a&&(0,s.checkLastError)("Can\'t get an profile file name."),t._OrtFree(a)},t.extractTransferableBuffers=e=>{const t=[];for(const r of e){const e=r[2];!Array.isArray(e)&&e.buffer&&t.push(e.buffer)}return t}},263:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.dispose=t.getInstance=t.initializeWebAssembly=void 0;const i=o(r(449)),s=r(932),u=r(474);let c,l=!1,f=!1,d=!1;t.initializeWebAssembly=async e=>{if(l)return Promise.resolve();if(f)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(d)throw new Error("previous call to \'initializeWebAssembly()\' failed.");f=!0;const t=e.initTimeout,n=e.numThreads,a=e.simd,o=n>1&&(()=>{try{return"undefined"!=typeof SharedArrayBuffer&&("undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch(e){return!1}})(),p=a&&(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch(e){return!1}})(),g=e.wasmPaths,h="string"==typeof g?g:void 0,m=((e,t)=>t?e?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":e?"ort-wasm-simd.wasm":"ort-wasm.wasm")(p,o),y="object"==typeof g?g[m]:void 0;let v=!1;const b=[];if(t>0&&b.push(new Promise((e=>{setTimeout((()=>{v=!0,e()}),t)}))),b.push(new Promise(((e,t)=>{const n=o?u:s,a={locateFile:(e,t)=>o&&e.endsWith(".worker.js")&&"undefined"!=typeof Blob?URL.createObjectURL(new Blob([r(154)],{type:"text/javascript"})):e.endsWith(".wasm")?y||(null!=h?h:t)+m:t+e};if(o)if("undefined"==typeof Blob)a.mainScriptUrlOrBlob=i.join(__dirname,"ort-wasm-threaded.js");else{const e=`var ortWasmThreaded=(function(){var _scriptDir;return ${n.toString()}})();`;a.mainScriptUrlOrBlob=new Blob([e],{type:"text/javascript"})}n(a).then((t=>{f=!1,l=!0,c=t,e()}),(e=>{f=!1,d=!0,t(e)}))}))),await Promise.race(b),v)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},t.getInstance=()=>{if(l&&c)return c;throw new Error("WebAssembly is not initialized yet.")},t.dispose=()=>{var e;!l||f||d||(f=!0,null===(e=c.PThread)||void 0===e||e.terminateAllThreads(),c=void 0,f=!1,l=!1,d=!0)}},497:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkLastError=t.iterateExtraOptions=t.allocWasmString=void 0;const n=r(263);t.allocWasmString=(e,t)=>{const r=(0,n.getInstance)(),a=r.lengthBytesUTF8(e)+1,o=r._malloc(a);return r.stringToUTF8(e,o,a),t.push(o),o},t.iterateExtraOptions=(e,r,n,a)=>{if("object"==typeof e&&null!==e){if(n.has(e))throw new Error("Circular reference in options");n.add(e)}Object.entries(e).forEach((([e,o])=>{const i=r?r+e:e;if("object"==typeof o)(0,t.iterateExtraOptions)(o,i+".",n,a);else if("string"==typeof o||"number"==typeof o)a(i,o.toString());else{if("boolean"!=typeof o)throw new Error("Can\'t handle extra config type: "+typeof o);a(i,o?"1":"0")}}))},t.checkLastError=e=>{const t=(0,n.getInstance)(),r=t.stackSave();try{const r=t.stackAlloc(8);t._OrtGetLastError(r,r+4);const n=t.HEAP32[r/4],a=t.HEAPU32[r/4+1],o=a?t.UTF8ToString(a):"";throw new Error(`${e} ERROR_CODE: ${n}, ERROR_MESSAGE: ${o}`)}finally{t.stackRestore(r)}}},474:(e,t,r)=>{var _scriptDir,n=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,"undefined"!=typeof __filename&&(_scriptDir=_scriptDir||__filename),function(e={}){function t(){return k.buffer!=x.buffer&&Y(),x}function n(){return k.buffer!=x.buffer&&Y(),I}function a(){return k.buffer!=x.buffer&&Y(),U}function o(){return k.buffer!=x.buffer&&Y(),L}function i(){return k.buffer!=x.buffer&&Y(),W}var s,u,c=e;c.ready=new Promise(((e,t)=>{s=e,u=t}));var l,f,d,p=Object.assign({},c),g="./this.program",h=(e,t)=>{throw t},m="object"==typeof window,y="function"==typeof importScripts,v="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,b=c.ENVIRONMENT_IS_PTHREAD||!1,w="";function _(e){return c.locateFile?c.locateFile(e,w):w+e}if(v){var O=r(384),S=r(908);let t;w=y?S.dirname(w)+"/":__dirname+"/",l=(e,t)=>(e=e.startsWith("file://")?new URL(e):S.normalize(e),O.readFileSync(e,t?void 0:"utf8")),d=e=>((e=l(e,!0)).buffer||(e=new Uint8Array(e)),e),f=(e,t,r,n=!0)=>{e=e.startsWith("file://")?new URL(e):S.normalize(e),O.readFile(e,n?void 0:"utf8",((e,a)=>{e?r(e):t(n?a.buffer:a)}))},!c.thisProgram&&1<process.argv.length&&(g=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),h=(e,t)=>{throw process.exitCode=e,t},c.inspect=()=>"[Emscripten Module object]";try{t=r(925)}catch(e){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),e}global.Worker=t.Worker}else(m||y)&&(y?w=self.location.href:"undefined"!=typeof document&&document.currentScript&&(w=document.currentScript.src),_scriptDir&&(w=_scriptDir),w=0!==w.indexOf("blob:")?w.substr(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1):"",v||(l=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},y&&(d=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),f=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)}));v&&"undefined"==typeof performance&&(global.performance=r(953).performance);var E=console.log.bind(console),A=console.error.bind(console);v&&(E=(...e)=>O.writeSync(1,e.join(" ")+"\\n"),A=(...e)=>O.writeSync(2,e.join(" ")+"\\n"));var T,M=c.print||E,R=c.printErr||A;Object.assign(c,p),p=null,c.thisProgram&&(g=c.thisProgram),c.quit&&(h=c.quit),c.wasmBinary&&(T=c.wasmBinary);var F=c.noExitRuntime||!0;"object"!=typeof WebAssembly&&te("no native wasm support detected");var k,C,P,D,x,I,U,L,W,H=!1;function Y(){var e=k.buffer;c.HEAP8=x=new Int8Array(e),c.HEAP16=new Int16Array(e),c.HEAP32=U=new Int32Array(e),c.HEAPU8=I=new Uint8Array(e),c.HEAPU16=new Uint16Array(e),c.HEAPU32=L=new Uint32Array(e),c.HEAPF32=new Float32Array(e),c.HEAPF64=W=new Float64Array(e)}var j=c.INITIAL_MEMORY||16777216;if(5242880<=j||te("INITIAL_MEMORY should be larger than STACK_SIZE, was "+j+"! (STACK_SIZE=5242880)"),b)k=c.wasmMemory;else if(c.wasmMemory)k=c.wasmMemory;else if(!((k=new WebAssembly.Memory({initial:j/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw R("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),v&&R("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");Y(),j=k.buffer.byteLength;var z,G=[],N=[],B=[],$=0;function q(){return F||0<$}var V,J,X=0,K=null,Z=null;function Q(){X++,c.monitorRunDependencies&&c.monitorRunDependencies(X)}function ee(){if(X--,c.monitorRunDependencies&&c.monitorRunDependencies(X),0==X&&(null!==K&&(clearInterval(K),K=null),Z)){var e=Z;Z=null,e()}}function te(e){throw c.onAbort&&c.onAbort(e),R(e="Aborted("+e+")"),H=!0,D=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),u(e),e}function re(e){return e.startsWith("data:application/octet-stream;base64,")}function ne(e){if(e==V&&T)return new Uint8Array(T);if(d)return d(e);throw"both async and sync fetching of the wasm failed"}function ae(e,t,r){return function(e){if(!T&&(m||y)){if("function"==typeof fetch&&!e.startsWith("file://"))return fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at \'"+e+"\'";return t.arrayBuffer()})).catch((()=>ne(e)));if(f)return new Promise(((t,r)=>{f(e,(e=>t(new Uint8Array(e))),r)}))}return Promise.resolve().then((()=>ne(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{R("failed to asynchronously prepare wasm: "+e),te(e)}))}function oe(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}function ie(e){e.terminate(),e.onmessage=()=>{}}function se(e){(e=ge.Fa[e])||te(),ge.fb(e)}function ue(e){var t=ge.Za();if(!t)return 6;ge.Ia.push(t),ge.Fa[e.Ha]=t,t.Ha=e.Ha;var r={cmd:"run",start_routine:e.gb,arg:e.Ya,pthread_ptr:e.Ha};return v&&t.unref(),t.postMessage(r,e.mb),0}re(V="ort-wasm-threaded.wasm")||(V=_(V));var ce="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,le=(e,t,r)=>{var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&ce)return ce.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,r):e.subarray(t,r));for(n="";t<r;){var a=e[t++];if(128&a){var o=63&e[t++];if(192==(224&a))n+=String.fromCharCode((31&a)<<6|o);else{var i=63&e[t++];65536>(a=224==(240&a)?(15&a)<<12|o<<6|i:(7&a)<<18|o<<12|i<<6|63&e[t++])?n+=String.fromCharCode(a):(a-=65536,n+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else n+=String.fromCharCode(a)}return n},fe=(e,t)=>(e>>>=0)?le(n(),e,t):"";function de(e){if(b)return qe(1,1,e);D=e,q()||(ge.hb(),c.onExit&&c.onExit(e),H=!0),h(e,new oe(e))}var pe=e=>{if(D=e,b)throw me(e),"unwind";de(e)},ge={La:[],Ia:[],Ta:[],Fa:{},Pa:function(){b?ge.ab():ge.$a()},$a:function(){G.unshift((()=>{Q(),ge.bb((()=>ee()))}))},ab:function(){ge.receiveObjectTransfer=ge.eb,ge.threadInitTLS=ge.Sa,ge.setExitStatus=ge.Ra,F=!1},Ra:function(e){D=e},rb:["$terminateWorker"],hb:function(){for(var e of ge.Ia)ie(e);for(e of ge.La)ie(e);ge.La=[],ge.Ia=[],ge.Fa=[]},fb:function(e){var t=e.Ha;delete ge.Fa[t],ge.La.push(e),ge.Ia.splice(ge.Ia.indexOf(e),1),e.Ha=0,yt(t)},eb:function(){},Sa:function(){ge.Ta.forEach((e=>e()))},cb:e=>new Promise((t=>{e.onmessage=r=>{var n=(r=r.data).cmd;if(r.targetThread&&r.targetThread!=dt()){var a=ge.Fa[r.qb];a?a.postMessage(r,r.transferList):R(\'Internal error! Worker sent a message "\'+n+\'" to target pthread \'+r.targetThread+", but that thread no longer exists!")}else"checkMailbox"===n?He():"spawnThread"===n?ue(r):"cleanupThread"===n?se(r.thread):"killThread"===n?(r=r.thread,n=ge.Fa[r],delete ge.Fa[r],ie(n),yt(r),ge.Ia.splice(ge.Ia.indexOf(n),1),n.Ha=0):"cancelThread"===n?ge.Fa[r.thread].postMessage({cmd:"cancel"}):"loaded"===n?(e.loaded=!0,t(e)):"alert"===n?alert("Thread "+r.threadId+": "+r.text):"setimmediate"===r.target?e.postMessage(r):"callHandler"===n?c[r.handler](...r.args):n&&R("worker sent an unknown command "+n)},e.onerror=e=>{throw R("worker sent an error! "+e.filename+":"+e.lineno+": "+e.message),e},v&&(e.on("message",(function(t){e.onmessage({data:t})})),e.on("error",(function(t){e.onerror(t)})));var r,n=[];for(r of["onExit","onAbort","print","printErr"])c.hasOwnProperty(r)&&n.push(r);e.postMessage({cmd:"load",handlers:n,urlOrBlob:c.mainScriptUrlOrBlob||_scriptDir,wasmMemory:k,wasmModule:P})})),bb:function(e){e()},Xa:function(){var e=_("ort-wasm-threaded.worker.js");e=new Worker(e),ge.La.push(e)},Za:function(){return 0==ge.La.length&&(ge.Xa(),ge.cb(ge.La[0])),ge.La.pop()}};c.PThread=ge;var he=e=>{for(;0<e.length;)e.shift()(c)};function me(e){if(b)return qe(2,0,e);pe(e)}c.establishStackSpace=function(){var e=dt(),t=a()[e+52>>2>>>0];e=a()[e+56>>2>>>0],_t(t,t-e),St(t)};var ye=[];function ve(e){this.Oa=e-24,this.Wa=function(e){o()[this.Oa+4>>2>>>0]=e},this.Va=function(e){o()[this.Oa+8>>2>>>0]=e},this.Pa=function(e,t){this.Ua(),this.Wa(e),this.Va(t)},this.Ua=function(){o()[this.Oa+16>>2>>>0]=0}}function be(e,t,r,n){return b?qe(3,1,e,t,r,n):we(e,t,r,n)}function we(e,t,r,n){if(e>>>=0,t>>>=0,r>>>=0,n>>>=0,"undefined"==typeof SharedArrayBuffer)return R("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var a=[];return b&&0===a.length?be(e,t,r,n):(e={gb:r,Ha:e,Ya:n,mb:a},b?(e.ob="spawnThread",postMessage(e,a),0):ue(e))}function _e(e,t,r){return b?qe(4,1,e,t,r):0}function Oe(e,t){if(b)return qe(5,1,e,t)}c.invokeEntryPoint=function(e,t){var r=ye[e];r||(e>=ye.length&&(ye.length=e+1),ye[e]=r=z.get(e)),e=r(t),q()?ge.Ra(e):vt(e)};var Se=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t},Ee=(e,t,r,n)=>{if(!(0<n))return 0;var a=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var i=e.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++o)),127>=i){if(r>=n)break;t[r++>>>0]=i}else{if(2047>=i){if(r+1>=n)break;t[r++>>>0]=192|i>>6}else{if(65535>=i){if(r+2>=n)break;t[r++>>>0]=224|i>>12}else{if(r+3>=n)break;t[r++>>>0]=240|i>>18,t[r++>>>0]=128|i>>12&63}t[r++>>>0]=128|i>>6&63}t[r++>>>0]=128|63&i}}return t[r>>>0]=0,r-a},Ae=(e,t,r)=>Ee(e,n(),t,r);function Te(e,t){if(b)return qe(6,1,e,t)}function Me(e,t,r){if(b)return qe(7,1,e,t,r)}function Re(e,t,r){return b?qe(8,1,e,t,r):0}function Fe(e,t){if(b)return qe(9,1,e,t)}function ke(e,t,r){if(b)return qe(10,1,e,t,r)}function Ce(e,t,r,n){if(b)return qe(11,1,e,t,r,n)}function Pe(e,t,r,n){if(b)return qe(12,1,e,t,r,n)}function De(e,t,r,n){if(b)return qe(13,1,e,t,r,n)}function xe(e){if(b)return qe(14,1,e)}function Ie(e,t){if(b)return qe(15,1,e,t)}function Ue(e,t,r){if(b)return qe(16,1,e,t,r)}var Le=e=>{if(!H)try{if(e(),!q())try{b?vt(D):pe(D)}catch(e){e instanceof oe||"unwind"==e||h(1,e)}}catch(e){e instanceof oe||"unwind"==e||h(1,e)}};function We(e){e>>>=0,"function"==typeof Atomics.nb&&(Atomics.nb(a(),e>>2,e).value.then(He),e+=128,Atomics.store(a(),e>>2,1))}function He(){var e=dt();e&&(We(e),Le((()=>bt())))}c.__emscripten_thread_mailbox_await=We,c.checkMailbox=He;var Ye=e=>0==e%4&&(0!=e%100||0==e%400),je=[0,31,60,91,121,152,182,213,244,274,305,335],ze=[0,31,59,90,120,151,181,212,243,273,304,334];function Ge(e,t,r,n,a,o,i,s){return b?qe(17,1,e,t,r,n,a,o,i,s):-52}function Ne(e,t,r,n,a,o,i){if(b)return qe(18,1,e,t,r,n,a,o,i)}var Be=e=>{var t=Se(e)+1,r=pt(t);return r&&Ae(e,r,t),r},$e=e=>{var t=Ot();return e=e(),St(t),e};function qe(e,t){var r=arguments.length-2,n=arguments;return $e((()=>{for(var a=Et(8*r),o=a>>3,s=0;s<r;s++){var u=n[2+s];i()[o+s>>>0]=u}return mt(e,r,a,t)}))}var Ve,Je=[],Xe={},Ke=()=>{if(!Ve){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:g||"./this.program"};for(e in Xe)void 0===Xe[e]?delete t[e]:t[e]=Xe[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);Ve=r}return Ve};function Ze(e,r){if(b)return qe(19,1,e,r);e>>>=0,r>>>=0;var n=0;return Ke().forEach((function(a,i){var s=r+n;for(i=o()[e+4*i>>2>>>0]=s,s=0;s<a.length;++s)t()[i++>>0>>>0]=a.charCodeAt(s);t()[i>>0>>>0]=0,n+=a.length+1})),0}function Qe(e,t){if(b)return qe(20,1,e,t);e>>>=0,t>>>=0;var r=Ke();o()[e>>2>>>0]=r.length;var n=0;return r.forEach((function(e){n+=e.length+1})),o()[t>>2>>>0]=n,0}function et(e){return b?qe(21,1,e):52}function tt(e,t,r,n){return b?qe(22,1,e,t,r,n):52}function rt(e,t,r,n,a){return b?qe(23,1,e,t,r,n,a):70}var nt=[null,[],[]];function at(e,t,r,a){if(b)return qe(24,1,e,t,r,a);t>>>=0,r>>>=0,a>>>=0;for(var i=0,s=0;s<r;s++){var u=o()[t>>2>>>0],c=o()[t+4>>2>>>0];t+=8;for(var l=0;l<c;l++){var f=n()[u+l>>>0],d=nt[e];0===f||10===f?((1===e?M:R)(le(d,0)),d.length=0):d.push(f)}i+=c}return o()[a>>2>>>0]=i,0}var ot=e=>(ot=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>(e.set(crypto.getRandomValues(new Uint8Array(e.byteLength))),e);if(v)try{var e=r(760);if(e.randomFillSync)return t=>e.randomFillSync(t);var t=e.randomBytes;return e=>(e.set(t(e.byteLength)),e)}catch(e){}te("initRandomDevice")})())(e),it=[31,29,31,30,31,30,31,31,30,31,30,31],st=[31,28,31,30,31,30,31,31,30,31,30,31],ut=(e,r)=>{t().set(e,r>>>0)};function ct(e,t,r,n){function o(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function i(e,t){return o(e,t,"0")}function s(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function u(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function c(e){var t=e.Ja;for(e=new Date(new Date(e.Ka+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(Ye(e.getFullYear())?it:st)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=u(new Date(e.getFullYear(),0,4)),r=u(r),0>=s(t,e)?0>=s(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,r>>>=0,n>>>=0;var l=a()[n+40>>2>>>0];for(var f in n={kb:a()[n>>2>>>0],jb:a()[n+4>>2>>>0],Ma:a()[n+8>>2>>>0],Qa:a()[n+12>>2>>>0],Na:a()[n+16>>2>>>0],Ka:a()[n+20>>2>>>0],Ga:a()[n+24>>2>>>0],Ja:a()[n+28>>2>>>0],sb:a()[n+32>>2>>>0],ib:a()[n+36>>2>>>0],lb:l?fe(l):""},r=fe(r),l={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(f,"g"),l[f]);var d="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),p="January February March April May June July August September October November December".split(" ");for(f in l={"%a":e=>d[e.Ga].substring(0,3),"%A":e=>d[e.Ga],"%b":e=>p[e.Na].substring(0,3),"%B":e=>p[e.Na],"%C":e=>i((e.Ka+1900)/100|0,2),"%d":e=>i(e.Qa,2),"%e":e=>o(e.Qa,2," "),"%g":e=>c(e).toString().substring(2),"%G":e=>c(e),"%H":e=>i(e.Ma,2),"%I":e=>(0==(e=e.Ma)?e=12:12<e&&(e-=12),i(e,2)),"%j":e=>{for(var t=0,r=0;r<=e.Na-1;t+=(Ye(e.Ka+1900)?it:st)[r++]);return i(e.Qa+t,3)},"%m":e=>i(e.Na+1,2),"%M":e=>i(e.jb,2),"%n":()=>"\\n","%p":e=>0<=e.Ma&&12>e.Ma?"AM":"PM","%S":e=>i(e.kb,2),"%t":()=>"\\t","%u":e=>e.Ga||7,"%U":e=>i(Math.floor((e.Ja+7-e.Ga)/7),2),"%V":e=>{var t=Math.floor((e.Ja+7-(e.Ga+6)%7)/7);if(2>=(e.Ga+371-e.Ja-2)%7&&t++,t)53==t&&(4==(r=(e.Ga+371-e.Ja)%7)||3==r&&Ye(e.Ka)||(t=1));else{t=52;var r=(e.Ga+7-e.Ja-1)%7;(4==r||5==r&&Ye(e.Ka%400-1))&&t++}return i(t,2)},"%w":e=>e.Ga,"%W":e=>i(Math.floor((e.Ja+7-(e.Ga+6)%7)/7),2),"%y":e=>(e.Ka+1900).toString().substring(2),"%Y":e=>e.Ka+1900,"%z":e=>{var t=0<=(e=e.ib);return e=Math.abs(e)/60,(t?"+":"-")+String("0000"+(e/60*100+e%60)).slice(-4)},"%Z":e=>e.lb,"%%":()=>"%"},r=r.replace(/%%/g,"\\0\\0"),l)r.includes(f)&&(r=r.replace(new RegExp(f,"g"),l[f](n)));return f=function(e){var t=Array(Se(e)+1);return Ee(e,t,0,t.length),t}(r=r.replace(/\\0\\0/g,"%")),f.length>t?0:(ut(f,e),f.length-1)}ge.Pa();var lt=[null,de,me,be,_e,Oe,Te,Me,Re,Fe,ke,Ce,Pe,De,xe,Ie,Ue,Ge,Ne,Ze,Qe,et,tt,rt,at],ft={b:function(e,t,r){throw new ve(e>>>=0).Pa(t>>>0,r>>>0),e},N:function(e){gt(e>>>0,!y,1,!m,131072,!1),ge.Sa()},k:function(e){e>>>=0,b?postMessage({cmd:"cleanupThread",thread:e}):se(e)},I:we,h:_e,T:Oe,E:Te,G:Me,U:Re,R:Fe,J:ke,Q:Ce,o:Pe,F:De,C:xe,S:Ie,D:Ue,q:()=>!0,A:function(e,t){(e>>>=0)==t>>>0?setTimeout((()=>He())):b?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=ge.Fa[e])&&e.postMessage({cmd:"checkMailbox"})},L:function(){return-1},M:We,p:function(e){v&&ge.Fa[e>>>0].ref()},t:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),a()[r>>2>>>0]=e.getUTCSeconds(),a()[r+4>>2>>>0]=e.getUTCMinutes(),a()[r+8>>2>>>0]=e.getUTCHours(),a()[r+12>>2>>>0]=e.getUTCDate(),a()[r+16>>2>>>0]=e.getUTCMonth(),a()[r+20>>2>>>0]=e.getUTCFullYear()-1900,a()[r+24>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,a()[r+28>>2>>>0]=e},u:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),a()[r>>2>>>0]=e.getSeconds(),a()[r+4>>2>>>0]=e.getMinutes(),a()[r+8>>2>>>0]=e.getHours(),a()[r+12>>2>>>0]=e.getDate(),a()[r+16>>2>>>0]=e.getMonth(),a()[r+20>>2>>>0]=e.getFullYear()-1900,a()[r+24>>2>>>0]=e.getDay(),t=(Ye(e.getFullYear())?je:ze)[e.getMonth()]+e.getDate()-1|0,a()[r+28>>2>>>0]=t,a()[r+36>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t)),a()[r+32>>2>>>0]=e},v:function(e){e>>>=0;var t=new Date(a()[e+20>>2>>>0]+1900,a()[e+16>>2>>>0],a()[e+12>>2>>>0],a()[e+8>>2>>>0],a()[e+4>>2>>>0],a()[e>>2>>>0],0),r=a()[e+32>>2>>>0],n=t.getTimezoneOffset(),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),i=new Date(t.getFullYear(),0,1).getTimezoneOffset(),s=Math.min(i,o);return 0>r?a()[e+32>>2>>>0]=Number(o!=i&&s==n):0<r!=(s==n)&&(o=Math.max(i,o),t.setTime(t.getTime()+6e4*((0<r?s:o)-n))),a()[e+24>>2>>>0]=t.getDay(),r=(Ye(t.getFullYear())?je:ze)[t.getMonth()]+t.getDate()-1|0,a()[e+28>>2>>>0]=r,a()[e>>2>>>0]=t.getSeconds(),a()[e+4>>2>>>0]=t.getMinutes(),a()[e+8>>2>>>0]=t.getHours(),a()[e+12>>2>>>0]=t.getDate(),a()[e+16>>2>>>0]=t.getMonth(),a()[e+20>>2>>>0]=t.getYear(),e=t.getTime()/1e3,wt((J=e,1<=+Math.abs(J)?0<J?+Math.floor(J/4294967296)>>>0:~~+Math.ceil((J-+(~~J>>>0))/4294967296)>>>0:0)),e>>>0},r:Ge,s:Ne,z:function(e,t,r){function n(e){return(e=e.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?e[1]:"GMT"}e>>>=0,t>>>=0,r>>>=0;var i=(new Date).getFullYear(),s=new Date(i,0,1),u=new Date(i,6,1);i=s.getTimezoneOffset();var c=u.getTimezoneOffset(),l=Math.max(i,c);o()[e>>2>>>0]=60*l,a()[t>>2>>>0]=Number(i!=c),e=n(s),t=n(u),e=Be(e),t=Be(t),c<i?(o()[r>>2>>>0]=e,o()[r+4>>2>>>0]=t):(o()[r>>2>>>0]=t,o()[r+4>>2>>>0]=e)},c:()=>{te("")},l:function(){},i:function(){return Date.now()},V:()=>{throw $+=1,"unwind"},B:function(){return 4294901760},e:()=>performance.timeOrigin+performance.now(),f:function(){return v?r(993).cpus().length:navigator.hardwareConcurrency},K:function(e,t,r,n){for(ge.pb=t>>>0,Je.length=r,t=n>>>0>>3,n=0;n<r;n++)Je[n]=i()[t+n>>>0];return lt[e].apply(null,Je)},y:function(e){e>>>=0;var t=n().length;if(e<=t||4294901760<e)return!1;for(var r=1;4>=r;r*=2){var a=t*(1+.2/r);a=Math.min(a,e+100663296);var o=Math;a=Math.max(e,a);e:{o=o.min.call(o,4294901760,a+(65536-a%65536)%65536)-k.buffer.byteLength+65535>>>16;try{k.grow(o),Y();var i=1;break e}catch(e){}i=void 0}if(i)return!0}return!1},O:Ze,P:Qe,j:pe,g:et,n:tt,w:rt,m:at,x:function(e,t){return e>>>=0,t>>>=0,ot(n().subarray(e>>>0,e+t>>>0)),0},a:k||c.wasmMemory,H:ct,d:function(e,t,r,n){return ct(e>>>0,t>>>0,r>>>0,n>>>0)}};!function(){function e(e,t){return e=e.exports,C=e=function(e){var t=e=>()=>e()>>>0,r=e=>t=>e(t)>>>0;return(e=Object.assign({},e)).__errno_location=t(e.__errno_location),e.pthread_self=t(e.pthread_self),e.malloc=r(e.malloc),e.stackSave=t(e.stackSave),e.stackAlloc=r(e.stackAlloc),e}(e),ge.Ta.push(C.sa),z=C.ta,N.unshift(C.W),P=t,ee(),e}var t={a:ft};if(Q(),c.instantiateWasm)try{return c.instantiateWasm(t,e)}catch(e){R("Module.instantiateWasm callback failed with error: "+e),u(e)}(function(e,t){var r=V;return T||"function"!=typeof WebAssembly.instantiateStreaming||re(r)||r.startsWith("file://")||v||"function"!=typeof fetch?ae(r,e,t):fetch(r,{credentials:"same-origin"}).then((n=>WebAssembly.instantiateStreaming(n,e).then(t,(function(n){return R("wasm streaming compile failed: "+n),R("falling back to ArrayBuffer instantiation"),ae(r,e,t)}))))})(t,(function(t){e(t.instance,t.module)})).catch(u)}(),c._OrtInit=(e,t)=>(c._OrtInit=C.X)(e,t),c._OrtGetLastError=(e,t)=>(c._OrtGetLastError=C.Y)(e,t),c._OrtCreateSessionOptions=(e,t,r,n,a,o,i,s,u,l)=>(c._OrtCreateSessionOptions=C.Z)(e,t,r,n,a,o,i,s,u,l),c._OrtAppendExecutionProvider=(e,t)=>(c._OrtAppendExecutionProvider=C._)(e,t),c._OrtAddSessionConfigEntry=(e,t,r)=>(c._OrtAddSessionConfigEntry=C.$)(e,t,r),c._OrtReleaseSessionOptions=e=>(c._OrtReleaseSessionOptions=C.aa)(e),c._OrtCreateSession=(e,t,r)=>(c._OrtCreateSession=C.ba)(e,t,r),c._OrtReleaseSession=e=>(c._OrtReleaseSession=C.ca)(e),c._OrtGetInputOutputCount=(e,t,r)=>(c._OrtGetInputOutputCount=C.da)(e,t,r),c._OrtGetInputName=(e,t)=>(c._OrtGetInputName=C.ea)(e,t),c._OrtGetOutputName=(e,t)=>(c._OrtGetOutputName=C.fa)(e,t),c._OrtFree=e=>(c._OrtFree=C.ga)(e),c._OrtCreateTensor=(e,t,r,n,a)=>(c._OrtCreateTensor=C.ha)(e,t,r,n,a),c._OrtGetTensorData=(e,t,r,n,a)=>(c._OrtGetTensorData=C.ia)(e,t,r,n,a),c._OrtReleaseTensor=e=>(c._OrtReleaseTensor=C.ja)(e),c._OrtCreateRunOptions=(e,t,r,n)=>(c._OrtCreateRunOptions=C.ka)(e,t,r,n),c._OrtAddRunConfigEntry=(e,t,r)=>(c._OrtAddRunConfigEntry=C.la)(e,t,r),c._OrtReleaseRunOptions=e=>(c._OrtReleaseRunOptions=C.ma)(e),c._OrtRun=(e,t,r,n,a,o,i,s)=>(c._OrtRun=C.na)(e,t,r,n,a,o,i,s),c._OrtEndProfiling=e=>(c._OrtEndProfiling=C.oa)(e);var dt=c._pthread_self=()=>(dt=c._pthread_self=C.pa)(),pt=c._malloc=e=>(pt=c._malloc=C.qa)(e);c._free=e=>(c._free=C.ra)(e),c.__emscripten_tls_init=()=>(c.__emscripten_tls_init=C.sa)();var gt=c.__emscripten_thread_init=(e,t,r,n,a,o)=>(gt=c.__emscripten_thread_init=C.ua)(e,t,r,n,a,o);c.__emscripten_thread_crashed=()=>(c.__emscripten_thread_crashed=C.va)();var ht,mt=(e,t,r,n)=>(mt=C.wa)(e,t,r,n),yt=e=>(yt=C.xa)(e),vt=c.__emscripten_thread_exit=e=>(vt=c.__emscripten_thread_exit=C.ya)(e),bt=c.__emscripten_check_mailbox=()=>(bt=c.__emscripten_check_mailbox=C.za)(),wt=e=>(wt=C.Aa)(e),_t=(e,t)=>(_t=C.Ba)(e,t),Ot=()=>(Ot=C.Ca)(),St=e=>(St=C.Da)(e),Et=e=>(Et=C.Ea)(e);function At(){function e(){if(!ht&&(ht=!0,c.calledRun=!0,!H)&&(b||he(N),s(c),c.onRuntimeInitialized&&c.onRuntimeInitialized(),!b)){if(c.postRun)for("function"==typeof c.postRun&&(c.postRun=[c.postRun]);c.postRun.length;){var e=c.postRun.shift();B.unshift(e)}he(B)}}if(!(0<X))if(b)s(c),b||he(N),startWorker(c);else{if(c.preRun)for("function"==typeof c.preRun&&(c.preRun=[c.preRun]);c.preRun.length;)G.unshift(c.preRun.shift());he(G),0<X||(c.setStatus?(c.setStatus("Running..."),setTimeout((function(){setTimeout((function(){c.setStatus("")}),1),e()}),1)):e())}}if(c.keepRuntimeAlive=q,c.wasmMemory=k,c.stackAlloc=Et,c.stackSave=Ot,c.stackRestore=St,c.UTF8ToString=fe,c.stringToUTF8=Ae,c.lengthBytesUTF8=Se,c.ExitStatus=oe,c.PThread=ge,Z=function e(){ht||At(),ht||(Z=e)},c.preInit)for("function"==typeof c.preInit&&(c.preInit=[c.preInit]);0<c.preInit.length;)c.preInit.pop()();return At(),e.ready});e.exports=n},932:(e,t,r)=>{var _scriptDir,n=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,"undefined"!=typeof __filename&&(_scriptDir=_scriptDir||__filename),function(e={}){var t,n,a=e;a.ready=new Promise(((e,r)=>{t=e,n=r}));var o,i,s,u=Object.assign({},a),c="./this.program",l=(e,t)=>{throw t},f="object"==typeof window,d="function"==typeof importScripts,p="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,g="";if(p){var h=r(384),m=r(908);g=d?m.dirname(g)+"/":__dirname+"/",o=(e,t)=>(e=e.startsWith("file://")?new URL(e):m.normalize(e),h.readFileSync(e,t?void 0:"utf8")),s=e=>((e=o(e,!0)).buffer||(e=new Uint8Array(e)),e),i=(e,t,r,n=!0)=>{e=e.startsWith("file://")?new URL(e):m.normalize(e),h.readFile(e,n?void 0:"utf8",((e,a)=>{e?r(e):t(n?a.buffer:a)}))},!a.thisProgram&&1<process.argv.length&&(c=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),l=(e,t)=>{throw process.exitCode=e,t},a.inspect=()=>"[Emscripten Module object]"}else(f||d)&&(d?g=self.location.href:"undefined"!=typeof document&&document.currentScript&&(g=document.currentScript.src),_scriptDir&&(g=_scriptDir),g=0!==g.indexOf("blob:")?g.substr(0,g.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},d&&(s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),i=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)});var y,v=a.print||console.log.bind(console),b=a.printErr||console.error.bind(console);Object.assign(a,u),u=null,a.thisProgram&&(c=a.thisProgram),a.quit&&(l=a.quit),a.wasmBinary&&(y=a.wasmBinary);var w=a.noExitRuntime||!0;"object"!=typeof WebAssembly&&W("no native wasm support detected");var _,O,S,E,A,T,M=!1;function R(){var e=_.buffer;a.HEAP8=S=new Int8Array(e),a.HEAP16=new Int16Array(e),a.HEAP32=A=new Int32Array(e),a.HEAPU8=E=new Uint8Array(e),a.HEAPU16=new Uint16Array(e),a.HEAPU32=T=new Uint32Array(e),a.HEAPF32=new Float32Array(e),a.HEAPF64=new Float64Array(e)}var F=[],k=[],C=[];function P(){var e=a.preRun.shift();F.unshift(e)}var D,x,I=0,U=null,L=null;function W(e){throw a.onAbort&&a.onAbort(e),b(e="Aborted("+e+")"),M=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e}function H(e){return e.startsWith("data:application/octet-stream;base64,")}if(!H(D="ort-wasm.wasm")){var Y=D;D=a.locateFile?a.locateFile(Y,g):g+Y}function j(e){if(e==D&&y)return new Uint8Array(y);if(s)return s(e);throw"both async and sync fetching of the wasm failed"}function z(e,t,r){return function(e){if(!y&&(f||d)){if("function"==typeof fetch&&!e.startsWith("file://"))return fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at \'"+e+"\'";return t.arrayBuffer()})).catch((()=>j(e)));if(i)return new Promise(((t,r)=>{i(e,(e=>t(new Uint8Array(e))),r)}))}return Promise.resolve().then((()=>j(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{b("failed to asynchronously prepare wasm: "+e),W(e)}))}function G(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var N=e=>{for(;0<e.length;)e.shift()(a)};function B(e){this.qa=e-24,this.va=function(e){T[this.qa+4>>2>>>0]=e},this.ua=function(e){T[this.qa+8>>2>>>0]=e},this.sa=function(e,t){this.ta(),this.va(e),this.ua(t)},this.ta=function(){T[this.qa+16>>2>>>0]=0}}var $,q="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,V=(e,t,r)=>{var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&q)return q.decode(e.subarray(t,r));for(n="";t<r;){var a=e[t++];if(128&a){var o=63&e[t++];if(192==(224&a))n+=String.fromCharCode((31&a)<<6|o);else{var i=63&e[t++];65536>(a=224==(240&a)?(15&a)<<12|o<<6|i:(7&a)<<18|o<<12|i<<6|63&e[t++])?n+=String.fromCharCode(a):(a-=65536,n+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else n+=String.fromCharCode(a)}return n},J=(e,t)=>(e>>>=0)?V(E,e,t):"",X=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t},K=(e,t,r,n)=>{if(!(0<n))return 0;var a=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var i=e.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++o)),127>=i){if(r>=n)break;t[r++>>>0]=i}else{if(2047>=i){if(r+1>=n)break;t[r++>>>0]=192|i>>6}else{if(65535>=i){if(r+2>=n)break;t[r++>>>0]=224|i>>12}else{if(r+3>=n)break;t[r++>>>0]=240|i>>18,t[r++>>>0]=128|i>>12&63}t[r++>>>0]=128|i>>6&63}t[r++>>>0]=128|63&i}}return t[r>>>0]=0,r-a},Z=e=>0==e%4&&(0!=e%100||0==e%400),Q=[0,31,60,91,121,152,182,213,244,274,305,335],ee=[0,31,59,90,120,151,181,212,243,273,304,334],te=e=>{var t=X(e)+1,r=le(t);return r&&K(e,E,r,t),r},re={},ne=()=>{if(!$){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:c||"./this.program"};for(e in re)void 0===re[e]?delete t[e]:t[e]=re[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);$=r}return $},ae=[null,[],[]],oe=e=>(oe=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>crypto.getRandomValues(e);if(p)try{var e=r(760);if(e.randomFillSync)return t=>e.randomFillSync(t);var t=e.randomBytes;return e=>(e.set(t(e.byteLength)),e)}catch(e){}W("initRandomDevice")})())(e),ie=[31,29,31,30,31,30,31,31,30,31,30,31],se=[31,28,31,30,31,30,31,31,30,31,30,31];function ue(e,t,r,n){function a(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function o(e,t){return a(e,t,"0")}function i(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function s(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function u(e){var t=e.ma;for(e=new Date(new Date(e.na+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(Z(e.getFullYear())?ie:se)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=s(new Date(e.getFullYear(),0,4)),r=s(r),0>=i(t,e)?0>=i(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,r>>>=0;var c=A[40+(n>>>=0)>>2>>>0];for(var l in n={ya:A[n>>2>>>0],xa:A[n+4>>2>>>0],oa:A[n+8>>2>>>0],ra:A[n+12>>2>>>0],pa:A[n+16>>2>>>0],na:A[n+20>>2>>>0],ha:A[n+24>>2>>>0],ma:A[n+28>>2>>>0],Aa:A[n+32>>2>>>0],wa:A[n+36>>2>>>0],za:c?J(c):""},r=J(r),c={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(l,"g"),c[l]);var f="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),d="January February March April May June July August September October November December".split(" ");for(l in c={"%a":e=>f[e.ha].substring(0,3),"%A":e=>f[e.ha],"%b":e=>d[e.pa].substring(0,3),"%B":e=>d[e.pa],"%C":e=>o((e.na+1900)/100|0,2),"%d":e=>o(e.ra,2),"%e":e=>a(e.ra,2," "),"%g":e=>u(e).toString().substring(2),"%G":e=>u(e),"%H":e=>o(e.oa,2),"%I":e=>(0==(e=e.oa)?e=12:12<e&&(e-=12),o(e,2)),"%j":e=>{for(var t=0,r=0;r<=e.pa-1;t+=(Z(e.na+1900)?ie:se)[r++]);return o(e.ra+t,3)},"%m":e=>o(e.pa+1,2),"%M":e=>o(e.xa,2),"%n":()=>"\\n","%p":e=>0<=e.oa&&12>e.oa?"AM":"PM","%S":e=>o(e.ya,2),"%t":()=>"\\t","%u":e=>e.ha||7,"%U":e=>o(Math.floor((e.ma+7-e.ha)/7),2),"%V":e=>{var t=Math.floor((e.ma+7-(e.ha+6)%7)/7);if(2>=(e.ha+371-e.ma-2)%7&&t++,t)53==t&&(4==(r=(e.ha+371-e.ma)%7)||3==r&&Z(e.na)||(t=1));else{t=52;var r=(e.ha+7-e.ma-1)%7;(4==r||5==r&&Z(e.na%400-1))&&t++}return o(t,2)},"%w":e=>e.ha,"%W":e=>o(Math.floor((e.ma+7-(e.ha+6)%7)/7),2),"%y":e=>(e.na+1900).toString().substring(2),"%Y":e=>e.na+1900,"%z":e=>{var t=0<=(e=e.wa);return e=Math.abs(e)/60,(t?"+":"-")+String("0000"+(e/60*100+e%60)).slice(-4)},"%Z":e=>e.za,"%%":()=>"%"},r=r.replace(/%%/g,"\\0\\0"),c)r.includes(l)&&(r=r.replace(new RegExp(l,"g"),c[l](n)));return l=function(e){var t=Array(X(e)+1);return K(e,t,0,t.length),t}(r=r.replace(/\\0\\0/g,"%")),l.length>t?0:(S.set(l,e>>>0),l.length-1)}var ce={a:function(e,t,r){throw new B(e>>>=0).sa(t>>>0,r>>>0),e},e:function(){return 0},I:function(){},y:function(){},A:function(){},K:function(){return 0},G:function(){},B:function(){},F:function(){},g:function(){},z:function(){},w:function(){},H:function(){},x:function(){},k:()=>!0,n:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),A[r>>2>>>0]=e.getUTCSeconds(),A[r+4>>2>>>0]=e.getUTCMinutes(),A[r+8>>2>>>0]=e.getUTCHours(),A[r+12>>2>>>0]=e.getUTCDate(),A[r+16>>2>>>0]=e.getUTCMonth(),A[r+20>>2>>>0]=e.getUTCFullYear()-1900,A[r+24>>2>>>0]=e.getUTCDay(),A[r+28>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},o:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),A[r>>2>>>0]=e.getSeconds(),A[r+4>>2>>>0]=e.getMinutes(),A[r+8>>2>>>0]=e.getHours(),A[r+12>>2>>>0]=e.getDate(),A[r+16>>2>>>0]=e.getMonth(),A[r+20>>2>>>0]=e.getFullYear()-1900,A[r+24>>2>>>0]=e.getDay(),A[r+28>>2>>>0]=(Z(e.getFullYear())?Q:ee)[e.getMonth()]+e.getDate()-1|0,A[r+36>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();A[r+32>>2>>>0]=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t))},p:function(e){e>>>=0;var t=new Date(A[e+20>>2>>>0]+1900,A[e+16>>2>>>0],A[e+12>>2>>>0],A[e+8>>2>>>0],A[e+4>>2>>>0],A[e>>2>>>0],0),r=A[e+32>>2>>>0],n=t.getTimezoneOffset(),a=new Date(t.getFullYear(),6,1).getTimezoneOffset(),o=new Date(t.getFullYear(),0,1).getTimezoneOffset(),i=Math.min(o,a);return 0>r?A[e+32>>2>>>0]=Number(a!=o&&i==n):0<r!=(i==n)&&(a=Math.max(o,a),t.setTime(t.getTime()+6e4*((0<r?i:a)-n))),A[e+24>>2>>>0]=t.getDay(),A[e+28>>2>>>0]=(Z(t.getFullYear())?Q:ee)[t.getMonth()]+t.getDate()-1|0,A[e>>2>>>0]=t.getSeconds(),A[e+4>>2>>>0]=t.getMinutes(),A[e+8>>2>>>0]=t.getHours(),A[e+12>>2>>>0]=t.getDate(),A[e+16>>2>>>0]=t.getMonth(),A[e+20>>2>>>0]=t.getYear(),e=t.getTime()/1e3,de((x=e,1<=+Math.abs(x)?0<x?+Math.floor(x/4294967296)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)),e>>>0},l:function(){return-52},m:function(){},u:function(e,t,r){function n(e){return(e=e.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?e[1]:"GMT"}r>>>=0;var a=(new Date).getFullYear(),o=new Date(a,0,1),i=new Date(a,6,1);a=o.getTimezoneOffset();var s=i.getTimezoneOffset();T[e>>>0>>2>>>0]=60*Math.max(a,s),A[t>>>0>>2>>>0]=Number(a!=s),e=n(o),t=n(i),e=te(e),t=te(t),s<a?(T[r>>2>>>0]=e,T[r+4>>2>>>0]=t):(T[r>>2>>>0]=t,T[r+4>>2>>>0]=e)},d:()=>{W("")},h:function(){return Date.now()},v:function(){return 4294901760},b:()=>performance.now(),J:function(e,t,r){return t>>>=0,E.copyWithin(e>>>0>>>0,t>>>0,t+(r>>>0)>>>0)},t:function(e){e>>>=0;var t=E.length;if(4294901760<e)return!1;for(var r=1;4>=r;r*=2){var n=t*(1+.2/r);n=Math.min(n,e+100663296);var a=Math;n=Math.max(e,n);e:{a=a.min.call(a,4294901760,n+(65536-n%65536)%65536)-_.buffer.byteLength+65535>>>16;try{_.grow(a),R();var o=1;break e}catch(e){}o=void 0}if(o)return!0}return!1},D:function(e,t){e>>>=0,t>>>=0;var r=0;return ne().forEach((function(n,a){var o=t+r;for(a=T[e+4*a>>2>>>0]=o,o=0;o<n.length;++o)S[a++>>0>>>0]=n.charCodeAt(o);S[a>>0>>>0]=0,r+=n.length+1})),0},E:function(e,t){e>>>=0,t>>>=0;var r=ne();T[e>>2>>>0]=r.length;var n=0;return r.forEach((function(e){n+=e.length+1})),T[t>>2>>>0]=n,0},s:e=>{w||(a.onExit&&a.onExit(e),M=!0),l(e,new G(e))},f:()=>52,j:function(){return 52},q:function(){return 70},i:function(e,t,r,n){t>>>=0,r>>>=0,n>>>=0;for(var a=0,o=0;o<r;o++){var i=T[t>>2>>>0],s=T[t+4>>2>>>0];t+=8;for(var u=0;u<s;u++){var c=E[i+u>>>0],l=ae[e];0===c||10===c?((1===e?v:b)(V(l,0)),l.length=0):l.push(c)}a+=s}return T[n>>2>>>0]=a,0},r:function(e,t){return e>>>=0,oe(E.subarray(e>>>0,e+(t>>>0)>>>0)),0},C:ue,c:function(e,t,r,n){return ue(e>>>0,t>>>0,r>>>0,n>>>0)}};!function(){function e(e){if(e=e.exports,O=e=function(e){var t=e=>()=>e()>>>0,r=e=>t=>e(t)>>>0;return(e=Object.assign({},e)).__errno_location=t(e.__errno_location),e.malloc=r(e.malloc),e.stackSave=t(e.stackSave),e.stackAlloc=r(e.stackAlloc),e}(e),_=O.L,R(),k.unshift(O.M),I--,a.monitorRunDependencies&&a.monitorRunDependencies(I),0==I&&(null!==U&&(clearInterval(U),U=null),L)){var t=L;L=null,t()}return e}var t={a:ce};if(I++,a.monitorRunDependencies&&a.monitorRunDependencies(I),a.instantiateWasm)try{return a.instantiateWasm(t,e)}catch(e){b("Module.instantiateWasm callback failed with error: "+e),n(e)}(function(e,t){var r=D;return y||"function"!=typeof WebAssembly.instantiateStreaming||H(r)||r.startsWith("file://")||p||"function"!=typeof fetch?z(r,e,t):fetch(r,{credentials:"same-origin"}).then((n=>WebAssembly.instantiateStreaming(n,e).then(t,(function(n){return b("wasm streaming compile failed: "+n),b("falling back to ArrayBuffer instantiation"),z(r,e,t)}))))})(t,(function(t){e(t.instance)})).catch(n)}(),a._OrtInit=(e,t)=>(a._OrtInit=O.N)(e,t),a._OrtGetLastError=(e,t)=>(a._OrtGetLastError=O.O)(e,t),a._OrtCreateSessionOptions=(e,t,r,n,o,i,s,u,c,l)=>(a._OrtCreateSessionOptions=O.P)(e,t,r,n,o,i,s,u,c,l),a._OrtAppendExecutionProvider=(e,t)=>(a._OrtAppendExecutionProvider=O.Q)(e,t),a._OrtAddSessionConfigEntry=(e,t,r)=>(a._OrtAddSessionConfigEntry=O.R)(e,t,r),a._OrtReleaseSessionOptions=e=>(a._OrtReleaseSessionOptions=O.S)(e),a._OrtCreateSession=(e,t,r)=>(a._OrtCreateSession=O.T)(e,t,r),a._OrtReleaseSession=e=>(a._OrtReleaseSession=O.U)(e),a._OrtGetInputOutputCount=(e,t,r)=>(a._OrtGetInputOutputCount=O.V)(e,t,r),a._OrtGetInputName=(e,t)=>(a._OrtGetInputName=O.W)(e,t),a._OrtGetOutputName=(e,t)=>(a._OrtGetOutputName=O.X)(e,t),a._OrtFree=e=>(a._OrtFree=O.Y)(e),a._OrtCreateTensor=(e,t,r,n,o)=>(a._OrtCreateTensor=O.Z)(e,t,r,n,o),a._OrtGetTensorData=(e,t,r,n,o)=>(a._OrtGetTensorData=O._)(e,t,r,n,o),a._OrtReleaseTensor=e=>(a._OrtReleaseTensor=O.$)(e),a._OrtCreateRunOptions=(e,t,r,n)=>(a._OrtCreateRunOptions=O.aa)(e,t,r,n),a._OrtAddRunConfigEntry=(e,t,r)=>(a._OrtAddRunConfigEntry=O.ba)(e,t,r),a._OrtReleaseRunOptions=e=>(a._OrtReleaseRunOptions=O.ca)(e),a._OrtRun=(e,t,r,n,o,i,s,u)=>(a._OrtRun=O.da)(e,t,r,n,o,i,s,u),a._OrtEndProfiling=e=>(a._OrtEndProfiling=O.ea)(e);var le=a._malloc=e=>(le=a._malloc=O.fa)(e);a._free=e=>(a._free=O.ga)(e);var fe,de=e=>(de=O.ia)(e),pe=()=>(pe=O.ja)(),ge=e=>(ge=O.ka)(e),he=e=>(he=O.la)(e);function me(){function e(){if(!fe&&(fe=!0,a.calledRun=!0,!M)){if(N(k),t(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),a.postRun)for("function"==typeof a.postRun&&(a.postRun=[a.postRun]);a.postRun.length;){var e=a.postRun.shift();C.unshift(e)}N(C)}}if(!(0<I)){if(a.preRun)for("function"==typeof a.preRun&&(a.preRun=[a.preRun]);a.preRun.length;)P();N(F),0<I||(a.setStatus?(a.setStatus("Running..."),setTimeout((function(){setTimeout((function(){a.setStatus("")}),1),e()}),1)):e())}}if(a.stackAlloc=he,a.stackSave=pe,a.stackRestore=ge,a.UTF8ToString=J,a.stringToUTF8=(e,t,r)=>K(e,E,t,r),a.lengthBytesUTF8=X,L=function e(){fe||me(),fe||(L=e)},a.preInit)for("function"==typeof a.preInit&&(a.preInit=[a.preInit]);0<a.preInit.length;)a.preInit.pop()();return me(),e.ready});e.exports=n},154:e=>{"use strict";e.exports=\'"use strict";var e={},a="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node;if(a){var r=require("worker_threads"),t=r.parentPort;t.on("message",(e=>onmessage({data:e})));var s=require("fs");Object.assign(global,{self:global,require:require,Module:e,location:{href:__filename},Worker:r.Worker,importScripts:e=>(0,eval)(s.readFileSync(e,"utf8")+"//# sourceURL="+e),postMessage:e=>t.postMessage(e),performance:global.performance||{now:Date.now}})}var o=!1,d=function(){var e=Array.prototype.slice.call(arguments).join(" ");a?s.writeSync(2,e+"\\\\n"):console.error(e)};self.alert=function(){var a=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:a,threadId:e._pthread_self()})},e.instantiateWasm=(a,r)=>{var t=e.wasmModule;return e.wasmModule=null,r(new WebAssembly.Instance(t,a))},self.onunhandledrejection=e=>{throw e.reason??e},self.onmessage=function a(r){try{if("load"===r.data.cmd){let s=[];self.onmessage=e=>s.push(e),self.startWorker=r=>{e=r,postMessage({cmd:"loaded"});for(let e of s)a(e);self.onmessage=a},e.wasmModule=r.data.wasmModule;for(const a of r.data.handlers)e[a]=(...e)=>{postMessage({cmd:"callHandler",handler:a,args:e})};if(e.wasmMemory=r.data.wasmMemory,e.buffer=e.wasmMemory.buffer,e.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof r.data.urlOrBlob)importScripts(r.data.urlOrBlob);else{var t=URL.createObjectURL(r.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(e)}else if("run"===r.data.cmd){e.__emscripten_thread_init(r.data.pthread_ptr,0,0,1),e.__emscripten_thread_mailbox_await(r.data.pthread_ptr),e.establishStackSpace(),e.PThread.receiveObjectTransfer(r.data),e.PThread.threadInitTLS(),o||(o=!0);try{e.invokeEntryPoint(r.data.start_routine,r.data.arg)}catch(e){if("unwind"!=e)throw e}}else"cancel"===r.data.cmd?e._pthread_self()&&e.__emscripten_thread_exit(-1):"setimmediate"===r.data.target||("checkMailbox"===r.data.cmd?o&&e.checkMailbox():r.data.cmd&&(d("worker.js received unknown command "+r.data.cmd),d(r.data)))}catch(a){throw e.__emscripten_thread_crashed&&e.__emscripten_thread_crashed(),a}};\\n\'},760:()=>{},384:()=>{},993:()=>{},908:()=>{},953:()=>{},925:()=>{},449:()=>{}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(()=>{"use strict";const e=r(259),t=r(263);self.onmessage=r=>{switch(r.data.type){case"init-wasm":try{(0,t.initializeWebAssembly)(r.data.in).then((()=>postMessage({type:"init-wasm"})),(e=>postMessage({type:"init-wasm",err:e})))}catch(e){postMessage({type:"init-wasm",err:e})}break;case"init-ort":try{(0,e.initRuntime)(r.data.in).then((()=>postMessage({type:"init-ort"})),(e=>postMessage({type:"init-ort",err:e}))),postMessage({type:"init-ort"})}catch(e){postMessage({type:"init-ort",err:e})}break;case"create_allocate":try{const{model:t}=r.data.in,n=(0,e.createSessionAllocate)(t);postMessage({type:"create_allocate",out:n})}catch(e){postMessage({type:"create_allocate",err:e})}break;case"create_finalize":try{const{modeldata:t,options:n}=r.data.in,a=(0,e.createSessionFinalize)(t,n);postMessage({type:"create_finalize",out:a})}catch(e){postMessage({type:"create_finalize",err:e})}break;case"create":try{const{model:t,options:n}=r.data.in,a=(0,e.createSession)(t,n);postMessage({type:"create",out:a})}catch(e){postMessage({type:"create",err:e})}break;case"release":try{const t=r.data.in;(0,e.releaseSession)(t),postMessage({type:"release"})}catch(e){postMessage({type:"release",err:e})}break;case"run":try{const{sessionId:t,inputIndices:n,inputs:a,outputIndices:o,options:i}=r.data.in;(0,e.run)(t,n,a,o,i).then((t=>{postMessage({type:"run",out:t},(0,e.extractTransferableBuffers)(t))}),(e=>{postMessage({type:"run",err:e})}))}catch(e){postMessage({type:"run",err:e})}break;case"end-profiling":try{const t=r.data.in;(0,e.endProfiling)(t),postMessage({type:"end-profiling"})}catch(e){postMessage({type:"end-profiling",err:e})}}}})()})();\n',"Worker",void 0,void 0)}},6614:m=>{m.exports=function(t,n,r,a){var u=self||window;try{try{var h;try{h=new u.Blob([t])}catch{(h=new(u.BlobBuilder||u.WebKitBlobBuilder||u.MozBlobBuilder||u.MSBlobBuilder)).append(t),h=h.getBlob()}var f=u.URL||u.webkitURL,d=f.createObjectURL(h),p=new u[n](d,r);return f.revokeObjectURL(d),p}catch{return new u[n]("data:application/javascript,".concat(encodeURIComponent(t)),r)}}catch{if(!a)throw Error("Inline worker is not supported");return new u[n](a,r)}}},2446:(m,t,n)=>{var r,a,u,h=n(2100),f=h.Reader,d=h.Writer,p=h.util,c=h.roots.default||(h.roots.default={});c.onnx=((u={}).Version=(r={},(a=Object.create(r))[r[0]="_START_VERSION"]=0,a[r[1]="IR_VERSION_2017_10_10"]=1,a[r[2]="IR_VERSION_2017_10_30"]=2,a[r[3]="IR_VERSION_2017_11_3"]=3,a[r[4]="IR_VERSION_2019_1_22"]=4,a[r[5]="IR_VERSION_2019_3_18"]=5,a[r[6]="IR_VERSION_2019_9_19"]=6,a[r[7]="IR_VERSION_2020_5_8"]=7,a[r[8]="IR_VERSION_2021_7_30"]=8,a[r[9]="IR_VERSION"]=9,a),u.AttributeProto=function(){function o(e){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],this.sparseTensors=[],this.typeProtos=[],e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.name="",o.prototype.refAttrName="",o.prototype.docString="",o.prototype.type=0,o.prototype.f=0,o.prototype.i=p.Long?p.Long.fromBits(0,0,!1):0,o.prototype.s=p.newBuffer([]),o.prototype.t=null,o.prototype.g=null,o.prototype.sparseTensor=null,o.prototype.tp=null,o.prototype.floats=p.emptyArray,o.prototype.ints=p.emptyArray,o.prototype.strings=p.emptyArray,o.prototype.tensors=p.emptyArray,o.prototype.graphs=p.emptyArray,o.prototype.sparseTensors=p.emptyArray,o.prototype.typeProtos=p.emptyArray,o.create=function(e){return new o(e)},o.encode=function(e,s){if(s||(s=d.create()),e.name!=null&&Object.hasOwnProperty.call(e,"name")&&s.uint32(10).string(e.name),e.f!=null&&Object.hasOwnProperty.call(e,"f")&&s.uint32(21).float(e.f),e.i!=null&&Object.hasOwnProperty.call(e,"i")&&s.uint32(24).int64(e.i),e.s!=null&&Object.hasOwnProperty.call(e,"s")&&s.uint32(34).bytes(e.s),e.t!=null&&Object.hasOwnProperty.call(e,"t")&&c.onnx.TensorProto.encode(e.t,s.uint32(42).fork()).ldelim(),e.g!=null&&Object.hasOwnProperty.call(e,"g")&&c.onnx.GraphProto.encode(e.g,s.uint32(50).fork()).ldelim(),e.floats!=null&&e.floats.length){s.uint32(58).fork();for(var l=0;l<e.floats.length;++l)s.float(e.floats[l]);s.ldelim()}if(e.ints!=null&&e.ints.length){for(s.uint32(66).fork(),l=0;l<e.ints.length;++l)s.int64(e.ints[l]);s.ldelim()}if(e.strings!=null&&e.strings.length)for(l=0;l<e.strings.length;++l)s.uint32(74).bytes(e.strings[l]);if(e.tensors!=null&&e.tensors.length)for(l=0;l<e.tensors.length;++l)c.onnx.TensorProto.encode(e.tensors[l],s.uint32(82).fork()).ldelim();if(e.graphs!=null&&e.graphs.length)for(l=0;l<e.graphs.length;++l)c.onnx.GraphProto.encode(e.graphs[l],s.uint32(90).fork()).ldelim();if(e.docString!=null&&Object.hasOwnProperty.call(e,"docString")&&s.uint32(106).string(e.docString),e.tp!=null&&Object.hasOwnProperty.call(e,"tp")&&c.onnx.TypeProto.encode(e.tp,s.uint32(114).fork()).ldelim(),e.typeProtos!=null&&e.typeProtos.length)for(l=0;l<e.typeProtos.length;++l)c.onnx.TypeProto.encode(e.typeProtos[l],s.uint32(122).fork()).ldelim();if(e.type!=null&&Object.hasOwnProperty.call(e,"type")&&s.uint32(160).int32(e.type),e.refAttrName!=null&&Object.hasOwnProperty.call(e,"refAttrName")&&s.uint32(170).string(e.refAttrName),e.sparseTensor!=null&&Object.hasOwnProperty.call(e,"sparseTensor")&&c.onnx.SparseTensorProto.encode(e.sparseTensor,s.uint32(178).fork()).ldelim(),e.sparseTensors!=null&&e.sparseTensors.length)for(l=0;l<e.sparseTensors.length;++l)c.onnx.SparseTensorProto.encode(e.sparseTensors[l],s.uint32(186).fork()).ldelim();return s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.AttributeProto;e.pos<l;){var y=e.uint32();switch(y>>>3){case 1:g.name=e.string();break;case 21:g.refAttrName=e.string();break;case 13:g.docString=e.string();break;case 20:g.type=e.int32();break;case 2:g.f=e.float();break;case 3:g.i=e.int64();break;case 4:g.s=e.bytes();break;case 5:g.t=c.onnx.TensorProto.decode(e,e.uint32());break;case 6:g.g=c.onnx.GraphProto.decode(e,e.uint32());break;case 22:g.sparseTensor=c.onnx.SparseTensorProto.decode(e,e.uint32());break;case 14:g.tp=c.onnx.TypeProto.decode(e,e.uint32());break;case 7:if(g.floats&&g.floats.length||(g.floats=[]),(7&y)==2)for(var b=e.uint32()+e.pos;e.pos<b;)g.floats.push(e.float());else g.floats.push(e.float());break;case 8:if(g.ints&&g.ints.length||(g.ints=[]),(7&y)==2)for(b=e.uint32()+e.pos;e.pos<b;)g.ints.push(e.int64());else g.ints.push(e.int64());break;case 9:g.strings&&g.strings.length||(g.strings=[]),g.strings.push(e.bytes());break;case 10:g.tensors&&g.tensors.length||(g.tensors=[]),g.tensors.push(c.onnx.TensorProto.decode(e,e.uint32()));break;case 11:g.graphs&&g.graphs.length||(g.graphs=[]),g.graphs.push(c.onnx.GraphProto.decode(e,e.uint32()));break;case 23:g.sparseTensors&&g.sparseTensors.length||(g.sparseTensors=[]),g.sparseTensors.push(c.onnx.SparseTensorProto.decode(e,e.uint32()));break;case 15:g.typeProtos&&g.typeProtos.length||(g.typeProtos=[]),g.typeProtos.push(c.onnx.TypeProto.decode(e,e.uint32()));break;default:e.skipType(7&y)}}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.name!=null&&e.hasOwnProperty("name")&&!p.isString(e.name))return"name: string expected";if(e.refAttrName!=null&&e.hasOwnProperty("refAttrName")&&!p.isString(e.refAttrName))return"refAttrName: string expected";if(e.docString!=null&&e.hasOwnProperty("docString")&&!p.isString(e.docString))return"docString: string expected";if(e.type!=null&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 11:case 13:case 6:case 7:case 8:case 9:case 10:case 12:case 14:}if(e.f!=null&&e.hasOwnProperty("f")&&typeof e.f!="number")return"f: number expected";if(e.i!=null&&e.hasOwnProperty("i")&&!(p.isInteger(e.i)||e.i&&p.isInteger(e.i.low)&&p.isInteger(e.i.high)))return"i: integer|Long expected";if(e.s!=null&&e.hasOwnProperty("s")&&!(e.s&&typeof e.s.length=="number"||p.isString(e.s)))return"s: buffer expected";if(e.t!=null&&e.hasOwnProperty("t")&&(l=c.onnx.TensorProto.verify(e.t)))return"t."+l;if(e.g!=null&&e.hasOwnProperty("g")&&(l=c.onnx.GraphProto.verify(e.g)))return"g."+l;if(e.sparseTensor!=null&&e.hasOwnProperty("sparseTensor")&&(l=c.onnx.SparseTensorProto.verify(e.sparseTensor)))return"sparseTensor."+l;if(e.tp!=null&&e.hasOwnProperty("tp")&&(l=c.onnx.TypeProto.verify(e.tp)))return"tp."+l;if(e.floats!=null&&e.hasOwnProperty("floats")){if(!Array.isArray(e.floats))return"floats: array expected";for(var s=0;s<e.floats.length;++s)if(typeof e.floats[s]!="number")return"floats: number[] expected"}if(e.ints!=null&&e.hasOwnProperty("ints")){if(!Array.isArray(e.ints))return"ints: array expected";for(s=0;s<e.ints.length;++s)if(!(p.isInteger(e.ints[s])||e.ints[s]&&p.isInteger(e.ints[s].low)&&p.isInteger(e.ints[s].high)))return"ints: integer|Long[] expected"}if(e.strings!=null&&e.hasOwnProperty("strings")){if(!Array.isArray(e.strings))return"strings: array expected";for(s=0;s<e.strings.length;++s)if(!(e.strings[s]&&typeof e.strings[s].length=="number"||p.isString(e.strings[s])))return"strings: buffer[] expected"}if(e.tensors!=null&&e.hasOwnProperty("tensors")){if(!Array.isArray(e.tensors))return"tensors: array expected";for(s=0;s<e.tensors.length;++s)if(l=c.onnx.TensorProto.verify(e.tensors[s]))return"tensors."+l}if(e.graphs!=null&&e.hasOwnProperty("graphs")){if(!Array.isArray(e.graphs))return"graphs: array expected";for(s=0;s<e.graphs.length;++s)if(l=c.onnx.GraphProto.verify(e.graphs[s]))return"graphs."+l}if(e.sparseTensors!=null&&e.hasOwnProperty("sparseTensors")){if(!Array.isArray(e.sparseTensors))return"sparseTensors: array expected";for(s=0;s<e.sparseTensors.length;++s)if(l=c.onnx.SparseTensorProto.verify(e.sparseTensors[s]))return"sparseTensors."+l}if(e.typeProtos!=null&&e.hasOwnProperty("typeProtos")){if(!Array.isArray(e.typeProtos))return"typeProtos: array expected";for(s=0;s<e.typeProtos.length;++s){var l;if(l=c.onnx.TypeProto.verify(e.typeProtos[s]))return"typeProtos."+l}}return null},o.fromObject=function(e){if(e instanceof c.onnx.AttributeProto)return e;var s=new c.onnx.AttributeProto;switch(e.name!=null&&(s.name=String(e.name)),e.refAttrName!=null&&(s.refAttrName=String(e.refAttrName)),e.docString!=null&&(s.docString=String(e.docString)),e.type){default:if(typeof e.type=="number"){s.type=e.type;break}break;case"UNDEFINED":case 0:s.type=0;break;case"FLOAT":case 1:s.type=1;break;case"INT":case 2:s.type=2;break;case"STRING":case 3:s.type=3;break;case"TENSOR":case 4:s.type=4;break;case"GRAPH":case 5:s.type=5;break;case"SPARSE_TENSOR":case 11:s.type=11;break;case"TYPE_PROTO":case 13:s.type=13;break;case"FLOATS":case 6:s.type=6;break;case"INTS":case 7:s.type=7;break;case"STRINGS":case 8:s.type=8;break;case"TENSORS":case 9:s.type=9;break;case"GRAPHS":case 10:s.type=10;break;case"SPARSE_TENSORS":case 12:s.type=12;break;case"TYPE_PROTOS":case 14:s.type=14}if(e.f!=null&&(s.f=Number(e.f)),e.i!=null&&(p.Long?(s.i=p.Long.fromValue(e.i)).unsigned=!1:typeof e.i=="string"?s.i=parseInt(e.i,10):typeof e.i=="number"?s.i=e.i:typeof e.i=="object"&&(s.i=new p.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber())),e.s!=null&&(typeof e.s=="string"?p.base64.decode(e.s,s.s=p.newBuffer(p.base64.length(e.s)),0):e.s.length>=0&&(s.s=e.s)),e.t!=null){if(typeof e.t!="object")throw TypeError(".onnx.AttributeProto.t: object expected");s.t=c.onnx.TensorProto.fromObject(e.t)}if(e.g!=null){if(typeof e.g!="object")throw TypeError(".onnx.AttributeProto.g: object expected");s.g=c.onnx.GraphProto.fromObject(e.g)}if(e.sparseTensor!=null){if(typeof e.sparseTensor!="object")throw TypeError(".onnx.AttributeProto.sparseTensor: object expected");s.sparseTensor=c.onnx.SparseTensorProto.fromObject(e.sparseTensor)}if(e.tp!=null){if(typeof e.tp!="object")throw TypeError(".onnx.AttributeProto.tp: object expected");s.tp=c.onnx.TypeProto.fromObject(e.tp)}if(e.floats){if(!Array.isArray(e.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");s.floats=[];for(var l=0;l<e.floats.length;++l)s.floats[l]=Number(e.floats[l])}if(e.ints){if(!Array.isArray(e.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");for(s.ints=[],l=0;l<e.ints.length;++l)p.Long?(s.ints[l]=p.Long.fromValue(e.ints[l])).unsigned=!1:typeof e.ints[l]=="string"?s.ints[l]=parseInt(e.ints[l],10):typeof e.ints[l]=="number"?s.ints[l]=e.ints[l]:typeof e.ints[l]=="object"&&(s.ints[l]=new p.LongBits(e.ints[l].low>>>0,e.ints[l].high>>>0).toNumber())}if(e.strings){if(!Array.isArray(e.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");for(s.strings=[],l=0;l<e.strings.length;++l)typeof e.strings[l]=="string"?p.base64.decode(e.strings[l],s.strings[l]=p.newBuffer(p.base64.length(e.strings[l])),0):e.strings[l].length>=0&&(s.strings[l]=e.strings[l])}if(e.tensors){if(!Array.isArray(e.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");for(s.tensors=[],l=0;l<e.tensors.length;++l){if(typeof e.tensors[l]!="object")throw TypeError(".onnx.AttributeProto.tensors: object expected");s.tensors[l]=c.onnx.TensorProto.fromObject(e.tensors[l])}}if(e.graphs){if(!Array.isArray(e.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");for(s.graphs=[],l=0;l<e.graphs.length;++l){if(typeof e.graphs[l]!="object")throw TypeError(".onnx.AttributeProto.graphs: object expected");s.graphs[l]=c.onnx.GraphProto.fromObject(e.graphs[l])}}if(e.sparseTensors){if(!Array.isArray(e.sparseTensors))throw TypeError(".onnx.AttributeProto.sparseTensors: array expected");for(s.sparseTensors=[],l=0;l<e.sparseTensors.length;++l){if(typeof e.sparseTensors[l]!="object")throw TypeError(".onnx.AttributeProto.sparseTensors: object expected");s.sparseTensors[l]=c.onnx.SparseTensorProto.fromObject(e.sparseTensors[l])}}if(e.typeProtos){if(!Array.isArray(e.typeProtos))throw TypeError(".onnx.AttributeProto.typeProtos: array expected");for(s.typeProtos=[],l=0;l<e.typeProtos.length;++l){if(typeof e.typeProtos[l]!="object")throw TypeError(".onnx.AttributeProto.typeProtos: object expected");s.typeProtos[l]=c.onnx.TypeProto.fromObject(e.typeProtos[l])}}return s},o.toObject=function(e,s){s||(s={});var l={};if((s.arrays||s.defaults)&&(l.floats=[],l.ints=[],l.strings=[],l.tensors=[],l.graphs=[],l.typeProtos=[],l.sparseTensors=[]),s.defaults){if(l.name="",l.f=0,p.Long){var g=new p.Long(0,0,!1);l.i=s.longs===String?g.toString():s.longs===Number?g.toNumber():g}else l.i=s.longs===String?"0":0;s.bytes===String?l.s="":(l.s=[],s.bytes!==Array&&(l.s=p.newBuffer(l.s))),l.t=null,l.g=null,l.docString="",l.tp=null,l.type=s.enums===String?"UNDEFINED":0,l.refAttrName="",l.sparseTensor=null}if(e.name!=null&&e.hasOwnProperty("name")&&(l.name=e.name),e.f!=null&&e.hasOwnProperty("f")&&(l.f=s.json&&!isFinite(e.f)?String(e.f):e.f),e.i!=null&&e.hasOwnProperty("i")&&(typeof e.i=="number"?l.i=s.longs===String?String(e.i):e.i:l.i=s.longs===String?p.Long.prototype.toString.call(e.i):s.longs===Number?new p.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber():e.i),e.s!=null&&e.hasOwnProperty("s")&&(l.s=s.bytes===String?p.base64.encode(e.s,0,e.s.length):s.bytes===Array?Array.prototype.slice.call(e.s):e.s),e.t!=null&&e.hasOwnProperty("t")&&(l.t=c.onnx.TensorProto.toObject(e.t,s)),e.g!=null&&e.hasOwnProperty("g")&&(l.g=c.onnx.GraphProto.toObject(e.g,s)),e.floats&&e.floats.length){l.floats=[];for(var y=0;y<e.floats.length;++y)l.floats[y]=s.json&&!isFinite(e.floats[y])?String(e.floats[y]):e.floats[y]}if(e.ints&&e.ints.length)for(l.ints=[],y=0;y<e.ints.length;++y)typeof e.ints[y]=="number"?l.ints[y]=s.longs===String?String(e.ints[y]):e.ints[y]:l.ints[y]=s.longs===String?p.Long.prototype.toString.call(e.ints[y]):s.longs===Number?new p.LongBits(e.ints[y].low>>>0,e.ints[y].high>>>0).toNumber():e.ints[y];if(e.strings&&e.strings.length)for(l.strings=[],y=0;y<e.strings.length;++y)l.strings[y]=s.bytes===String?p.base64.encode(e.strings[y],0,e.strings[y].length):s.bytes===Array?Array.prototype.slice.call(e.strings[y]):e.strings[y];if(e.tensors&&e.tensors.length)for(l.tensors=[],y=0;y<e.tensors.length;++y)l.tensors[y]=c.onnx.TensorProto.toObject(e.tensors[y],s);if(e.graphs&&e.graphs.length)for(l.graphs=[],y=0;y<e.graphs.length;++y)l.graphs[y]=c.onnx.GraphProto.toObject(e.graphs[y],s);if(e.docString!=null&&e.hasOwnProperty("docString")&&(l.docString=e.docString),e.tp!=null&&e.hasOwnProperty("tp")&&(l.tp=c.onnx.TypeProto.toObject(e.tp,s)),e.typeProtos&&e.typeProtos.length)for(l.typeProtos=[],y=0;y<e.typeProtos.length;++y)l.typeProtos[y]=c.onnx.TypeProto.toObject(e.typeProtos[y],s);if(e.type!=null&&e.hasOwnProperty("type")&&(l.type=s.enums===String?c.onnx.AttributeProto.AttributeType[e.type]===void 0?e.type:c.onnx.AttributeProto.AttributeType[e.type]:e.type),e.refAttrName!=null&&e.hasOwnProperty("refAttrName")&&(l.refAttrName=e.refAttrName),e.sparseTensor!=null&&e.hasOwnProperty("sparseTensor")&&(l.sparseTensor=c.onnx.SparseTensorProto.toObject(e.sparseTensor,s)),e.sparseTensors&&e.sparseTensors.length)for(l.sparseTensors=[],y=0;y<e.sparseTensors.length;++y)l.sparseTensors[y]=c.onnx.SparseTensorProto.toObject(e.sparseTensors[y],s);return l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.AttributeProto"},o.AttributeType=function(){var e={},s=Object.create(e);return s[e[0]="UNDEFINED"]=0,s[e[1]="FLOAT"]=1,s[e[2]="INT"]=2,s[e[3]="STRING"]=3,s[e[4]="TENSOR"]=4,s[e[5]="GRAPH"]=5,s[e[11]="SPARSE_TENSOR"]=11,s[e[13]="TYPE_PROTO"]=13,s[e[6]="FLOATS"]=6,s[e[7]="INTS"]=7,s[e[8]="STRINGS"]=8,s[e[9]="TENSORS"]=9,s[e[10]="GRAPHS"]=10,s[e[12]="SPARSE_TENSORS"]=12,s[e[14]="TYPE_PROTOS"]=14,s}(),o}(),u.ValueInfoProto=function(){function o(e){if(e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.name="",o.prototype.type=null,o.prototype.docString="",o.create=function(e){return new o(e)},o.encode=function(e,s){return s||(s=d.create()),e.name!=null&&Object.hasOwnProperty.call(e,"name")&&s.uint32(10).string(e.name),e.type!=null&&Object.hasOwnProperty.call(e,"type")&&c.onnx.TypeProto.encode(e.type,s.uint32(18).fork()).ldelim(),e.docString!=null&&Object.hasOwnProperty.call(e,"docString")&&s.uint32(26).string(e.docString),s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.ValueInfoProto;e.pos<l;){var y=e.uint32();switch(y>>>3){case 1:g.name=e.string();break;case 2:g.type=c.onnx.TypeProto.decode(e,e.uint32());break;case 3:g.docString=e.string();break;default:e.skipType(7&y)}}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.name!=null&&e.hasOwnProperty("name")&&!p.isString(e.name))return"name: string expected";if(e.type!=null&&e.hasOwnProperty("type")){var s=c.onnx.TypeProto.verify(e.type);if(s)return"type."+s}return e.docString!=null&&e.hasOwnProperty("docString")&&!p.isString(e.docString)?"docString: string expected":null},o.fromObject=function(e){if(e instanceof c.onnx.ValueInfoProto)return e;var s=new c.onnx.ValueInfoProto;if(e.name!=null&&(s.name=String(e.name)),e.type!=null){if(typeof e.type!="object")throw TypeError(".onnx.ValueInfoProto.type: object expected");s.type=c.onnx.TypeProto.fromObject(e.type)}return e.docString!=null&&(s.docString=String(e.docString)),s},o.toObject=function(e,s){s||(s={});var l={};return s.defaults&&(l.name="",l.type=null,l.docString=""),e.name!=null&&e.hasOwnProperty("name")&&(l.name=e.name),e.type!=null&&e.hasOwnProperty("type")&&(l.type=c.onnx.TypeProto.toObject(e.type,s)),e.docString!=null&&e.hasOwnProperty("docString")&&(l.docString=e.docString),l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.ValueInfoProto"},o}(),u.NodeProto=function(){function o(e){if(this.input=[],this.output=[],this.attribute=[],e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.input=p.emptyArray,o.prototype.output=p.emptyArray,o.prototype.name="",o.prototype.opType="",o.prototype.domain="",o.prototype.attribute=p.emptyArray,o.prototype.docString="",o.create=function(e){return new o(e)},o.encode=function(e,s){if(s||(s=d.create()),e.input!=null&&e.input.length)for(var l=0;l<e.input.length;++l)s.uint32(10).string(e.input[l]);if(e.output!=null&&e.output.length)for(l=0;l<e.output.length;++l)s.uint32(18).string(e.output[l]);if(e.name!=null&&Object.hasOwnProperty.call(e,"name")&&s.uint32(26).string(e.name),e.opType!=null&&Object.hasOwnProperty.call(e,"opType")&&s.uint32(34).string(e.opType),e.attribute!=null&&e.attribute.length)for(l=0;l<e.attribute.length;++l)c.onnx.AttributeProto.encode(e.attribute[l],s.uint32(42).fork()).ldelim();return e.docString!=null&&Object.hasOwnProperty.call(e,"docString")&&s.uint32(50).string(e.docString),e.domain!=null&&Object.hasOwnProperty.call(e,"domain")&&s.uint32(58).string(e.domain),s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.NodeProto;e.pos<l;){var y=e.uint32();switch(y>>>3){case 1:g.input&&g.input.length||(g.input=[]),g.input.push(e.string());break;case 2:g.output&&g.output.length||(g.output=[]),g.output.push(e.string());break;case 3:g.name=e.string();break;case 4:g.opType=e.string();break;case 7:g.domain=e.string();break;case 5:g.attribute&&g.attribute.length||(g.attribute=[]),g.attribute.push(c.onnx.AttributeProto.decode(e,e.uint32()));break;case 6:g.docString=e.string();break;default:e.skipType(7&y)}}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.input!=null&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var s=0;s<e.input.length;++s)if(!p.isString(e.input[s]))return"input: string[] expected"}if(e.output!=null&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(s=0;s<e.output.length;++s)if(!p.isString(e.output[s]))return"output: string[] expected"}if(e.name!=null&&e.hasOwnProperty("name")&&!p.isString(e.name))return"name: string expected";if(e.opType!=null&&e.hasOwnProperty("opType")&&!p.isString(e.opType))return"opType: string expected";if(e.domain!=null&&e.hasOwnProperty("domain")&&!p.isString(e.domain))return"domain: string expected";if(e.attribute!=null&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(s=0;s<e.attribute.length;++s){var l=c.onnx.AttributeProto.verify(e.attribute[s]);if(l)return"attribute."+l}}return e.docString!=null&&e.hasOwnProperty("docString")&&!p.isString(e.docString)?"docString: string expected":null},o.fromObject=function(e){if(e instanceof c.onnx.NodeProto)return e;var s=new c.onnx.NodeProto;if(e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.NodeProto.input: array expected");s.input=[];for(var l=0;l<e.input.length;++l)s.input[l]=String(e.input[l])}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.NodeProto.output: array expected");for(s.output=[],l=0;l<e.output.length;++l)s.output[l]=String(e.output[l])}if(e.name!=null&&(s.name=String(e.name)),e.opType!=null&&(s.opType=String(e.opType)),e.domain!=null&&(s.domain=String(e.domain)),e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");for(s.attribute=[],l=0;l<e.attribute.length;++l){if(typeof e.attribute[l]!="object")throw TypeError(".onnx.NodeProto.attribute: object expected");s.attribute[l]=c.onnx.AttributeProto.fromObject(e.attribute[l])}}return e.docString!=null&&(s.docString=String(e.docString)),s},o.toObject=function(e,s){s||(s={});var l={};if((s.arrays||s.defaults)&&(l.input=[],l.output=[],l.attribute=[]),s.defaults&&(l.name="",l.opType="",l.docString="",l.domain=""),e.input&&e.input.length){l.input=[];for(var g=0;g<e.input.length;++g)l.input[g]=e.input[g]}if(e.output&&e.output.length)for(l.output=[],g=0;g<e.output.length;++g)l.output[g]=e.output[g];if(e.name!=null&&e.hasOwnProperty("name")&&(l.name=e.name),e.opType!=null&&e.hasOwnProperty("opType")&&(l.opType=e.opType),e.attribute&&e.attribute.length)for(l.attribute=[],g=0;g<e.attribute.length;++g)l.attribute[g]=c.onnx.AttributeProto.toObject(e.attribute[g],s);return e.docString!=null&&e.hasOwnProperty("docString")&&(l.docString=e.docString),e.domain!=null&&e.hasOwnProperty("domain")&&(l.domain=e.domain),l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.NodeProto"},o}(),u.TrainingInfoProto=function(){function o(e){if(this.initializationBinding=[],this.updateBinding=[],e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.initialization=null,o.prototype.algorithm=null,o.prototype.initializationBinding=p.emptyArray,o.prototype.updateBinding=p.emptyArray,o.create=function(e){return new o(e)},o.encode=function(e,s){if(s||(s=d.create()),e.initialization!=null&&Object.hasOwnProperty.call(e,"initialization")&&c.onnx.GraphProto.encode(e.initialization,s.uint32(10).fork()).ldelim(),e.algorithm!=null&&Object.hasOwnProperty.call(e,"algorithm")&&c.onnx.GraphProto.encode(e.algorithm,s.uint32(18).fork()).ldelim(),e.initializationBinding!=null&&e.initializationBinding.length)for(var l=0;l<e.initializationBinding.length;++l)c.onnx.StringStringEntryProto.encode(e.initializationBinding[l],s.uint32(26).fork()).ldelim();if(e.updateBinding!=null&&e.updateBinding.length)for(l=0;l<e.updateBinding.length;++l)c.onnx.StringStringEntryProto.encode(e.updateBinding[l],s.uint32(34).fork()).ldelim();return s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.TrainingInfoProto;e.pos<l;){var y=e.uint32();switch(y>>>3){case 1:g.initialization=c.onnx.GraphProto.decode(e,e.uint32());break;case 2:g.algorithm=c.onnx.GraphProto.decode(e,e.uint32());break;case 3:g.initializationBinding&&g.initializationBinding.length||(g.initializationBinding=[]),g.initializationBinding.push(c.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 4:g.updateBinding&&g.updateBinding.length||(g.updateBinding=[]),g.updateBinding.push(c.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&y)}}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.initialization!=null&&e.hasOwnProperty("initialization")&&(l=c.onnx.GraphProto.verify(e.initialization)))return"initialization."+l;if(e.algorithm!=null&&e.hasOwnProperty("algorithm")&&(l=c.onnx.GraphProto.verify(e.algorithm)))return"algorithm."+l;if(e.initializationBinding!=null&&e.hasOwnProperty("initializationBinding")){if(!Array.isArray(e.initializationBinding))return"initializationBinding: array expected";for(var s=0;s<e.initializationBinding.length;++s)if(l=c.onnx.StringStringEntryProto.verify(e.initializationBinding[s]))return"initializationBinding."+l}if(e.updateBinding!=null&&e.hasOwnProperty("updateBinding")){if(!Array.isArray(e.updateBinding))return"updateBinding: array expected";for(s=0;s<e.updateBinding.length;++s){var l;if(l=c.onnx.StringStringEntryProto.verify(e.updateBinding[s]))return"updateBinding."+l}}return null},o.fromObject=function(e){if(e instanceof c.onnx.TrainingInfoProto)return e;var s=new c.onnx.TrainingInfoProto;if(e.initialization!=null){if(typeof e.initialization!="object")throw TypeError(".onnx.TrainingInfoProto.initialization: object expected");s.initialization=c.onnx.GraphProto.fromObject(e.initialization)}if(e.algorithm!=null){if(typeof e.algorithm!="object")throw TypeError(".onnx.TrainingInfoProto.algorithm: object expected");s.algorithm=c.onnx.GraphProto.fromObject(e.algorithm)}if(e.initializationBinding){if(!Array.isArray(e.initializationBinding))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: array expected");s.initializationBinding=[];for(var l=0;l<e.initializationBinding.length;++l){if(typeof e.initializationBinding[l]!="object")throw TypeError(".onnx.TrainingInfoProto.initializationBinding: object expected");s.initializationBinding[l]=c.onnx.StringStringEntryProto.fromObject(e.initializationBinding[l])}}if(e.updateBinding){if(!Array.isArray(e.updateBinding))throw TypeError(".onnx.TrainingInfoProto.updateBinding: array expected");for(s.updateBinding=[],l=0;l<e.updateBinding.length;++l){if(typeof e.updateBinding[l]!="object")throw TypeError(".onnx.TrainingInfoProto.updateBinding: object expected");s.updateBinding[l]=c.onnx.StringStringEntryProto.fromObject(e.updateBinding[l])}}return s},o.toObject=function(e,s){s||(s={});var l={};if((s.arrays||s.defaults)&&(l.initializationBinding=[],l.updateBinding=[]),s.defaults&&(l.initialization=null,l.algorithm=null),e.initialization!=null&&e.hasOwnProperty("initialization")&&(l.initialization=c.onnx.GraphProto.toObject(e.initialization,s)),e.algorithm!=null&&e.hasOwnProperty("algorithm")&&(l.algorithm=c.onnx.GraphProto.toObject(e.algorithm,s)),e.initializationBinding&&e.initializationBinding.length){l.initializationBinding=[];for(var g=0;g<e.initializationBinding.length;++g)l.initializationBinding[g]=c.onnx.StringStringEntryProto.toObject(e.initializationBinding[g],s)}if(e.updateBinding&&e.updateBinding.length)for(l.updateBinding=[],g=0;g<e.updateBinding.length;++g)l.updateBinding[g]=c.onnx.StringStringEntryProto.toObject(e.updateBinding[g],s);return l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.TrainingInfoProto"},o}(),u.ModelProto=function(){function o(e){if(this.opsetImport=[],this.metadataProps=[],this.trainingInfo=[],this.functions=[],e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.irVersion=p.Long?p.Long.fromBits(0,0,!1):0,o.prototype.opsetImport=p.emptyArray,o.prototype.producerName="",o.prototype.producerVersion="",o.prototype.domain="",o.prototype.modelVersion=p.Long?p.Long.fromBits(0,0,!1):0,o.prototype.docString="",o.prototype.graph=null,o.prototype.metadataProps=p.emptyArray,o.prototype.trainingInfo=p.emptyArray,o.prototype.functions=p.emptyArray,o.create=function(e){return new o(e)},o.encode=function(e,s){if(s||(s=d.create()),e.irVersion!=null&&Object.hasOwnProperty.call(e,"irVersion")&&s.uint32(8).int64(e.irVersion),e.producerName!=null&&Object.hasOwnProperty.call(e,"producerName")&&s.uint32(18).string(e.producerName),e.producerVersion!=null&&Object.hasOwnProperty.call(e,"producerVersion")&&s.uint32(26).string(e.producerVersion),e.domain!=null&&Object.hasOwnProperty.call(e,"domain")&&s.uint32(34).string(e.domain),e.modelVersion!=null&&Object.hasOwnProperty.call(e,"modelVersion")&&s.uint32(40).int64(e.modelVersion),e.docString!=null&&Object.hasOwnProperty.call(e,"docString")&&s.uint32(50).string(e.docString),e.graph!=null&&Object.hasOwnProperty.call(e,"graph")&&c.onnx.GraphProto.encode(e.graph,s.uint32(58).fork()).ldelim(),e.opsetImport!=null&&e.opsetImport.length)for(var l=0;l<e.opsetImport.length;++l)c.onnx.OperatorSetIdProto.encode(e.opsetImport[l],s.uint32(66).fork()).ldelim();if(e.metadataProps!=null&&e.metadataProps.length)for(l=0;l<e.metadataProps.length;++l)c.onnx.StringStringEntryProto.encode(e.metadataProps[l],s.uint32(114).fork()).ldelim();if(e.trainingInfo!=null&&e.trainingInfo.length)for(l=0;l<e.trainingInfo.length;++l)c.onnx.TrainingInfoProto.encode(e.trainingInfo[l],s.uint32(162).fork()).ldelim();if(e.functions!=null&&e.functions.length)for(l=0;l<e.functions.length;++l)c.onnx.FunctionProto.encode(e.functions[l],s.uint32(202).fork()).ldelim();return s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.ModelProto;e.pos<l;){var y=e.uint32();switch(y>>>3){case 1:g.irVersion=e.int64();break;case 8:g.opsetImport&&g.opsetImport.length||(g.opsetImport=[]),g.opsetImport.push(c.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 2:g.producerName=e.string();break;case 3:g.producerVersion=e.string();break;case 4:g.domain=e.string();break;case 5:g.modelVersion=e.int64();break;case 6:g.docString=e.string();break;case 7:g.graph=c.onnx.GraphProto.decode(e,e.uint32());break;case 14:g.metadataProps&&g.metadataProps.length||(g.metadataProps=[]),g.metadataProps.push(c.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 20:g.trainingInfo&&g.trainingInfo.length||(g.trainingInfo=[]),g.trainingInfo.push(c.onnx.TrainingInfoProto.decode(e,e.uint32()));break;case 25:g.functions&&g.functions.length||(g.functions=[]),g.functions.push(c.onnx.FunctionProto.decode(e,e.uint32()));break;default:e.skipType(7&y)}}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.irVersion!=null&&e.hasOwnProperty("irVersion")&&!(p.isInteger(e.irVersion)||e.irVersion&&p.isInteger(e.irVersion.low)&&p.isInteger(e.irVersion.high)))return"irVersion: integer|Long expected";if(e.opsetImport!=null&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(var s=0;s<e.opsetImport.length;++s)if(l=c.onnx.OperatorSetIdProto.verify(e.opsetImport[s]))return"opsetImport."+l}if(e.producerName!=null&&e.hasOwnProperty("producerName")&&!p.isString(e.producerName))return"producerName: string expected";if(e.producerVersion!=null&&e.hasOwnProperty("producerVersion")&&!p.isString(e.producerVersion))return"producerVersion: string expected";if(e.domain!=null&&e.hasOwnProperty("domain")&&!p.isString(e.domain))return"domain: string expected";if(e.modelVersion!=null&&e.hasOwnProperty("modelVersion")&&!(p.isInteger(e.modelVersion)||e.modelVersion&&p.isInteger(e.modelVersion.low)&&p.isInteger(e.modelVersion.high)))return"modelVersion: integer|Long expected";if(e.docString!=null&&e.hasOwnProperty("docString")&&!p.isString(e.docString))return"docString: string expected";if(e.graph!=null&&e.hasOwnProperty("graph")&&(l=c.onnx.GraphProto.verify(e.graph)))return"graph."+l;if(e.metadataProps!=null&&e.hasOwnProperty("metadataProps")){if(!Array.isArray(e.metadataProps))return"metadataProps: array expected";for(s=0;s<e.metadataProps.length;++s)if(l=c.onnx.StringStringEntryProto.verify(e.metadataProps[s]))return"metadataProps."+l}if(e.trainingInfo!=null&&e.hasOwnProperty("trainingInfo")){if(!Array.isArray(e.trainingInfo))return"trainingInfo: array expected";for(s=0;s<e.trainingInfo.length;++s)if(l=c.onnx.TrainingInfoProto.verify(e.trainingInfo[s]))return"trainingInfo."+l}if(e.functions!=null&&e.hasOwnProperty("functions")){if(!Array.isArray(e.functions))return"functions: array expected";for(s=0;s<e.functions.length;++s){var l;if(l=c.onnx.FunctionProto.verify(e.functions[s]))return"functions."+l}}return null},o.fromObject=function(e){if(e instanceof c.onnx.ModelProto)return e;var s=new c.onnx.ModelProto;if(e.irVersion!=null&&(p.Long?(s.irVersion=p.Long.fromValue(e.irVersion)).unsigned=!1:typeof e.irVersion=="string"?s.irVersion=parseInt(e.irVersion,10):typeof e.irVersion=="number"?s.irVersion=e.irVersion:typeof e.irVersion=="object"&&(s.irVersion=new p.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber())),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");s.opsetImport=[];for(var l=0;l<e.opsetImport.length;++l){if(typeof e.opsetImport[l]!="object")throw TypeError(".onnx.ModelProto.opsetImport: object expected");s.opsetImport[l]=c.onnx.OperatorSetIdProto.fromObject(e.opsetImport[l])}}if(e.producerName!=null&&(s.producerName=String(e.producerName)),e.producerVersion!=null&&(s.producerVersion=String(e.producerVersion)),e.domain!=null&&(s.domain=String(e.domain)),e.modelVersion!=null&&(p.Long?(s.modelVersion=p.Long.fromValue(e.modelVersion)).unsigned=!1:typeof e.modelVersion=="string"?s.modelVersion=parseInt(e.modelVersion,10):typeof e.modelVersion=="number"?s.modelVersion=e.modelVersion:typeof e.modelVersion=="object"&&(s.modelVersion=new p.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber())),e.docString!=null&&(s.docString=String(e.docString)),e.graph!=null){if(typeof e.graph!="object")throw TypeError(".onnx.ModelProto.graph: object expected");s.graph=c.onnx.GraphProto.fromObject(e.graph)}if(e.metadataProps){if(!Array.isArray(e.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");for(s.metadataProps=[],l=0;l<e.metadataProps.length;++l){if(typeof e.metadataProps[l]!="object")throw TypeError(".onnx.ModelProto.metadataProps: object expected");s.metadataProps[l]=c.onnx.StringStringEntryProto.fromObject(e.metadataProps[l])}}if(e.trainingInfo){if(!Array.isArray(e.trainingInfo))throw TypeError(".onnx.ModelProto.trainingInfo: array expected");for(s.trainingInfo=[],l=0;l<e.trainingInfo.length;++l){if(typeof e.trainingInfo[l]!="object")throw TypeError(".onnx.ModelProto.trainingInfo: object expected");s.trainingInfo[l]=c.onnx.TrainingInfoProto.fromObject(e.trainingInfo[l])}}if(e.functions){if(!Array.isArray(e.functions))throw TypeError(".onnx.ModelProto.functions: array expected");for(s.functions=[],l=0;l<e.functions.length;++l){if(typeof e.functions[l]!="object")throw TypeError(".onnx.ModelProto.functions: object expected");s.functions[l]=c.onnx.FunctionProto.fromObject(e.functions[l])}}return s},o.toObject=function(e,s){s||(s={});var l={};if((s.arrays||s.defaults)&&(l.opsetImport=[],l.metadataProps=[],l.trainingInfo=[],l.functions=[]),s.defaults){if(p.Long){var g=new p.Long(0,0,!1);l.irVersion=s.longs===String?g.toString():s.longs===Number?g.toNumber():g}else l.irVersion=s.longs===String?"0":0;l.producerName="",l.producerVersion="",l.domain="",p.Long?(g=new p.Long(0,0,!1),l.modelVersion=s.longs===String?g.toString():s.longs===Number?g.toNumber():g):l.modelVersion=s.longs===String?"0":0,l.docString="",l.graph=null}if(e.irVersion!=null&&e.hasOwnProperty("irVersion")&&(typeof e.irVersion=="number"?l.irVersion=s.longs===String?String(e.irVersion):e.irVersion:l.irVersion=s.longs===String?p.Long.prototype.toString.call(e.irVersion):s.longs===Number?new p.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber():e.irVersion),e.producerName!=null&&e.hasOwnProperty("producerName")&&(l.producerName=e.producerName),e.producerVersion!=null&&e.hasOwnProperty("producerVersion")&&(l.producerVersion=e.producerVersion),e.domain!=null&&e.hasOwnProperty("domain")&&(l.domain=e.domain),e.modelVersion!=null&&e.hasOwnProperty("modelVersion")&&(typeof e.modelVersion=="number"?l.modelVersion=s.longs===String?String(e.modelVersion):e.modelVersion:l.modelVersion=s.longs===String?p.Long.prototype.toString.call(e.modelVersion):s.longs===Number?new p.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber():e.modelVersion),e.docString!=null&&e.hasOwnProperty("docString")&&(l.docString=e.docString),e.graph!=null&&e.hasOwnProperty("graph")&&(l.graph=c.onnx.GraphProto.toObject(e.graph,s)),e.opsetImport&&e.opsetImport.length){l.opsetImport=[];for(var y=0;y<e.opsetImport.length;++y)l.opsetImport[y]=c.onnx.OperatorSetIdProto.toObject(e.opsetImport[y],s)}if(e.metadataProps&&e.metadataProps.length)for(l.metadataProps=[],y=0;y<e.metadataProps.length;++y)l.metadataProps[y]=c.onnx.StringStringEntryProto.toObject(e.metadataProps[y],s);if(e.trainingInfo&&e.trainingInfo.length)for(l.trainingInfo=[],y=0;y<e.trainingInfo.length;++y)l.trainingInfo[y]=c.onnx.TrainingInfoProto.toObject(e.trainingInfo[y],s);if(e.functions&&e.functions.length)for(l.functions=[],y=0;y<e.functions.length;++y)l.functions[y]=c.onnx.FunctionProto.toObject(e.functions[y],s);return l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.ModelProto"},o}(),u.StringStringEntryProto=function(){function o(e){if(e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.key="",o.prototype.value="",o.create=function(e){return new o(e)},o.encode=function(e,s){return s||(s=d.create()),e.key!=null&&Object.hasOwnProperty.call(e,"key")&&s.uint32(10).string(e.key),e.value!=null&&Object.hasOwnProperty.call(e,"value")&&s.uint32(18).string(e.value),s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.StringStringEntryProto;e.pos<l;){var y=e.uint32();switch(y>>>3){case 1:g.key=e.string();break;case 2:g.value=e.string();break;default:e.skipType(7&y)}}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){return typeof e!="object"||e===null?"object expected":e.key!=null&&e.hasOwnProperty("key")&&!p.isString(e.key)?"key: string expected":e.value!=null&&e.hasOwnProperty("value")&&!p.isString(e.value)?"value: string expected":null},o.fromObject=function(e){if(e instanceof c.onnx.StringStringEntryProto)return e;var s=new c.onnx.StringStringEntryProto;return e.key!=null&&(s.key=String(e.key)),e.value!=null&&(s.value=String(e.value)),s},o.toObject=function(e,s){s||(s={});var l={};return s.defaults&&(l.key="",l.value=""),e.key!=null&&e.hasOwnProperty("key")&&(l.key=e.key),e.value!=null&&e.hasOwnProperty("value")&&(l.value=e.value),l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.StringStringEntryProto"},o}(),u.TensorAnnotation=function(){function o(e){if(this.quantParameterTensorNames=[],e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.tensorName="",o.prototype.quantParameterTensorNames=p.emptyArray,o.create=function(e){return new o(e)},o.encode=function(e,s){if(s||(s=d.create()),e.tensorName!=null&&Object.hasOwnProperty.call(e,"tensorName")&&s.uint32(10).string(e.tensorName),e.quantParameterTensorNames!=null&&e.quantParameterTensorNames.length)for(var l=0;l<e.quantParameterTensorNames.length;++l)c.onnx.StringStringEntryProto.encode(e.quantParameterTensorNames[l],s.uint32(18).fork()).ldelim();return s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.TensorAnnotation;e.pos<l;){var y=e.uint32();switch(y>>>3){case 1:g.tensorName=e.string();break;case 2:g.quantParameterTensorNames&&g.quantParameterTensorNames.length||(g.quantParameterTensorNames=[]),g.quantParameterTensorNames.push(c.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&y)}}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.tensorName!=null&&e.hasOwnProperty("tensorName")&&!p.isString(e.tensorName))return"tensorName: string expected";if(e.quantParameterTensorNames!=null&&e.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(e.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var s=0;s<e.quantParameterTensorNames.length;++s){var l=c.onnx.StringStringEntryProto.verify(e.quantParameterTensorNames[s]);if(l)return"quantParameterTensorNames."+l}}return null},o.fromObject=function(e){if(e instanceof c.onnx.TensorAnnotation)return e;var s=new c.onnx.TensorAnnotation;if(e.tensorName!=null&&(s.tensorName=String(e.tensorName)),e.quantParameterTensorNames){if(!Array.isArray(e.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");s.quantParameterTensorNames=[];for(var l=0;l<e.quantParameterTensorNames.length;++l){if(typeof e.quantParameterTensorNames[l]!="object")throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");s.quantParameterTensorNames[l]=c.onnx.StringStringEntryProto.fromObject(e.quantParameterTensorNames[l])}}return s},o.toObject=function(e,s){s||(s={});var l={};if((s.arrays||s.defaults)&&(l.quantParameterTensorNames=[]),s.defaults&&(l.tensorName=""),e.tensorName!=null&&e.hasOwnProperty("tensorName")&&(l.tensorName=e.tensorName),e.quantParameterTensorNames&&e.quantParameterTensorNames.length){l.quantParameterTensorNames=[];for(var g=0;g<e.quantParameterTensorNames.length;++g)l.quantParameterTensorNames[g]=c.onnx.StringStringEntryProto.toObject(e.quantParameterTensorNames[g],s)}return l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.TensorAnnotation"},o}(),u.GraphProto=function(){function o(e){if(this.node=[],this.initializer=[],this.sparseInitializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.node=p.emptyArray,o.prototype.name="",o.prototype.initializer=p.emptyArray,o.prototype.sparseInitializer=p.emptyArray,o.prototype.docString="",o.prototype.input=p.emptyArray,o.prototype.output=p.emptyArray,o.prototype.valueInfo=p.emptyArray,o.prototype.quantizationAnnotation=p.emptyArray,o.create=function(e){return new o(e)},o.encode=function(e,s){if(s||(s=d.create()),e.node!=null&&e.node.length)for(var l=0;l<e.node.length;++l)c.onnx.NodeProto.encode(e.node[l],s.uint32(10).fork()).ldelim();if(e.name!=null&&Object.hasOwnProperty.call(e,"name")&&s.uint32(18).string(e.name),e.initializer!=null&&e.initializer.length)for(l=0;l<e.initializer.length;++l)c.onnx.TensorProto.encode(e.initializer[l],s.uint32(42).fork()).ldelim();if(e.docString!=null&&Object.hasOwnProperty.call(e,"docString")&&s.uint32(82).string(e.docString),e.input!=null&&e.input.length)for(l=0;l<e.input.length;++l)c.onnx.ValueInfoProto.encode(e.input[l],s.uint32(90).fork()).ldelim();if(e.output!=null&&e.output.length)for(l=0;l<e.output.length;++l)c.onnx.ValueInfoProto.encode(e.output[l],s.uint32(98).fork()).ldelim();if(e.valueInfo!=null&&e.valueInfo.length)for(l=0;l<e.valueInfo.length;++l)c.onnx.ValueInfoProto.encode(e.valueInfo[l],s.uint32(106).fork()).ldelim();if(e.quantizationAnnotation!=null&&e.quantizationAnnotation.length)for(l=0;l<e.quantizationAnnotation.length;++l)c.onnx.TensorAnnotation.encode(e.quantizationAnnotation[l],s.uint32(114).fork()).ldelim();if(e.sparseInitializer!=null&&e.sparseInitializer.length)for(l=0;l<e.sparseInitializer.length;++l)c.onnx.SparseTensorProto.encode(e.sparseInitializer[l],s.uint32(122).fork()).ldelim();return s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.GraphProto;e.pos<l;){var y=e.uint32();switch(y>>>3){case 1:g.node&&g.node.length||(g.node=[]),g.node.push(c.onnx.NodeProto.decode(e,e.uint32()));break;case 2:g.name=e.string();break;case 5:g.initializer&&g.initializer.length||(g.initializer=[]),g.initializer.push(c.onnx.TensorProto.decode(e,e.uint32()));break;case 15:g.sparseInitializer&&g.sparseInitializer.length||(g.sparseInitializer=[]),g.sparseInitializer.push(c.onnx.SparseTensorProto.decode(e,e.uint32()));break;case 10:g.docString=e.string();break;case 11:g.input&&g.input.length||(g.input=[]),g.input.push(c.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 12:g.output&&g.output.length||(g.output=[]),g.output.push(c.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 13:g.valueInfo&&g.valueInfo.length||(g.valueInfo=[]),g.valueInfo.push(c.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 14:g.quantizationAnnotation&&g.quantizationAnnotation.length||(g.quantizationAnnotation=[]),g.quantizationAnnotation.push(c.onnx.TensorAnnotation.decode(e,e.uint32()));break;default:e.skipType(7&y)}}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.node!=null&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(var s=0;s<e.node.length;++s)if(l=c.onnx.NodeProto.verify(e.node[s]))return"node."+l}if(e.name!=null&&e.hasOwnProperty("name")&&!p.isString(e.name))return"name: string expected";if(e.initializer!=null&&e.hasOwnProperty("initializer")){if(!Array.isArray(e.initializer))return"initializer: array expected";for(s=0;s<e.initializer.length;++s)if(l=c.onnx.TensorProto.verify(e.initializer[s]))return"initializer."+l}if(e.sparseInitializer!=null&&e.hasOwnProperty("sparseInitializer")){if(!Array.isArray(e.sparseInitializer))return"sparseInitializer: array expected";for(s=0;s<e.sparseInitializer.length;++s)if(l=c.onnx.SparseTensorProto.verify(e.sparseInitializer[s]))return"sparseInitializer."+l}if(e.docString!=null&&e.hasOwnProperty("docString")&&!p.isString(e.docString))return"docString: string expected";if(e.input!=null&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(s=0;s<e.input.length;++s)if(l=c.onnx.ValueInfoProto.verify(e.input[s]))return"input."+l}if(e.output!=null&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(s=0;s<e.output.length;++s)if(l=c.onnx.ValueInfoProto.verify(e.output[s]))return"output."+l}if(e.valueInfo!=null&&e.hasOwnProperty("valueInfo")){if(!Array.isArray(e.valueInfo))return"valueInfo: array expected";for(s=0;s<e.valueInfo.length;++s)if(l=c.onnx.ValueInfoProto.verify(e.valueInfo[s]))return"valueInfo."+l}if(e.quantizationAnnotation!=null&&e.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(e.quantizationAnnotation))return"quantizationAnnotation: array expected";for(s=0;s<e.quantizationAnnotation.length;++s){var l;if(l=c.onnx.TensorAnnotation.verify(e.quantizationAnnotation[s]))return"quantizationAnnotation."+l}}return null},o.fromObject=function(e){if(e instanceof c.onnx.GraphProto)return e;var s=new c.onnx.GraphProto;if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.GraphProto.node: array expected");s.node=[];for(var l=0;l<e.node.length;++l){if(typeof e.node[l]!="object")throw TypeError(".onnx.GraphProto.node: object expected");s.node[l]=c.onnx.NodeProto.fromObject(e.node[l])}}if(e.name!=null&&(s.name=String(e.name)),e.initializer){if(!Array.isArray(e.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");for(s.initializer=[],l=0;l<e.initializer.length;++l){if(typeof e.initializer[l]!="object")throw TypeError(".onnx.GraphProto.initializer: object expected");s.initializer[l]=c.onnx.TensorProto.fromObject(e.initializer[l])}}if(e.sparseInitializer){if(!Array.isArray(e.sparseInitializer))throw TypeError(".onnx.GraphProto.sparseInitializer: array expected");for(s.sparseInitializer=[],l=0;l<e.sparseInitializer.length;++l){if(typeof e.sparseInitializer[l]!="object")throw TypeError(".onnx.GraphProto.sparseInitializer: object expected");s.sparseInitializer[l]=c.onnx.SparseTensorProto.fromObject(e.sparseInitializer[l])}}if(e.docString!=null&&(s.docString=String(e.docString)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.GraphProto.input: array expected");for(s.input=[],l=0;l<e.input.length;++l){if(typeof e.input[l]!="object")throw TypeError(".onnx.GraphProto.input: object expected");s.input[l]=c.onnx.ValueInfoProto.fromObject(e.input[l])}}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.GraphProto.output: array expected");for(s.output=[],l=0;l<e.output.length;++l){if(typeof e.output[l]!="object")throw TypeError(".onnx.GraphProto.output: object expected");s.output[l]=c.onnx.ValueInfoProto.fromObject(e.output[l])}}if(e.valueInfo){if(!Array.isArray(e.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");for(s.valueInfo=[],l=0;l<e.valueInfo.length;++l){if(typeof e.valueInfo[l]!="object")throw TypeError(".onnx.GraphProto.valueInfo: object expected");s.valueInfo[l]=c.onnx.ValueInfoProto.fromObject(e.valueInfo[l])}}if(e.quantizationAnnotation){if(!Array.isArray(e.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");for(s.quantizationAnnotation=[],l=0;l<e.quantizationAnnotation.length;++l){if(typeof e.quantizationAnnotation[l]!="object")throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");s.quantizationAnnotation[l]=c.onnx.TensorAnnotation.fromObject(e.quantizationAnnotation[l])}}return s},o.toObject=function(e,s){s||(s={});var l={};if((s.arrays||s.defaults)&&(l.node=[],l.initializer=[],l.input=[],l.output=[],l.valueInfo=[],l.quantizationAnnotation=[],l.sparseInitializer=[]),s.defaults&&(l.name="",l.docString=""),e.node&&e.node.length){l.node=[];for(var g=0;g<e.node.length;++g)l.node[g]=c.onnx.NodeProto.toObject(e.node[g],s)}if(e.name!=null&&e.hasOwnProperty("name")&&(l.name=e.name),e.initializer&&e.initializer.length)for(l.initializer=[],g=0;g<e.initializer.length;++g)l.initializer[g]=c.onnx.TensorProto.toObject(e.initializer[g],s);if(e.docString!=null&&e.hasOwnProperty("docString")&&(l.docString=e.docString),e.input&&e.input.length)for(l.input=[],g=0;g<e.input.length;++g)l.input[g]=c.onnx.ValueInfoProto.toObject(e.input[g],s);if(e.output&&e.output.length)for(l.output=[],g=0;g<e.output.length;++g)l.output[g]=c.onnx.ValueInfoProto.toObject(e.output[g],s);if(e.valueInfo&&e.valueInfo.length)for(l.valueInfo=[],g=0;g<e.valueInfo.length;++g)l.valueInfo[g]=c.onnx.ValueInfoProto.toObject(e.valueInfo[g],s);if(e.quantizationAnnotation&&e.quantizationAnnotation.length)for(l.quantizationAnnotation=[],g=0;g<e.quantizationAnnotation.length;++g)l.quantizationAnnotation[g]=c.onnx.TensorAnnotation.toObject(e.quantizationAnnotation[g],s);if(e.sparseInitializer&&e.sparseInitializer.length)for(l.sparseInitializer=[],g=0;g<e.sparseInitializer.length;++g)l.sparseInitializer[g]=c.onnx.SparseTensorProto.toObject(e.sparseInitializer[g],s);return l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.GraphProto"},o}(),u.TensorProto=function(){function o(e){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.dims=p.emptyArray,o.prototype.dataType=0,o.prototype.segment=null,o.prototype.floatData=p.emptyArray,o.prototype.int32Data=p.emptyArray,o.prototype.stringData=p.emptyArray,o.prototype.int64Data=p.emptyArray,o.prototype.name="",o.prototype.docString="",o.prototype.rawData=p.newBuffer([]),o.prototype.externalData=p.emptyArray,o.prototype.dataLocation=0,o.prototype.doubleData=p.emptyArray,o.prototype.uint64Data=p.emptyArray,o.create=function(e){return new o(e)},o.encode=function(e,s){if(s||(s=d.create()),e.dims!=null&&e.dims.length){s.uint32(10).fork();for(var l=0;l<e.dims.length;++l)s.int64(e.dims[l]);s.ldelim()}if(e.dataType!=null&&Object.hasOwnProperty.call(e,"dataType")&&s.uint32(16).int32(e.dataType),e.segment!=null&&Object.hasOwnProperty.call(e,"segment")&&c.onnx.TensorProto.Segment.encode(e.segment,s.uint32(26).fork()).ldelim(),e.floatData!=null&&e.floatData.length){for(s.uint32(34).fork(),l=0;l<e.floatData.length;++l)s.float(e.floatData[l]);s.ldelim()}if(e.int32Data!=null&&e.int32Data.length){for(s.uint32(42).fork(),l=0;l<e.int32Data.length;++l)s.int32(e.int32Data[l]);s.ldelim()}if(e.stringData!=null&&e.stringData.length)for(l=0;l<e.stringData.length;++l)s.uint32(50).bytes(e.stringData[l]);if(e.int64Data!=null&&e.int64Data.length){for(s.uint32(58).fork(),l=0;l<e.int64Data.length;++l)s.int64(e.int64Data[l]);s.ldelim()}if(e.name!=null&&Object.hasOwnProperty.call(e,"name")&&s.uint32(66).string(e.name),e.rawData!=null&&Object.hasOwnProperty.call(e,"rawData")&&s.uint32(74).bytes(e.rawData),e.doubleData!=null&&e.doubleData.length){for(s.uint32(82).fork(),l=0;l<e.doubleData.length;++l)s.double(e.doubleData[l]);s.ldelim()}if(e.uint64Data!=null&&e.uint64Data.length){for(s.uint32(90).fork(),l=0;l<e.uint64Data.length;++l)s.uint64(e.uint64Data[l]);s.ldelim()}if(e.docString!=null&&Object.hasOwnProperty.call(e,"docString")&&s.uint32(98).string(e.docString),e.externalData!=null&&e.externalData.length)for(l=0;l<e.externalData.length;++l)c.onnx.StringStringEntryProto.encode(e.externalData[l],s.uint32(106).fork()).ldelim();return e.dataLocation!=null&&Object.hasOwnProperty.call(e,"dataLocation")&&s.uint32(112).int32(e.dataLocation),s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.TensorProto;e.pos<l;){var y=e.uint32();switch(y>>>3){case 1:if(g.dims&&g.dims.length||(g.dims=[]),(7&y)==2)for(var b=e.uint32()+e.pos;e.pos<b;)g.dims.push(e.int64());else g.dims.push(e.int64());break;case 2:g.dataType=e.int32();break;case 3:g.segment=c.onnx.TensorProto.Segment.decode(e,e.uint32());break;case 4:if(g.floatData&&g.floatData.length||(g.floatData=[]),(7&y)==2)for(b=e.uint32()+e.pos;e.pos<b;)g.floatData.push(e.float());else g.floatData.push(e.float());break;case 5:if(g.int32Data&&g.int32Data.length||(g.int32Data=[]),(7&y)==2)for(b=e.uint32()+e.pos;e.pos<b;)g.int32Data.push(e.int32());else g.int32Data.push(e.int32());break;case 6:g.stringData&&g.stringData.length||(g.stringData=[]),g.stringData.push(e.bytes());break;case 7:if(g.int64Data&&g.int64Data.length||(g.int64Data=[]),(7&y)==2)for(b=e.uint32()+e.pos;e.pos<b;)g.int64Data.push(e.int64());else g.int64Data.push(e.int64());break;case 8:g.name=e.string();break;case 12:g.docString=e.string();break;case 9:g.rawData=e.bytes();break;case 13:g.externalData&&g.externalData.length||(g.externalData=[]),g.externalData.push(c.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 14:g.dataLocation=e.int32();break;case 10:if(g.doubleData&&g.doubleData.length||(g.doubleData=[]),(7&y)==2)for(b=e.uint32()+e.pos;e.pos<b;)g.doubleData.push(e.double());else g.doubleData.push(e.double());break;case 11:if(g.uint64Data&&g.uint64Data.length||(g.uint64Data=[]),(7&y)==2)for(b=e.uint32()+e.pos;e.pos<b;)g.uint64Data.push(e.uint64());else g.uint64Data.push(e.uint64());break;default:e.skipType(7&y)}}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.dims!=null&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var s=0;s<e.dims.length;++s)if(!(p.isInteger(e.dims[s])||e.dims[s]&&p.isInteger(e.dims[s].low)&&p.isInteger(e.dims[s].high)))return"dims: integer|Long[] expected"}if(e.dataType!=null&&e.hasOwnProperty("dataType")&&!p.isInteger(e.dataType))return"dataType: integer expected";if(e.segment!=null&&e.hasOwnProperty("segment")&&(l=c.onnx.TensorProto.Segment.verify(e.segment)))return"segment."+l;if(e.floatData!=null&&e.hasOwnProperty("floatData")){if(!Array.isArray(e.floatData))return"floatData: array expected";for(s=0;s<e.floatData.length;++s)if(typeof e.floatData[s]!="number")return"floatData: number[] expected"}if(e.int32Data!=null&&e.hasOwnProperty("int32Data")){if(!Array.isArray(e.int32Data))return"int32Data: array expected";for(s=0;s<e.int32Data.length;++s)if(!p.isInteger(e.int32Data[s]))return"int32Data: integer[] expected"}if(e.stringData!=null&&e.hasOwnProperty("stringData")){if(!Array.isArray(e.stringData))return"stringData: array expected";for(s=0;s<e.stringData.length;++s)if(!(e.stringData[s]&&typeof e.stringData[s].length=="number"||p.isString(e.stringData[s])))return"stringData: buffer[] expected"}if(e.int64Data!=null&&e.hasOwnProperty("int64Data")){if(!Array.isArray(e.int64Data))return"int64Data: array expected";for(s=0;s<e.int64Data.length;++s)if(!(p.isInteger(e.int64Data[s])||e.int64Data[s]&&p.isInteger(e.int64Data[s].low)&&p.isInteger(e.int64Data[s].high)))return"int64Data: integer|Long[] expected"}if(e.name!=null&&e.hasOwnProperty("name")&&!p.isString(e.name))return"name: string expected";if(e.docString!=null&&e.hasOwnProperty("docString")&&!p.isString(e.docString))return"docString: string expected";if(e.rawData!=null&&e.hasOwnProperty("rawData")&&!(e.rawData&&typeof e.rawData.length=="number"||p.isString(e.rawData)))return"rawData: buffer expected";if(e.externalData!=null&&e.hasOwnProperty("externalData")){if(!Array.isArray(e.externalData))return"externalData: array expected";for(s=0;s<e.externalData.length;++s){var l;if(l=c.onnx.StringStringEntryProto.verify(e.externalData[s]))return"externalData."+l}}if(e.dataLocation!=null&&e.hasOwnProperty("dataLocation"))switch(e.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:}if(e.doubleData!=null&&e.hasOwnProperty("doubleData")){if(!Array.isArray(e.doubleData))return"doubleData: array expected";for(s=0;s<e.doubleData.length;++s)if(typeof e.doubleData[s]!="number")return"doubleData: number[] expected"}if(e.uint64Data!=null&&e.hasOwnProperty("uint64Data")){if(!Array.isArray(e.uint64Data))return"uint64Data: array expected";for(s=0;s<e.uint64Data.length;++s)if(!(p.isInteger(e.uint64Data[s])||e.uint64Data[s]&&p.isInteger(e.uint64Data[s].low)&&p.isInteger(e.uint64Data[s].high)))return"uint64Data: integer|Long[] expected"}return null},o.fromObject=function(e){if(e instanceof c.onnx.TensorProto)return e;var s=new c.onnx.TensorProto;if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.TensorProto.dims: array expected");s.dims=[];for(var l=0;l<e.dims.length;++l)p.Long?(s.dims[l]=p.Long.fromValue(e.dims[l])).unsigned=!1:typeof e.dims[l]=="string"?s.dims[l]=parseInt(e.dims[l],10):typeof e.dims[l]=="number"?s.dims[l]=e.dims[l]:typeof e.dims[l]=="object"&&(s.dims[l]=new p.LongBits(e.dims[l].low>>>0,e.dims[l].high>>>0).toNumber())}if(e.dataType!=null&&(s.dataType=0|e.dataType),e.segment!=null){if(typeof e.segment!="object")throw TypeError(".onnx.TensorProto.segment: object expected");s.segment=c.onnx.TensorProto.Segment.fromObject(e.segment)}if(e.floatData){if(!Array.isArray(e.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");for(s.floatData=[],l=0;l<e.floatData.length;++l)s.floatData[l]=Number(e.floatData[l])}if(e.int32Data){if(!Array.isArray(e.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");for(s.int32Data=[],l=0;l<e.int32Data.length;++l)s.int32Data[l]=0|e.int32Data[l]}if(e.stringData){if(!Array.isArray(e.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");for(s.stringData=[],l=0;l<e.stringData.length;++l)typeof e.stringData[l]=="string"?p.base64.decode(e.stringData[l],s.stringData[l]=p.newBuffer(p.base64.length(e.stringData[l])),0):e.stringData[l].length>=0&&(s.stringData[l]=e.stringData[l])}if(e.int64Data){if(!Array.isArray(e.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");for(s.int64Data=[],l=0;l<e.int64Data.length;++l)p.Long?(s.int64Data[l]=p.Long.fromValue(e.int64Data[l])).unsigned=!1:typeof e.int64Data[l]=="string"?s.int64Data[l]=parseInt(e.int64Data[l],10):typeof e.int64Data[l]=="number"?s.int64Data[l]=e.int64Data[l]:typeof e.int64Data[l]=="object"&&(s.int64Data[l]=new p.LongBits(e.int64Data[l].low>>>0,e.int64Data[l].high>>>0).toNumber())}if(e.name!=null&&(s.name=String(e.name)),e.docString!=null&&(s.docString=String(e.docString)),e.rawData!=null&&(typeof e.rawData=="string"?p.base64.decode(e.rawData,s.rawData=p.newBuffer(p.base64.length(e.rawData)),0):e.rawData.length>=0&&(s.rawData=e.rawData)),e.externalData){if(!Array.isArray(e.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");for(s.externalData=[],l=0;l<e.externalData.length;++l){if(typeof e.externalData[l]!="object")throw TypeError(".onnx.TensorProto.externalData: object expected");s.externalData[l]=c.onnx.StringStringEntryProto.fromObject(e.externalData[l])}}switch(e.dataLocation){default:if(typeof e.dataLocation=="number"){s.dataLocation=e.dataLocation;break}break;case"DEFAULT":case 0:s.dataLocation=0;break;case"EXTERNAL":case 1:s.dataLocation=1}if(e.doubleData){if(!Array.isArray(e.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");for(s.doubleData=[],l=0;l<e.doubleData.length;++l)s.doubleData[l]=Number(e.doubleData[l])}if(e.uint64Data){if(!Array.isArray(e.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");for(s.uint64Data=[],l=0;l<e.uint64Data.length;++l)p.Long?(s.uint64Data[l]=p.Long.fromValue(e.uint64Data[l])).unsigned=!0:typeof e.uint64Data[l]=="string"?s.uint64Data[l]=parseInt(e.uint64Data[l],10):typeof e.uint64Data[l]=="number"?s.uint64Data[l]=e.uint64Data[l]:typeof e.uint64Data[l]=="object"&&(s.uint64Data[l]=new p.LongBits(e.uint64Data[l].low>>>0,e.uint64Data[l].high>>>0).toNumber(!0))}return s},o.toObject=function(e,s){s||(s={});var l={};if((s.arrays||s.defaults)&&(l.dims=[],l.floatData=[],l.int32Data=[],l.stringData=[],l.int64Data=[],l.doubleData=[],l.uint64Data=[],l.externalData=[]),s.defaults&&(l.dataType=0,l.segment=null,l.name="",s.bytes===String?l.rawData="":(l.rawData=[],s.bytes!==Array&&(l.rawData=p.newBuffer(l.rawData))),l.docString="",l.dataLocation=s.enums===String?"DEFAULT":0),e.dims&&e.dims.length){l.dims=[];for(var g=0;g<e.dims.length;++g)typeof e.dims[g]=="number"?l.dims[g]=s.longs===String?String(e.dims[g]):e.dims[g]:l.dims[g]=s.longs===String?p.Long.prototype.toString.call(e.dims[g]):s.longs===Number?new p.LongBits(e.dims[g].low>>>0,e.dims[g].high>>>0).toNumber():e.dims[g]}if(e.dataType!=null&&e.hasOwnProperty("dataType")&&(l.dataType=e.dataType),e.segment!=null&&e.hasOwnProperty("segment")&&(l.segment=c.onnx.TensorProto.Segment.toObject(e.segment,s)),e.floatData&&e.floatData.length)for(l.floatData=[],g=0;g<e.floatData.length;++g)l.floatData[g]=s.json&&!isFinite(e.floatData[g])?String(e.floatData[g]):e.floatData[g];if(e.int32Data&&e.int32Data.length)for(l.int32Data=[],g=0;g<e.int32Data.length;++g)l.int32Data[g]=e.int32Data[g];if(e.stringData&&e.stringData.length)for(l.stringData=[],g=0;g<e.stringData.length;++g)l.stringData[g]=s.bytes===String?p.base64.encode(e.stringData[g],0,e.stringData[g].length):s.bytes===Array?Array.prototype.slice.call(e.stringData[g]):e.stringData[g];if(e.int64Data&&e.int64Data.length)for(l.int64Data=[],g=0;g<e.int64Data.length;++g)typeof e.int64Data[g]=="number"?l.int64Data[g]=s.longs===String?String(e.int64Data[g]):e.int64Data[g]:l.int64Data[g]=s.longs===String?p.Long.prototype.toString.call(e.int64Data[g]):s.longs===Number?new p.LongBits(e.int64Data[g].low>>>0,e.int64Data[g].high>>>0).toNumber():e.int64Data[g];if(e.name!=null&&e.hasOwnProperty("name")&&(l.name=e.name),e.rawData!=null&&e.hasOwnProperty("rawData")&&(l.rawData=s.bytes===String?p.base64.encode(e.rawData,0,e.rawData.length):s.bytes===Array?Array.prototype.slice.call(e.rawData):e.rawData),e.doubleData&&e.doubleData.length)for(l.doubleData=[],g=0;g<e.doubleData.length;++g)l.doubleData[g]=s.json&&!isFinite(e.doubleData[g])?String(e.doubleData[g]):e.doubleData[g];if(e.uint64Data&&e.uint64Data.length)for(l.uint64Data=[],g=0;g<e.uint64Data.length;++g)typeof e.uint64Data[g]=="number"?l.uint64Data[g]=s.longs===String?String(e.uint64Data[g]):e.uint64Data[g]:l.uint64Data[g]=s.longs===String?p.Long.prototype.toString.call(e.uint64Data[g]):s.longs===Number?new p.LongBits(e.uint64Data[g].low>>>0,e.uint64Data[g].high>>>0).toNumber(!0):e.uint64Data[g];if(e.docString!=null&&e.hasOwnProperty("docString")&&(l.docString=e.docString),e.externalData&&e.externalData.length)for(l.externalData=[],g=0;g<e.externalData.length;++g)l.externalData[g]=c.onnx.StringStringEntryProto.toObject(e.externalData[g],s);return e.dataLocation!=null&&e.hasOwnProperty("dataLocation")&&(l.dataLocation=s.enums===String?c.onnx.TensorProto.DataLocation[e.dataLocation]===void 0?e.dataLocation:c.onnx.TensorProto.DataLocation[e.dataLocation]:e.dataLocation),l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.TensorProto"},o.DataType=function(){var e={},s=Object.create(e);return s[e[0]="UNDEFINED"]=0,s[e[1]="FLOAT"]=1,s[e[2]="UINT8"]=2,s[e[3]="INT8"]=3,s[e[4]="UINT16"]=4,s[e[5]="INT16"]=5,s[e[6]="INT32"]=6,s[e[7]="INT64"]=7,s[e[8]="STRING"]=8,s[e[9]="BOOL"]=9,s[e[10]="FLOAT16"]=10,s[e[11]="DOUBLE"]=11,s[e[12]="UINT32"]=12,s[e[13]="UINT64"]=13,s[e[14]="COMPLEX64"]=14,s[e[15]="COMPLEX128"]=15,s[e[16]="BFLOAT16"]=16,s[e[17]="FLOAT8E4M3FN"]=17,s[e[18]="FLOAT8E4M3FNUZ"]=18,s[e[19]="FLOAT8E5M2"]=19,s[e[20]="FLOAT8E5M2FNUZ"]=20,s}(),o.Segment=function(){function e(s){if(s)for(var l=Object.keys(s),g=0;g<l.length;++g)s[l[g]]!=null&&(this[l[g]]=s[l[g]])}return e.prototype.begin=p.Long?p.Long.fromBits(0,0,!1):0,e.prototype.end=p.Long?p.Long.fromBits(0,0,!1):0,e.create=function(s){return new e(s)},e.encode=function(s,l){return l||(l=d.create()),s.begin!=null&&Object.hasOwnProperty.call(s,"begin")&&l.uint32(8).int64(s.begin),s.end!=null&&Object.hasOwnProperty.call(s,"end")&&l.uint32(16).int64(s.end),l},e.encodeDelimited=function(s,l){return this.encode(s,l).ldelim()},e.decode=function(s,l){s instanceof f||(s=f.create(s));for(var g=l===void 0?s.len:s.pos+l,y=new c.onnx.TensorProto.Segment;s.pos<g;){var b=s.uint32();switch(b>>>3){case 1:y.begin=s.int64();break;case 2:y.end=s.int64();break;default:s.skipType(7&b)}}return y},e.decodeDelimited=function(s){return s instanceof f||(s=new f(s)),this.decode(s,s.uint32())},e.verify=function(s){return typeof s!="object"||s===null?"object expected":s.begin!=null&&s.hasOwnProperty("begin")&&!(p.isInteger(s.begin)||s.begin&&p.isInteger(s.begin.low)&&p.isInteger(s.begin.high))?"begin: integer|Long expected":s.end!=null&&s.hasOwnProperty("end")&&!(p.isInteger(s.end)||s.end&&p.isInteger(s.end.low)&&p.isInteger(s.end.high))?"end: integer|Long expected":null},e.fromObject=function(s){if(s instanceof c.onnx.TensorProto.Segment)return s;var l=new c.onnx.TensorProto.Segment;return s.begin!=null&&(p.Long?(l.begin=p.Long.fromValue(s.begin)).unsigned=!1:typeof s.begin=="string"?l.begin=parseInt(s.begin,10):typeof s.begin=="number"?l.begin=s.begin:typeof s.begin=="object"&&(l.begin=new p.LongBits(s.begin.low>>>0,s.begin.high>>>0).toNumber())),s.end!=null&&(p.Long?(l.end=p.Long.fromValue(s.end)).unsigned=!1:typeof s.end=="string"?l.end=parseInt(s.end,10):typeof s.end=="number"?l.end=s.end:typeof s.end=="object"&&(l.end=new p.LongBits(s.end.low>>>0,s.end.high>>>0).toNumber())),l},e.toObject=function(s,l){l||(l={});var g={};if(l.defaults){if(p.Long){var y=new p.Long(0,0,!1);g.begin=l.longs===String?y.toString():l.longs===Number?y.toNumber():y}else g.begin=l.longs===String?"0":0;p.Long?(y=new p.Long(0,0,!1),g.end=l.longs===String?y.toString():l.longs===Number?y.toNumber():y):g.end=l.longs===String?"0":0}return s.begin!=null&&s.hasOwnProperty("begin")&&(typeof s.begin=="number"?g.begin=l.longs===String?String(s.begin):s.begin:g.begin=l.longs===String?p.Long.prototype.toString.call(s.begin):l.longs===Number?new p.LongBits(s.begin.low>>>0,s.begin.high>>>0).toNumber():s.begin),s.end!=null&&s.hasOwnProperty("end")&&(typeof s.end=="number"?g.end=l.longs===String?String(s.end):s.end:g.end=l.longs===String?p.Long.prototype.toString.call(s.end):l.longs===Number?new p.LongBits(s.end.low>>>0,s.end.high>>>0).toNumber():s.end),g},e.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},e.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.TensorProto.Segment"},e}(),o.DataLocation=function(){var e={},s=Object.create(e);return s[e[0]="DEFAULT"]=0,s[e[1]="EXTERNAL"]=1,s}(),o}(),u.SparseTensorProto=function(){function o(e){if(this.dims=[],e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.values=null,o.prototype.indices=null,o.prototype.dims=p.emptyArray,o.create=function(e){return new o(e)},o.encode=function(e,s){if(s||(s=d.create()),e.values!=null&&Object.hasOwnProperty.call(e,"values")&&c.onnx.TensorProto.encode(e.values,s.uint32(10).fork()).ldelim(),e.indices!=null&&Object.hasOwnProperty.call(e,"indices")&&c.onnx.TensorProto.encode(e.indices,s.uint32(18).fork()).ldelim(),e.dims!=null&&e.dims.length){s.uint32(26).fork();for(var l=0;l<e.dims.length;++l)s.int64(e.dims[l]);s.ldelim()}return s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.SparseTensorProto;e.pos<l;){var y=e.uint32();switch(y>>>3){case 1:g.values=c.onnx.TensorProto.decode(e,e.uint32());break;case 2:g.indices=c.onnx.TensorProto.decode(e,e.uint32());break;case 3:if(g.dims&&g.dims.length||(g.dims=[]),(7&y)==2)for(var b=e.uint32()+e.pos;e.pos<b;)g.dims.push(e.int64());else g.dims.push(e.int64());break;default:e.skipType(7&y)}}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){if(typeof e!="object"||e===null)return"object expected";var s;if(e.values!=null&&e.hasOwnProperty("values")&&(s=c.onnx.TensorProto.verify(e.values)))return"values."+s;if(e.indices!=null&&e.hasOwnProperty("indices")&&(s=c.onnx.TensorProto.verify(e.indices)))return"indices."+s;if(e.dims!=null&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var l=0;l<e.dims.length;++l)if(!(p.isInteger(e.dims[l])||e.dims[l]&&p.isInteger(e.dims[l].low)&&p.isInteger(e.dims[l].high)))return"dims: integer|Long[] expected"}return null},o.fromObject=function(e){if(e instanceof c.onnx.SparseTensorProto)return e;var s=new c.onnx.SparseTensorProto;if(e.values!=null){if(typeof e.values!="object")throw TypeError(".onnx.SparseTensorProto.values: object expected");s.values=c.onnx.TensorProto.fromObject(e.values)}if(e.indices!=null){if(typeof e.indices!="object")throw TypeError(".onnx.SparseTensorProto.indices: object expected");s.indices=c.onnx.TensorProto.fromObject(e.indices)}if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.SparseTensorProto.dims: array expected");s.dims=[];for(var l=0;l<e.dims.length;++l)p.Long?(s.dims[l]=p.Long.fromValue(e.dims[l])).unsigned=!1:typeof e.dims[l]=="string"?s.dims[l]=parseInt(e.dims[l],10):typeof e.dims[l]=="number"?s.dims[l]=e.dims[l]:typeof e.dims[l]=="object"&&(s.dims[l]=new p.LongBits(e.dims[l].low>>>0,e.dims[l].high>>>0).toNumber())}return s},o.toObject=function(e,s){s||(s={});var l={};if((s.arrays||s.defaults)&&(l.dims=[]),s.defaults&&(l.values=null,l.indices=null),e.values!=null&&e.hasOwnProperty("values")&&(l.values=c.onnx.TensorProto.toObject(e.values,s)),e.indices!=null&&e.hasOwnProperty("indices")&&(l.indices=c.onnx.TensorProto.toObject(e.indices,s)),e.dims&&e.dims.length){l.dims=[];for(var g=0;g<e.dims.length;++g)typeof e.dims[g]=="number"?l.dims[g]=s.longs===String?String(e.dims[g]):e.dims[g]:l.dims[g]=s.longs===String?p.Long.prototype.toString.call(e.dims[g]):s.longs===Number?new p.LongBits(e.dims[g].low>>>0,e.dims[g].high>>>0).toNumber():e.dims[g]}return l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.SparseTensorProto"},o}(),u.TensorShapeProto=function(){function o(e){if(this.dim=[],e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.dim=p.emptyArray,o.create=function(e){return new o(e)},o.encode=function(e,s){if(s||(s=d.create()),e.dim!=null&&e.dim.length)for(var l=0;l<e.dim.length;++l)c.onnx.TensorShapeProto.Dimension.encode(e.dim[l],s.uint32(10).fork()).ldelim();return s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.TensorShapeProto;e.pos<l;){var y=e.uint32();y>>>3==1?(g.dim&&g.dim.length||(g.dim=[]),g.dim.push(c.onnx.TensorShapeProto.Dimension.decode(e,e.uint32()))):e.skipType(7&y)}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.dim!=null&&e.hasOwnProperty("dim")){if(!Array.isArray(e.dim))return"dim: array expected";for(var s=0;s<e.dim.length;++s){var l=c.onnx.TensorShapeProto.Dimension.verify(e.dim[s]);if(l)return"dim."+l}}return null},o.fromObject=function(e){if(e instanceof c.onnx.TensorShapeProto)return e;var s=new c.onnx.TensorShapeProto;if(e.dim){if(!Array.isArray(e.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");s.dim=[];for(var l=0;l<e.dim.length;++l){if(typeof e.dim[l]!="object")throw TypeError(".onnx.TensorShapeProto.dim: object expected");s.dim[l]=c.onnx.TensorShapeProto.Dimension.fromObject(e.dim[l])}}return s},o.toObject=function(e,s){s||(s={});var l={};if((s.arrays||s.defaults)&&(l.dim=[]),e.dim&&e.dim.length){l.dim=[];for(var g=0;g<e.dim.length;++g)l.dim[g]=c.onnx.TensorShapeProto.Dimension.toObject(e.dim[g],s)}return l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.TensorShapeProto"},o.Dimension=function(){function e(l){if(l)for(var g=Object.keys(l),y=0;y<g.length;++y)l[g[y]]!=null&&(this[g[y]]=l[g[y]])}var s;return e.prototype.dimValue=null,e.prototype.dimParam=null,e.prototype.denotation="",Object.defineProperty(e.prototype,"value",{get:p.oneOfGetter(s=["dimValue","dimParam"]),set:p.oneOfSetter(s)}),e.create=function(l){return new e(l)},e.encode=function(l,g){return g||(g=d.create()),l.dimValue!=null&&Object.hasOwnProperty.call(l,"dimValue")&&g.uint32(8).int64(l.dimValue),l.dimParam!=null&&Object.hasOwnProperty.call(l,"dimParam")&&g.uint32(18).string(l.dimParam),l.denotation!=null&&Object.hasOwnProperty.call(l,"denotation")&&g.uint32(26).string(l.denotation),g},e.encodeDelimited=function(l,g){return this.encode(l,g).ldelim()},e.decode=function(l,g){l instanceof f||(l=f.create(l));for(var y=g===void 0?l.len:l.pos+g,b=new c.onnx.TensorShapeProto.Dimension;l.pos<y;){var _=l.uint32();switch(_>>>3){case 1:b.dimValue=l.int64();break;case 2:b.dimParam=l.string();break;case 3:b.denotation=l.string();break;default:l.skipType(7&_)}}return b},e.decodeDelimited=function(l){return l instanceof f||(l=new f(l)),this.decode(l,l.uint32())},e.verify=function(l){if(typeof l!="object"||l===null)return"object expected";var g={};if(l.dimValue!=null&&l.hasOwnProperty("dimValue")&&(g.value=1,!(p.isInteger(l.dimValue)||l.dimValue&&p.isInteger(l.dimValue.low)&&p.isInteger(l.dimValue.high))))return"dimValue: integer|Long expected";if(l.dimParam!=null&&l.hasOwnProperty("dimParam")){if(g.value===1)return"value: multiple values";if(g.value=1,!p.isString(l.dimParam))return"dimParam: string expected"}return l.denotation!=null&&l.hasOwnProperty("denotation")&&!p.isString(l.denotation)?"denotation: string expected":null},e.fromObject=function(l){if(l instanceof c.onnx.TensorShapeProto.Dimension)return l;var g=new c.onnx.TensorShapeProto.Dimension;return l.dimValue!=null&&(p.Long?(g.dimValue=p.Long.fromValue(l.dimValue)).unsigned=!1:typeof l.dimValue=="string"?g.dimValue=parseInt(l.dimValue,10):typeof l.dimValue=="number"?g.dimValue=l.dimValue:typeof l.dimValue=="object"&&(g.dimValue=new p.LongBits(l.dimValue.low>>>0,l.dimValue.high>>>0).toNumber())),l.dimParam!=null&&(g.dimParam=String(l.dimParam)),l.denotation!=null&&(g.denotation=String(l.denotation)),g},e.toObject=function(l,g){g||(g={});var y={};return g.defaults&&(y.denotation=""),l.dimValue!=null&&l.hasOwnProperty("dimValue")&&(typeof l.dimValue=="number"?y.dimValue=g.longs===String?String(l.dimValue):l.dimValue:y.dimValue=g.longs===String?p.Long.prototype.toString.call(l.dimValue):g.longs===Number?new p.LongBits(l.dimValue.low>>>0,l.dimValue.high>>>0).toNumber():l.dimValue,g.oneofs&&(y.value="dimValue")),l.dimParam!=null&&l.hasOwnProperty("dimParam")&&(y.dimParam=l.dimParam,g.oneofs&&(y.value="dimParam")),l.denotation!=null&&l.hasOwnProperty("denotation")&&(y.denotation=l.denotation),y},e.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},e.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.TensorShapeProto.Dimension"},e}(),o}(),u.TypeProto=function(){function o(s){if(s)for(var l=Object.keys(s),g=0;g<l.length;++g)s[l[g]]!=null&&(this[l[g]]=s[l[g]])}var e;return o.prototype.tensorType=null,o.prototype.sequenceType=null,o.prototype.mapType=null,o.prototype.optionalType=null,o.prototype.sparseTensorType=null,o.prototype.denotation="",Object.defineProperty(o.prototype,"value",{get:p.oneOfGetter(e=["tensorType","sequenceType","mapType","optionalType","sparseTensorType"]),set:p.oneOfSetter(e)}),o.create=function(s){return new o(s)},o.encode=function(s,l){return l||(l=d.create()),s.tensorType!=null&&Object.hasOwnProperty.call(s,"tensorType")&&c.onnx.TypeProto.Tensor.encode(s.tensorType,l.uint32(10).fork()).ldelim(),s.sequenceType!=null&&Object.hasOwnProperty.call(s,"sequenceType")&&c.onnx.TypeProto.Sequence.encode(s.sequenceType,l.uint32(34).fork()).ldelim(),s.mapType!=null&&Object.hasOwnProperty.call(s,"mapType")&&c.onnx.TypeProto.Map.encode(s.mapType,l.uint32(42).fork()).ldelim(),s.denotation!=null&&Object.hasOwnProperty.call(s,"denotation")&&l.uint32(50).string(s.denotation),s.sparseTensorType!=null&&Object.hasOwnProperty.call(s,"sparseTensorType")&&c.onnx.TypeProto.SparseTensor.encode(s.sparseTensorType,l.uint32(66).fork()).ldelim(),s.optionalType!=null&&Object.hasOwnProperty.call(s,"optionalType")&&c.onnx.TypeProto.Optional.encode(s.optionalType,l.uint32(74).fork()).ldelim(),l},o.encodeDelimited=function(s,l){return this.encode(s,l).ldelim()},o.decode=function(s,l){s instanceof f||(s=f.create(s));for(var g=l===void 0?s.len:s.pos+l,y=new c.onnx.TypeProto;s.pos<g;){var b=s.uint32();switch(b>>>3){case 1:y.tensorType=c.onnx.TypeProto.Tensor.decode(s,s.uint32());break;case 4:y.sequenceType=c.onnx.TypeProto.Sequence.decode(s,s.uint32());break;case 5:y.mapType=c.onnx.TypeProto.Map.decode(s,s.uint32());break;case 9:y.optionalType=c.onnx.TypeProto.Optional.decode(s,s.uint32());break;case 8:y.sparseTensorType=c.onnx.TypeProto.SparseTensor.decode(s,s.uint32());break;case 6:y.denotation=s.string();break;default:s.skipType(7&b)}}return y},o.decodeDelimited=function(s){return s instanceof f||(s=new f(s)),this.decode(s,s.uint32())},o.verify=function(s){if(typeof s!="object"||s===null)return"object expected";var l={};if(s.tensorType!=null&&s.hasOwnProperty("tensorType")&&(l.value=1,g=c.onnx.TypeProto.Tensor.verify(s.tensorType)))return"tensorType."+g;if(s.sequenceType!=null&&s.hasOwnProperty("sequenceType")){if(l.value===1)return"value: multiple values";if(l.value=1,g=c.onnx.TypeProto.Sequence.verify(s.sequenceType))return"sequenceType."+g}if(s.mapType!=null&&s.hasOwnProperty("mapType")){if(l.value===1)return"value: multiple values";if(l.value=1,g=c.onnx.TypeProto.Map.verify(s.mapType))return"mapType."+g}if(s.optionalType!=null&&s.hasOwnProperty("optionalType")){if(l.value===1)return"value: multiple values";if(l.value=1,g=c.onnx.TypeProto.Optional.verify(s.optionalType))return"optionalType."+g}if(s.sparseTensorType!=null&&s.hasOwnProperty("sparseTensorType")){if(l.value===1)return"value: multiple values";var g;if(l.value=1,g=c.onnx.TypeProto.SparseTensor.verify(s.sparseTensorType))return"sparseTensorType."+g}return s.denotation!=null&&s.hasOwnProperty("denotation")&&!p.isString(s.denotation)?"denotation: string expected":null},o.fromObject=function(s){if(s instanceof c.onnx.TypeProto)return s;var l=new c.onnx.TypeProto;if(s.tensorType!=null){if(typeof s.tensorType!="object")throw TypeError(".onnx.TypeProto.tensorType: object expected");l.tensorType=c.onnx.TypeProto.Tensor.fromObject(s.tensorType)}if(s.sequenceType!=null){if(typeof s.sequenceType!="object")throw TypeError(".onnx.TypeProto.sequenceType: object expected");l.sequenceType=c.onnx.TypeProto.Sequence.fromObject(s.sequenceType)}if(s.mapType!=null){if(typeof s.mapType!="object")throw TypeError(".onnx.TypeProto.mapType: object expected");l.mapType=c.onnx.TypeProto.Map.fromObject(s.mapType)}if(s.optionalType!=null){if(typeof s.optionalType!="object")throw TypeError(".onnx.TypeProto.optionalType: object expected");l.optionalType=c.onnx.TypeProto.Optional.fromObject(s.optionalType)}if(s.sparseTensorType!=null){if(typeof s.sparseTensorType!="object")throw TypeError(".onnx.TypeProto.sparseTensorType: object expected");l.sparseTensorType=c.onnx.TypeProto.SparseTensor.fromObject(s.sparseTensorType)}return s.denotation!=null&&(l.denotation=String(s.denotation)),l},o.toObject=function(s,l){l||(l={});var g={};return l.defaults&&(g.denotation=""),s.tensorType!=null&&s.hasOwnProperty("tensorType")&&(g.tensorType=c.onnx.TypeProto.Tensor.toObject(s.tensorType,l),l.oneofs&&(g.value="tensorType")),s.sequenceType!=null&&s.hasOwnProperty("sequenceType")&&(g.sequenceType=c.onnx.TypeProto.Sequence.toObject(s.sequenceType,l),l.oneofs&&(g.value="sequenceType")),s.mapType!=null&&s.hasOwnProperty("mapType")&&(g.mapType=c.onnx.TypeProto.Map.toObject(s.mapType,l),l.oneofs&&(g.value="mapType")),s.denotation!=null&&s.hasOwnProperty("denotation")&&(g.denotation=s.denotation),s.sparseTensorType!=null&&s.hasOwnProperty("sparseTensorType")&&(g.sparseTensorType=c.onnx.TypeProto.SparseTensor.toObject(s.sparseTensorType,l),l.oneofs&&(g.value="sparseTensorType")),s.optionalType!=null&&s.hasOwnProperty("optionalType")&&(g.optionalType=c.onnx.TypeProto.Optional.toObject(s.optionalType,l),l.oneofs&&(g.value="optionalType")),g},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/onnx.TypeProto"},o.Tensor=function(){function s(l){if(l)for(var g=Object.keys(l),y=0;y<g.length;++y)l[g[y]]!=null&&(this[g[y]]=l[g[y]])}return s.prototype.elemType=0,s.prototype.shape=null,s.create=function(l){return new s(l)},s.encode=function(l,g){return g||(g=d.create()),l.elemType!=null&&Object.hasOwnProperty.call(l,"elemType")&&g.uint32(8).int32(l.elemType),l.shape!=null&&Object.hasOwnProperty.call(l,"shape")&&c.onnx.TensorShapeProto.encode(l.shape,g.uint32(18).fork()).ldelim(),g},s.encodeDelimited=function(l,g){return this.encode(l,g).ldelim()},s.decode=function(l,g){l instanceof f||(l=f.create(l));for(var y=g===void 0?l.len:l.pos+g,b=new c.onnx.TypeProto.Tensor;l.pos<y;){var _=l.uint32();switch(_>>>3){case 1:b.elemType=l.int32();break;case 2:b.shape=c.onnx.TensorShapeProto.decode(l,l.uint32());break;default:l.skipType(7&_)}}return b},s.decodeDelimited=function(l){return l instanceof f||(l=new f(l)),this.decode(l,l.uint32())},s.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.elemType!=null&&l.hasOwnProperty("elemType")&&!p.isInteger(l.elemType))return"elemType: integer expected";if(l.shape!=null&&l.hasOwnProperty("shape")){var g=c.onnx.TensorShapeProto.verify(l.shape);if(g)return"shape."+g}return null},s.fromObject=function(l){if(l instanceof c.onnx.TypeProto.Tensor)return l;var g=new c.onnx.TypeProto.Tensor;if(l.elemType!=null&&(g.elemType=0|l.elemType),l.shape!=null){if(typeof l.shape!="object")throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");g.shape=c.onnx.TensorShapeProto.fromObject(l.shape)}return g},s.toObject=function(l,g){g||(g={});var y={};return g.defaults&&(y.elemType=0,y.shape=null),l.elemType!=null&&l.hasOwnProperty("elemType")&&(y.elemType=l.elemType),l.shape!=null&&l.hasOwnProperty("shape")&&(y.shape=c.onnx.TensorShapeProto.toObject(l.shape,g)),y},s.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},s.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.TypeProto.Tensor"},s}(),o.Sequence=function(){function s(l){if(l)for(var g=Object.keys(l),y=0;y<g.length;++y)l[g[y]]!=null&&(this[g[y]]=l[g[y]])}return s.prototype.elemType=null,s.create=function(l){return new s(l)},s.encode=function(l,g){return g||(g=d.create()),l.elemType!=null&&Object.hasOwnProperty.call(l,"elemType")&&c.onnx.TypeProto.encode(l.elemType,g.uint32(10).fork()).ldelim(),g},s.encodeDelimited=function(l,g){return this.encode(l,g).ldelim()},s.decode=function(l,g){l instanceof f||(l=f.create(l));for(var y=g===void 0?l.len:l.pos+g,b=new c.onnx.TypeProto.Sequence;l.pos<y;){var _=l.uint32();_>>>3==1?b.elemType=c.onnx.TypeProto.decode(l,l.uint32()):l.skipType(7&_)}return b},s.decodeDelimited=function(l){return l instanceof f||(l=new f(l)),this.decode(l,l.uint32())},s.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.elemType!=null&&l.hasOwnProperty("elemType")){var g=c.onnx.TypeProto.verify(l.elemType);if(g)return"elemType."+g}return null},s.fromObject=function(l){if(l instanceof c.onnx.TypeProto.Sequence)return l;var g=new c.onnx.TypeProto.Sequence;if(l.elemType!=null){if(typeof l.elemType!="object")throw TypeError(".onnx.TypeProto.Sequence.elemType: object expected");g.elemType=c.onnx.TypeProto.fromObject(l.elemType)}return g},s.toObject=function(l,g){g||(g={});var y={};return g.defaults&&(y.elemType=null),l.elemType!=null&&l.hasOwnProperty("elemType")&&(y.elemType=c.onnx.TypeProto.toObject(l.elemType,g)),y},s.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},s.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.TypeProto.Sequence"},s}(),o.Map=function(){function s(l){if(l)for(var g=Object.keys(l),y=0;y<g.length;++y)l[g[y]]!=null&&(this[g[y]]=l[g[y]])}return s.prototype.keyType=0,s.prototype.valueType=null,s.create=function(l){return new s(l)},s.encode=function(l,g){return g||(g=d.create()),l.keyType!=null&&Object.hasOwnProperty.call(l,"keyType")&&g.uint32(8).int32(l.keyType),l.valueType!=null&&Object.hasOwnProperty.call(l,"valueType")&&c.onnx.TypeProto.encode(l.valueType,g.uint32(18).fork()).ldelim(),g},s.encodeDelimited=function(l,g){return this.encode(l,g).ldelim()},s.decode=function(l,g){l instanceof f||(l=f.create(l));for(var y=g===void 0?l.len:l.pos+g,b=new c.onnx.TypeProto.Map;l.pos<y;){var _=l.uint32();switch(_>>>3){case 1:b.keyType=l.int32();break;case 2:b.valueType=c.onnx.TypeProto.decode(l,l.uint32());break;default:l.skipType(7&_)}}return b},s.decodeDelimited=function(l){return l instanceof f||(l=new f(l)),this.decode(l,l.uint32())},s.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.keyType!=null&&l.hasOwnProperty("keyType")&&!p.isInteger(l.keyType))return"keyType: integer expected";if(l.valueType!=null&&l.hasOwnProperty("valueType")){var g=c.onnx.TypeProto.verify(l.valueType);if(g)return"valueType."+g}return null},s.fromObject=function(l){if(l instanceof c.onnx.TypeProto.Map)return l;var g=new c.onnx.TypeProto.Map;if(l.keyType!=null&&(g.keyType=0|l.keyType),l.valueType!=null){if(typeof l.valueType!="object")throw TypeError(".onnx.TypeProto.Map.valueType: object expected");g.valueType=c.onnx.TypeProto.fromObject(l.valueType)}return g},s.toObject=function(l,g){g||(g={});var y={};return g.defaults&&(y.keyType=0,y.valueType=null),l.keyType!=null&&l.hasOwnProperty("keyType")&&(y.keyType=l.keyType),l.valueType!=null&&l.hasOwnProperty("valueType")&&(y.valueType=c.onnx.TypeProto.toObject(l.valueType,g)),y},s.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},s.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.TypeProto.Map"},s}(),o.Optional=function(){function s(l){if(l)for(var g=Object.keys(l),y=0;y<g.length;++y)l[g[y]]!=null&&(this[g[y]]=l[g[y]])}return s.prototype.elemType=null,s.create=function(l){return new s(l)},s.encode=function(l,g){return g||(g=d.create()),l.elemType!=null&&Object.hasOwnProperty.call(l,"elemType")&&c.onnx.TypeProto.encode(l.elemType,g.uint32(10).fork()).ldelim(),g},s.encodeDelimited=function(l,g){return this.encode(l,g).ldelim()},s.decode=function(l,g){l instanceof f||(l=f.create(l));for(var y=g===void 0?l.len:l.pos+g,b=new c.onnx.TypeProto.Optional;l.pos<y;){var _=l.uint32();_>>>3==1?b.elemType=c.onnx.TypeProto.decode(l,l.uint32()):l.skipType(7&_)}return b},s.decodeDelimited=function(l){return l instanceof f||(l=new f(l)),this.decode(l,l.uint32())},s.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.elemType!=null&&l.hasOwnProperty("elemType")){var g=c.onnx.TypeProto.verify(l.elemType);if(g)return"elemType."+g}return null},s.fromObject=function(l){if(l instanceof c.onnx.TypeProto.Optional)return l;var g=new c.onnx.TypeProto.Optional;if(l.elemType!=null){if(typeof l.elemType!="object")throw TypeError(".onnx.TypeProto.Optional.elemType: object expected");g.elemType=c.onnx.TypeProto.fromObject(l.elemType)}return g},s.toObject=function(l,g){g||(g={});var y={};return g.defaults&&(y.elemType=null),l.elemType!=null&&l.hasOwnProperty("elemType")&&(y.elemType=c.onnx.TypeProto.toObject(l.elemType,g)),y},s.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},s.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.TypeProto.Optional"},s}(),o.SparseTensor=function(){function s(l){if(l)for(var g=Object.keys(l),y=0;y<g.length;++y)l[g[y]]!=null&&(this[g[y]]=l[g[y]])}return s.prototype.elemType=0,s.prototype.shape=null,s.create=function(l){return new s(l)},s.encode=function(l,g){return g||(g=d.create()),l.elemType!=null&&Object.hasOwnProperty.call(l,"elemType")&&g.uint32(8).int32(l.elemType),l.shape!=null&&Object.hasOwnProperty.call(l,"shape")&&c.onnx.TensorShapeProto.encode(l.shape,g.uint32(18).fork()).ldelim(),g},s.encodeDelimited=function(l,g){return this.encode(l,g).ldelim()},s.decode=function(l,g){l instanceof f||(l=f.create(l));for(var y=g===void 0?l.len:l.pos+g,b=new c.onnx.TypeProto.SparseTensor;l.pos<y;){var _=l.uint32();switch(_>>>3){case 1:b.elemType=l.int32();break;case 2:b.shape=c.onnx.TensorShapeProto.decode(l,l.uint32());break;default:l.skipType(7&_)}}return b},s.decodeDelimited=function(l){return l instanceof f||(l=new f(l)),this.decode(l,l.uint32())},s.verify=function(l){if(typeof l!="object"||l===null)return"object expected";if(l.elemType!=null&&l.hasOwnProperty("elemType")&&!p.isInteger(l.elemType))return"elemType: integer expected";if(l.shape!=null&&l.hasOwnProperty("shape")){var g=c.onnx.TensorShapeProto.verify(l.shape);if(g)return"shape."+g}return null},s.fromObject=function(l){if(l instanceof c.onnx.TypeProto.SparseTensor)return l;var g=new c.onnx.TypeProto.SparseTensor;if(l.elemType!=null&&(g.elemType=0|l.elemType),l.shape!=null){if(typeof l.shape!="object")throw TypeError(".onnx.TypeProto.SparseTensor.shape: object expected");g.shape=c.onnx.TensorShapeProto.fromObject(l.shape)}return g},s.toObject=function(l,g){g||(g={});var y={};return g.defaults&&(y.elemType=0,y.shape=null),l.elemType!=null&&l.hasOwnProperty("elemType")&&(y.elemType=l.elemType),l.shape!=null&&l.hasOwnProperty("shape")&&(y.shape=c.onnx.TensorShapeProto.toObject(l.shape,g)),y},s.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},s.getTypeUrl=function(l){return l===void 0&&(l="type.googleapis.com"),l+"/onnx.TypeProto.SparseTensor"},s}(),o}(),u.OperatorSetIdProto=function(){function o(e){if(e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.domain="",o.prototype.version=p.Long?p.Long.fromBits(0,0,!1):0,o.create=function(e){return new o(e)},o.encode=function(e,s){return s||(s=d.create()),e.domain!=null&&Object.hasOwnProperty.call(e,"domain")&&s.uint32(10).string(e.domain),e.version!=null&&Object.hasOwnProperty.call(e,"version")&&s.uint32(16).int64(e.version),s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.OperatorSetIdProto;e.pos<l;){var y=e.uint32();switch(y>>>3){case 1:g.domain=e.string();break;case 2:g.version=e.int64();break;default:e.skipType(7&y)}}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){return typeof e!="object"||e===null?"object expected":e.domain!=null&&e.hasOwnProperty("domain")&&!p.isString(e.domain)?"domain: string expected":e.version!=null&&e.hasOwnProperty("version")&&!(p.isInteger(e.version)||e.version&&p.isInteger(e.version.low)&&p.isInteger(e.version.high))?"version: integer|Long expected":null},o.fromObject=function(e){if(e instanceof c.onnx.OperatorSetIdProto)return e;var s=new c.onnx.OperatorSetIdProto;return e.domain!=null&&(s.domain=String(e.domain)),e.version!=null&&(p.Long?(s.version=p.Long.fromValue(e.version)).unsigned=!1:typeof e.version=="string"?s.version=parseInt(e.version,10):typeof e.version=="number"?s.version=e.version:typeof e.version=="object"&&(s.version=new p.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber())),s},o.toObject=function(e,s){s||(s={});var l={};if(s.defaults)if(l.domain="",p.Long){var g=new p.Long(0,0,!1);l.version=s.longs===String?g.toString():s.longs===Number?g.toNumber():g}else l.version=s.longs===String?"0":0;return e.domain!=null&&e.hasOwnProperty("domain")&&(l.domain=e.domain),e.version!=null&&e.hasOwnProperty("version")&&(typeof e.version=="number"?l.version=s.longs===String?String(e.version):e.version:l.version=s.longs===String?p.Long.prototype.toString.call(e.version):s.longs===Number?new p.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber():e.version),l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.OperatorSetIdProto"},o}(),u.OperatorStatus=function(){var o={},e=Object.create(o);return e[o[0]="EXPERIMENTAL"]=0,e[o[1]="STABLE"]=1,e}(),u.FunctionProto=function(){function o(e){if(this.input=[],this.output=[],this.attribute=[],this.attributeProto=[],this.node=[],this.opsetImport=[],e)for(var s=Object.keys(e),l=0;l<s.length;++l)e[s[l]]!=null&&(this[s[l]]=e[s[l]])}return o.prototype.name="",o.prototype.input=p.emptyArray,o.prototype.output=p.emptyArray,o.prototype.attribute=p.emptyArray,o.prototype.attributeProto=p.emptyArray,o.prototype.node=p.emptyArray,o.prototype.docString="",o.prototype.opsetImport=p.emptyArray,o.prototype.domain="",o.create=function(e){return new o(e)},o.encode=function(e,s){if(s||(s=d.create()),e.name!=null&&Object.hasOwnProperty.call(e,"name")&&s.uint32(10).string(e.name),e.input!=null&&e.input.length)for(var l=0;l<e.input.length;++l)s.uint32(34).string(e.input[l]);if(e.output!=null&&e.output.length)for(l=0;l<e.output.length;++l)s.uint32(42).string(e.output[l]);if(e.attribute!=null&&e.attribute.length)for(l=0;l<e.attribute.length;++l)s.uint32(50).string(e.attribute[l]);if(e.node!=null&&e.node.length)for(l=0;l<e.node.length;++l)c.onnx.NodeProto.encode(e.node[l],s.uint32(58).fork()).ldelim();if(e.docString!=null&&Object.hasOwnProperty.call(e,"docString")&&s.uint32(66).string(e.docString),e.opsetImport!=null&&e.opsetImport.length)for(l=0;l<e.opsetImport.length;++l)c.onnx.OperatorSetIdProto.encode(e.opsetImport[l],s.uint32(74).fork()).ldelim();if(e.domain!=null&&Object.hasOwnProperty.call(e,"domain")&&s.uint32(82).string(e.domain),e.attributeProto!=null&&e.attributeProto.length)for(l=0;l<e.attributeProto.length;++l)c.onnx.AttributeProto.encode(e.attributeProto[l],s.uint32(90).fork()).ldelim();return s},o.encodeDelimited=function(e,s){return this.encode(e,s).ldelim()},o.decode=function(e,s){e instanceof f||(e=f.create(e));for(var l=s===void 0?e.len:e.pos+s,g=new c.onnx.FunctionProto;e.pos<l;){var y=e.uint32();switch(y>>>3){case 1:g.name=e.string();break;case 4:g.input&&g.input.length||(g.input=[]),g.input.push(e.string());break;case 5:g.output&&g.output.length||(g.output=[]),g.output.push(e.string());break;case 6:g.attribute&&g.attribute.length||(g.attribute=[]),g.attribute.push(e.string());break;case 11:g.attributeProto&&g.attributeProto.length||(g.attributeProto=[]),g.attributeProto.push(c.onnx.AttributeProto.decode(e,e.uint32()));break;case 7:g.node&&g.node.length||(g.node=[]),g.node.push(c.onnx.NodeProto.decode(e,e.uint32()));break;case 8:g.docString=e.string();break;case 9:g.opsetImport&&g.opsetImport.length||(g.opsetImport=[]),g.opsetImport.push(c.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 10:g.domain=e.string();break;default:e.skipType(7&y)}}return g},o.decodeDelimited=function(e){return e instanceof f||(e=new f(e)),this.decode(e,e.uint32())},o.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.name!=null&&e.hasOwnProperty("name")&&!p.isString(e.name))return"name: string expected";if(e.input!=null&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var s=0;s<e.input.length;++s)if(!p.isString(e.input[s]))return"input: string[] expected"}if(e.output!=null&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(s=0;s<e.output.length;++s)if(!p.isString(e.output[s]))return"output: string[] expected"}if(e.attribute!=null&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(s=0;s<e.attribute.length;++s)if(!p.isString(e.attribute[s]))return"attribute: string[] expected"}if(e.attributeProto!=null&&e.hasOwnProperty("attributeProto")){if(!Array.isArray(e.attributeProto))return"attributeProto: array expected";for(s=0;s<e.attributeProto.length;++s)if(l=c.onnx.AttributeProto.verify(e.attributeProto[s]))return"attributeProto."+l}if(e.node!=null&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(s=0;s<e.node.length;++s)if(l=c.onnx.NodeProto.verify(e.node[s]))return"node."+l}if(e.docString!=null&&e.hasOwnProperty("docString")&&!p.isString(e.docString))return"docString: string expected";if(e.opsetImport!=null&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(s=0;s<e.opsetImport.length;++s){var l;if(l=c.onnx.OperatorSetIdProto.verify(e.opsetImport[s]))return"opsetImport."+l}}return e.domain!=null&&e.hasOwnProperty("domain")&&!p.isString(e.domain)?"domain: string expected":null},o.fromObject=function(e){if(e instanceof c.onnx.FunctionProto)return e;var s=new c.onnx.FunctionProto;if(e.name!=null&&(s.name=String(e.name)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.FunctionProto.input: array expected");s.input=[];for(var l=0;l<e.input.length;++l)s.input[l]=String(e.input[l])}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.FunctionProto.output: array expected");for(s.output=[],l=0;l<e.output.length;++l)s.output[l]=String(e.output[l])}if(e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.FunctionProto.attribute: array expected");for(s.attribute=[],l=0;l<e.attribute.length;++l)s.attribute[l]=String(e.attribute[l])}if(e.attributeProto){if(!Array.isArray(e.attributeProto))throw TypeError(".onnx.FunctionProto.attributeProto: array expected");for(s.attributeProto=[],l=0;l<e.attributeProto.length;++l){if(typeof e.attributeProto[l]!="object")throw TypeError(".onnx.FunctionProto.attributeProto: object expected");s.attributeProto[l]=c.onnx.AttributeProto.fromObject(e.attributeProto[l])}}if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.FunctionProto.node: array expected");for(s.node=[],l=0;l<e.node.length;++l){if(typeof e.node[l]!="object")throw TypeError(".onnx.FunctionProto.node: object expected");s.node[l]=c.onnx.NodeProto.fromObject(e.node[l])}}if(e.docString!=null&&(s.docString=String(e.docString)),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.FunctionProto.opsetImport: array expected");for(s.opsetImport=[],l=0;l<e.opsetImport.length;++l){if(typeof e.opsetImport[l]!="object")throw TypeError(".onnx.FunctionProto.opsetImport: object expected");s.opsetImport[l]=c.onnx.OperatorSetIdProto.fromObject(e.opsetImport[l])}}return e.domain!=null&&(s.domain=String(e.domain)),s},o.toObject=function(e,s){s||(s={});var l={};if((s.arrays||s.defaults)&&(l.input=[],l.output=[],l.attribute=[],l.node=[],l.opsetImport=[],l.attributeProto=[]),s.defaults&&(l.name="",l.docString="",l.domain=""),e.name!=null&&e.hasOwnProperty("name")&&(l.name=e.name),e.input&&e.input.length){l.input=[];for(var g=0;g<e.input.length;++g)l.input[g]=e.input[g]}if(e.output&&e.output.length)for(l.output=[],g=0;g<e.output.length;++g)l.output[g]=e.output[g];if(e.attribute&&e.attribute.length)for(l.attribute=[],g=0;g<e.attribute.length;++g)l.attribute[g]=e.attribute[g];if(e.node&&e.node.length)for(l.node=[],g=0;g<e.node.length;++g)l.node[g]=c.onnx.NodeProto.toObject(e.node[g],s);if(e.docString!=null&&e.hasOwnProperty("docString")&&(l.docString=e.docString),e.opsetImport&&e.opsetImport.length)for(l.opsetImport=[],g=0;g<e.opsetImport.length;++g)l.opsetImport[g]=c.onnx.OperatorSetIdProto.toObject(e.opsetImport[g],s);if(e.domain!=null&&e.hasOwnProperty("domain")&&(l.domain=e.domain),e.attributeProto&&e.attributeProto.length)for(l.attributeProto=[],g=0;g<e.attributeProto.length;++g)l.attributeProto[g]=c.onnx.AttributeProto.toObject(e.attributeProto[g],s);return l},o.prototype.toJSON=function(){return this.constructor.toObject(this,h.util.toJSONOptions)},o.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/onnx.FunctionProto"},o}(),u),m.exports=c},3474:(m,t,n)=>{var r,a=(r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0,typeof __filename<"u"&&(r=r||__filename),function(u={}){function h(){return X.buffer!=Q.buffer&&gt(),Q}function f(){return X.buffer!=Q.buffer&&gt(),tt}function d(){return X.buffer!=Q.buffer&&gt(),nt}function p(){return X.buffer!=Q.buffer&&gt(),ot}function c(){return X.buffer!=Q.buffer&&gt(),lt}var o,e,s=u;s.ready=new Promise((E,R)=>{o=E,e=R});var l,g,y,b=Object.assign({},s),_="./this.program",v=(E,R)=>{throw R},T=typeof window=="object",w=typeof importScripts=="function",A=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",S=s.ENVIRONMENT_IS_PTHREAD||!1,O="";function C(E){return s.locateFile?s.locateFile(E,O):O+E}if(A){var D=n(1384),$=n(908);let E;O=w?$.dirname(O)+"/":__dirname+"/",l=(R,N)=>(R=R.startsWith("file://")?new URL(R):$.normalize(R),D.readFileSync(R,N?void 0:"utf8")),y=R=>((R=l(R,!0)).buffer||(R=new Uint8Array(R)),R),g=(R,N,z,j=!0)=>{R=R.startsWith("file://")?new URL(R):$.normalize(R),D.readFile(R,j?void 0:"utf8",(Z,it)=>{Z?z(Z):N(j?it.buffer:it)})},!s.thisProgram&&1<process.argv.length&&(_=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),v=(R,N)=>{throw process.exitCode=R,N},s.inspect=()=>"[Emscripten Module object]";try{E=n(9925)}catch(R){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),R}commonjsGlobal.Worker=E.Worker}else(T||w)&&(w?O=self.location.href:typeof document<"u"&&document.currentScript&&(O=document.currentScript.src),r&&(O=r),O=O.indexOf("blob:")!==0?O.substr(0,O.replace(/[?#].*/,"").lastIndexOf("/")+1):"",A||(l=E=>{var R=new XMLHttpRequest;return R.open("GET",E,!1),R.send(null),R.responseText},w&&(y=E=>{var R=new XMLHttpRequest;return R.open("GET",E,!1),R.responseType="arraybuffer",R.send(null),new Uint8Array(R.response)}),g=(E,R,N)=>{var z=new XMLHttpRequest;z.open("GET",E,!0),z.responseType="arraybuffer",z.onload=()=>{z.status==200||z.status==0&&z.response?R(z.response):N()},z.onerror=N,z.send(null)}));A&&typeof performance>"u"&&(commonjsGlobal.performance=n(6953).performance);var L=console.log.bind(console),P=console.error.bind(console);A&&(L=(...E)=>D.writeSync(1,E.join(" ")+`
`),P=(...E)=>D.writeSync(2,E.join(" ")+`
`));var B,I=s.print||L,M=s.printErr||P;Object.assign(s,b),b=null,s.thisProgram&&(_=s.thisProgram),s.quit&&(v=s.quit),s.wasmBinary&&(B=s.wasmBinary);var k=s.noExitRuntime||!0;typeof WebAssembly!="object"&&Ot("no native wasm support detected");var X,G,J,Y,Q,tt,nt,ot,lt,ut=!1;function gt(){var E=X.buffer;s.HEAP8=Q=new Int8Array(E),s.HEAP16=new Int16Array(E),s.HEAP32=nt=new Int32Array(E),s.HEAPU8=tt=new Uint8Array(E),s.HEAPU16=new Uint16Array(E),s.HEAPU32=ot=new Uint32Array(E),s.HEAPF32=new Float32Array(E),s.HEAPF64=lt=new Float64Array(E)}var xt=s.INITIAL_MEMORY||16777216;if(5242880<=xt||Ot("INITIAL_MEMORY should be larger than STACK_SIZE, was "+xt+"! (STACK_SIZE=5242880)"),S)X=s.wasmMemory;else if(s.wasmMemory)X=s.wasmMemory;else if(!((X=new WebAssembly.Memory({initial:xt/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw M("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),A&&M("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");gt(),xt=X.buffer.byteLength;var pt,vt=[],Ct=[],ft=[],Tt=0;function Pt(){return k||0<Tt}var It,Mt,Ft=0,Dt=null;function Ut(){Ft++,s.monitorRunDependencies&&s.monitorRunDependencies(Ft)}function Lt(){if(Ft--,s.monitorRunDependencies&&s.monitorRunDependencies(Ft),Ft==0&&Dt){var E=Dt;Dt=null,E()}}function Ot(E){throw s.onAbort&&s.onAbort(E),M(E="Aborted("+E+")"),ut=!0,Y=1,E=new WebAssembly.RuntimeError(E+". Build with -sASSERTIONS for more info."),e(E),E}function Nt(E){return E.startsWith("data:application/octet-stream;base64,")}function qt(E){if(E==It&&B)return new Uint8Array(B);if(y)return y(E);throw"both async and sync fetching of the wasm failed"}function ne(E,R,N){return function(z){if(!B&&(T||w)){if(typeof fetch=="function"&&!z.startsWith("file://"))return fetch(z,{credentials:"same-origin"}).then(j=>{if(!j.ok)throw"failed to load wasm binary file at '"+z+"'";return j.arrayBuffer()}).catch(()=>qt(z));if(g)return new Promise((j,Z)=>{g(z,it=>j(new Uint8Array(it)),Z)})}return Promise.resolve().then(()=>qt(z))}(E).then(z=>WebAssembly.instantiate(z,R)).then(z=>z).then(N,z=>{M("failed to asynchronously prepare wasm: "+z),Ot(z)})}function zt(E){this.name="ExitStatus",this.message=`Program terminated with exit(${E})`,this.status=E}function Gt(E){E.terminate(),E.onmessage=()=>{}}function Xt(E){(E=st.Fa[E])||Ot(),st.fb(E)}function Yt(E){var R=st.Za();if(!R)return 6;st.Ia.push(R),st.Fa[E.Ha]=R,R.Ha=E.Ha;var N={cmd:"run",start_routine:E.gb,arg:E.Ya,pthread_ptr:E.Ha};return A&&R.unref(),R.postMessage(N,E.mb),0}Nt(It="ort-wasm-threaded.wasm")||(It=C(It));var re=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Kt=(E,R,N)=>{var z=(R>>>=0)+N;for(N=R;E[N]&&!(N>=z);)++N;if(16<N-R&&E.buffer&&re)return re.decode(E.buffer instanceof SharedArrayBuffer?E.slice(R,N):E.subarray(R,N));for(z="";R<N;){var j=E[R++];if(128&j){var Z=63&E[R++];if((224&j)==192)z+=String.fromCharCode((31&j)<<6|Z);else{var it=63&E[R++];65536>(j=(240&j)==224?(15&j)<<12|Z<<6|it:(7&j)<<18|Z<<12|it<<6|63&E[R++])?z+=String.fromCharCode(j):(j-=65536,z+=String.fromCharCode(55296|j>>10,56320|1023&j))}}else z+=String.fromCharCode(j)}return z},Bt=(E,R)=>(E>>>=0)?Kt(f(),E,R):"";function Zt(E){if(S)return mt(1,1,E);Y=E,Pt()||(st.hb(),s.onExit&&s.onExit(E),ut=!0),v(E,new zt(E))}var Ht=E=>{if(Y=E,S)throw Jt(E),"unwind";Zt(E)},st={La:[],Ia:[],Ta:[],Fa:{},Pa:function(){S?st.ab():st.$a()},$a:function(){vt.unshift(()=>{Ut(),st.bb(()=>Lt())})},ab:function(){st.receiveObjectTransfer=st.eb,st.threadInitTLS=st.Sa,st.setExitStatus=st.Ra,k=!1},Ra:function(E){Y=E},rb:["$terminateWorker"],hb:function(){for(var E of st.Ia)Gt(E);for(E of st.La)Gt(E);st.La=[],st.Ia=[],st.Fa=[]},fb:function(E){var R=E.Ha;delete st.Fa[R],st.La.push(E),st.Ia.splice(st.Ia.indexOf(E),1),E.Ha=0,pe(R)},eb:function(){},Sa:function(){st.Ta.forEach(E=>E())},cb:E=>new Promise(R=>{E.onmessage=j=>{var Z=(j=j.data).cmd;if(j.targetThread&&j.targetThread!=oe()){var it=st.Fa[j.qb];it?it.postMessage(j,j.transferList):M('Internal error! Worker sent a message "'+Z+'" to target pthread '+j.targetThread+", but that thread no longer exists!")}else Z==="checkMailbox"?ie():Z==="spawnThread"?Yt(j):Z==="cleanupThread"?Xt(j.thread):Z==="killThread"?(j=j.thread,Z=st.Fa[j],delete st.Fa[j],Gt(Z),pe(j),st.Ia.splice(st.Ia.indexOf(Z),1),Z.Ha=0):Z==="cancelThread"?st.Fa[j.thread].postMessage({cmd:"cancel"}):Z==="loaded"?(E.loaded=!0,R(E)):Z==="alert"?alert("Thread "+j.threadId+": "+j.text):j.target==="setimmediate"?E.postMessage(j):Z==="callHandler"?s[j.handler](...j.args):Z&&M("worker sent an unknown command "+Z)},E.onerror=j=>{throw M("worker sent an error! "+j.filename+":"+j.lineno+": "+j.message),j},A&&(E.on("message",function(j){E.onmessage({data:j})}),E.on("error",function(j){E.onerror(j)}));var N,z=[];for(N of["onExit","onAbort","print","printErr"])s.hasOwnProperty(N)&&z.push(N);E.postMessage({cmd:"load",handlers:z,urlOrBlob:s.mainScriptUrlOrBlob||r,wasmMemory:X,wasmModule:J})}),bb:function(E){E()},Xa:function(){var E=C("ort-wasm-threaded.worker.js");E=new Worker(E),st.La.push(E)},Za:function(){return st.La.length==0&&(st.Xa(),st.cb(st.La[0])),st.La.pop()}};s.PThread=st;var Vt=E=>{for(;0<E.length;)E.shift()(s)};function Jt(E){if(S)return mt(2,0,E);Ht(E)}s.establishStackSpace=function(){var E=oe(),R=d()[E+52>>2>>>0];E=d()[E+56>>2>>>0],Be(R,R-E),ae(R)};var F=[];function U(E){this.Oa=E-24,this.Wa=function(R){p()[this.Oa+4>>2>>>0]=R},this.Va=function(R){p()[this.Oa+8>>2>>>0]=R},this.Pa=function(R,N){this.Ua(),this.Wa(R),this.Va(N)},this.Ua=function(){p()[this.Oa+16>>2>>>0]=0}}function V(E,R,N,z){return S?mt(3,1,E,R,N,z):q(E,R,N,z)}function q(E,R,N,z){if(E>>>=0,R>>>=0,N>>>=0,z>>>=0,typeof SharedArrayBuffer>"u")return M("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var j=[];return S&&j.length===0?V(E,R,N,z):(E={gb:N,Ha:E,Ya:z,mb:j},S?(E.ob="spawnThread",postMessage(E,j),0):Yt(E))}function K(E,R,N){return S?mt(4,1,E,R,N):0}function rt(E,R){if(S)return mt(5,1,E,R)}s.invokeEntryPoint=function(E,R){var N=F[E];N||(E>=F.length&&(F.length=E+1),F[E]=N=pt.get(E)),E=N(R),Pt()?st.Ra(E):fe(E)};var at=E=>{for(var R=0,N=0;N<E.length;++N){var z=E.charCodeAt(N);127>=z?R++:2047>=z?R+=2:55296<=z&&57343>=z?(R+=4,++N):R+=3}return R},_t=(E,R,N,z)=>{if(!(0<z))return 0;var j=N>>>=0;z=N+z-1;for(var Z=0;Z<E.length;++Z){var it=E.charCodeAt(Z);if(55296<=it&&57343>=it&&(it=65536+((1023&it)<<10)|1023&E.charCodeAt(++Z)),127>=it){if(N>=z)break;R[N++>>>0]=it}else{if(2047>=it){if(N+1>=z)break;R[N++>>>0]=192|it>>6}else{if(65535>=it){if(N+2>=z)break;R[N++>>>0]=224|it>>12}else{if(N+3>=z)break;R[N++>>>0]=240|it>>18,R[N++>>>0]=128|it>>12&63}R[N++>>>0]=128|it>>6&63}R[N++>>>0]=128|63&it}}return R[N>>>0]=0,N-j},wt=(E,R,N)=>_t(E,f(),R,N);function Et(E,R){if(S)return mt(6,1,E,R)}function At(E,R,N){if(S)return mt(7,1,E,R,N)}function Qt(E,R,N){return S?mt(8,1,E,R,N):0}function te(E,R){if(S)return mt(9,1,E,R)}function H(E,R,N){if(S)return mt(10,1,E,R,N)}function ct(E,R,N,z){if(S)return mt(11,1,E,R,N,z)}function dt(E,R,N,z){if(S)return mt(12,1,E,R,N,z)}function $t(E,R,N,z){if(S)return mt(13,1,E,R,N,z)}function ee(E){if(S)return mt(14,1,E)}function ge(E,R){if(S)return mt(15,1,E,R)}function ye(E,R,N){if(S)return mt(16,1,E,R,N)}var Ge=E=>{if(!ut)try{if(E(),!Pt())try{S?fe(Y):Ht(Y)}catch(R){R instanceof zt||R=="unwind"||v(1,R)}}catch(R){R instanceof zt||R=="unwind"||v(1,R)}};function le(E){E>>>=0,typeof Atomics.nb=="function"&&(Atomics.nb(d(),E>>2,E).value.then(ie),E+=128,Atomics.store(d(),E>>2,1))}function ie(){var E=oe();E&&(le(E),Ge(()=>$e()))}s.__emscripten_thread_mailbox_await=le,s.checkMailbox=ie;var Wt=E=>E%4==0&&(E%100!=0||E%400==0),be=[0,31,60,91,121,152,182,213,244,274,305,335],_e=[0,31,59,90,120,151,181,212,243,273,304,334];function xe(E,R,N,z,j,Z,it,yt){return S?mt(17,1,E,R,N,z,j,Z,it,yt):-52}function ve(E,R,N,z,j,Z,it){if(S)return mt(18,1,E,R,N,z,j,Z,it)}var Te=E=>{var R=at(E)+1,N=Ce(R);return N&&wt(E,N,R),N},He=E=>{var R=de();return E=E(),ae(R),E};function mt(E,R){var N=arguments.length-2,z=arguments;return He(()=>{for(var j=me(8*N),Z=j>>3,it=0;it<N;it++){var yt=z[2+it];c()[Z+it>>>0]=yt}return Ne(E,N,j,R)})}var ue,ce=[],he={},we=()=>{if(!ue){var E,R={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:_||"./this.program"};for(E in he)he[E]===void 0?delete R[E]:R[E]=he[E];var N=[];for(E in R)N.push(`${E}=${R[E]}`);ue=N}return ue};function Ae(E,R){if(S)return mt(19,1,E,R);E>>>=0,R>>>=0;var N=0;return we().forEach(function(z,j){var Z=R+N;for(j=p()[E+4*j>>2>>>0]=Z,Z=0;Z<z.length;++Z)h()[j++>>0>>>0]=z.charCodeAt(Z);h()[j>>0>>>0]=0,N+=z.length+1}),0}function Se(E,R){if(S)return mt(20,1,E,R);E>>>=0,R>>>=0;var N=we();p()[E>>2>>>0]=N.length;var z=0;return N.forEach(function(j){z+=j.length+1}),p()[R>>2>>>0]=z,0}function Ee(E){return S?mt(21,1,E):52}function Ie(E,R,N,z){return S?mt(22,1,E,R,N,z):52}function Oe(E,R,N,z,j){return S?mt(23,1,E,R,N,z,j):70}var We=[null,[],[]];function Pe(E,R,N,z){if(S)return mt(24,1,E,R,N,z);R>>>=0,N>>>=0,z>>>=0;for(var j=0,Z=0;Z<N;Z++){var it=p()[R>>2>>>0],yt=p()[R+4>>2>>>0];R+=8;for(var kt=0;kt<yt;kt++){var St=f()[it+kt>>>0],Rt=We[E];St===0||St===10?((E===1?I:M)(Kt(Rt,0)),Rt.length=0):Rt.push(St)}j+=yt}return p()[z>>2>>>0]=j,0}var Me=E=>(Me=(()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return z=>(z.set(crypto.getRandomValues(new Uint8Array(z.byteLength))),z);if(A)try{var R=n(760);if(R.randomFillSync)return z=>R.randomFillSync(z);var N=R.randomBytes;return z=>(z.set(N(z.byteLength)),z)}catch{}Ot("initRandomDevice")})())(E),De=[31,29,31,30,31,30,31,31,30,31,30,31],Re=[31,28,31,30,31,30,31,31,30,31,30,31],qe=(E,R)=>{h().set(E,R>>>0)};function Fe(E,R,N,z){function j(W,ht,bt){for(W=typeof W=="number"?W.toString():W||"";W.length<ht;)W=bt[0]+W;return W}function Z(W,ht){return j(W,ht,"0")}function it(W,ht){function bt(je){return 0>je?-1:0<je?1:0}var jt;return(jt=bt(W.getFullYear()-ht.getFullYear()))===0&&(jt=bt(W.getMonth()-ht.getMonth()))===0&&(jt=bt(W.getDate()-ht.getDate())),jt}function yt(W){switch(W.getDay()){case 0:return new Date(W.getFullYear()-1,11,29);case 1:return W;case 2:return new Date(W.getFullYear(),0,3);case 3:return new Date(W.getFullYear(),0,2);case 4:return new Date(W.getFullYear(),0,1);case 5:return new Date(W.getFullYear()-1,11,31);case 6:return new Date(W.getFullYear()-1,11,30)}}function kt(W){var ht=W.Ja;for(W=new Date(new Date(W.Ka+1900,0,1).getTime());0<ht;){var bt=W.getMonth(),jt=(Wt(W.getFullYear())?De:Re)[bt];if(!(ht>jt-W.getDate())){W.setDate(W.getDate()+ht);break}ht-=jt-W.getDate()+1,W.setDate(1),11>bt?W.setMonth(bt+1):(W.setMonth(0),W.setFullYear(W.getFullYear()+1))}return bt=new Date(W.getFullYear()+1,0,4),ht=yt(new Date(W.getFullYear(),0,4)),bt=yt(bt),0>=it(ht,W)?0>=it(bt,W)?W.getFullYear()+1:W.getFullYear():W.getFullYear()-1}E>>>=0,R>>>=0,N>>>=0,z>>>=0;var St=d()[z+40>>2>>>0];for(var Rt in z={kb:d()[z>>2>>>0],jb:d()[z+4>>2>>>0],Ma:d()[z+8>>2>>>0],Qa:d()[z+12>>2>>>0],Na:d()[z+16>>2>>>0],Ka:d()[z+20>>2>>>0],Ga:d()[z+24>>2>>>0],Ja:d()[z+28>>2>>>0],sb:d()[z+32>>2>>>0],ib:d()[z+36>>2>>>0],lb:St?Bt(St):""},N=Bt(N),St={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})N=N.replace(new RegExp(Rt,"g"),St[Rt]);var ze="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ve="January February March April May June July August September October November December".split(" ");for(Rt in St={"%a":W=>ze[W.Ga].substring(0,3),"%A":W=>ze[W.Ga],"%b":W=>Ve[W.Na].substring(0,3),"%B":W=>Ve[W.Na],"%C":W=>Z((W.Ka+1900)/100|0,2),"%d":W=>Z(W.Qa,2),"%e":W=>j(W.Qa,2," "),"%g":W=>kt(W).toString().substring(2),"%G":W=>kt(W),"%H":W=>Z(W.Ma,2),"%I":W=>((W=W.Ma)==0?W=12:12<W&&(W-=12),Z(W,2)),"%j":W=>{for(var ht=0,bt=0;bt<=W.Na-1;ht+=(Wt(W.Ka+1900)?De:Re)[bt++]);return Z(W.Qa+ht,3)},"%m":W=>Z(W.Na+1,2),"%M":W=>Z(W.jb,2),"%n":()=>`
`,"%p":W=>0<=W.Ma&&12>W.Ma?"AM":"PM","%S":W=>Z(W.kb,2),"%t":()=>"	","%u":W=>W.Ga||7,"%U":W=>Z(Math.floor((W.Ja+7-W.Ga)/7),2),"%V":W=>{var ht=Math.floor((W.Ja+7-(W.Ga+6)%7)/7);if(2>=(W.Ga+371-W.Ja-2)%7&&ht++,ht)ht==53&&((bt=(W.Ga+371-W.Ja)%7)==4||bt==3&&Wt(W.Ka)||(ht=1));else{ht=52;var bt=(W.Ga+7-W.Ja-1)%7;(bt==4||bt==5&&Wt(W.Ka%400-1))&&ht++}return Z(ht,2)},"%w":W=>W.Ga,"%W":W=>Z(Math.floor((W.Ja+7-(W.Ga+6)%7)/7),2),"%y":W=>(W.Ka+1900).toString().substring(2),"%Y":W=>W.Ka+1900,"%z":W=>{var ht=0<=(W=W.ib);return W=Math.abs(W)/60,(ht?"+":"-")+("0000"+(W/60*100+W%60)).slice(-4)},"%Z":W=>W.lb,"%%":()=>"%"},N=N.replace(/%%/g,"\0\0"),St)N.includes(Rt)&&(N=N.replace(new RegExp(Rt,"g"),St[Rt](z)));return Rt=function(W){var ht=Array(at(W)+1);return _t(W,ht,0,ht.length),ht}(N=N.replace(/\0\0/g,"%")),Rt.length>R?0:(qe(Rt,E),Rt.length-1)}st.Pa();var Xe=[null,Zt,Jt,V,K,rt,Et,At,Qt,te,H,ct,dt,$t,ee,ge,ye,xe,ve,Ae,Se,Ee,Ie,Oe,Pe],Ye={b:function(E,R,N){throw new U(E>>>=0).Pa(R>>>0,N>>>0),E},N:function(E){ke(E>>>0,!w,1,!T,131072,!1),st.Sa()},k:function(E){E>>>=0,S?postMessage({cmd:"cleanupThread",thread:E}):Xt(E)},I:q,h:K,T:rt,E:Et,G:At,U:Qt,R:te,J:H,Q:ct,o:dt,F:$t,C:ee,S:ge,D:ye,q:()=>!0,A:function(E,R){(E>>>=0)==R>>>0?setTimeout(()=>ie()):S?postMessage({targetThread:E,cmd:"checkMailbox"}):(E=st.Fa[E])&&E.postMessage({cmd:"checkMailbox"})},L:function(){return-1},M:le,p:function(E){A&&st.Fa[E>>>0].ref()},t:function(E,R,N){E=R+2097152>>>0<4194305-!!E?(E>>>0)+4294967296*R:NaN,N>>>=0,E=new Date(1e3*E),d()[N>>2>>>0]=E.getUTCSeconds(),d()[N+4>>2>>>0]=E.getUTCMinutes(),d()[N+8>>2>>>0]=E.getUTCHours(),d()[N+12>>2>>>0]=E.getUTCDate(),d()[N+16>>2>>>0]=E.getUTCMonth(),d()[N+20>>2>>>0]=E.getUTCFullYear()-1900,d()[N+24>>2>>>0]=E.getUTCDay(),E=(E.getTime()-Date.UTC(E.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,d()[N+28>>2>>>0]=E},u:function(E,R,N){E=R+2097152>>>0<4194305-!!E?(E>>>0)+4294967296*R:NaN,N>>>=0,E=new Date(1e3*E),d()[N>>2>>>0]=E.getSeconds(),d()[N+4>>2>>>0]=E.getMinutes(),d()[N+8>>2>>>0]=E.getHours(),d()[N+12>>2>>>0]=E.getDate(),d()[N+16>>2>>>0]=E.getMonth(),d()[N+20>>2>>>0]=E.getFullYear()-1900,d()[N+24>>2>>>0]=E.getDay(),R=(Wt(E.getFullYear())?be:_e)[E.getMonth()]+E.getDate()-1|0,d()[N+28>>2>>>0]=R,d()[N+36>>2>>>0]=-60*E.getTimezoneOffset(),R=new Date(E.getFullYear(),6,1).getTimezoneOffset();var z=new Date(E.getFullYear(),0,1).getTimezoneOffset();E=0|(R!=z&&E.getTimezoneOffset()==Math.min(z,R)),d()[N+32>>2>>>0]=E},v:function(E){E>>>=0;var R=new Date(d()[E+20>>2>>>0]+1900,d()[E+16>>2>>>0],d()[E+12>>2>>>0],d()[E+8>>2>>>0],d()[E+4>>2>>>0],d()[E>>2>>>0],0),N=d()[E+32>>2>>>0],z=R.getTimezoneOffset(),j=new Date(R.getFullYear(),6,1).getTimezoneOffset(),Z=new Date(R.getFullYear(),0,1).getTimezoneOffset(),it=Math.min(Z,j);return 0>N?d()[E+32>>2>>>0]=+(j!=Z&&it==z):0<N!=(it==z)&&(j=Math.max(Z,j),R.setTime(R.getTime()+6e4*((0<N?it:j)-z))),d()[E+24>>2>>>0]=R.getDay(),N=(Wt(R.getFullYear())?be:_e)[R.getMonth()]+R.getDate()-1|0,d()[E+28>>2>>>0]=N,d()[E>>2>>>0]=R.getSeconds(),d()[E+4>>2>>>0]=R.getMinutes(),d()[E+8>>2>>>0]=R.getHours(),d()[E+12>>2>>>0]=R.getDate(),d()[E+16>>2>>>0]=R.getMonth(),d()[E+20>>2>>>0]=R.getYear(),E=R.getTime()/1e3,Le((Mt=E,1<=+Math.abs(Mt)?0<Mt?+Math.floor(Mt/4294967296)>>>0:~~+Math.ceil((Mt-+(~~Mt>>>0))/4294967296)>>>0:0)),E>>>0},r:xe,s:ve,z:function(E,R,N){function z(St){return(St=St.toTimeString().match(/\(([A-Za-z ]+)\)$/))?St[1]:"GMT"}E>>>=0,R>>>=0,N>>>=0;var j=new Date().getFullYear(),Z=new Date(j,0,1),it=new Date(j,6,1);j=Z.getTimezoneOffset();var yt=it.getTimezoneOffset(),kt=Math.max(j,yt);p()[E>>2>>>0]=60*kt,d()[R>>2>>>0]=+(j!=yt),E=z(Z),R=z(it),E=Te(E),R=Te(R),yt<j?(p()[N>>2>>>0]=E,p()[N+4>>2>>>0]=R):(p()[N>>2>>>0]=R,p()[N+4>>2>>>0]=E)},c:()=>{Ot("")},l:function(){},i:function(){return Date.now()},V:()=>{throw Tt+=1,"unwind"},B:function(){return 4294901760},e:()=>performance.timeOrigin+performance.now(),f:function(){return A?n(3993).cpus().length:navigator.hardwareConcurrency},K:function(E,R,N,z){for(st.pb=R>>>0,ce.length=N,R=z>>>0>>3,z=0;z<N;z++)ce[z]=c()[R+z>>>0];return Xe[E].apply(null,ce)},y:function(E){E>>>=0;var R=f().length;if(E<=R||4294901760<E)return!1;for(var N=1;4>=N;N*=2){var z=R*(1+.2/N);z=Math.min(z,E+100663296);var j=Math;z=Math.max(E,z);t:{j=j.min.call(j,4294901760,z+(65536-z%65536)%65536)-X.buffer.byteLength+65535>>>16;try{X.grow(j),gt();var Z=1;break t}catch{}Z=void 0}if(Z)return!0}return!1},O:Ae,P:Se,j:Ht,g:Ee,n:Ie,w:Oe,m:Pe,x:function(E,R){return E>>>=0,R>>>=0,Me(f().subarray(E>>>0,E+R>>>0)),0},a:X||s.wasmMemory,H:Fe,d:function(E,R,N,z){return Fe(E>>>0,R>>>0,N>>>0,z>>>0)}};(function(){function E(N,z){return N=N.exports,G=N=function(j){var Z=yt=>()=>yt()>>>0,it=yt=>kt=>yt(kt)>>>0;return(j=Object.assign({},j)).__errno_location=Z(j.__errno_location),j.pthread_self=Z(j.pthread_self),j.malloc=it(j.malloc),j.stackSave=Z(j.stackSave),j.stackAlloc=it(j.stackAlloc),j}(N),st.Ta.push(G.sa),pt=G.ta,Ct.unshift(G.W),J=z,Lt(),N}var R={a:Ye};if(Ut(),s.instantiateWasm)try{return s.instantiateWasm(R,E)}catch(N){M("Module.instantiateWasm callback failed with error: "+N),e(N)}(function(N,z){var j=It;return B||typeof WebAssembly.instantiateStreaming!="function"||Nt(j)||j.startsWith("file://")||A||typeof fetch!="function"?ne(j,N,z):fetch(j,{credentials:"same-origin"}).then(Z=>WebAssembly.instantiateStreaming(Z,N).then(z,function(it){return M("wasm streaming compile failed: "+it),M("falling back to ArrayBuffer instantiation"),ne(j,N,z)}))})(R,function(N){E(N.instance,N.module)}).catch(e)})(),s._OrtInit=(E,R)=>(s._OrtInit=G.X)(E,R),s._OrtGetLastError=(E,R)=>(s._OrtGetLastError=G.Y)(E,R),s._OrtCreateSessionOptions=(E,R,N,z,j,Z,it,yt,kt,St)=>(s._OrtCreateSessionOptions=G.Z)(E,R,N,z,j,Z,it,yt,kt,St),s._OrtAppendExecutionProvider=(E,R)=>(s._OrtAppendExecutionProvider=G._)(E,R),s._OrtAddSessionConfigEntry=(E,R,N)=>(s._OrtAddSessionConfigEntry=G.$)(E,R,N),s._OrtReleaseSessionOptions=E=>(s._OrtReleaseSessionOptions=G.aa)(E),s._OrtCreateSession=(E,R,N)=>(s._OrtCreateSession=G.ba)(E,R,N),s._OrtReleaseSession=E=>(s._OrtReleaseSession=G.ca)(E),s._OrtGetInputOutputCount=(E,R,N)=>(s._OrtGetInputOutputCount=G.da)(E,R,N),s._OrtGetInputName=(E,R)=>(s._OrtGetInputName=G.ea)(E,R),s._OrtGetOutputName=(E,R)=>(s._OrtGetOutputName=G.fa)(E,R),s._OrtFree=E=>(s._OrtFree=G.ga)(E),s._OrtCreateTensor=(E,R,N,z,j)=>(s._OrtCreateTensor=G.ha)(E,R,N,z,j),s._OrtGetTensorData=(E,R,N,z,j)=>(s._OrtGetTensorData=G.ia)(E,R,N,z,j),s._OrtReleaseTensor=E=>(s._OrtReleaseTensor=G.ja)(E),s._OrtCreateRunOptions=(E,R,N,z)=>(s._OrtCreateRunOptions=G.ka)(E,R,N,z),s._OrtAddRunConfigEntry=(E,R,N)=>(s._OrtAddRunConfigEntry=G.la)(E,R,N),s._OrtReleaseRunOptions=E=>(s._OrtReleaseRunOptions=G.ma)(E),s._OrtRun=(E,R,N,z,j,Z,it,yt)=>(s._OrtRun=G.na)(E,R,N,z,j,Z,it,yt),s._OrtEndProfiling=E=>(s._OrtEndProfiling=G.oa)(E);var oe=s._pthread_self=()=>(oe=s._pthread_self=G.pa)(),Ce=s._malloc=E=>(Ce=s._malloc=G.qa)(E);s._free=E=>(s._free=G.ra)(E),s.__emscripten_tls_init=()=>(s.__emscripten_tls_init=G.sa)();var ke=s.__emscripten_thread_init=(E,R,N,z,j,Z)=>(ke=s.__emscripten_thread_init=G.ua)(E,R,N,z,j,Z);s.__emscripten_thread_crashed=()=>(s.__emscripten_thread_crashed=G.va)();var se,Ne=(E,R,N,z)=>(Ne=G.wa)(E,R,N,z),pe=E=>(pe=G.xa)(E),fe=s.__emscripten_thread_exit=E=>(fe=s.__emscripten_thread_exit=G.ya)(E),$e=s.__emscripten_check_mailbox=()=>($e=s.__emscripten_check_mailbox=G.za)(),Le=E=>(Le=G.Aa)(E),Be=(E,R)=>(Be=G.Ba)(E,R),de=()=>(de=G.Ca)(),ae=E=>(ae=G.Da)(E),me=E=>(me=G.Ea)(E);function Ue(){function E(){if(!se&&(se=!0,s.calledRun=!0,!ut)&&(S||Vt(Ct),o(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),!S)){if(s.postRun)for(typeof s.postRun=="function"&&(s.postRun=[s.postRun]);s.postRun.length;){var R=s.postRun.shift();ft.unshift(R)}Vt(ft)}}if(!(0<Ft))if(S)o(s),S||Vt(Ct),startWorker(s);else{if(s.preRun)for(typeof s.preRun=="function"&&(s.preRun=[s.preRun]);s.preRun.length;)vt.unshift(s.preRun.shift());Vt(vt),0<Ft||(s.setStatus?(s.setStatus("Running..."),setTimeout(function(){setTimeout(function(){s.setStatus("")},1),E()},1)):E())}}if(s.keepRuntimeAlive=Pt,s.wasmMemory=X,s.stackAlloc=me,s.stackSave=de,s.stackRestore=ae,s.UTF8ToString=Bt,s.stringToUTF8=wt,s.lengthBytesUTF8=at,s.ExitStatus=zt,s.PThread=st,Dt=function E(){se||Ue(),se||(Dt=E)},s.preInit)for(typeof s.preInit=="function"&&(s.preInit=[s.preInit]);0<s.preInit.length;)s.preInit.pop()();return Ue(),u.ready});m.exports=a},932:(m,t,n)=>{var r,a=(r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0,typeof __filename<"u"&&(r=r||__filename),function(u={}){var h,f,d=u;d.ready=new Promise((F,U)=>{h=F,f=U});var p,c,o,e=Object.assign({},d),s="./this.program",l=(F,U)=>{throw U},g=typeof window=="object",y=typeof importScripts=="function",b=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",_="";if(b){var v=n(1384),T=n(908);_=y?T.dirname(_)+"/":__dirname+"/",p=(F,U)=>(F=F.startsWith("file://")?new URL(F):T.normalize(F),v.readFileSync(F,U?void 0:"utf8")),o=F=>((F=p(F,!0)).buffer||(F=new Uint8Array(F)),F),c=(F,U,V,q=!0)=>{F=F.startsWith("file://")?new URL(F):T.normalize(F),v.readFile(F,q?void 0:"utf8",(K,rt)=>{K?V(K):U(q?rt.buffer:rt)})},!d.thisProgram&&1<process.argv.length&&(s=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),l=(F,U)=>{throw process.exitCode=F,U},d.inspect=()=>"[Emscripten Module object]"}else(g||y)&&(y?_=self.location.href:typeof document<"u"&&document.currentScript&&(_=document.currentScript.src),r&&(_=r),_=_.indexOf("blob:")!==0?_.substr(0,_.replace(/[?#].*/,"").lastIndexOf("/")+1):"",p=F=>{var U=new XMLHttpRequest;return U.open("GET",F,!1),U.send(null),U.responseText},y&&(o=F=>{var U=new XMLHttpRequest;return U.open("GET",F,!1),U.responseType="arraybuffer",U.send(null),new Uint8Array(U.response)}),c=(F,U,V)=>{var q=new XMLHttpRequest;q.open("GET",F,!0),q.responseType="arraybuffer",q.onload=()=>{q.status==200||q.status==0&&q.response?U(q.response):V()},q.onerror=V,q.send(null)});var w,A=d.print||console.log.bind(console),S=d.printErr||console.error.bind(console);Object.assign(d,e),e=null,d.thisProgram&&(s=d.thisProgram),d.quit&&(l=d.quit),d.wasmBinary&&(w=d.wasmBinary);var O=d.noExitRuntime||!0;typeof WebAssembly!="object"&&ot("no native wasm support detected");var C,D,$,L,P,B,I=!1;function M(){var F=C.buffer;d.HEAP8=$=new Int8Array(F),d.HEAP16=new Int16Array(F),d.HEAP32=P=new Int32Array(F),d.HEAPU8=L=new Uint8Array(F),d.HEAPU16=new Uint16Array(F),d.HEAPU32=B=new Uint32Array(F),d.HEAPF32=new Float32Array(F),d.HEAPF64=new Float64Array(F)}var k=[],X=[],G=[];function J(){var F=d.preRun.shift();k.unshift(F)}var Y,Q,tt=0,nt=null;function ot(F){throw d.onAbort&&d.onAbort(F),S(F="Aborted("+F+")"),I=!0,F=new WebAssembly.RuntimeError(F+". Build with -sASSERTIONS for more info."),f(F),F}function lt(F){return F.startsWith("data:application/octet-stream;base64,")}if(!lt(Y="ort-wasm.wasm")){var ut=Y;Y=d.locateFile?d.locateFile(ut,_):_+ut}function gt(F){if(F==Y&&w)return new Uint8Array(w);if(o)return o(F);throw"both async and sync fetching of the wasm failed"}function xt(F,U,V){return function(q){if(!w&&(g||y)){if(typeof fetch=="function"&&!q.startsWith("file://"))return fetch(q,{credentials:"same-origin"}).then(K=>{if(!K.ok)throw"failed to load wasm binary file at '"+q+"'";return K.arrayBuffer()}).catch(()=>gt(q));if(c)return new Promise((K,rt)=>{c(q,at=>K(new Uint8Array(at)),rt)})}return Promise.resolve().then(()=>gt(q))}(F).then(q=>WebAssembly.instantiate(q,U)).then(q=>q).then(V,q=>{S("failed to asynchronously prepare wasm: "+q),ot(q)})}function pt(F){this.name="ExitStatus",this.message=`Program terminated with exit(${F})`,this.status=F}var vt=F=>{for(;0<F.length;)F.shift()(d)};function Ct(F){this.qa=F-24,this.va=function(U){B[this.qa+4>>2>>>0]=U},this.ua=function(U){B[this.qa+8>>2>>>0]=U},this.sa=function(U,V){this.ta(),this.va(U),this.ua(V)},this.ta=function(){B[this.qa+16>>2>>>0]=0}}var ft,Tt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Pt=(F,U,V)=>{var q=(U>>>=0)+V;for(V=U;F[V]&&!(V>=q);)++V;if(16<V-U&&F.buffer&&Tt)return Tt.decode(F.subarray(U,V));for(q="";U<V;){var K=F[U++];if(128&K){var rt=63&F[U++];if((224&K)==192)q+=String.fromCharCode((31&K)<<6|rt);else{var at=63&F[U++];65536>(K=(240&K)==224?(15&K)<<12|rt<<6|at:(7&K)<<18|rt<<12|at<<6|63&F[U++])?q+=String.fromCharCode(K):(K-=65536,q+=String.fromCharCode(55296|K>>10,56320|1023&K))}}else q+=String.fromCharCode(K)}return q},It=(F,U)=>(F>>>=0)?Pt(L,F,U):"",Mt=F=>{for(var U=0,V=0;V<F.length;++V){var q=F.charCodeAt(V);127>=q?U++:2047>=q?U+=2:55296<=q&&57343>=q?(U+=4,++V):U+=3}return U},Ft=(F,U,V,q)=>{if(!(0<q))return 0;var K=V>>>=0;q=V+q-1;for(var rt=0;rt<F.length;++rt){var at=F.charCodeAt(rt);if(55296<=at&&57343>=at&&(at=65536+((1023&at)<<10)|1023&F.charCodeAt(++rt)),127>=at){if(V>=q)break;U[V++>>>0]=at}else{if(2047>=at){if(V+1>=q)break;U[V++>>>0]=192|at>>6}else{if(65535>=at){if(V+2>=q)break;U[V++>>>0]=224|at>>12}else{if(V+3>=q)break;U[V++>>>0]=240|at>>18,U[V++>>>0]=128|at>>12&63}U[V++>>>0]=128|at>>6&63}U[V++>>>0]=128|63&at}}return U[V>>>0]=0,V-K},Dt=F=>F%4==0&&(F%100!=0||F%400==0),Ut=[0,31,60,91,121,152,182,213,244,274,305,335],Lt=[0,31,59,90,120,151,181,212,243,273,304,334],Ot=F=>{var U=Mt(F)+1,V=Kt(U);return V&&Ft(F,L,V,U),V},Nt={},qt=()=>{if(!ft){var F,U={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:s||"./this.program"};for(F in Nt)Nt[F]===void 0?delete U[F]:U[F]=Nt[F];var V=[];for(F in U)V.push(`${F}=${U[F]}`);ft=V}return ft},ne=[null,[],[]],zt=F=>(zt=(()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return q=>crypto.getRandomValues(q);if(b)try{var U=n(760);if(U.randomFillSync)return q=>U.randomFillSync(q);var V=U.randomBytes;return q=>(q.set(V(q.byteLength)),q)}catch{}ot("initRandomDevice")})())(F),Gt=[31,29,31,30,31,30,31,31,30,31,30,31],Xt=[31,28,31,30,31,30,31,31,30,31,30,31];function Yt(F,U,V,q){function K(H,ct,dt){for(H=typeof H=="number"?H.toString():H||"";H.length<ct;)H=dt[0]+H;return H}function rt(H,ct){return K(H,ct,"0")}function at(H,ct){function dt(ee){return 0>ee?-1:0<ee?1:0}var $t;return($t=dt(H.getFullYear()-ct.getFullYear()))===0&&($t=dt(H.getMonth()-ct.getMonth()))===0&&($t=dt(H.getDate()-ct.getDate())),$t}function _t(H){switch(H.getDay()){case 0:return new Date(H.getFullYear()-1,11,29);case 1:return H;case 2:return new Date(H.getFullYear(),0,3);case 3:return new Date(H.getFullYear(),0,2);case 4:return new Date(H.getFullYear(),0,1);case 5:return new Date(H.getFullYear()-1,11,31);case 6:return new Date(H.getFullYear()-1,11,30)}}function wt(H){var ct=H.ma;for(H=new Date(new Date(H.na+1900,0,1).getTime());0<ct;){var dt=H.getMonth(),$t=(Dt(H.getFullYear())?Gt:Xt)[dt];if(!(ct>$t-H.getDate())){H.setDate(H.getDate()+ct);break}ct-=$t-H.getDate()+1,H.setDate(1),11>dt?H.setMonth(dt+1):(H.setMonth(0),H.setFullYear(H.getFullYear()+1))}return dt=new Date(H.getFullYear()+1,0,4),ct=_t(new Date(H.getFullYear(),0,4)),dt=_t(dt),0>=at(ct,H)?0>=at(dt,H)?H.getFullYear()+1:H.getFullYear():H.getFullYear()-1}F>>>=0,U>>>=0,V>>>=0;var Et=P[40+(q>>>=0)>>2>>>0];for(var At in q={ya:P[q>>2>>>0],xa:P[q+4>>2>>>0],oa:P[q+8>>2>>>0],ra:P[q+12>>2>>>0],pa:P[q+16>>2>>>0],na:P[q+20>>2>>>0],ha:P[q+24>>2>>>0],ma:P[q+28>>2>>>0],Aa:P[q+32>>2>>>0],wa:P[q+36>>2>>>0],za:Et?It(Et):""},V=It(V),Et={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})V=V.replace(new RegExp(At,"g"),Et[At]);var Qt="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),te="January February March April May June July August September October November December".split(" ");for(At in Et={"%a":H=>Qt[H.ha].substring(0,3),"%A":H=>Qt[H.ha],"%b":H=>te[H.pa].substring(0,3),"%B":H=>te[H.pa],"%C":H=>rt((H.na+1900)/100|0,2),"%d":H=>rt(H.ra,2),"%e":H=>K(H.ra,2," "),"%g":H=>wt(H).toString().substring(2),"%G":H=>wt(H),"%H":H=>rt(H.oa,2),"%I":H=>((H=H.oa)==0?H=12:12<H&&(H-=12),rt(H,2)),"%j":H=>{for(var ct=0,dt=0;dt<=H.pa-1;ct+=(Dt(H.na+1900)?Gt:Xt)[dt++]);return rt(H.ra+ct,3)},"%m":H=>rt(H.pa+1,2),"%M":H=>rt(H.xa,2),"%n":()=>`
`,"%p":H=>0<=H.oa&&12>H.oa?"AM":"PM","%S":H=>rt(H.ya,2),"%t":()=>"	","%u":H=>H.ha||7,"%U":H=>rt(Math.floor((H.ma+7-H.ha)/7),2),"%V":H=>{var ct=Math.floor((H.ma+7-(H.ha+6)%7)/7);if(2>=(H.ha+371-H.ma-2)%7&&ct++,ct)ct==53&&((dt=(H.ha+371-H.ma)%7)==4||dt==3&&Dt(H.na)||(ct=1));else{ct=52;var dt=(H.ha+7-H.ma-1)%7;(dt==4||dt==5&&Dt(H.na%400-1))&&ct++}return rt(ct,2)},"%w":H=>H.ha,"%W":H=>rt(Math.floor((H.ma+7-(H.ha+6)%7)/7),2),"%y":H=>(H.na+1900).toString().substring(2),"%Y":H=>H.na+1900,"%z":H=>{var ct=0<=(H=H.wa);return H=Math.abs(H)/60,(ct?"+":"-")+("0000"+(H/60*100+H%60)).slice(-4)},"%Z":H=>H.za,"%%":()=>"%"},V=V.replace(/%%/g,"\0\0"),Et)V.includes(At)&&(V=V.replace(new RegExp(At,"g"),Et[At](q)));return At=function(H){var ct=Array(Mt(H)+1);return Ft(H,ct,0,ct.length),ct}(V=V.replace(/\0\0/g,"%")),At.length>U?0:($.set(At,F>>>0),At.length-1)}var re={a:function(F,U,V){throw new Ct(F>>>=0).sa(U>>>0,V>>>0),F},e:function(){return 0},I:function(){},y:function(){},A:function(){},K:function(){return 0},G:function(){},B:function(){},F:function(){},g:function(){},z:function(){},w:function(){},H:function(){},x:function(){},k:()=>!0,n:function(F,U,V){F=U+2097152>>>0<4194305-!!F?(F>>>0)+4294967296*U:NaN,V>>>=0,F=new Date(1e3*F),P[V>>2>>>0]=F.getUTCSeconds(),P[V+4>>2>>>0]=F.getUTCMinutes(),P[V+8>>2>>>0]=F.getUTCHours(),P[V+12>>2>>>0]=F.getUTCDate(),P[V+16>>2>>>0]=F.getUTCMonth(),P[V+20>>2>>>0]=F.getUTCFullYear()-1900,P[V+24>>2>>>0]=F.getUTCDay(),P[V+28>>2>>>0]=(F.getTime()-Date.UTC(F.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},o:function(F,U,V){F=U+2097152>>>0<4194305-!!F?(F>>>0)+4294967296*U:NaN,V>>>=0,F=new Date(1e3*F),P[V>>2>>>0]=F.getSeconds(),P[V+4>>2>>>0]=F.getMinutes(),P[V+8>>2>>>0]=F.getHours(),P[V+12>>2>>>0]=F.getDate(),P[V+16>>2>>>0]=F.getMonth(),P[V+20>>2>>>0]=F.getFullYear()-1900,P[V+24>>2>>>0]=F.getDay(),P[V+28>>2>>>0]=(Dt(F.getFullYear())?Ut:Lt)[F.getMonth()]+F.getDate()-1|0,P[V+36>>2>>>0]=-60*F.getTimezoneOffset(),U=new Date(F.getFullYear(),6,1).getTimezoneOffset();var q=new Date(F.getFullYear(),0,1).getTimezoneOffset();P[V+32>>2>>>0]=0|(U!=q&&F.getTimezoneOffset()==Math.min(q,U))},p:function(F){F>>>=0;var U=new Date(P[F+20>>2>>>0]+1900,P[F+16>>2>>>0],P[F+12>>2>>>0],P[F+8>>2>>>0],P[F+4>>2>>>0],P[F>>2>>>0],0),V=P[F+32>>2>>>0],q=U.getTimezoneOffset(),K=new Date(U.getFullYear(),6,1).getTimezoneOffset(),rt=new Date(U.getFullYear(),0,1).getTimezoneOffset(),at=Math.min(rt,K);return 0>V?P[F+32>>2>>>0]=+(K!=rt&&at==q):0<V!=(at==q)&&(K=Math.max(rt,K),U.setTime(U.getTime()+6e4*((0<V?at:K)-q))),P[F+24>>2>>>0]=U.getDay(),P[F+28>>2>>>0]=(Dt(U.getFullYear())?Ut:Lt)[U.getMonth()]+U.getDate()-1|0,P[F>>2>>>0]=U.getSeconds(),P[F+4>>2>>>0]=U.getMinutes(),P[F+8>>2>>>0]=U.getHours(),P[F+12>>2>>>0]=U.getDate(),P[F+16>>2>>>0]=U.getMonth(),P[F+20>>2>>>0]=U.getYear(),F=U.getTime()/1e3,Zt((Q=F,1<=+Math.abs(Q)?0<Q?+Math.floor(Q/4294967296)>>>0:~~+Math.ceil((Q-+(~~Q>>>0))/4294967296)>>>0:0)),F>>>0},l:function(){return-52},m:function(){},u:function(F,U,V){function q(wt){return(wt=wt.toTimeString().match(/\(([A-Za-z ]+)\)$/))?wt[1]:"GMT"}V>>>=0;var K=new Date().getFullYear(),rt=new Date(K,0,1),at=new Date(K,6,1);K=rt.getTimezoneOffset();var _t=at.getTimezoneOffset();B[F>>>0>>2>>>0]=60*Math.max(K,_t),P[U>>>0>>2>>>0]=+(K!=_t),F=q(rt),U=q(at),F=Ot(F),U=Ot(U),_t<K?(B[V>>2>>>0]=F,B[V+4>>2>>>0]=U):(B[V>>2>>>0]=U,B[V+4>>2>>>0]=F)},d:()=>{ot("")},h:function(){return Date.now()},v:function(){return 4294901760},b:()=>performance.now(),J:function(F,U,V){return U>>>=0,L.copyWithin(F>>>0>>>0,U>>>0,U+(V>>>0)>>>0)},t:function(F){F>>>=0;var U=L.length;if(4294901760<F)return!1;for(var V=1;4>=V;V*=2){var q=U*(1+.2/V);q=Math.min(q,F+100663296);var K=Math;q=Math.max(F,q);t:{K=K.min.call(K,4294901760,q+(65536-q%65536)%65536)-C.buffer.byteLength+65535>>>16;try{C.grow(K),M();var rt=1;break t}catch{}rt=void 0}if(rt)return!0}return!1},D:function(F,U){F>>>=0,U>>>=0;var V=0;return qt().forEach(function(q,K){var rt=U+V;for(K=B[F+4*K>>2>>>0]=rt,rt=0;rt<q.length;++rt)$[K++>>0>>>0]=q.charCodeAt(rt);$[K>>0>>>0]=0,V+=q.length+1}),0},E:function(F,U){F>>>=0,U>>>=0;var V=qt();B[F>>2>>>0]=V.length;var q=0;return V.forEach(function(K){q+=K.length+1}),B[U>>2>>>0]=q,0},s:F=>{O||(d.onExit&&d.onExit(F),I=!0),l(F,new pt(F))},f:()=>52,j:function(){return 52},q:function(){return 70},i:function(F,U,V,q){U>>>=0,V>>>=0,q>>>=0;for(var K=0,rt=0;rt<V;rt++){var at=B[U>>2>>>0],_t=B[U+4>>2>>>0];U+=8;for(var wt=0;wt<_t;wt++){var Et=L[at+wt>>>0],At=ne[F];Et===0||Et===10?((F===1?A:S)(Pt(At,0)),At.length=0):At.push(Et)}K+=_t}return B[q>>2>>>0]=K,0},r:function(F,U){return F>>>=0,zt(L.subarray(F>>>0,F+(U>>>0)>>>0)),0},C:Yt,c:function(F,U,V,q){return Yt(F>>>0,U>>>0,V>>>0,q>>>0)}};(function(){function F(V){if(V=V.exports,D=V=function(K){var rt=_t=>()=>_t()>>>0,at=_t=>wt=>_t(wt)>>>0;return(K=Object.assign({},K)).__errno_location=rt(K.__errno_location),K.malloc=at(K.malloc),K.stackSave=rt(K.stackSave),K.stackAlloc=at(K.stackAlloc),K}(V),C=D.L,M(),X.unshift(D.M),tt--,d.monitorRunDependencies&&d.monitorRunDependencies(tt),tt==0&&nt){var q=nt;nt=null,q()}return V}var U={a:re};if(tt++,d.monitorRunDependencies&&d.monitorRunDependencies(tt),d.instantiateWasm)try{return d.instantiateWasm(U,F)}catch(V){S("Module.instantiateWasm callback failed with error: "+V),f(V)}(function(V,q){var K=Y;return w||typeof WebAssembly.instantiateStreaming!="function"||lt(K)||K.startsWith("file://")||b||typeof fetch!="function"?xt(K,V,q):fetch(K,{credentials:"same-origin"}).then(rt=>WebAssembly.instantiateStreaming(rt,V).then(q,function(at){return S("wasm streaming compile failed: "+at),S("falling back to ArrayBuffer instantiation"),xt(K,V,q)}))})(U,function(V){F(V.instance)}).catch(f)})(),d._OrtInit=(F,U)=>(d._OrtInit=D.N)(F,U),d._OrtGetLastError=(F,U)=>(d._OrtGetLastError=D.O)(F,U),d._OrtCreateSessionOptions=(F,U,V,q,K,rt,at,_t,wt,Et)=>(d._OrtCreateSessionOptions=D.P)(F,U,V,q,K,rt,at,_t,wt,Et),d._OrtAppendExecutionProvider=(F,U)=>(d._OrtAppendExecutionProvider=D.Q)(F,U),d._OrtAddSessionConfigEntry=(F,U,V)=>(d._OrtAddSessionConfigEntry=D.R)(F,U,V),d._OrtReleaseSessionOptions=F=>(d._OrtReleaseSessionOptions=D.S)(F),d._OrtCreateSession=(F,U,V)=>(d._OrtCreateSession=D.T)(F,U,V),d._OrtReleaseSession=F=>(d._OrtReleaseSession=D.U)(F),d._OrtGetInputOutputCount=(F,U,V)=>(d._OrtGetInputOutputCount=D.V)(F,U,V),d._OrtGetInputName=(F,U)=>(d._OrtGetInputName=D.W)(F,U),d._OrtGetOutputName=(F,U)=>(d._OrtGetOutputName=D.X)(F,U),d._OrtFree=F=>(d._OrtFree=D.Y)(F),d._OrtCreateTensor=(F,U,V,q,K)=>(d._OrtCreateTensor=D.Z)(F,U,V,q,K),d._OrtGetTensorData=(F,U,V,q,K)=>(d._OrtGetTensorData=D._)(F,U,V,q,K),d._OrtReleaseTensor=F=>(d._OrtReleaseTensor=D.$)(F),d._OrtCreateRunOptions=(F,U,V,q)=>(d._OrtCreateRunOptions=D.aa)(F,U,V,q),d._OrtAddRunConfigEntry=(F,U,V)=>(d._OrtAddRunConfigEntry=D.ba)(F,U,V),d._OrtReleaseRunOptions=F=>(d._OrtReleaseRunOptions=D.ca)(F),d._OrtRun=(F,U,V,q,K,rt,at,_t)=>(d._OrtRun=D.da)(F,U,V,q,K,rt,at,_t),d._OrtEndProfiling=F=>(d._OrtEndProfiling=D.ea)(F);var Kt=d._malloc=F=>(Kt=d._malloc=D.fa)(F);d._free=F=>(d._free=D.ga)(F);var Bt,Zt=F=>(Zt=D.ia)(F),Ht=()=>(Ht=D.ja)(),st=F=>(st=D.ka)(F),Vt=F=>(Vt=D.la)(F);function Jt(){function F(){if(!Bt&&(Bt=!0,d.calledRun=!0,!I)){if(vt(X),h(d),d.onRuntimeInitialized&&d.onRuntimeInitialized(),d.postRun)for(typeof d.postRun=="function"&&(d.postRun=[d.postRun]);d.postRun.length;){var U=d.postRun.shift();G.unshift(U)}vt(G)}}if(!(0<tt)){if(d.preRun)for(typeof d.preRun=="function"&&(d.preRun=[d.preRun]);d.preRun.length;)J();vt(k),0<tt||(d.setStatus?(d.setStatus("Running..."),setTimeout(function(){setTimeout(function(){d.setStatus("")},1),F()},1)):F())}}if(d.stackAlloc=Vt,d.stackSave=Ht,d.stackRestore=st,d.UTF8ToString=It,d.stringToUTF8=(F,U,V)=>Ft(F,L,U,V),d.lengthBytesUTF8=Mt,nt=function F(){Bt||Jt(),Bt||(nt=F)},d.preInit)for(typeof d.preInit=="function"&&(d.preInit=[d.preInit]);0<d.preInit.length;)d.preInit.pop()();return Jt(),u.ready});m.exports=a},4537:m=>{m.exports=function(t,n){for(var r=new Array(arguments.length-1),a=0,u=2,h=!0;u<arguments.length;)r[a++]=arguments[u++];return new Promise(function(f,d){r[a]=function(p){if(h)if(h=!1,p)d(p);else{for(var c=new Array(arguments.length-1),o=0;o<c.length;)c[o++]=arguments[o];f.apply(null,c)}};try{t.apply(n||null,r)}catch(p){h&&(h=!1,d(p))}})}},7419:(m,t)=>{var n=t;n.length=function(f){var d=f.length;if(!d)return 0;for(var p=0;--d%4>1&&f.charAt(d)==="=";)++p;return Math.ceil(3*f.length)/4-p};for(var r=new Array(64),a=new Array(123),u=0;u<64;)a[r[u]=u<26?u+65:u<52?u+71:u<62?u-4:u-59|43]=u++;n.encode=function(f,d,p){for(var c,o=null,e=[],s=0,l=0;d<p;){var g=f[d++];switch(l){case 0:e[s++]=r[g>>2],c=(3&g)<<4,l=1;break;case 1:e[s++]=r[c|g>>4],c=(15&g)<<2,l=2;break;case 2:e[s++]=r[c|g>>6],e[s++]=r[63&g],l=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,e)),s=0)}return l&&(e[s++]=r[c],e[s++]=61,l===1&&(e[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,e.slice(0,s))),o.join("")):String.fromCharCode.apply(String,e.slice(0,s))};var h="invalid encoding";n.decode=function(f,d,p){for(var c,o=p,e=0,s=0;s<f.length;){var l=f.charCodeAt(s++);if(l===61&&e>1)break;if((l=a[l])===void 0)throw Error(h);switch(e){case 0:c=l,e=1;break;case 1:d[p++]=c<<2|(48&l)>>4,c=l,e=2;break;case 2:d[p++]=(15&c)<<4|(60&l)>>2,c=l,e=3;break;case 3:d[p++]=(3&c)<<6|l,e=0}}if(e===1)throw Error(h);return p-o},n.test=function(f){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(f)}},9211:m=>{function t(){this._listeners={}}m.exports=t,t.prototype.on=function(n,r,a){return(this._listeners[n]||(this._listeners[n]=[])).push({fn:r,ctx:a||this}),this},t.prototype.off=function(n,r){if(n===void 0)this._listeners={};else if(r===void 0)this._listeners[n]=[];else for(var a=this._listeners[n],u=0;u<a.length;)a[u].fn===r?a.splice(u,1):++u;return this},t.prototype.emit=function(n){var r=this._listeners[n];if(r){for(var a=[],u=1;u<arguments.length;)a.push(arguments[u++]);for(u=0;u<r.length;)r[u].fn.apply(r[u++].ctx,a)}return this}},945:m=>{function t(h){return typeof Float32Array<"u"?function(){var f=new Float32Array([-0]),d=new Uint8Array(f.buffer),p=d[3]===128;function c(l,g,y){f[0]=l,g[y]=d[0],g[y+1]=d[1],g[y+2]=d[2],g[y+3]=d[3]}function o(l,g,y){f[0]=l,g[y]=d[3],g[y+1]=d[2],g[y+2]=d[1],g[y+3]=d[0]}function e(l,g){return d[0]=l[g],d[1]=l[g+1],d[2]=l[g+2],d[3]=l[g+3],f[0]}function s(l,g){return d[3]=l[g],d[2]=l[g+1],d[1]=l[g+2],d[0]=l[g+3],f[0]}h.writeFloatLE=p?c:o,h.writeFloatBE=p?o:c,h.readFloatLE=p?e:s,h.readFloatBE=p?s:e}():function(){function f(p,c,o,e){var s=c<0?1:0;if(s&&(c=-c),c===0)p(1/c>0?0:2147483648,o,e);else if(isNaN(c))p(2143289344,o,e);else if(c>34028234663852886e22)p((s<<31|2139095040)>>>0,o,e);else if(c<11754943508222875e-54)p((s<<31|Math.round(c/1401298464324817e-60))>>>0,o,e);else{var l=Math.floor(Math.log(c)/Math.LN2);p((s<<31|l+127<<23|8388607&Math.round(c*Math.pow(2,-l)*8388608))>>>0,o,e)}}function d(p,c,o){var e=p(c,o),s=2*(e>>31)+1,l=e>>>23&255,g=8388607&e;return l===255?g?NaN:s*(1/0):l===0?1401298464324817e-60*s*g:s*Math.pow(2,l-150)*(g+8388608)}h.writeFloatLE=f.bind(null,n),h.writeFloatBE=f.bind(null,r),h.readFloatLE=d.bind(null,a),h.readFloatBE=d.bind(null,u)}(),typeof Float64Array<"u"?function(){var f=new Float64Array([-0]),d=new Uint8Array(f.buffer),p=d[7]===128;function c(l,g,y){f[0]=l,g[y]=d[0],g[y+1]=d[1],g[y+2]=d[2],g[y+3]=d[3],g[y+4]=d[4],g[y+5]=d[5],g[y+6]=d[6],g[y+7]=d[7]}function o(l,g,y){f[0]=l,g[y]=d[7],g[y+1]=d[6],g[y+2]=d[5],g[y+3]=d[4],g[y+4]=d[3],g[y+5]=d[2],g[y+6]=d[1],g[y+7]=d[0]}function e(l,g){return d[0]=l[g],d[1]=l[g+1],d[2]=l[g+2],d[3]=l[g+3],d[4]=l[g+4],d[5]=l[g+5],d[6]=l[g+6],d[7]=l[g+7],f[0]}function s(l,g){return d[7]=l[g],d[6]=l[g+1],d[5]=l[g+2],d[4]=l[g+3],d[3]=l[g+4],d[2]=l[g+5],d[1]=l[g+6],d[0]=l[g+7],f[0]}h.writeDoubleLE=p?c:o,h.writeDoubleBE=p?o:c,h.readDoubleLE=p?e:s,h.readDoubleBE=p?s:e}():function(){function f(p,c,o,e,s,l){var g=e<0?1:0;if(g&&(e=-e),e===0)p(0,s,l+c),p(1/e>0?0:2147483648,s,l+o);else if(isNaN(e))p(0,s,l+c),p(2146959360,s,l+o);else if(e>17976931348623157e292)p(0,s,l+c),p((g<<31|2146435072)>>>0,s,l+o);else{var y;if(e<22250738585072014e-324)p((y=e/5e-324)>>>0,s,l+c),p((g<<31|y/4294967296)>>>0,s,l+o);else{var b=Math.floor(Math.log(e)/Math.LN2);b===1024&&(b=1023),p(4503599627370496*(y=e*Math.pow(2,-b))>>>0,s,l+c),p((g<<31|b+1023<<20|1048576*y&1048575)>>>0,s,l+o)}}}function d(p,c,o,e,s){var l=p(e,s+c),g=p(e,s+o),y=2*(g>>31)+1,b=g>>>20&2047,_=4294967296*(1048575&g)+l;return b===2047?_?NaN:y*(1/0):b===0?5e-324*y*_:y*Math.pow(2,b-1075)*(_+4503599627370496)}h.writeDoubleLE=f.bind(null,n,0,4),h.writeDoubleBE=f.bind(null,r,4,0),h.readDoubleLE=d.bind(null,a,0,4),h.readDoubleBE=d.bind(null,u,4,0)}(),h}function n(h,f,d){f[d]=255&h,f[d+1]=h>>>8&255,f[d+2]=h>>>16&255,f[d+3]=h>>>24}function r(h,f,d){f[d]=h>>>24,f[d+1]=h>>>16&255,f[d+2]=h>>>8&255,f[d+3]=255&h}function a(h,f){return(h[f]|h[f+1]<<8|h[f+2]<<16|h[f+3]<<24)>>>0}function u(h,f){return(h[f]<<24|h[f+1]<<16|h[f+2]<<8|h[f+3])>>>0}m.exports=t(t)},7199:module=>{function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(m){}return null}module.exports=inquire},6662:m=>{m.exports=function(t,n,r){var a=r||8192,u=a>>>1,h=null,f=a;return function(d){if(d<1||d>u)return t(d);f+d>a&&(h=t(a),f=0);var p=n.call(h,f,f+=d);return 7&f&&(f=1+(7|f)),p}}},4997:(m,t)=>{var n=t;n.length=function(r){for(var a=0,u=0,h=0;h<r.length;++h)(u=r.charCodeAt(h))<128?a+=1:u<2048?a+=2:(64512&u)==55296&&(64512&r.charCodeAt(h+1))==56320?(++h,a+=4):a+=3;return a},n.read=function(r,a,u){if(u-a<1)return"";for(var h,f=null,d=[],p=0;a<u;)(h=r[a++])<128?d[p++]=h:h>191&&h<224?d[p++]=(31&h)<<6|63&r[a++]:h>239&&h<365?(h=((7&h)<<18|(63&r[a++])<<12|(63&r[a++])<<6|63&r[a++])-65536,d[p++]=55296+(h>>10),d[p++]=56320+(1023&h)):d[p++]=(15&h)<<12|(63&r[a++])<<6|63&r[a++],p>8191&&((f||(f=[])).push(String.fromCharCode.apply(String,d)),p=0);return f?(p&&f.push(String.fromCharCode.apply(String,d.slice(0,p))),f.join("")):String.fromCharCode.apply(String,d.slice(0,p))},n.write=function(r,a,u){for(var h,f,d=u,p=0;p<r.length;++p)(h=r.charCodeAt(p))<128?a[u++]=h:h<2048?(a[u++]=h>>6|192,a[u++]=63&h|128):(64512&h)==55296&&(64512&(f=r.charCodeAt(p+1)))==56320?(h=65536+((1023&h)<<10)+(1023&f),++p,a[u++]=h>>18|240,a[u++]=h>>12&63|128,a[u++]=h>>6&63|128,a[u++]=63&h|128):(a[u++]=h>>12|224,a[u++]=h>>6&63|128,a[u++]=63&h|128);return u-d}},3442:(m,t)=>{t.__esModule=!0;var n=function(){function r(a){if(!a)throw new TypeError("Invalid argument; `value` has no value.");this.value=r.EMPTY,a&&r.isGuid(a)&&(this.value=a)}return r.isGuid=function(a){var u=a.toString();return a&&(a instanceof r||r.validator.test(u))},r.create=function(){return new r([r.gen(2),r.gen(1),r.gen(1),r.gen(1),r.gen(3)].join("-"))},r.createEmpty=function(){return new r("emptyguid")},r.parse=function(a){return new r(a)},r.raw=function(){return[r.gen(2),r.gen(1),r.gen(1),r.gen(1),r.gen(3)].join("-")},r.gen=function(a){for(var u="",h=0;h<a;h++)u+=(65536*(1+Math.random())|0).toString(16).substring(1);return u},r.prototype.equals=function(a){return r.isGuid(a)&&this.value===a.toString()},r.prototype.isEmpty=function(){return this.value===r.EMPTY},r.prototype.toString=function(){return this.value},r.prototype.toJSON=function(){return{value:this.value}},r.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),r.EMPTY="00000000-0000-0000-0000-000000000000",r}();t.Guid=n},2100:(m,t,n)=>{m.exports=n(9482)},9482:(m,t,n)=>{var r=t;function a(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(1173),r.BufferWriter=n(3155),r.Reader=n(1408),r.BufferReader=n(593),r.util=n(9693),r.rpc=n(5994),r.roots=n(5054),r.configure=a,a()},1408:(m,t,n)=>{m.exports=d;var r,a=n(9693),u=a.LongBits,h=a.utf8;function f(g,y){return RangeError("index out of range: "+g.pos+" + "+(y||1)+" > "+g.len)}function d(g){this.buf=g,this.pos=0,this.len=g.length}var p,c=typeof Uint8Array<"u"?function(g){if(g instanceof Uint8Array||Array.isArray(g))return new d(g);throw Error("illegal buffer")}:function(g){if(Array.isArray(g))return new d(g);throw Error("illegal buffer")},o=function(){return a.Buffer?function(g){return(d.create=function(y){return a.Buffer.isBuffer(y)?new r(y):c(y)})(g)}:c};function e(){var g=new u(0,0),y=0;if(!(this.len-this.pos>4)){for(;y<3;++y){if(this.pos>=this.len)throw f(this);if(g.lo=(g.lo|(127&this.buf[this.pos])<<7*y)>>>0,this.buf[this.pos++]<128)return g}return g.lo=(g.lo|(127&this.buf[this.pos++])<<7*y)>>>0,g}for(;y<4;++y)if(g.lo=(g.lo|(127&this.buf[this.pos])<<7*y)>>>0,this.buf[this.pos++]<128)return g;if(g.lo=(g.lo|(127&this.buf[this.pos])<<28)>>>0,g.hi=(g.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return g;if(y=0,this.len-this.pos>4){for(;y<5;++y)if(g.hi=(g.hi|(127&this.buf[this.pos])<<7*y+3)>>>0,this.buf[this.pos++]<128)return g}else for(;y<5;++y){if(this.pos>=this.len)throw f(this);if(g.hi=(g.hi|(127&this.buf[this.pos])<<7*y+3)>>>0,this.buf[this.pos++]<128)return g}throw Error("invalid varint encoding")}function s(g,y){return(g[y-4]|g[y-3]<<8|g[y-2]<<16|g[y-1]<<24)>>>0}function l(){if(this.pos+8>this.len)throw f(this,8);return new u(s(this.buf,this.pos+=4),s(this.buf,this.pos+=4))}d.create=o(),d.prototype._slice=a.Array.prototype.subarray||a.Array.prototype.slice,d.prototype.uint32=(p=4294967295,function(){if(p=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(p=(p|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(p=(p|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(p=(p|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(p=(p|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return p;if((this.pos+=5)>this.len)throw this.pos=this.len,f(this,10);return p}),d.prototype.int32=function(){return 0|this.uint32()},d.prototype.sint32=function(){var g=this.uint32();return g>>>1^-(1&g)|0},d.prototype.bool=function(){return this.uint32()!==0},d.prototype.fixed32=function(){if(this.pos+4>this.len)throw f(this,4);return s(this.buf,this.pos+=4)},d.prototype.sfixed32=function(){if(this.pos+4>this.len)throw f(this,4);return 0|s(this.buf,this.pos+=4)},d.prototype.float=function(){if(this.pos+4>this.len)throw f(this,4);var g=a.float.readFloatLE(this.buf,this.pos);return this.pos+=4,g},d.prototype.double=function(){if(this.pos+8>this.len)throw f(this,4);var g=a.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,g},d.prototype.bytes=function(){var g=this.uint32(),y=this.pos,b=this.pos+g;if(b>this.len)throw f(this,g);return this.pos+=g,Array.isArray(this.buf)?this.buf.slice(y,b):y===b?new this.buf.constructor(0):this._slice.call(this.buf,y,b)},d.prototype.string=function(){var g=this.bytes();return h.read(g,0,g.length)},d.prototype.skip=function(g){if(typeof g=="number"){if(this.pos+g>this.len)throw f(this,g);this.pos+=g}else do if(this.pos>=this.len)throw f(this);while(128&this.buf[this.pos++]);return this},d.prototype.skipType=function(g){switch(g){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(g=7&this.uint32())!=4;)this.skipType(g);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+g+" at offset "+this.pos)}return this},d._configure=function(g){r=g,d.create=o(),r._configure();var y=a.Long?"toLong":"toNumber";a.merge(d.prototype,{int64:function(){return e.call(this)[y](!1)},uint64:function(){return e.call(this)[y](!0)},sint64:function(){return e.call(this).zzDecode()[y](!1)},fixed64:function(){return l.call(this)[y](!0)},sfixed64:function(){return l.call(this)[y](!1)}})}},593:(m,t,n)=>{m.exports=u;var r=n(1408);(u.prototype=Object.create(r.prototype)).constructor=u;var a=n(9693);function u(h){r.call(this,h)}u._configure=function(){a.Buffer&&(u.prototype._slice=a.Buffer.prototype.slice)},u.prototype.string=function(){var h=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+h,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+h,this.len))},u._configure()},5054:m=>{m.exports={}},5994:(m,t,n)=>{t.Service=n(7948)},7948:(m,t,n)=>{m.exports=a;var r=n(9693);function a(u,h,f){if(typeof u!="function")throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=u,this.requestDelimited=!!h,this.responseDelimited=!!f}(a.prototype=Object.create(r.EventEmitter.prototype)).constructor=a,a.prototype.rpcCall=function u(h,f,d,p,c){if(!p)throw TypeError("request must be specified");var o=this;if(!c)return r.asPromise(u,o,h,f,d,p);if(o.rpcImpl)try{return o.rpcImpl(h,f[o.requestDelimited?"encodeDelimited":"encode"](p).finish(),function(e,s){if(e)return o.emit("error",e,h),c(e);if(s!==null){if(!(s instanceof d))try{s=d[o.responseDelimited?"decodeDelimited":"decode"](s)}catch(l){return o.emit("error",l,h),c(l)}return o.emit("data",s,h),c(null,s)}o.end(!0)})}catch(e){return o.emit("error",e,h),void setTimeout(function(){c(e)},0)}else setTimeout(function(){c(Error("already ended"))},0)},a.prototype.end=function(u){return this.rpcImpl&&(u||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:(m,t,n)=>{m.exports=a;var r=n(9693);function a(d,p){this.lo=d>>>0,this.hi=p>>>0}var u=a.zero=new a(0,0);u.toNumber=function(){return 0},u.zzEncode=u.zzDecode=function(){return this},u.length=function(){return 1};var h=a.zeroHash="\0\0\0\0\0\0\0\0";a.fromNumber=function(d){if(d===0)return u;var p=d<0;p&&(d=-d);var c=d>>>0,o=(d-c)/4294967296>>>0;return p&&(o=~o>>>0,c=~c>>>0,++c>4294967295&&(c=0,++o>4294967295&&(o=0))),new a(c,o)},a.from=function(d){if(typeof d=="number")return a.fromNumber(d);if(r.isString(d)){if(!r.Long)return a.fromNumber(parseInt(d,10));d=r.Long.fromString(d)}return d.low||d.high?new a(d.low>>>0,d.high>>>0):u},a.prototype.toNumber=function(d){if(!d&&this.hi>>>31){var p=1+~this.lo>>>0,c=~this.hi>>>0;return p||(c=c+1>>>0),-(p+4294967296*c)}return this.lo+4294967296*this.hi},a.prototype.toLong=function(d){return r.Long?new r.Long(0|this.lo,0|this.hi,!!d):{low:0|this.lo,high:0|this.hi,unsigned:!!d}};var f=String.prototype.charCodeAt;a.fromHash=function(d){return d===h?u:new a((f.call(d,0)|f.call(d,1)<<8|f.call(d,2)<<16|f.call(d,3)<<24)>>>0,(f.call(d,4)|f.call(d,5)<<8|f.call(d,6)<<16|f.call(d,7)<<24)>>>0)},a.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},a.prototype.zzEncode=function(){var d=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^d)>>>0,this.lo=(this.lo<<1^d)>>>0,this},a.prototype.zzDecode=function(){var d=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^d)>>>0,this.hi=(this.hi>>>1^d)>>>0,this},a.prototype.length=function(){var d=this.lo,p=(this.lo>>>28|this.hi<<4)>>>0,c=this.hi>>>24;return c===0?p===0?d<16384?d<128?1:2:d<2097152?3:4:p<16384?p<128?5:6:p<2097152?7:8:c<128?9:10}},9693:function(m,t,n){var r=t;function a(h,f,d){for(var p=Object.keys(f),c=0;c<p.length;++c)h[p[c]]!==void 0&&d||(h[p[c]]=f[p[c]]);return h}function u(h){function f(d,p){if(!(this instanceof f))return new f(d,p);Object.defineProperty(this,"message",{get:function(){return d}}),Error.captureStackTrace?Error.captureStackTrace(this,f):Object.defineProperty(this,"stack",{value:new Error().stack||""}),p&&a(this,p)}return f.prototype=Object.create(Error.prototype,{constructor:{value:f,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return h},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),f}r.asPromise=n(4537),r.base64=n(7419),r.EventEmitter=n(9211),r.float=n(945),r.inquire=n(7199),r.utf8=n(4997),r.pool=n(6662),r.LongBits=n(1945),r.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),r.global=r.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(h){return typeof h=="number"&&isFinite(h)&&Math.floor(h)===h},r.isString=function(h){return typeof h=="string"||h instanceof String},r.isObject=function(h){return h&&typeof h=="object"},r.isset=r.isSet=function(h,f){var d=h[f];return!(d==null||!h.hasOwnProperty(f))&&(typeof d!="object"||(Array.isArray(d)?d.length:Object.keys(d).length)>0)},r.Buffer=function(){try{var h=r.inquire("buffer").Buffer;return h.prototype.utf8Write?h:null}catch{return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(h){return typeof h=="number"?r.Buffer?r._Buffer_allocUnsafe(h):new r.Array(h):r.Buffer?r._Buffer_from(h):typeof Uint8Array>"u"?h:new Uint8Array(h)},r.Array=typeof Uint8Array<"u"?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(h){return h?r.LongBits.from(h).toHash():r.LongBits.zeroHash},r.longFromHash=function(h,f){var d=r.LongBits.fromHash(h);return r.Long?r.Long.fromBits(d.lo,d.hi,f):d.toNumber(!!f)},r.merge=a,r.lcFirst=function(h){return h.charAt(0).toLowerCase()+h.substring(1)},r.newError=u,r.ProtocolError=u("ProtocolError"),r.oneOfGetter=function(h){for(var f={},d=0;d<h.length;++d)f[h[d]]=1;return function(){for(var p=Object.keys(this),c=p.length-1;c>-1;--c)if(f[p[c]]===1&&this[p[c]]!==void 0&&this[p[c]]!==null)return p[c]}},r.oneOfSetter=function(h){return function(f){for(var d=0;d<h.length;++d)h[d]!==f&&delete this[h[d]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var h=r.Buffer;h?(r._Buffer_from=h.from!==Uint8Array.from&&h.from||function(f,d){return new h(f,d)},r._Buffer_allocUnsafe=h.allocUnsafe||function(f){return new h(f)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},1173:(m,t,n)=>{m.exports=o;var r,a=n(9693),u=a.LongBits,h=a.base64,f=a.utf8;function d(_,v,T){this.fn=_,this.len=v,this.next=void 0,this.val=T}function p(){}function c(_){this.head=_.head,this.tail=_.tail,this.len=_.len,this.next=_.states}function o(){this.len=0,this.head=new d(p,0,0),this.tail=this.head,this.states=null}var e=function(){return a.Buffer?function(){return(o.create=function(){return new r})()}:function(){return new o}};function s(_,v,T){v[T]=255&_}function l(_,v){this.len=_,this.next=void 0,this.val=v}function g(_,v,T){for(;_.hi;)v[T++]=127&_.lo|128,_.lo=(_.lo>>>7|_.hi<<25)>>>0,_.hi>>>=7;for(;_.lo>127;)v[T++]=127&_.lo|128,_.lo=_.lo>>>7;v[T++]=_.lo}function y(_,v,T){v[T]=255&_,v[T+1]=_>>>8&255,v[T+2]=_>>>16&255,v[T+3]=_>>>24}o.create=e(),o.alloc=function(_){return new a.Array(_)},a.Array!==Array&&(o.alloc=a.pool(o.alloc,a.Array.prototype.subarray)),o.prototype._push=function(_,v,T){return this.tail=this.tail.next=new d(_,v,T),this.len+=v,this},l.prototype=Object.create(d.prototype),l.prototype.fn=function(_,v,T){for(;_>127;)v[T++]=127&_|128,_>>>=7;v[T]=_},o.prototype.uint32=function(_){return this.len+=(this.tail=this.tail.next=new l((_>>>=0)<128?1:_<16384?2:_<2097152?3:_<268435456?4:5,_)).len,this},o.prototype.int32=function(_){return _<0?this._push(g,10,u.fromNumber(_)):this.uint32(_)},o.prototype.sint32=function(_){return this.uint32((_<<1^_>>31)>>>0)},o.prototype.uint64=function(_){var v=u.from(_);return this._push(g,v.length(),v)},o.prototype.int64=o.prototype.uint64,o.prototype.sint64=function(_){var v=u.from(_).zzEncode();return this._push(g,v.length(),v)},o.prototype.bool=function(_){return this._push(s,1,_?1:0)},o.prototype.fixed32=function(_){return this._push(y,4,_>>>0)},o.prototype.sfixed32=o.prototype.fixed32,o.prototype.fixed64=function(_){var v=u.from(_);return this._push(y,4,v.lo)._push(y,4,v.hi)},o.prototype.sfixed64=o.prototype.fixed64,o.prototype.float=function(_){return this._push(a.float.writeFloatLE,4,_)},o.prototype.double=function(_){return this._push(a.float.writeDoubleLE,8,_)};var b=a.Array.prototype.set?function(_,v,T){v.set(_,T)}:function(_,v,T){for(var w=0;w<_.length;++w)v[T+w]=_[w]};o.prototype.bytes=function(_){var v=_.length>>>0;if(!v)return this._push(s,1,0);if(a.isString(_)){var T=o.alloc(v=h.length(_));h.decode(_,T,0),_=T}return this.uint32(v)._push(b,v,_)},o.prototype.string=function(_){var v=f.length(_);return v?this.uint32(v)._push(f.write,v,_):this._push(s,1,0)},o.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new d(p,0,0),this.len=0,this},o.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new d(p,0,0),this.len=0),this},o.prototype.ldelim=function(){var _=this.head,v=this.tail,T=this.len;return this.reset().uint32(T),T&&(this.tail.next=_.next,this.tail=v,this.len+=T),this},o.prototype.finish=function(){for(var _=this.head.next,v=this.constructor.alloc(this.len),T=0;_;)_.fn(_.val,v,T),T+=_.len,_=_.next;return v},o._configure=function(_){r=_,o.create=e(),r._configure()}},3155:(m,t,n)=>{m.exports=u;var r=n(1173);(u.prototype=Object.create(r.prototype)).constructor=u;var a=n(9693);function u(){r.call(this)}function h(f,d,p){f.length<40?a.utf8.write(f,d,p):d.utf8Write?d.utf8Write(f,p):d.write(f,p)}u._configure=function(){u.alloc=a._Buffer_allocUnsafe,u.writeBytesBuffer=a.Buffer&&a.Buffer.prototype instanceof Uint8Array&&a.Buffer.prototype.set.name==="set"?function(f,d,p){d.set(f,p)}:function(f,d,p){if(f.copy)f.copy(d,p,0,f.length);else for(var c=0;c<f.length;)d[p++]=f[c++]}},u.prototype.bytes=function(f){a.isString(f)&&(f=a._Buffer_from(f,"base64"));var d=f.length>>>0;return this.uint32(d),d&&this._push(u.writeBytesBuffer,d,f),this},u.prototype.string=function(f){var d=a.Buffer.byteLength(f);return this.uint32(d),d&&this._push(h,d,f),this},u._configure()},4154:m=>{m.exports=`"use strict";var e={},a="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node;if(a){var r=require("worker_threads"),t=r.parentPort;t.on("message",(e=>onmessage({data:e})));var s=require("fs");Object.assign(global,{self:global,require:require,Module:e,location:{href:__filename},Worker:r.Worker,importScripts:e=>(0,eval)(s.readFileSync(e,"utf8")+"//# sourceURL="+e),postMessage:e=>t.postMessage(e),performance:global.performance||{now:Date.now}})}var o=!1,d=function(){var e=Array.prototype.slice.call(arguments).join(" ");a?s.writeSync(2,e+"\\n"):console.error(e)};self.alert=function(){var a=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:a,threadId:e._pthread_self()})},e.instantiateWasm=(a,r)=>{var t=e.wasmModule;return e.wasmModule=null,r(new WebAssembly.Instance(t,a))},self.onunhandledrejection=e=>{throw e.reason??e},self.onmessage=function a(r){try{if("load"===r.data.cmd){let s=[];self.onmessage=e=>s.push(e),self.startWorker=r=>{e=r,postMessage({cmd:"loaded"});for(let e of s)a(e);self.onmessage=a},e.wasmModule=r.data.wasmModule;for(const a of r.data.handlers)e[a]=(...e)=>{postMessage({cmd:"callHandler",handler:a,args:e})};if(e.wasmMemory=r.data.wasmMemory,e.buffer=e.wasmMemory.buffer,e.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof r.data.urlOrBlob)importScripts(r.data.urlOrBlob);else{var t=URL.createObjectURL(r.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(e)}else if("run"===r.data.cmd){e.__emscripten_thread_init(r.data.pthread_ptr,0,0,1),e.__emscripten_thread_mailbox_await(r.data.pthread_ptr),e.establishStackSpace(),e.PThread.receiveObjectTransfer(r.data),e.PThread.threadInitTLS(),o||(o=!0);try{e.invokeEntryPoint(r.data.start_routine,r.data.arg)}catch(e){if("unwind"!=e)throw e}}else"cancel"===r.data.cmd?e._pthread_self()&&e.__emscripten_thread_exit(-1):"setimmediate"===r.data.target||("checkMailbox"===r.data.cmd?o&&e.checkMailbox():r.data.cmd&&(d("worker.js received unknown command "+r.data.cmd),d(r.data)))}catch(a){throw e.__emscripten_thread_crashed&&e.__emscripten_thread_crashed(),a}};
`},7067:()=>{},1296:()=>{},760:()=>{},1384:()=>{},3993:()=>{},908:()=>{},6953:()=>{},9925:()=>{},2806:()=>{},6449:()=>{},2850:()=>{},5381:()=>{},685:(m,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolveBackend=t.registerBackend=void 0;const n={},r=[];t.registerBackend=(a,u,h)=>{if(!u||typeof u.init!="function"||typeof u.createSessionHandler!="function")throw new TypeError("not a valid backend");{const f=n[a];if(f===void 0)n[a]={backend:u,priority:h};else{if(f.priority>h)return;if(f.priority===h&&f.backend!==u)throw new Error(`cannot register backend "${a}" using priority ${h}`)}if(h>=0){const d=r.indexOf(a);d!==-1&&r.splice(d,1);for(let p=0;p<r.length;p++)if(n[r[p]].priority<=h)return void r.splice(p,0,a);r.push(a)}}},t.resolveBackend=async a=>{const u=a.length===0?r:a,h=[];for(const f of u){const d=n[f];if(d){if(d.initialized)return d.backend;if(d.aborted)continue;const p=!!d.initPromise;try{return p||(d.initPromise=d.backend.init()),await d.initPromise,d.initialized=!0,d.backend}catch(c){p||h.push({name:f,err:c}),d.aborted=!0}finally{delete d.initPromise}}}throw new Error(`no available backend found. ERR: ${h.map(f=>`[${f.name}] ${f.err}`).join(", ")}`)}},4798:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.registerBackend=void 0;var r=n(685);Object.defineProperty(t,"registerBackend",{enumerable:!0,get:function(){return r.registerBackend}})},3121:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.env=void 0;const r=n(9104);let a="warning";t.env={wasm:{},webgl:{},webgpu:{},versions:{common:r.version},set logLevel(u){if(u!==void 0){if(typeof u!="string"||["verbose","info","warning","error","fatal"].indexOf(u)===-1)throw new Error(`Unsupported logging level: ${u}`);a=u}},get logLevel(){return a}},Object.defineProperty(t.env,"logLevel",{enumerable:!0})},2457:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.env=void 0;const r=n(3121);t.env=r.env},2235:function(m,t,n){var r=this&&this.__createBinding||(Object.create?function(u,h,f,d){d===void 0&&(d=f);var p=Object.getOwnPropertyDescriptor(h,f);p&&!("get"in p?!h.__esModule:p.writable||p.configurable)||(p={enumerable:!0,get:function(){return h[f]}}),Object.defineProperty(u,d,p)}:function(u,h,f,d){d===void 0&&(d=f),u[d]=h[f]}),a=this&&this.__exportStar||function(u,h){for(var f in u)f==="default"||Object.prototype.hasOwnProperty.call(h,f)||r(h,u,f)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(4798),t),a(n(2457),t),a(n(3974),t),a(n(963),t),a(n(7852),t)},8036:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InferenceSession=void 0;const r=n(685),a=n(963);class u{constructor(f){this.handler=f}async run(f,d,p){const c={};let o={};if(typeof f!="object"||f===null||f instanceof a.Tensor||Array.isArray(f))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let e=!0;if(typeof d=="object"){if(d===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(d instanceof a.Tensor)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(d)){if(d.length===0)throw new TypeError("'fetches' cannot be an empty array.");e=!1;for(const g of d){if(typeof g!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(g)===-1)throw new RangeError(`'fetches' contains invalid output name: ${g}.`);c[g]=null}if(typeof p=="object"&&p!==null)o=p;else if(p!==void 0)throw new TypeError("'options' must be an object.")}else{let g=!1;const y=Object.getOwnPropertyNames(d);for(const b of this.outputNames)if(y.indexOf(b)!==-1){const _=d[b];(_===null||_ instanceof a.Tensor)&&(g=!0,e=!1,c[b]=_)}if(g){if(typeof p=="object"&&p!==null)o=p;else if(p!==void 0)throw new TypeError("'options' must be an object.")}else o=d}}else if(d!==void 0)throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const g of this.inputNames)if(f[g]===void 0)throw new Error(`input '${g}' is missing in 'feeds'.`);if(e)for(const g of this.outputNames)c[g]=null;const s=await this.handler.run(f,c,o),l={};for(const g in s)Object.hasOwnProperty.call(s,g)&&(l[g]=new a.Tensor(s[g].type,s[g].data,s[g].dims));return l}async release(){return this.handler.dispose()}static async create(f,d,p,c){let o,e={};if(typeof f=="string"){if(o=f,typeof d=="object"&&d!==null)e=d;else if(d!==void 0)throw new TypeError("'options' must be an object.")}else if(f instanceof Uint8Array){if(o=f,typeof d=="object"&&d!==null)e=d;else if(d!==void 0)throw new TypeError("'options' must be an object.")}else{if(!(f instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&f instanceof SharedArrayBuffer))throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");{const y=f;let b=0,_=f.byteLength;if(typeof d=="object"&&d!==null)e=d;else if(typeof d=="number"){if(b=d,!Number.isSafeInteger(b))throw new RangeError("'byteOffset' must be an integer.");if(b<0||b>=y.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${y.byteLength}).`);if(_=f.byteLength-b,typeof p=="number"){if(_=p,!Number.isSafeInteger(_))throw new RangeError("'byteLength' must be an integer.");if(_<=0||b+_>y.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${y.byteLength-b}].`);if(typeof c=="object"&&c!==null)e=c;else if(c!==void 0)throw new TypeError("'options' must be an object.")}else if(p!==void 0)throw new TypeError("'byteLength' must be a number.")}else if(d!==void 0)throw new TypeError("'options' must be an object.");o=new Uint8Array(y,b,_)}}const s=(e.executionProviders||[]).map(y=>typeof y=="string"?y:y.name),l=await(0,r.resolveBackend)(s),g=await l.createSessionHandler(o,e);return new u(g)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}t.InferenceSession=u},3974:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InferenceSession=void 0;const r=n(8036);t.InferenceSession=r.InferenceSession},7852:(m,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2350:(m,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tensorToImageData=t.tensorToDataURL=void 0,t.tensorToDataURL=(n,r)=>{const a=document.createElement("canvas");a.width=n.dims[3],a.height=n.dims[2];const u=a.getContext("2d");if(u!=null){let h,f;(r==null?void 0:r.tensorLayout)!==void 0&&r.tensorLayout==="NHWC"?(h=n.dims[2],f=n.dims[3]):(h=n.dims[3],f=n.dims[2]);const d=(r==null?void 0:r.format)!==void 0?r.format:"RGB",p=r==null?void 0:r.norm;let c,o;p===void 0||p.mean===void 0?c=[255,255,255,255]:typeof p.mean=="number"?c=[p.mean,p.mean,p.mean,p.mean]:(c=[p.mean[0],p.mean[1],p.mean[2],0],p.mean[3]!==void 0&&(c[3]=p.mean[3])),p===void 0||p.bias===void 0?o=[0,0,0,0]:typeof p.bias=="number"?o=[p.bias,p.bias,p.bias,p.bias]:(o=[p.bias[0],p.bias[1],p.bias[2],0],p.bias[3]!==void 0&&(o[3]=p.bias[3]));const e=f*h;let s=0,l=e,g=2*e,y=-1;d==="RGBA"?(s=0,l=e,g=2*e,y=3*e):d==="RGB"?(s=0,l=e,g=2*e):d==="RBG"&&(s=0,g=e,l=2*e);for(let b=0;b<f;b++)for(let _=0;_<h;_++){const v=(n.data[s++]-o[0])*c[0],T=(n.data[l++]-o[1])*c[1],w=(n.data[g++]-o[2])*c[2],A=y===-1?255:(n.data[y++]-o[3])*c[3];u.fillStyle="rgba("+v+","+T+","+w+","+A+")",u.fillRect(_,b,1,1)}return a.toDataURL()}throw new Error("Can not access image data")},t.tensorToImageData=(n,r)=>{const a=document.createElement("canvas").getContext("2d");let u;if(a==null)throw new Error("Can not access image data");{let h,f,d;(r==null?void 0:r.tensorLayout)!==void 0&&r.tensorLayout==="NHWC"?(h=n.dims[2],f=n.dims[1],d=n.dims[3]):(h=n.dims[3],f=n.dims[2],d=n.dims[1]);const p=r!==void 0&&r.format!==void 0?r.format:"RGB",c=r==null?void 0:r.norm;let o,e;c===void 0||c.mean===void 0?o=[255,255,255,255]:typeof c.mean=="number"?o=[c.mean,c.mean,c.mean,c.mean]:(o=[c.mean[0],c.mean[1],c.mean[2],255],c.mean[3]!==void 0&&(o[3]=c.mean[3])),c===void 0||c.bias===void 0?e=[0,0,0,0]:typeof c.bias=="number"?e=[c.bias,c.bias,c.bias,c.bias]:(e=[c.bias[0],c.bias[1],c.bias[2],0],c.bias[3]!==void 0&&(e[3]=c.bias[3]));const s=f*h;if(r!==void 0&&(r.format!==void 0&&d===4&&r.format!=="RGBA"||d===3&&r.format!=="RGB"&&r.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");const l=4;let g=0,y=1,b=2,_=3,v=0,T=s,w=2*s,A=-1;p==="RGBA"?(v=0,T=s,w=2*s,A=3*s):p==="RGB"?(v=0,T=s,w=2*s):p==="RBG"&&(v=0,w=s,T=2*s),u=a.createImageData(h,f);for(let S=0;S<f*h;g+=l,y+=l,b+=l,_+=l,S++)u.data[g]=(n.data[v++]-e[0])*o[0],u.data[y]=(n.data[T++]-e[1])*o[1],u.data[b]=(n.data[w++]-e[2])*o[2],u.data[_]=A===-1?255:(n.data[A++]-e[3])*o[3]}return u}},4866:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tensorFromImage=t.bufferToTensor=void 0;const r=n(963);t.bufferToTensor=(a,u)=>{if(a===void 0)throw new Error("Image buffer must be defined");if(u.height===void 0||u.width===void 0)throw new Error("Image height and width must be defined");if(u.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");const{height:h,width:f}=u,d=u.norm??{mean:255,bias:0};let p,c;p=typeof d.mean=="number"?[d.mean,d.mean,d.mean,d.mean]:[d.mean[0],d.mean[1],d.mean[2],d.mean[3]??255],c=typeof d.bias=="number"?[d.bias,d.bias,d.bias,d.bias]:[d.bias[0],d.bias[1],d.bias[2],d.bias[3]??0];const o=u.format!==void 0?u.format:"RGBA",e=u.tensorFormat!==void 0&&u.tensorFormat!==void 0?u.tensorFormat:"RGB",s=h*f,l=e==="RGBA"?new Float32Array(4*s):new Float32Array(3*s);let g=4,y=0,b=1,_=2,v=3,T=0,w=s,A=2*s,S=-1;o==="RGB"&&(g=3,y=0,b=1,_=2,v=-1),e==="RGBA"?S=3*s:e==="RBG"?(T=0,A=s,w=2*s):e==="BGR"&&(A=0,w=s,T=2*s);for(let O=0;O<s;O++,y+=g,_+=g,b+=g,v+=g)l[T++]=(a[y]+c[0])/p[0],l[w++]=(a[b]+c[1])/p[1],l[A++]=(a[_]+c[2])/p[2],S!==-1&&v!==-1&&(l[S++]=(a[v]+c[3])/p[3]);return e==="RGBA"?new r.Tensor("float32",l,[1,4,h,f]):new r.Tensor("float32",l,[1,3,h,f])},t.tensorFromImage=async(a,u)=>{const h=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,f=typeof ImageData<"u"&&a instanceof ImageData,d=typeof ImageBitmap<"u"&&a instanceof ImageBitmap,p=typeof a=="string";let c,o=u??{};if(h){const e=document.createElement("canvas");e.width=a.width,e.height=a.height;const s=e.getContext("2d");if(s==null)throw new Error("Can not access image data");{let l=a.height,g=a.width;if(u!==void 0&&u.resizedHeight!==void 0&&u.resizedWidth!==void 0&&(l=u.resizedHeight,g=u.resizedWidth),u!==void 0){if(o=u,u.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");o.tensorFormat="RGBA",o.height=l,o.width=g}else o.tensorFormat="RGBA",o.height=l,o.width=g;s.drawImage(a,0,0),c=s.getImageData(0,0,g,l).data}}else{if(!f){if(d){if(u===void 0)throw new Error("Please provide image config with format for Imagebitmap");const e=document.createElement("canvas");e.width=a.width,e.height=a.height;const s=e.getContext("2d");if(s!=null){const l=a.height,g=a.width;return s.drawImage(a,0,0,g,l),c=s.getImageData(0,0,g,l).data,o.height=l,o.width=g,(0,t.bufferToTensor)(c,o)}throw new Error("Can not access image data")}if(p)return new Promise((e,s)=>{const l=document.createElement("canvas"),g=l.getContext("2d");if(!a||!g)return s();const y=new Image;y.crossOrigin="Anonymous",y.src=a,y.onload=()=>{l.width=y.width,l.height=y.height,g.drawImage(y,0,0,l.width,l.height);const b=g.getImageData(0,0,l.width,l.height);o.height=l.height,o.width=l.width,e((0,t.bufferToTensor)(b.data,o))}});throw new Error("Input data provided is not supported - aborted tensor creation")}{let e,s;if(u!==void 0&&u.resizedWidth!==void 0&&u.resizedHeight!==void 0?(e=u.resizedHeight,s=u.resizedWidth):(e=a.height,s=a.width),u!==void 0&&(o=u),o.format="RGBA",o.height=e,o.width=s,u!==void 0){const l=document.createElement("canvas");l.width=s,l.height=e;const g=l.getContext("2d");if(g==null)throw new Error("Can not access image data");g.putImageData(a,0,0),c=g.getImageData(0,0,s,e).data}else c=a.data}}if(c!==void 0)return(0,t.bufferToTensor)(c,o);throw new Error("Input data provided is not supported - aborted tensor creation")}},5957:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Tensor=void 0;const r=n(2350),a=n(4866),u=n(106),h=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),f=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let d=!1;t.Tensor=class{constructor(p,c,o){let e,s,l;if((()=>{if(!d){d=!0;const y=typeof BigInt64Array<"u"&&typeof BigInt64Array.from=="function",b=typeof BigUint64Array<"u"&&typeof BigUint64Array.from=="function";y&&(h.set("int64",BigInt64Array),f.set(BigInt64Array,"int64")),b&&(h.set("uint64",BigUint64Array),f.set(BigUint64Array,"uint64"))}})(),typeof p=="string")if(e=p,l=o,p==="string"){if(!Array.isArray(c))throw new TypeError("A string tensor's data must be a string array.");s=c}else{const y=h.get(p);if(y===void 0)throw new TypeError(`Unsupported tensor type: ${p}.`);if(Array.isArray(c)){if(p==="float16")throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");s=p==="uint64"||p==="int64"?y.from(c,BigInt):y.from(c)}else{if(!(c instanceof y))throw new TypeError(`A ${e} tensor's data must be type of ${y}`);s=c}}else if(l=c,Array.isArray(p)){if(p.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const y=typeof p[0];if(y==="string")e="string",s=p;else{if(y!=="boolean")throw new TypeError(`Invalid element type of data array: ${y}.`);e="bool",s=Uint8Array.from(p)}}else{const y=f.get(p.constructor);if(y===void 0)throw new TypeError(`Unsupported type for tensor data: ${p.constructor}.`);e=y,s=p}if(l===void 0)l=[s.length];else if(!Array.isArray(l))throw new TypeError("A tensor's dims must be a number array");const g=(0,u.calculateSize)(l);if(g!==s.length)throw new Error(`Tensor's size(${g}) does not match data length(${s.length}).`);this.dims=l,this.type=e,this.data=s,this.size=g}static async fromImage(p,c){return(0,a.tensorFromImage)(p,c)}toDataURL(p){return(0,r.tensorToDataURL)(this,p)}toImageData(p){return(0,r.tensorToImageData)(this,p)}reshape(p){return(0,u.tensorReshape)(this,p)}}},106:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tensorReshape=t.calculateSize=void 0;const r=n(963);t.calculateSize=a=>{let u=1;for(let h=0;h<a.length;h++){const f=a[h];if(typeof f!="number"||!Number.isSafeInteger(f))throw new TypeError(`dims[${h}] must be an integer, got: ${f}`);if(f<0)throw new RangeError(`dims[${h}] must be a non-negative integer, got: ${f}`);u*=f}return u},t.tensorReshape=(a,u)=>new r.Tensor(a.type,a.data,u)},963:(m,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Tensor=void 0;const r=n(5957);t.Tensor=r.Tensor},9104:(m,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="1.16.3"},1583:(m,t)=>{var n,r=function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=null;try{u=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function h(I,M,k){this.low=0|I,this.high=0|M,this.unsigned=!!k}function f(I){return(I&&I.__isLong__)===!0}function d(I){var M=Math.clz32(I&-I);return I?31-M:M}h.prototype.__isLong__,Object.defineProperty(h.prototype,"__isLong__",{value:!0}),h.isLong=f;var p={},c={};function o(I,M){var k,X,G;return M?(G=0<=(I>>>=0)&&I<256)&&(X=c[I])?X:(k=s(I,0,!0),G&&(c[I]=k),k):(G=-128<=(I|=0)&&I<128)&&(X=p[I])?X:(k=s(I,I<0?-1:0,!1),G&&(p[I]=k),k)}function e(I,M){if(isNaN(I))return M?A:w;if(M){if(I<0)return A;if(I>=_)return $}else{if(I<=-v)return L;if(I+1>=v)return D}return I<0?e(-I,M).neg():s(I%b|0,I/b|0,M)}function s(I,M,k){return new h(I,M,k)}h.fromInt=o,h.fromNumber=e,h.fromBits=s;var l=Math.pow;function g(I,M,k){if(I.length===0)throw Error("empty string");if(typeof M=="number"?(k=M,M=!1):M=!!M,I==="NaN"||I==="Infinity"||I==="+Infinity"||I==="-Infinity")return M?A:w;if((k=k||10)<2||36<k)throw RangeError("radix");var X;if((X=I.indexOf("-"))>0)throw Error("interior hyphen");if(X===0)return g(I.substring(1),M,k).neg();for(var G=e(l(k,8)),J=w,Y=0;Y<I.length;Y+=8){var Q=Math.min(8,I.length-Y),tt=parseInt(I.substring(Y,Y+Q),k);if(Q<8){var nt=e(l(k,Q));J=J.mul(nt).add(e(tt))}else J=(J=J.mul(G)).add(e(tt))}return J.unsigned=M,J}function y(I,M){return typeof I=="number"?e(I,M):typeof I=="string"?g(I,M):s(I.low,I.high,typeof M=="boolean"?M:I.unsigned)}h.fromString=g,h.fromValue=y;var b=4294967296,_=b*b,v=_/2,T=o(1<<24),w=o(0);h.ZERO=w;var A=o(0,!0);h.UZERO=A;var S=o(1);h.ONE=S;var O=o(1,!0);h.UONE=O;var C=o(-1);h.NEG_ONE=C;var D=s(-1,2147483647,!1);h.MAX_VALUE=D;var $=s(-1,-1,!0);h.MAX_UNSIGNED_VALUE=$;var L=s(0,-2147483648,!1);h.MIN_VALUE=L;var P=h.prototype;P.toInt=function(){return this.unsigned?this.low>>>0:this.low},P.toNumber=function(){return this.unsigned?(this.high>>>0)*b+(this.low>>>0):this.high*b+(this.low>>>0)},P.toString=function(I){if((I=I||10)<2||36<I)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(L)){var M=e(I),k=this.div(M),X=k.mul(M).sub(this);return k.toString(I)+X.toInt().toString(I)}return"-"+this.neg().toString(I)}for(var G=e(l(I,6),this.unsigned),J=this,Y="";;){var Q=J.div(G),tt=(J.sub(Q.mul(G)).toInt()>>>0).toString(I);if((J=Q).isZero())return tt+Y;for(;tt.length<6;)tt="0"+tt;Y=""+tt+Y}},P.getHighBits=function(){return this.high},P.getHighBitsUnsigned=function(){return this.high>>>0},P.getLowBits=function(){return this.low},P.getLowBitsUnsigned=function(){return this.low>>>0},P.getNumBitsAbs=function(){if(this.isNegative())return this.eq(L)?64:this.neg().getNumBitsAbs();for(var I=this.high!=0?this.high:this.low,M=31;M>0&&!(I&1<<M);M--);return this.high!=0?M+33:M+1},P.isZero=function(){return this.high===0&&this.low===0},P.eqz=P.isZero,P.isNegative=function(){return!this.unsigned&&this.high<0},P.isPositive=function(){return this.unsigned||this.high>=0},P.isOdd=function(){return(1&this.low)==1},P.isEven=function(){return(1&this.low)==0},P.equals=function(I){return f(I)||(I=y(I)),(this.unsigned===I.unsigned||this.high>>>31!=1||I.high>>>31!=1)&&this.high===I.high&&this.low===I.low},P.eq=P.equals,P.notEquals=function(I){return!this.eq(I)},P.neq=P.notEquals,P.ne=P.notEquals,P.lessThan=function(I){return this.comp(I)<0},P.lt=P.lessThan,P.lessThanOrEqual=function(I){return this.comp(I)<=0},P.lte=P.lessThanOrEqual,P.le=P.lessThanOrEqual,P.greaterThan=function(I){return this.comp(I)>0},P.gt=P.greaterThan,P.greaterThanOrEqual=function(I){return this.comp(I)>=0},P.gte=P.greaterThanOrEqual,P.ge=P.greaterThanOrEqual,P.compare=function(I){if(f(I)||(I=y(I)),this.eq(I))return 0;var M=this.isNegative(),k=I.isNegative();return M&&!k?-1:!M&&k?1:this.unsigned?I.high>>>0>this.high>>>0||I.high===this.high&&I.low>>>0>this.low>>>0?-1:1:this.sub(I).isNegative()?-1:1},P.comp=P.compare,P.negate=function(){return!this.unsigned&&this.eq(L)?L:this.not().add(S)},P.neg=P.negate,P.add=function(I){f(I)||(I=y(I));var M=this.high>>>16,k=65535&this.high,X=this.low>>>16,G=65535&this.low,J=I.high>>>16,Y=65535&I.high,Q=I.low>>>16,tt=0,nt=0,ot=0,lt=0;return ot+=(lt+=G+(65535&I.low))>>>16,nt+=(ot+=X+Q)>>>16,tt+=(nt+=k+Y)>>>16,tt+=M+J,s((ot&=65535)<<16|(lt&=65535),(tt&=65535)<<16|(nt&=65535),this.unsigned)},P.subtract=function(I){return f(I)||(I=y(I)),this.add(I.neg())},P.sub=P.subtract,P.multiply=function(I){if(this.isZero())return this;if(f(I)||(I=y(I)),u)return s(u.mul(this.low,this.high,I.low,I.high),u.get_high(),this.unsigned);if(I.isZero())return this.unsigned?A:w;if(this.eq(L))return I.isOdd()?L:w;if(I.eq(L))return this.isOdd()?L:w;if(this.isNegative())return I.isNegative()?this.neg().mul(I.neg()):this.neg().mul(I).neg();if(I.isNegative())return this.mul(I.neg()).neg();if(this.lt(T)&&I.lt(T))return e(this.toNumber()*I.toNumber(),this.unsigned);var M=this.high>>>16,k=65535&this.high,X=this.low>>>16,G=65535&this.low,J=I.high>>>16,Y=65535&I.high,Q=I.low>>>16,tt=65535&I.low,nt=0,ot=0,lt=0,ut=0;return lt+=(ut+=G*tt)>>>16,ot+=(lt+=X*tt)>>>16,lt&=65535,ot+=(lt+=G*Q)>>>16,nt+=(ot+=k*tt)>>>16,ot&=65535,nt+=(ot+=X*Q)>>>16,ot&=65535,nt+=(ot+=G*Y)>>>16,nt+=M*tt+k*Q+X*Y+G*J,s((lt&=65535)<<16|(ut&=65535),(nt&=65535)<<16|(ot&=65535),this.unsigned)},P.mul=P.multiply,P.divide=function(I){if(f(I)||(I=y(I)),I.isZero())throw Error("division by zero");var M,k,X;if(u)return this.unsigned||this.high!==-2147483648||I.low!==-1||I.high!==-1?s((this.unsigned?u.div_u:u.div_s)(this.low,this.high,I.low,I.high),u.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?A:w;if(this.unsigned){if(I.unsigned||(I=I.toUnsigned()),I.gt(this))return A;if(I.gt(this.shru(1)))return O;X=A}else{if(this.eq(L))return I.eq(S)||I.eq(C)?L:I.eq(L)?S:(M=this.shr(1).div(I).shl(1)).eq(w)?I.isNegative()?S:C:(k=this.sub(I.mul(M)),X=M.add(k.div(I)));if(I.eq(L))return this.unsigned?A:w;if(this.isNegative())return I.isNegative()?this.neg().div(I.neg()):this.neg().div(I).neg();if(I.isNegative())return this.div(I.neg()).neg();X=w}for(k=this;k.gte(I);){M=Math.max(1,Math.floor(k.toNumber()/I.toNumber()));for(var G=Math.ceil(Math.log(M)/Math.LN2),J=G<=48?1:l(2,G-48),Y=e(M),Q=Y.mul(I);Q.isNegative()||Q.gt(k);)Q=(Y=e(M-=J,this.unsigned)).mul(I);Y.isZero()&&(Y=S),X=X.add(Y),k=k.sub(Q)}return X},P.div=P.divide,P.modulo=function(I){return f(I)||(I=y(I)),u?s((this.unsigned?u.rem_u:u.rem_s)(this.low,this.high,I.low,I.high),u.get_high(),this.unsigned):this.sub(this.div(I).mul(I))},P.mod=P.modulo,P.rem=P.modulo,P.not=function(){return s(~this.low,~this.high,this.unsigned)},P.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},P.clz=P.countLeadingZeros,P.countTrailingZeros=function(){return this.low?d(this.low):d(this.high)+32},P.ctz=P.countTrailingZeros,P.and=function(I){return f(I)||(I=y(I)),s(this.low&I.low,this.high&I.high,this.unsigned)},P.or=function(I){return f(I)||(I=y(I)),s(this.low|I.low,this.high|I.high,this.unsigned)},P.xor=function(I){return f(I)||(I=y(I)),s(this.low^I.low,this.high^I.high,this.unsigned)},P.shiftLeft=function(I){return f(I)&&(I=I.toInt()),(I&=63)==0?this:I<32?s(this.low<<I,this.high<<I|this.low>>>32-I,this.unsigned):s(0,this.low<<I-32,this.unsigned)},P.shl=P.shiftLeft,P.shiftRight=function(I){return f(I)&&(I=I.toInt()),(I&=63)==0?this:I<32?s(this.low>>>I|this.high<<32-I,this.high>>I,this.unsigned):s(this.high>>I-32,this.high>=0?0:-1,this.unsigned)},P.shr=P.shiftRight,P.shiftRightUnsigned=function(I){return f(I)&&(I=I.toInt()),(I&=63)==0?this:I<32?s(this.low>>>I|this.high<<32-I,this.high>>>I,this.unsigned):s(I===32?this.high:this.high>>>I-32,0,this.unsigned)},P.shru=P.shiftRightUnsigned,P.shr_u=P.shiftRightUnsigned,P.rotateLeft=function(I){var M;return f(I)&&(I=I.toInt()),(I&=63)==0?this:I===32?s(this.high,this.low,this.unsigned):I<32?(M=32-I,s(this.low<<I|this.high>>>M,this.high<<I|this.low>>>M,this.unsigned)):(M=32-(I-=32),s(this.high<<I|this.low>>>M,this.low<<I|this.high>>>M,this.unsigned))},P.rotl=P.rotateLeft,P.rotateRight=function(I){var M;return f(I)&&(I=I.toInt()),(I&=63)==0?this:I===32?s(this.high,this.low,this.unsigned):I<32?(M=32-I,s(this.high<<M|this.low>>>I,this.low<<M|this.high>>>I,this.unsigned)):(M=32-(I-=32),s(this.low<<M|this.high>>>I,this.high<<M|this.low>>>I,this.unsigned))},P.rotr=P.rotateRight,P.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},P.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},P.toBytes=function(I){return I?this.toBytesLE():this.toBytesBE()},P.toBytesLE=function(){var I=this.high,M=this.low;return[255&M,M>>>8&255,M>>>16&255,M>>>24,255&I,I>>>8&255,I>>>16&255,I>>>24]},P.toBytesBE=function(){var I=this.high,M=this.low;return[I>>>24,I>>>16&255,I>>>8&255,255&I,M>>>24,M>>>16&255,M>>>8&255,255&M]},h.fromBytes=function(I,M,k){return k?h.fromBytesLE(I,M):h.fromBytesBE(I,M)},h.fromBytesLE=function(I,M){return new h(I[0]|I[1]<<8|I[2]<<16|I[3]<<24,I[4]|I[5]<<8|I[6]<<16|I[7]<<24,M)},h.fromBytesBE=function(I,M){return new h(I[4]<<24|I[5]<<16|I[6]<<8|I[7],I[0]<<24|I[1]<<16|I[2]<<8|I[3],M)};var B=h;return a.default=B,"default"in a?a.default:a}({});(n=(function(){return r}).apply(t,[]))===void 0||(m.exports=n)},5686:(m,t,n)=>{n.r(t),n.d(t,{flatbuffers:()=>r});var r={};r.Offset,r.Table,r.SIZEOF_SHORT=2,r.SIZEOF_INT=4,r.FILE_IDENTIFIER_LENGTH=4,r.SIZE_PREFIX_LENGTH=4,r.Encoding={UTF8_BYTES:1,UTF16_STRING:2},r.int32=new Int32Array(2),r.float32=new Float32Array(r.int32.buffer),r.float64=new Float64Array(r.int32.buffer),r.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1,r.Long=function(a,u){this.low=0|a,this.high=0|u},r.Long.create=function(a,u){return a==0&&u==0?r.Long.ZERO:new r.Long(a,u)},r.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high},r.Long.prototype.equals=function(a){return this.low==a.low&&this.high==a.high},r.Long.ZERO=new r.Long(0,0),r.Builder=function(a){if(a)u=a;else var u=1024;this.bb=r.ByteBuffer.allocate(u),this.space=u,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},r.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},r.Builder.prototype.forceDefaults=function(a){this.force_defaults=a},r.Builder.prototype.dataBuffer=function(){return this.bb},r.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},r.Builder.prototype.prep=function(a,u){a>this.minalign&&(this.minalign=a);for(var h=1+~(this.bb.capacity()-this.space+u)&a-1;this.space<h+a+u;){var f=this.bb.capacity();this.bb=r.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-f}this.pad(h)},r.Builder.prototype.pad=function(a){for(var u=0;u<a;u++)this.bb.writeInt8(--this.space,0)},r.Builder.prototype.writeInt8=function(a){this.bb.writeInt8(this.space-=1,a)},r.Builder.prototype.writeInt16=function(a){this.bb.writeInt16(this.space-=2,a)},r.Builder.prototype.writeInt32=function(a){this.bb.writeInt32(this.space-=4,a)},r.Builder.prototype.writeInt64=function(a){this.bb.writeInt64(this.space-=8,a)},r.Builder.prototype.writeFloat32=function(a){this.bb.writeFloat32(this.space-=4,a)},r.Builder.prototype.writeFloat64=function(a){this.bb.writeFloat64(this.space-=8,a)},r.Builder.prototype.addInt8=function(a){this.prep(1,0),this.writeInt8(a)},r.Builder.prototype.addInt16=function(a){this.prep(2,0),this.writeInt16(a)},r.Builder.prototype.addInt32=function(a){this.prep(4,0),this.writeInt32(a)},r.Builder.prototype.addInt64=function(a){this.prep(8,0),this.writeInt64(a)},r.Builder.prototype.addFloat32=function(a){this.prep(4,0),this.writeFloat32(a)},r.Builder.prototype.addFloat64=function(a){this.prep(8,0),this.writeFloat64(a)},r.Builder.prototype.addFieldInt8=function(a,u,h){(this.force_defaults||u!=h)&&(this.addInt8(u),this.slot(a))},r.Builder.prototype.addFieldInt16=function(a,u,h){(this.force_defaults||u!=h)&&(this.addInt16(u),this.slot(a))},r.Builder.prototype.addFieldInt32=function(a,u,h){(this.force_defaults||u!=h)&&(this.addInt32(u),this.slot(a))},r.Builder.prototype.addFieldInt64=function(a,u,h){!this.force_defaults&&u.equals(h)||(this.addInt64(u),this.slot(a))},r.Builder.prototype.addFieldFloat32=function(a,u,h){(this.force_defaults||u!=h)&&(this.addFloat32(u),this.slot(a))},r.Builder.prototype.addFieldFloat64=function(a,u,h){(this.force_defaults||u!=h)&&(this.addFloat64(u),this.slot(a))},r.Builder.prototype.addFieldOffset=function(a,u,h){(this.force_defaults||u!=h)&&(this.addOffset(u),this.slot(a))},r.Builder.prototype.addFieldStruct=function(a,u,h){u!=h&&(this.nested(u),this.slot(a))},r.Builder.prototype.nested=function(a){if(a!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},r.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},r.Builder.prototype.slot=function(a){this.vtable[a]=this.offset()},r.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},r.Builder.growByteBuffer=function(a){var u=a.capacity();if(3221225472&u)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var h=u<<1,f=r.ByteBuffer.allocate(h);return f.setPosition(h-u),f.bytes().set(a.bytes(),h-u),f},r.Builder.prototype.addOffset=function(a){this.prep(r.SIZEOF_INT,0),this.writeInt32(this.offset()-a+r.SIZEOF_INT)},r.Builder.prototype.startObject=function(a){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=a;for(var u=0;u<a;u++)this.vtable[u]=0;this.isNested=!0,this.object_start=this.offset()},r.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var a=this.offset(),u=this.vtable_in_use-1;u>=0&&this.vtable[u]==0;u--);for(var h=u+1;u>=0;u--)this.addInt16(this.vtable[u]!=0?a-this.vtable[u]:0);this.addInt16(a-this.object_start);var f=(h+2)*r.SIZEOF_SHORT;this.addInt16(f);var d=0,p=this.space;t:for(u=0;u<this.vtables.length;u++){var c=this.bb.capacity()-this.vtables[u];if(f==this.bb.readInt16(c)){for(var o=r.SIZEOF_SHORT;o<f;o+=r.SIZEOF_SHORT)if(this.bb.readInt16(p+o)!=this.bb.readInt16(c+o))continue t;d=this.vtables[u];break}}return d?(this.space=this.bb.capacity()-a,this.bb.writeInt32(this.space,d-a)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-a,this.offset()-a)),this.isNested=!1,a},r.Builder.prototype.finish=function(a,u,h){var f=h?r.SIZE_PREFIX_LENGTH:0;if(u){var d=u;if(this.prep(this.minalign,r.SIZEOF_INT+r.FILE_IDENTIFIER_LENGTH+f),d.length!=r.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+r.FILE_IDENTIFIER_LENGTH);for(var p=r.FILE_IDENTIFIER_LENGTH-1;p>=0;p--)this.writeInt8(d.charCodeAt(p))}this.prep(this.minalign,r.SIZEOF_INT+f),this.addOffset(a),f&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},r.Builder.prototype.finishSizePrefixed=function(a,u){this.finish(a,u,!0)},r.Builder.prototype.requiredField=function(a,u){var h=this.bb.capacity()-a,f=h-this.bb.readInt32(h);if(this.bb.readInt16(f+u)==0)throw new Error("FlatBuffers: field "+u+" must be set")},r.Builder.prototype.startVector=function(a,u,h){this.notNested(),this.vector_num_elems=u,this.prep(r.SIZEOF_INT,a*u),this.prep(h,a*u)},r.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},r.Builder.prototype.createString=function(a){if(a instanceof Uint8Array)var u=a;else{u=[];for(var h=0;h<a.length;){var f,d=a.charCodeAt(h++);(f=d<55296||d>=56320?d:(d<<10)+a.charCodeAt(h++)+-56613888)<128?u.push(f):(f<2048?u.push(f>>6&31|192):(f<65536?u.push(f>>12&15|224):u.push(f>>18&7|240,f>>12&63|128),u.push(f>>6&63|128)),u.push(63&f|128))}}this.addInt8(0),this.startVector(1,u.length,1),this.bb.setPosition(this.space-=u.length),h=0;for(var p=this.space,c=this.bb.bytes();h<u.length;h++)c[p++]=u[h];return this.endVector()},r.Builder.prototype.createLong=function(a,u){return r.Long.create(a,u)},r.ByteBuffer=function(a){this.bytes_=a,this.position_=0},r.ByteBuffer.allocate=function(a){return new r.ByteBuffer(new Uint8Array(a))},r.ByteBuffer.prototype.clear=function(){this.position_=0},r.ByteBuffer.prototype.bytes=function(){return this.bytes_},r.ByteBuffer.prototype.position=function(){return this.position_},r.ByteBuffer.prototype.setPosition=function(a){this.position_=a},r.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},r.ByteBuffer.prototype.readInt8=function(a){return this.readUint8(a)<<24>>24},r.ByteBuffer.prototype.readUint8=function(a){return this.bytes_[a]},r.ByteBuffer.prototype.readInt16=function(a){return this.readUint16(a)<<16>>16},r.ByteBuffer.prototype.readUint16=function(a){return this.bytes_[a]|this.bytes_[a+1]<<8},r.ByteBuffer.prototype.readInt32=function(a){return this.bytes_[a]|this.bytes_[a+1]<<8|this.bytes_[a+2]<<16|this.bytes_[a+3]<<24},r.ByteBuffer.prototype.readUint32=function(a){return this.readInt32(a)>>>0},r.ByteBuffer.prototype.readInt64=function(a){return new r.Long(this.readInt32(a),this.readInt32(a+4))},r.ByteBuffer.prototype.readUint64=function(a){return new r.Long(this.readUint32(a),this.readUint32(a+4))},r.ByteBuffer.prototype.readFloat32=function(a){return r.int32[0]=this.readInt32(a),r.float32[0]},r.ByteBuffer.prototype.readFloat64=function(a){return r.int32[r.isLittleEndian?0:1]=this.readInt32(a),r.int32[r.isLittleEndian?1:0]=this.readInt32(a+4),r.float64[0]},r.ByteBuffer.prototype.writeInt8=function(a,u){this.bytes_[a]=u},r.ByteBuffer.prototype.writeUint8=function(a,u){this.bytes_[a]=u},r.ByteBuffer.prototype.writeInt16=function(a,u){this.bytes_[a]=u,this.bytes_[a+1]=u>>8},r.ByteBuffer.prototype.writeUint16=function(a,u){this.bytes_[a]=u,this.bytes_[a+1]=u>>8},r.ByteBuffer.prototype.writeInt32=function(a,u){this.bytes_[a]=u,this.bytes_[a+1]=u>>8,this.bytes_[a+2]=u>>16,this.bytes_[a+3]=u>>24},r.ByteBuffer.prototype.writeUint32=function(a,u){this.bytes_[a]=u,this.bytes_[a+1]=u>>8,this.bytes_[a+2]=u>>16,this.bytes_[a+3]=u>>24},r.ByteBuffer.prototype.writeInt64=function(a,u){this.writeInt32(a,u.low),this.writeInt32(a+4,u.high)},r.ByteBuffer.prototype.writeUint64=function(a,u){this.writeUint32(a,u.low),this.writeUint32(a+4,u.high)},r.ByteBuffer.prototype.writeFloat32=function(a,u){r.float32[0]=u,this.writeInt32(a,r.int32[0])},r.ByteBuffer.prototype.writeFloat64=function(a,u){r.float64[0]=u,this.writeInt32(a,r.int32[r.isLittleEndian?0:1]),this.writeInt32(a+4,r.int32[r.isLittleEndian?1:0])},r.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+r.SIZEOF_INT+r.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var a="",u=0;u<r.FILE_IDENTIFIER_LENGTH;u++)a+=String.fromCharCode(this.readInt8(this.position_+r.SIZEOF_INT+u));return a},r.ByteBuffer.prototype.__offset=function(a,u){var h=a-this.readInt32(a);return u<this.readInt16(h)?this.readInt16(h+u):0},r.ByteBuffer.prototype.__union=function(a,u){return a.bb_pos=u+this.readInt32(u),a.bb=this,a},r.ByteBuffer.prototype.__string=function(a,u){a+=this.readInt32(a);var h=this.readInt32(a),f="",d=0;if(a+=r.SIZEOF_INT,u===r.Encoding.UTF8_BYTES)return this.bytes_.subarray(a,a+h);for(;d<h;){var p,c=this.readUint8(a+d++);if(c<192)p=c;else{var o=this.readUint8(a+d++);if(c<224)p=(31&c)<<6|63&o;else{var e=this.readUint8(a+d++);p=c<240?(15&c)<<12|(63&o)<<6|63&e:(7&c)<<18|(63&o)<<12|(63&e)<<6|63&this.readUint8(a+d++)}}p<65536?f+=String.fromCharCode(p):(p-=65536,f+=String.fromCharCode(55296+(p>>10),56320+(1023&p)))}return f},r.ByteBuffer.prototype.__indirect=function(a){return a+this.readInt32(a)},r.ByteBuffer.prototype.__vector=function(a){return a+this.readInt32(a)+r.SIZEOF_INT},r.ByteBuffer.prototype.__vector_len=function(a){return this.readInt32(a+this.readInt32(a))},r.ByteBuffer.prototype.__has_identifier=function(a){if(a.length!=r.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+r.FILE_IDENTIFIER_LENGTH);for(var u=0;u<r.FILE_IDENTIFIER_LENGTH;u++)if(a.charCodeAt(u)!=this.readInt8(this.position_+r.SIZEOF_INT+u))return!1;return!0},r.ByteBuffer.prototype.createLong=function(a,u){return r.Long.create(a,u)}}},__webpack_module_cache__={};function __webpack_require__(m){var t=__webpack_module_cache__[m];if(t!==void 0)return t.exports;var n=__webpack_module_cache__[m]={exports:{}};return __webpack_modules__[m].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=m=>{var t=m&&m.__esModule?()=>m.default:()=>m;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(m,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(m,n)&&Object.defineProperty(m,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(m,t)=>Object.prototype.hasOwnProperty.call(m,t),__webpack_require__.r=m=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__(1057);return __webpack_exports__})())})(ort_min);var ort_minExports=ort_min.exports;/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.6.9
*/var durl=function(m){return URL.createObjectURL(new Blob([m],{type:"text/javascript"}))};try{URL.revokeObjectURL(durl(""))}catch(m){durl=function(t){return"data:application/javascript;charset=UTF-8,"+encodeURI(t)}}var u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(m,t){for(var n=new u16(31),r=0;r<31;++r)n[r]=t+=1<<m[r-1];for(var a=new u32(n[30]),r=1;r<30;++r)for(var u=n[r];u<n[r+1];++u)a[u]=u-n[r]<<5|r;return[n,a]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1];fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),fd=_b[0],rev=new u16(32768);for(var i=0;i<32768;++i){var x=(i&43690)>>>1|(i&21845)<<1;x=(x&52428)>>>2|(x&13107)<<2,x=(x&61680)>>>4|(x&3855)<<4,rev[i]=((x&65280)>>>8|(x&255)<<8)>>>1}var hMap=function(m,t,n){for(var r=m.length,a=0,u=new u16(t);a<r;++a)++u[m[a]-1];var h=new u16(t);for(a=0;a<t;++a)h[a]=h[a-1]+u[a-1]<<1;var f;if(n){f=new u16(1<<t);var d=15-t;for(a=0;a<r;++a)if(m[a])for(var p=a<<4|m[a],c=t-m[a],o=h[m[a]-1]++<<c,e=o|(1<<c)-1;o<=e;++o)f[rev[o]>>>d]=p}else for(f=new u16(r),a=0;a<r;++a)m[a]&&(f[a]=rev[h[m[a]-1]++]>>>15-m[a]);return f},flt=new u8(288);for(var i=0;i<144;++i)flt[i]=8;for(var i=144;i<256;++i)flt[i]=9;for(var i=256;i<280;++i)flt[i]=7;for(var i=280;i<288;++i)flt[i]=8;var fdt=new u8(32);for(var i=0;i<32;++i)fdt[i]=5;var flrm=hMap(flt,9,1),fdrm=hMap(fdt,5,1),max=function(m){for(var t=m[0],n=1;n<m.length;++n)m[n]>t&&(t=m[n]);return t},bits=function(m,t,n){var r=t/8|0;return(m[r]|m[r+1]<<8)>>(t&7)&n},bits16=function(m,t){var n=t/8|0;return(m[n]|m[n+1]<<8|m[n+2]<<16)>>(t&7)},shft=function(m){return(m/8|0)+(m&7&&1)},slc=function(m,t,n){(t==null||t<0)&&(t=0),(n==null||n>m.length)&&(n=m.length);var r=new(m instanceof u16?u16:m instanceof u32?u32:u8)(n-t);return r.set(m.subarray(t,n)),r},inflt=function(m,t,n){var r=m.length;if(!r||n&&!n.l&&r<5)return t||new u8(0);var a=!t||n,u=!n||n.i;n||(n={}),t||(t=new u8(r*3));var h=function(lt){var ut=t.length;if(lt>ut){var gt=new u8(Math.max(ut*2,lt));gt.set(t),t=gt}},f=n.f||0,d=n.p||0,p=n.b||0,c=n.l,o=n.d,e=n.m,s=n.n,l=r*8;do{if(!c){n.f=f=bits(m,d,1);var g=bits(m,d+1,3);if(d+=3,g)if(g==1)c=flrm,o=fdrm,e=9,s=5;else if(g==2){var v=bits(m,d,31)+257,T=bits(m,d+10,15)+4,w=v+bits(m,d+5,31)+1;d+=14;for(var A=new u8(w),S=new u8(19),O=0;O<T;++O)S[clim[O]]=bits(m,d+O*3,7);d+=T*3;for(var C=max(S),D=(1<<C)-1,$=hMap(S,C,1),O=0;O<w;){var L=$[bits(m,d,D)];d+=L&15;var y=L>>>4;if(y<16)A[O++]=y;else{var P=0,B=0;for(y==16?(B=3+bits(m,d,3),d+=2,P=A[O-1]):y==17?(B=3+bits(m,d,7),d+=3):y==18&&(B=11+bits(m,d,127),d+=7);B--;)A[O++]=P}}var I=A.subarray(0,v),M=A.subarray(v);e=max(I),s=max(M),c=hMap(I,e,1),o=hMap(M,s,1)}else throw"invalid block type";else{var y=shft(d)+4,b=m[y-4]|m[y-3]<<8,_=y+b;if(_>r){if(u)throw"unexpected EOF";break}a&&h(p+b),t.set(m.subarray(y,_),p),n.b=p+=b,n.p=d=_*8;continue}if(d>l){if(u)throw"unexpected EOF";break}}a&&h(p+131072);for(var k=(1<<e)-1,X=(1<<s)-1,G=d;;G=d){var P=c[bits16(m,d)&k],J=P>>>4;if(d+=P&15,d>l){if(u)throw"unexpected EOF";break}if(!P)throw"invalid length/literal";if(J<256)t[p++]=J;else if(J==256){G=d,c=null;break}else{var Y=J-254;if(J>264){var O=J-257,Q=fleb[O];Y=bits(m,d,(1<<Q)-1)+fl[O],d+=Q}var tt=o[bits16(m,d)&X],nt=tt>>>4;if(!tt)throw"invalid distance";d+=tt&15;var M=fd[nt];if(nt>3){var Q=fdeb[nt];M+=bits16(m,d)&(1<<Q)-1,d+=Q}if(d>l){if(u)throw"unexpected EOF";break}a&&h(p+131072);for(var ot=p+Y;p<ot;p+=4)t[p]=t[p-M],t[p+1]=t[p+1-M],t[p+2]=t[p+2-M],t[p+3]=t[p+3-M];p=ot}}n.l=c,n.p=G,n.b=p,c&&(f=1,n.m=e,n.d=o,n.n=s)}while(!f);return p==t.length?t:slc(t,0,p)},et=new u8(0),zlv=function(m){if((m[0]&15)!=8||m[0]>>>4>7||(m[0]<<8|m[1])%31)throw"invalid zlib data";if(m[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function unzlibSync(m,t){return inflt((zlv(m),m.subarray(2,-4)),t)}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et,{stream:!0}),tds=1}catch(m){}function findSpan(m,t,n){const r=n.length-m-1;if(t>=n[r])return r-1;if(t<=n[m])return m;let a=m,u=r,h=Math.floor((a+u)/2);for(;t<n[h]||t>=n[h+1];)t<n[h]?u=h:a=h,h=Math.floor((a+u)/2);return h}function calcBasisFunctions(m,t,n,r){const a=[],u=[],h=[];a[0]=1;for(let f=1;f<=n;++f){u[f]=t-r[m+1-f],h[f]=r[m+f]-t;let d=0;for(let p=0;p<f;++p){const c=h[p+1],o=u[f-p],e=a[p]/(c+o);a[p]=d+c*e,d=o*e}a[f]=d}return a}function calcBSplinePoint(m,t,n,r){const a=findSpan(m,r,t),u=calcBasisFunctions(a,r,m,t),h=new Vector4(0,0,0,0);for(let f=0;f<=m;++f){const d=n[a-m+f],p=u[f],c=d.w*p;h.x+=d.x*c,h.y+=d.y*c,h.z+=d.z*c,h.w+=d.w*p}return h}function calcBasisFunctionDerivatives(m,t,n,r,a){const u=[];for(let o=0;o<=n;++o)u[o]=0;const h=[];for(let o=0;o<=r;++o)h[o]=u.slice(0);const f=[];for(let o=0;o<=n;++o)f[o]=u.slice(0);f[0][0]=1;const d=u.slice(0),p=u.slice(0);for(let o=1;o<=n;++o){d[o]=t-a[m+1-o],p[o]=a[m+o]-t;let e=0;for(let s=0;s<o;++s){const l=p[s+1],g=d[o-s];f[o][s]=l+g;const y=f[s][o-1]/f[o][s];f[s][o]=e+l*y,e=g*y}f[o][o]=e}for(let o=0;o<=n;++o)h[0][o]=f[o][n];for(let o=0;o<=n;++o){let e=0,s=1;const l=[];for(let g=0;g<=n;++g)l[g]=u.slice(0);l[0][0]=1;for(let g=1;g<=r;++g){let y=0;const b=o-g,_=n-g;o>=g&&(l[s][0]=l[e][0]/f[_+1][b],y=l[s][0]*f[b][_]);const v=b>=-1?1:-b,T=o-1<=_?g-1:n-o;for(let A=v;A<=T;++A)l[s][A]=(l[e][A]-l[e][A-1])/f[_+1][b+A],y+=l[s][A]*f[b+A][_];o<=_&&(l[s][g]=-l[e][g-1]/f[_+1][o],y+=l[s][g]*f[o][_]),h[g][o]=y;const w=e;e=s,s=w}}let c=n;for(let o=1;o<=r;++o){for(let e=0;e<=n;++e)h[o][e]*=c;c*=n-o}return h}function calcBSplineDerivatives(m,t,n,r,a){const u=a<m?a:m,h=[],f=findSpan(m,r,t),d=calcBasisFunctionDerivatives(f,r,m,u,t),p=[];for(let c=0;c<n.length;++c){const o=n[c].clone(),e=o.w;o.x*=e,o.y*=e,o.z*=e,p[c]=o}for(let c=0;c<=u;++c){const o=p[f-m].clone().multiplyScalar(d[c][0]);for(let e=1;e<=m;++e)o.add(p[f-m+e].clone().multiplyScalar(d[c][e]));h[c]=o}for(let c=u+1;c<=a+1;++c)h[c]=new Vector4(0,0,0);return h}function calcKoverI(m,t){let n=1;for(let a=2;a<=m;++a)n*=a;let r=1;for(let a=2;a<=t;++a)r*=a;for(let a=2;a<=m-t;++a)r*=a;return n/r}function calcRationalCurveDerivatives(m){const t=m.length,n=[],r=[];for(let u=0;u<t;++u){const h=m[u];n[u]=new Vector3(h.x,h.y,h.z),r[u]=h.w}const a=[];for(let u=0;u<t;++u){const h=n[u].clone();for(let f=1;f<=u;++f)h.sub(a[u-f].clone().multiplyScalar(calcKoverI(u,f)*r[f]));a[u]=h.divideScalar(r[0])}return a}function calcNURBSDerivatives(m,t,n,r,a){const u=calcBSplineDerivatives(m,t,n,r,a);return calcRationalCurveDerivatives(u)}class NURBSCurve extends Curve{constructor(t,n,r,a,u){super(),this.degree=t,this.knots=n,this.controlPoints=[],this.startKnot=a||0,this.endKnot=u||this.knots.length-1;for(let h=0;h<r.length;++h){const f=r[h];this.controlPoints[h]=new Vector4(f.x,f.y,f.z,f.w)}}getPoint(t,n=new Vector3){const r=n,a=this.knots[this.startKnot]+t*(this.knots[this.endKnot]-this.knots[this.startKnot]),u=calcBSplinePoint(this.degree,this.knots,this.controlPoints,a);return u.w!==1&&u.divideScalar(u.w),r.set(u.x,u.y,u.z)}getTangent(t,n=new Vector3){const r=n,a=this.knots[0]+t*(this.knots[this.knots.length-1]-this.knots[0]),u=calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,a,1);return r.copy(u[1]).normalize(),r}}let fbxTree,connections,sceneGraph;class FBXLoader extends Loader{constructor(t){super(t)}load(t,n,r,a){const u=this,h=u.path===""?LoaderUtils.extractUrlBase(t):u.path,f=new FileLoader(this.manager);f.setPath(u.path),f.setResponseType("arraybuffer"),f.setRequestHeader(u.requestHeader),f.setWithCredentials(u.withCredentials),f.load(t,function(d){try{n(u.parse(d,h))}catch(p){a?a(p):console.error(p),u.manager.itemError(t)}},r,a)}parse(t,n){if(isFbxFormatBinary(t))fbxTree=new BinaryParser().parse(t);else{const a=convertArrayBufferToString(t);if(!isFbxFormatASCII(a))throw new Error("THREE.FBXLoader: Unknown format.");if(getFbxVersion(a)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+getFbxVersion(a));fbxTree=new TextParser().parse(a)}const r=new TextureLoader(this.manager).setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);return new FBXTreeParser(r,this.manager).parse(fbxTree)}}class FBXTreeParser{constructor(t,n){this.textureLoader=t,this.manager=n}parse(){connections=this.parseConnections();const t=this.parseImages(),n=this.parseTextures(t),r=this.parseMaterials(n),a=this.parseDeformers(),u=new GeometryParser().parse(a);return this.parseScene(a,u,r),sceneGraph}parseConnections(){const t=new Map;return"Connections"in fbxTree&&fbxTree.Connections.connections.forEach(function(r){const a=r[0],u=r[1],h=r[2];t.has(a)||t.set(a,{parents:[],children:[]});const f={ID:u,relationship:h};t.get(a).parents.push(f),t.has(u)||t.set(u,{parents:[],children:[]});const d={ID:a,relationship:h};t.get(u).children.push(d)}),t}parseImages(){const t={},n={};if("Video"in fbxTree.Objects){const r=fbxTree.Objects.Video;for(const a in r){const u=r[a],h=parseInt(a);if(t[h]=u.RelativeFilename||u.Filename,"Content"in u){const f=u.Content instanceof ArrayBuffer&&u.Content.byteLength>0,d=typeof u.Content=="string"&&u.Content!=="";if(f||d){const p=this.parseImage(r[a]);n[u.RelativeFilename||u.Filename]=p}}}}for(const r in t){const a=t[r];n[a]!==void 0?t[r]=n[a]:t[r]=t[r].split("\\").pop()}return t}parseImage(t){const n=t.Content,r=t.RelativeFilename||t.Filename,a=r.slice(r.lastIndexOf(".")+1).toLowerCase();let u;switch(a){case"bmp":u="image/bmp";break;case"jpg":case"jpeg":u="image/jpeg";break;case"png":u="image/png";break;case"tif":u="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",r),u="image/tga";break;default:console.warn('FBXLoader: Image type "'+a+'" is not supported.');return}if(typeof n=="string")return"data:"+u+";base64,"+n;{const h=new Uint8Array(n);return window.URL.createObjectURL(new Blob([h],{type:u}))}}parseTextures(t){const n=new Map;if("Texture"in fbxTree.Objects){const r=fbxTree.Objects.Texture;for(const a in r){const u=this.parseTexture(r[a],t);n.set(parseInt(a),u)}}return n}parseTexture(t,n){const r=this.loadTexture(t,n);r.ID=t.id,r.name=t.attrName;const a=t.WrapModeU,u=t.WrapModeV,h=a!==void 0?a.value:0,f=u!==void 0?u.value:0;if(r.wrapS=h===0?RepeatWrapping:ClampToEdgeWrapping,r.wrapT=f===0?RepeatWrapping:ClampToEdgeWrapping,"Scaling"in t){const d=t.Scaling.value;r.repeat.x=d[0],r.repeat.y=d[1]}if("Translation"in t){const d=t.Translation.value;r.offset.x=d[0],r.offset.y=d[1]}return r}loadTexture(t,n){let r;const a=this.textureLoader.path,u=connections.get(t.id).children;u!==void 0&&u.length>0&&n[u[0].ID]!==void 0&&(r=n[u[0].ID],(r.indexOf("blob:")===0||r.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let h;const f=t.FileName.slice(-3).toLowerCase();if(f==="tga"){const d=this.manager.getHandler(".tga");d===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",t.RelativeFilename),h=new Texture):(d.setPath(this.textureLoader.path),h=d.load(r))}else if(f==="dds"){const d=this.manager.getHandler(".dds");d===null?(console.warn("FBXLoader: DDS loader not found, creating placeholder texture for",t.RelativeFilename),h=new Texture):(d.setPath(this.textureLoader.path),h=d.load(r))}else f==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",t.RelativeFilename),h=new Texture):h=this.textureLoader.load(r);return this.textureLoader.setPath(a),h}parseMaterials(t){const n=new Map;if("Material"in fbxTree.Objects){const r=fbxTree.Objects.Material;for(const a in r){const u=this.parseMaterial(r[a],t);u!==null&&n.set(parseInt(a),u)}}return n}parseMaterial(t,n){const r=t.id,a=t.attrName;let u=t.ShadingModel;if(typeof u=="object"&&(u=u.value),!connections.has(r))return null;const h=this.parseParameters(t,n,r);let f;switch(u.toLowerCase()){case"phong":f=new MeshPhongMaterial;break;case"lambert":f=new MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',u),f=new MeshPhongMaterial;break}return f.setValues(h),f.name=a,f}parseParameters(t,n,r){const a={};t.BumpFactor&&(a.bumpScale=t.BumpFactor.value),t.Diffuse?a.color=new Color().fromArray(t.Diffuse.value).convertSRGBToLinear():t.DiffuseColor&&(t.DiffuseColor.type==="Color"||t.DiffuseColor.type==="ColorRGB")&&(a.color=new Color().fromArray(t.DiffuseColor.value).convertSRGBToLinear()),t.DisplacementFactor&&(a.displacementScale=t.DisplacementFactor.value),t.Emissive?a.emissive=new Color().fromArray(t.Emissive.value).convertSRGBToLinear():t.EmissiveColor&&(t.EmissiveColor.type==="Color"||t.EmissiveColor.type==="ColorRGB")&&(a.emissive=new Color().fromArray(t.EmissiveColor.value).convertSRGBToLinear()),t.EmissiveFactor&&(a.emissiveIntensity=parseFloat(t.EmissiveFactor.value)),t.Opacity&&(a.opacity=parseFloat(t.Opacity.value)),a.opacity<1&&(a.transparent=!0),t.ReflectionFactor&&(a.reflectivity=t.ReflectionFactor.value),t.Shininess&&(a.shininess=t.Shininess.value),t.Specular?a.specular=new Color().fromArray(t.Specular.value).convertSRGBToLinear():t.SpecularColor&&t.SpecularColor.type==="Color"&&(a.specular=new Color().fromArray(t.SpecularColor.value).convertSRGBToLinear());const u=this;return connections.get(r).children.forEach(function(h){const f=h.relationship;switch(f){case"Bump":a.bumpMap=u.getTexture(n,h.ID);break;case"Maya|TEX_ao_map":a.aoMap=u.getTexture(n,h.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":a.map=u.getTexture(n,h.ID),a.map!==void 0&&(a.map.colorSpace=SRGBColorSpace);break;case"DisplacementColor":a.displacementMap=u.getTexture(n,h.ID);break;case"EmissiveColor":a.emissiveMap=u.getTexture(n,h.ID),a.emissiveMap!==void 0&&(a.emissiveMap.colorSpace=SRGBColorSpace);break;case"NormalMap":case"Maya|TEX_normal_map":a.normalMap=u.getTexture(n,h.ID);break;case"ReflectionColor":a.envMap=u.getTexture(n,h.ID),a.envMap!==void 0&&(a.envMap.mapping=EquirectangularReflectionMapping,a.envMap.colorSpace=SRGBColorSpace);break;case"SpecularColor":a.specularMap=u.getTexture(n,h.ID),a.specularMap!==void 0&&(a.specularMap.colorSpace=SRGBColorSpace);break;case"TransparentColor":case"TransparencyFactor":a.alphaMap=u.getTexture(n,h.ID),a.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",f);break}}),a}getTexture(t,n){return"LayeredTexture"in fbxTree.Objects&&n in fbxTree.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=connections.get(n).children[0].ID),t.get(n)}parseDeformers(){const t={},n={};if("Deformer"in fbxTree.Objects){const r=fbxTree.Objects.Deformer;for(const a in r){const u=r[a],h=connections.get(parseInt(a));if(u.attrType==="Skin"){const f=this.parseSkeleton(h,r);f.ID=a,h.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),f.geometryID=h.parents[0].ID,t[a]=f}else if(u.attrType==="BlendShape"){const f={id:a};f.rawTargets=this.parseMorphTargets(h,r),f.id=a,h.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),n[a]=f}}}return{skeletons:t,morphTargets:n}}parseSkeleton(t,n){const r=[];return t.children.forEach(function(a){const u=n[a.ID];if(u.attrType!=="Cluster")return;const h={ID:a.ID,indices:[],weights:[],transformLink:new Matrix4().fromArray(u.TransformLink.a)};"Indexes"in u&&(h.indices=u.Indexes.a,h.weights=u.Weights.a),r.push(h)}),{rawBones:r,bones:[]}}parseMorphTargets(t,n){const r=[];for(let a=0;a<t.children.length;a++){const u=t.children[a],h=n[u.ID],f={name:h.attrName,initialWeight:h.DeformPercent,id:h.id,fullWeights:h.FullWeights.a};if(h.attrType!=="BlendShapeChannel")return;f.geoID=connections.get(parseInt(u.ID)).children.filter(function(d){return d.relationship===void 0})[0].ID,r.push(f)}return r}parseScene(t,n,r){sceneGraph=new Group;const a=this.parseModels(t.skeletons,n,r),u=fbxTree.Objects.Model,h=this;a.forEach(function(d){const p=u[d.ID];h.setLookAtProperties(d,p),connections.get(d.ID).parents.forEach(function(o){const e=a.get(o.ID);e!==void 0&&e.add(d)}),d.parent===null&&sceneGraph.add(d)}),this.bindSkeleton(t.skeletons,n,a),this.addGlobalSceneSettings(),sceneGraph.traverse(function(d){if(d.userData.transformData){d.parent&&(d.userData.transformData.parentMatrix=d.parent.matrix,d.userData.transformData.parentMatrixWorld=d.parent.matrixWorld);const p=generateTransform(d.userData.transformData);d.applyMatrix4(p),d.updateWorldMatrix()}});const f=new AnimationParser().parse();sceneGraph.children.length===1&&sceneGraph.children[0].isGroup&&(sceneGraph.children[0].animations=f,sceneGraph=sceneGraph.children[0]),sceneGraph.animations=f}parseModels(t,n,r){const a=new Map,u=fbxTree.Objects.Model;for(const h in u){const f=parseInt(h),d=u[h],p=connections.get(f);let c=this.buildSkeleton(p,t,f,d.attrName);if(!c){switch(d.attrType){case"Camera":c=this.createCamera(p);break;case"Light":c=this.createLight(p);break;case"Mesh":c=this.createMesh(p,n,r);break;case"NurbsCurve":c=this.createCurve(p,n);break;case"LimbNode":case"Root":c=new Bone;break;case"Null":default:c=new Group;break}c.name=d.attrName?PropertyBinding.sanitizeNodeName(d.attrName):"",c.userData.originalName=d.attrName,c.ID=f}this.getTransformData(c,d),a.set(f,c)}return a}buildSkeleton(t,n,r,a){let u=null;return t.parents.forEach(function(h){for(const f in n){const d=n[f];d.rawBones.forEach(function(p,c){if(p.ID===h.ID){const o=u;u=new Bone,u.matrixWorld.copy(p.transformLink),u.name=a?PropertyBinding.sanitizeNodeName(a):"",u.userData.originalName=a,u.ID=r,d.bones[c]=u,o!==null&&u.add(o)}})}}),u}createCamera(t){let n,r;if(t.children.forEach(function(a){const u=fbxTree.Objects.NodeAttribute[a.ID];u!==void 0&&(r=u)}),r===void 0)n=new Object3D;else{let a=0;r.CameraProjectionType!==void 0&&r.CameraProjectionType.value===1&&(a=1);let u=1;r.NearPlane!==void 0&&(u=r.NearPlane.value/1e3);let h=1e3;r.FarPlane!==void 0&&(h=r.FarPlane.value/1e3);let f=window.innerWidth,d=window.innerHeight;r.AspectWidth!==void 0&&r.AspectHeight!==void 0&&(f=r.AspectWidth.value,d=r.AspectHeight.value);const p=f/d;let c=45;r.FieldOfView!==void 0&&(c=r.FieldOfView.value);const o=r.FocalLength?r.FocalLength.value:null;switch(a){case 0:n=new PerspectiveCamera(c,p,u,h),o!==null&&n.setFocalLength(o);break;case 1:n=new OrthographicCamera(-f/2,f/2,d/2,-d/2,u,h);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+a+"."),n=new Object3D;break}}return n}createLight(t){let n,r;if(t.children.forEach(function(a){const u=fbxTree.Objects.NodeAttribute[a.ID];u!==void 0&&(r=u)}),r===void 0)n=new Object3D;else{let a;r.LightType===void 0?a=0:a=r.LightType.value;let u=16777215;r.Color!==void 0&&(u=new Color().fromArray(r.Color.value).convertSRGBToLinear());let h=r.Intensity===void 0?1:r.Intensity.value/100;r.CastLightOnObject!==void 0&&r.CastLightOnObject.value===0&&(h=0);let f=0;r.FarAttenuationEnd!==void 0&&(r.EnableFarAttenuation!==void 0&&r.EnableFarAttenuation.value===0?f=0:f=r.FarAttenuationEnd.value);const d=1;switch(a){case 0:n=new PointLight(u,h,f,d);break;case 1:n=new DirectionalLight(u,h);break;case 2:let p=Math.PI/3;r.InnerAngle!==void 0&&(p=MathUtils.degToRad(r.InnerAngle.value));let c=0;r.OuterAngle!==void 0&&(c=MathUtils.degToRad(r.OuterAngle.value),c=Math.max(c,1)),n=new SpotLight(u,h,f,p,c,d);break;default:console.warn("THREE.FBXLoader: Unknown light type "+r.LightType.value+", defaulting to a PointLight."),n=new PointLight(u,h);break}r.CastShadows!==void 0&&r.CastShadows.value===1&&(n.castShadow=!0)}return n}createMesh(t,n,r){let a,u=null,h=null;const f=[];return t.children.forEach(function(d){n.has(d.ID)&&(u=n.get(d.ID)),r.has(d.ID)&&f.push(r.get(d.ID))}),f.length>1?h=f:f.length>0?h=f[0]:(h=new MeshPhongMaterial({name:Loader.DEFAULT_MATERIAL_NAME,color:13421772}),f.push(h)),"color"in u.attributes&&f.forEach(function(d){d.vertexColors=!0}),u.FBX_Deformer?(a=new SkinnedMesh(u,h),a.normalizeSkinWeights()):a=new Mesh(u,h),a}createCurve(t,n){const r=t.children.reduce(function(u,h){return n.has(h.ID)&&(u=n.get(h.ID)),u},null),a=new LineBasicMaterial({name:Loader.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new Line(r,a)}getTransformData(t,n){const r={};"InheritType"in n&&(r.inheritType=parseInt(n.InheritType.value)),"RotationOrder"in n?r.eulerOrder=getEulerOrder(n.RotationOrder.value):r.eulerOrder="ZYX","Lcl_Translation"in n&&(r.translation=n.Lcl_Translation.value),"PreRotation"in n&&(r.preRotation=n.PreRotation.value),"Lcl_Rotation"in n&&(r.rotation=n.Lcl_Rotation.value),"PostRotation"in n&&(r.postRotation=n.PostRotation.value),"Lcl_Scaling"in n&&(r.scale=n.Lcl_Scaling.value),"ScalingOffset"in n&&(r.scalingOffset=n.ScalingOffset.value),"ScalingPivot"in n&&(r.scalingPivot=n.ScalingPivot.value),"RotationOffset"in n&&(r.rotationOffset=n.RotationOffset.value),"RotationPivot"in n&&(r.rotationPivot=n.RotationPivot.value),t.userData.transformData=r}setLookAtProperties(t,n){"LookAtProperty"in n&&connections.get(t.ID).children.forEach(function(a){if(a.relationship==="LookAtProperty"){const u=fbxTree.Objects.Model[a.ID];if("Lcl_Translation"in u){const h=u.Lcl_Translation.value;t.target!==void 0?(t.target.position.fromArray(h),sceneGraph.add(t.target)):t.lookAt(new Vector3().fromArray(h))}}})}bindSkeleton(t,n,r){const a=this.parsePoseNodes();for(const u in t){const h=t[u];connections.get(parseInt(h.ID)).parents.forEach(function(d){if(n.has(d.ID)){const p=d.ID;connections.get(p).parents.forEach(function(o){r.has(o.ID)&&r.get(o.ID).bind(new Skeleton(h.bones),a[o.ID])})}})}}parsePoseNodes(){const t={};if("Pose"in fbxTree.Objects){const n=fbxTree.Objects.Pose;for(const r in n)if(n[r].attrType==="BindPose"&&n[r].NbPoseNodes>0){const a=n[r].PoseNode;Array.isArray(a)?a.forEach(function(u){t[u.Node]=new Matrix4().fromArray(u.Matrix.a)}):t[a.Node]=new Matrix4().fromArray(a.Matrix.a)}}return t}addGlobalSceneSettings(){if("GlobalSettings"in fbxTree){if("AmbientColor"in fbxTree.GlobalSettings){const t=fbxTree.GlobalSettings.AmbientColor.value,n=t[0],r=t[1],a=t[2];if(n!==0||r!==0||a!==0){const u=new Color(n,r,a).convertSRGBToLinear();sceneGraph.add(new AmbientLight(u,1))}}"UnitScaleFactor"in fbxTree.GlobalSettings&&(sceneGraph.userData.unitScaleFactor=fbxTree.GlobalSettings.UnitScaleFactor.value)}}}class GeometryParser{constructor(){this.negativeMaterialIndices=!1}parse(t){const n=new Map;if("Geometry"in fbxTree.Objects){const r=fbxTree.Objects.Geometry;for(const a in r){const u=connections.get(parseInt(a)),h=this.parseGeometry(u,r[a],t);n.set(parseInt(a),h)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),n}parseGeometry(t,n,r){switch(n.attrType){case"Mesh":return this.parseMeshGeometry(t,n,r);case"NurbsCurve":return this.parseNurbsGeometry(n)}}parseMeshGeometry(t,n,r){const a=r.skeletons,u=[],h=t.parents.map(function(o){return fbxTree.Objects.Model[o.ID]});if(h.length===0)return;const f=t.children.reduce(function(o,e){return a[e.ID]!==void 0&&(o=a[e.ID]),o},null);t.children.forEach(function(o){r.morphTargets[o.ID]!==void 0&&u.push(r.morphTargets[o.ID])});const d=h[0],p={};"RotationOrder"in d&&(p.eulerOrder=getEulerOrder(d.RotationOrder.value)),"InheritType"in d&&(p.inheritType=parseInt(d.InheritType.value)),"GeometricTranslation"in d&&(p.translation=d.GeometricTranslation.value),"GeometricRotation"in d&&(p.rotation=d.GeometricRotation.value),"GeometricScaling"in d&&(p.scale=d.GeometricScaling.value);const c=generateTransform(p);return this.genGeometry(n,f,u,c)}genGeometry(t,n,r,a){const u=new BufferGeometry;t.attrName&&(u.name=t.attrName);const h=this.parseGeoNode(t,n),f=this.genBuffers(h),d=new Float32BufferAttribute(f.vertex,3);if(d.applyMatrix4(a),u.setAttribute("position",d),f.colors.length>0&&u.setAttribute("color",new Float32BufferAttribute(f.colors,3)),n&&(u.setAttribute("skinIndex",new Uint16BufferAttribute(f.weightsIndices,4)),u.setAttribute("skinWeight",new Float32BufferAttribute(f.vertexWeights,4)),u.FBX_Deformer=n),f.normal.length>0){const p=new Matrix3().getNormalMatrix(a),c=new Float32BufferAttribute(f.normal,3);c.applyNormalMatrix(p),u.setAttribute("normal",c)}if(f.uvs.forEach(function(p,c){const o=c===0?"uv":`uv${c}`;u.setAttribute(o,new Float32BufferAttribute(f.uvs[c],2))}),h.material&&h.material.mappingType!=="AllSame"){let p=f.materialIndex[0],c=0;if(f.materialIndex.forEach(function(o,e){o!==p&&(u.addGroup(c,e-c,p),p=o,c=e)}),u.groups.length>0){const o=u.groups[u.groups.length-1],e=o.start+o.count;e!==f.materialIndex.length&&u.addGroup(e,f.materialIndex.length-e,p)}u.groups.length===0&&u.addGroup(0,f.materialIndex.length,f.materialIndex[0])}return this.addMorphTargets(u,t,r,a),u}parseGeoNode(t,n){const r={};if(r.vertexPositions=t.Vertices!==void 0?t.Vertices.a:[],r.vertexIndices=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],t.LayerElementColor&&(r.color=this.parseVertexColors(t.LayerElementColor[0])),t.LayerElementMaterial&&(r.material=this.parseMaterialIndices(t.LayerElementMaterial[0])),t.LayerElementNormal&&(r.normal=this.parseNormals(t.LayerElementNormal[0])),t.LayerElementUV){r.uv=[];let a=0;for(;t.LayerElementUV[a];)t.LayerElementUV[a].UV&&r.uv.push(this.parseUVs(t.LayerElementUV[a])),a++}return r.weightTable={},n!==null&&(r.skeleton=n,n.rawBones.forEach(function(a,u){a.indices.forEach(function(h,f){r.weightTable[h]===void 0&&(r.weightTable[h]=[]),r.weightTable[h].push({id:u,weight:a.weights[f]})})})),r}genBuffers(t){const n={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let r=0,a=0,u=!1,h=[],f=[],d=[],p=[],c=[],o=[];const e=this;return t.vertexIndices.forEach(function(s,l){let g,y=!1;s<0&&(s=s^-1,y=!0);let b=[],_=[];if(h.push(s*3,s*3+1,s*3+2),t.color){const v=getData(l,r,s,t.color);d.push(v[0],v[1],v[2])}if(t.skeleton){if(t.weightTable[s]!==void 0&&t.weightTable[s].forEach(function(v){_.push(v.weight),b.push(v.id)}),_.length>4){u||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),u=!0);const v=[0,0,0,0],T=[0,0,0,0];_.forEach(function(w,A){let S=w,O=b[A];T.forEach(function(C,D,$){if(S>C){$[D]=S,S=C;const L=v[D];v[D]=O,O=L}})}),b=v,_=T}for(;_.length<4;)_.push(0),b.push(0);for(let v=0;v<4;++v)c.push(_[v]),o.push(b[v])}if(t.normal){const v=getData(l,r,s,t.normal);f.push(v[0],v[1],v[2])}t.material&&t.material.mappingType!=="AllSame"&&(g=getData(l,r,s,t.material)[0],g<0&&(e.negativeMaterialIndices=!0,g=0)),t.uv&&t.uv.forEach(function(v,T){const w=getData(l,r,s,v);p[T]===void 0&&(p[T]=[]),p[T].push(w[0]),p[T].push(w[1])}),a++,y&&(e.genFace(n,t,h,g,f,d,p,c,o,a),r++,a=0,h=[],f=[],d=[],p=[],c=[],o=[])}),n}getNormalNewell(t){const n=new Vector3(0,0,0);for(let r=0;r<t.length;r++){const a=t[r],u=t[(r+1)%t.length];n.x+=(a.y-u.y)*(a.z+u.z),n.y+=(a.z-u.z)*(a.x+u.x),n.z+=(a.x-u.x)*(a.y+u.y)}return n.normalize(),n}getNormalTangentAndBitangent(t){const n=this.getNormalNewell(t),a=(Math.abs(n.z)>.5?new Vector3(0,1,0):new Vector3(0,0,1)).cross(n).normalize(),u=n.clone().cross(a).normalize();return{normal:n,tangent:a,bitangent:u}}flattenVertex(t,n,r){return new Vector2(t.dot(n),t.dot(r))}genFace(t,n,r,a,u,h,f,d,p,c){let o;if(c>3){const e=[];for(let y=0;y<r.length;y+=3)e.push(new Vector3(n.vertexPositions[r[y]],n.vertexPositions[r[y+1]],n.vertexPositions[r[y+2]]));const{tangent:s,bitangent:l}=this.getNormalTangentAndBitangent(e),g=[];for(const y of e)g.push(this.flattenVertex(y,s,l));o=ShapeUtils.triangulateShape(g,[])}else o=[[0,1,2]];for(const[e,s,l]of o)t.vertex.push(n.vertexPositions[r[e*3]]),t.vertex.push(n.vertexPositions[r[e*3+1]]),t.vertex.push(n.vertexPositions[r[e*3+2]]),t.vertex.push(n.vertexPositions[r[s*3]]),t.vertex.push(n.vertexPositions[r[s*3+1]]),t.vertex.push(n.vertexPositions[r[s*3+2]]),t.vertex.push(n.vertexPositions[r[l*3]]),t.vertex.push(n.vertexPositions[r[l*3+1]]),t.vertex.push(n.vertexPositions[r[l*3+2]]),n.skeleton&&(t.vertexWeights.push(d[e*4]),t.vertexWeights.push(d[e*4+1]),t.vertexWeights.push(d[e*4+2]),t.vertexWeights.push(d[e*4+3]),t.vertexWeights.push(d[s*4]),t.vertexWeights.push(d[s*4+1]),t.vertexWeights.push(d[s*4+2]),t.vertexWeights.push(d[s*4+3]),t.vertexWeights.push(d[l*4]),t.vertexWeights.push(d[l*4+1]),t.vertexWeights.push(d[l*4+2]),t.vertexWeights.push(d[l*4+3]),t.weightsIndices.push(p[e*4]),t.weightsIndices.push(p[e*4+1]),t.weightsIndices.push(p[e*4+2]),t.weightsIndices.push(p[e*4+3]),t.weightsIndices.push(p[s*4]),t.weightsIndices.push(p[s*4+1]),t.weightsIndices.push(p[s*4+2]),t.weightsIndices.push(p[s*4+3]),t.weightsIndices.push(p[l*4]),t.weightsIndices.push(p[l*4+1]),t.weightsIndices.push(p[l*4+2]),t.weightsIndices.push(p[l*4+3])),n.color&&(t.colors.push(h[e*3]),t.colors.push(h[e*3+1]),t.colors.push(h[e*3+2]),t.colors.push(h[s*3]),t.colors.push(h[s*3+1]),t.colors.push(h[s*3+2]),t.colors.push(h[l*3]),t.colors.push(h[l*3+1]),t.colors.push(h[l*3+2])),n.material&&n.material.mappingType!=="AllSame"&&(t.materialIndex.push(a),t.materialIndex.push(a),t.materialIndex.push(a)),n.normal&&(t.normal.push(u[e*3]),t.normal.push(u[e*3+1]),t.normal.push(u[e*3+2]),t.normal.push(u[s*3]),t.normal.push(u[s*3+1]),t.normal.push(u[s*3+2]),t.normal.push(u[l*3]),t.normal.push(u[l*3+1]),t.normal.push(u[l*3+2])),n.uv&&n.uv.forEach(function(g,y){t.uvs[y]===void 0&&(t.uvs[y]=[]),t.uvs[y].push(f[y][e*2]),t.uvs[y].push(f[y][e*2+1]),t.uvs[y].push(f[y][s*2]),t.uvs[y].push(f[y][s*2+1]),t.uvs[y].push(f[y][l*2]),t.uvs[y].push(f[y][l*2+1])})}addMorphTargets(t,n,r,a){if(r.length===0)return;t.morphTargetsRelative=!0,t.morphAttributes.position=[];const u=this;r.forEach(function(h){h.rawTargets.forEach(function(f){const d=fbxTree.Objects.Geometry[f.geoID];d!==void 0&&u.genMorphGeometry(t,n,d,a,f.name)})})}genMorphGeometry(t,n,r,a,u){const h=n.PolygonVertexIndex!==void 0?n.PolygonVertexIndex.a:[],f=r.Vertices!==void 0?r.Vertices.a:[],d=r.Indexes!==void 0?r.Indexes.a:[],p=t.attributes.position.count*3,c=new Float32Array(p);for(let l=0;l<d.length;l++){const g=d[l]*3;c[g]=f[l*3],c[g+1]=f[l*3+1],c[g+2]=f[l*3+2]}const o={vertexIndices:h,vertexPositions:c},e=this.genBuffers(o),s=new Float32BufferAttribute(e.vertex,3);s.name=u||r.attrName,s.applyMatrix4(a),t.morphAttributes.position.push(s)}parseNormals(t){const n=t.MappingInformationType,r=t.ReferenceInformationType,a=t.Normals.a;let u=[];return r==="IndexToDirect"&&("NormalIndex"in t?u=t.NormalIndex.a:"NormalsIndex"in t&&(u=t.NormalsIndex.a)),{dataSize:3,buffer:a,indices:u,mappingType:n,referenceType:r}}parseUVs(t){const n=t.MappingInformationType,r=t.ReferenceInformationType,a=t.UV.a;let u=[];return r==="IndexToDirect"&&(u=t.UVIndex.a),{dataSize:2,buffer:a,indices:u,mappingType:n,referenceType:r}}parseVertexColors(t){const n=t.MappingInformationType,r=t.ReferenceInformationType,a=t.Colors.a;let u=[];r==="IndexToDirect"&&(u=t.ColorIndex.a);for(let h=0,f=new Color;h<a.length;h+=4)f.fromArray(a,h).convertSRGBToLinear().toArray(a,h);return{dataSize:4,buffer:a,indices:u,mappingType:n,referenceType:r}}parseMaterialIndices(t){const n=t.MappingInformationType,r=t.ReferenceInformationType;if(n==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};const a=t.Materials.a,u=[];for(let h=0;h<a.length;++h)u.push(h);return{dataSize:1,buffer:a,indices:u,mappingType:n,referenceType:r}}parseNurbsGeometry(t){const n=parseInt(t.Order);if(isNaN(n))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",t.Order,t.id),new BufferGeometry;const r=n-1,a=t.KnotVector.a,u=[],h=t.Points.a;for(let o=0,e=h.length;o<e;o+=4)u.push(new Vector4().fromArray(h,o));let f,d;if(t.Form==="Closed")u.push(u[0]);else if(t.Form==="Periodic"){f=r,d=a.length-1-f;for(let o=0;o<r;++o)u.push(u[o])}const c=new NURBSCurve(r,a,u,f,d).getPoints(u.length*12);return new BufferGeometry().setFromPoints(c)}}class AnimationParser{parse(){const t=[],n=this.parseClips();if(n!==void 0)for(const r in n){const a=n[r],u=this.addClip(a);t.push(u)}return t}parseClips(){if(fbxTree.Objects.AnimationCurve===void 0)return;const t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);const n=this.parseAnimationLayers(t);return this.parseAnimStacks(n)}parseAnimationCurveNodes(){const t=fbxTree.Objects.AnimationCurveNode,n=new Map;for(const r in t){const a=t[r];if(a.attrName.match(/S|R|T|DeformPercent/)!==null){const u={id:a.id,attr:a.attrName,curves:{}};n.set(u.id,u)}}return n}parseAnimationCurves(t){const n=fbxTree.Objects.AnimationCurve;for(const r in n){const a={id:n[r].id,times:n[r].KeyTime.a.map(convertFBXTimeToSeconds),values:n[r].KeyValueFloat.a},u=connections.get(a.id);if(u!==void 0){const h=u.parents[0].ID,f=u.parents[0].relationship;f.match(/X/)?t.get(h).curves.x=a:f.match(/Y/)?t.get(h).curves.y=a:f.match(/Z/)?t.get(h).curves.z=a:f.match(/DeformPercent/)&&t.has(h)&&(t.get(h).curves.morph=a)}}}parseAnimationLayers(t){const n=fbxTree.Objects.AnimationLayer,r=new Map;for(const a in n){const u=[],h=connections.get(parseInt(a));h!==void 0&&(h.children.forEach(function(d,p){if(t.has(d.ID)){const c=t.get(d.ID);if(c.curves.x!==void 0||c.curves.y!==void 0||c.curves.z!==void 0){if(u[p]===void 0){const o=connections.get(d.ID).parents.filter(function(e){return e.relationship!==void 0})[0].ID;if(o!==void 0){const e=fbxTree.Objects.Model[o.toString()];if(e===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",d);return}const s={modelName:e.attrName?PropertyBinding.sanitizeNodeName(e.attrName):"",ID:e.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};sceneGraph.traverse(function(l){l.ID===e.id&&(s.transform=l.matrix,l.userData.transformData&&(s.eulerOrder=l.userData.transformData.eulerOrder))}),s.transform||(s.transform=new Matrix4),"PreRotation"in e&&(s.preRotation=e.PreRotation.value),"PostRotation"in e&&(s.postRotation=e.PostRotation.value),u[p]=s}}u[p]&&(u[p][c.attr]=c)}else if(c.curves.morph!==void 0){if(u[p]===void 0){const o=connections.get(d.ID).parents.filter(function(b){return b.relationship!==void 0})[0].ID,e=connections.get(o).parents[0].ID,s=connections.get(e).parents[0].ID,l=connections.get(s).parents[0].ID,g=fbxTree.Objects.Model[l],y={modelName:g.attrName?PropertyBinding.sanitizeNodeName(g.attrName):"",morphName:fbxTree.Objects.Deformer[o].attrName};u[p]=y}u[p][c.attr]=c}}}),r.set(parseInt(a),u))}return r}parseAnimStacks(t){const n=fbxTree.Objects.AnimationStack,r={};for(const a in n){const u=connections.get(parseInt(a)).children;u.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const h=t.get(u[0].ID);r[a]={name:n[a].attrName,layer:h}}return r}addClip(t){let n=[];const r=this;return t.layer.forEach(function(a){n=n.concat(r.generateTracks(a))}),new AnimationClip(t.name,-1,n)}generateTracks(t){const n=[];let r=new Vector3,a=new Vector3;if(t.transform&&t.transform.decompose(r,new Quaternion,a),r=r.toArray(),a=a.toArray(),t.T!==void 0&&Object.keys(t.T.curves).length>0){const u=this.generateVectorTrack(t.modelName,t.T.curves,r,"position");u!==void 0&&n.push(u)}if(t.R!==void 0&&Object.keys(t.R.curves).length>0){const u=this.generateRotationTrack(t.modelName,t.R.curves,t.preRotation,t.postRotation,t.eulerOrder);u!==void 0&&n.push(u)}if(t.S!==void 0&&Object.keys(t.S.curves).length>0){const u=this.generateVectorTrack(t.modelName,t.S.curves,a,"scale");u!==void 0&&n.push(u)}if(t.DeformPercent!==void 0){const u=this.generateMorphTrack(t);u!==void 0&&n.push(u)}return n}generateVectorTrack(t,n,r,a){const u=this.getTimesForAllAxes(n),h=this.getKeyframeTrackValues(u,n,r);return new VectorKeyframeTrack(t+"."+a,u,h)}generateRotationTrack(t,n,r,a,u){let h,f;if(n.x!==void 0&&n.y!==void 0&&n.z!==void 0){const o=this.interpolateRotations(n.x,n.y,n.z,u);h=o[0],f=o[1]}r!==void 0&&(r=r.map(MathUtils.degToRad),r.push(u),r=new Euler().fromArray(r),r=new Quaternion().setFromEuler(r)),a!==void 0&&(a=a.map(MathUtils.degToRad),a.push(u),a=new Euler().fromArray(a),a=new Quaternion().setFromEuler(a).invert());const d=new Quaternion,p=new Euler,c=[];if(!f||!h)return new QuaternionKeyframeTrack(t+".quaternion",[],[]);for(let o=0;o<f.length;o+=3)p.set(f[o],f[o+1],f[o+2],u),d.setFromEuler(p),r!==void 0&&d.premultiply(r),a!==void 0&&d.multiply(a),o>2&&new Quaternion().fromArray(c,(o-3)/3*4).dot(d)<0&&d.set(-d.x,-d.y,-d.z,-d.w),d.toArray(c,o/3*4);return new QuaternionKeyframeTrack(t+".quaternion",h,c)}generateMorphTrack(t){const n=t.DeformPercent.curves.morph,r=n.values.map(function(u){return u/100}),a=sceneGraph.getObjectByName(t.modelName).morphTargetDictionary[t.morphName];return new NumberKeyframeTrack(t.modelName+".morphTargetInfluences["+a+"]",n.times,r)}getTimesForAllAxes(t){let n=[];if(t.x!==void 0&&(n=n.concat(t.x.times)),t.y!==void 0&&(n=n.concat(t.y.times)),t.z!==void 0&&(n=n.concat(t.z.times)),n=n.sort(function(r,a){return r-a}),n.length>1){let r=1,a=n[0];for(let u=1;u<n.length;u++){const h=n[u];h!==a&&(n[r]=h,a=h,r++)}n=n.slice(0,r)}return n}getKeyframeTrackValues(t,n,r){const a=r,u=[];let h=-1,f=-1,d=-1;return t.forEach(function(p){if(n.x&&(h=n.x.times.indexOf(p)),n.y&&(f=n.y.times.indexOf(p)),n.z&&(d=n.z.times.indexOf(p)),h!==-1){const c=n.x.values[h];u.push(c),a[0]=c}else u.push(a[0]);if(f!==-1){const c=n.y.values[f];u.push(c),a[1]=c}else u.push(a[1]);if(d!==-1){const c=n.z.values[d];u.push(c),a[2]=c}else u.push(a[2])}),u}interpolateRotations(t,n,r,a){const u=[],h=[];u.push(t.times[0]),h.push(MathUtils.degToRad(t.values[0])),h.push(MathUtils.degToRad(n.values[0])),h.push(MathUtils.degToRad(r.values[0]));for(let f=1;f<t.values.length;f++){const d=[t.values[f-1],n.values[f-1],r.values[f-1]];if(isNaN(d[0])||isNaN(d[1])||isNaN(d[2]))continue;const p=d.map(MathUtils.degToRad),c=[t.values[f],n.values[f],r.values[f]];if(isNaN(c[0])||isNaN(c[1])||isNaN(c[2]))continue;const o=c.map(MathUtils.degToRad),e=[c[0]-d[0],c[1]-d[1],c[2]-d[2]],s=[Math.abs(e[0]),Math.abs(e[1]),Math.abs(e[2])];if(s[0]>=180||s[1]>=180||s[2]>=180){const g=Math.max(...s)/180,y=new Euler(...p,a),b=new Euler(...o,a),_=new Quaternion().setFromEuler(y),v=new Quaternion().setFromEuler(b);_.dot(v)&&v.set(-v.x,-v.y,-v.z,-v.w);const T=t.times[f-1],w=t.times[f]-T,A=new Quaternion,S=new Euler;for(let O=0;O<1;O+=1/g)A.copy(_.clone().slerp(v.clone(),O)),u.push(T+O*w),S.setFromQuaternion(A,a),h.push(S.x),h.push(S.y),h.push(S.z)}else u.push(t.times[f]),h.push(MathUtils.degToRad(t.values[f])),h.push(MathUtils.degToRad(n.values[f])),h.push(MathUtils.degToRad(r.values[f]))}return[u,h]}}class TextParser{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(t){this.nodeStack.push(t),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(t,n){this.currentProp=t,this.currentPropName=n}parse(t){this.currentIndent=0,this.allNodes=new FBXTree,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const n=this,r=t.split(/[\r\n]+/);return r.forEach(function(a,u){const h=a.match(/^[\s\t]*;/),f=a.match(/^[\s\t]*$/);if(h||f)return;const d=a.match("^\\t{"+n.currentIndent+"}(\\w+):(.*){",""),p=a.match("^\\t{"+n.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),c=a.match("^\\t{"+(n.currentIndent-1)+"}}");d?n.parseNodeBegin(a,d):p?n.parseNodeProperty(a,p,r[++u]):c?n.popStack():a.match(/^[^\s\t}]/)&&n.parseNodePropertyContinued(a)}),this.allNodes}parseNodeBegin(t,n){const r=n[1].trim().replace(/^"/,"").replace(/"$/,""),a=n[2].split(",").map(function(d){return d.trim().replace(/^"/,"").replace(/"$/,"")}),u={name:r},h=this.parseNodeAttr(a),f=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(r,u):r in f?(r==="PoseNode"?f.PoseNode.push(u):f[r].id!==void 0&&(f[r]={},f[r][f[r].id]=f[r]),h.id!==""&&(f[r][h.id]=u)):typeof h.id=="number"?(f[r]={},f[r][h.id]=u):r!=="Properties70"&&(r==="PoseNode"?f[r]=[u]:f[r]=u),typeof h.id=="number"&&(u.id=h.id),h.name!==""&&(u.attrName=h.name),h.type!==""&&(u.attrType=h.type),this.pushStack(u)}parseNodeAttr(t){let n=t[0];t[0]!==""&&(n=parseInt(t[0]),isNaN(n)&&(n=t[0]));let r="",a="";return t.length>1&&(r=t[1].replace(/^(\w+)::/,""),a=t[2]),{id:n,name:r,type:a}}parseNodeProperty(t,n,r){let a=n[1].replace(/^"/,"").replace(/"$/,"").trim(),u=n[2].replace(/^"/,"").replace(/"$/,"").trim();a==="Content"&&u===","&&(u=r.replace(/"/g,"").replace(/,$/,"").trim());const h=this.getCurrentNode();if(h.name==="Properties70"){this.parseNodeSpecialProperty(t,a,u);return}if(a==="C"){const d=u.split(",").slice(1),p=parseInt(d[0]),c=parseInt(d[1]);let o=u.split(",").slice(3);o=o.map(function(e){return e.trim().replace(/^"/,"")}),a="connections",u=[p,c],append(u,o),h[a]===void 0&&(h[a]=[])}a==="Node"&&(h.id=u),a in h&&Array.isArray(h[a])?h[a].push(u):a!=="a"?h[a]=u:h.a=u,this.setCurrentProp(h,a),a==="a"&&u.slice(-1)!==","&&(h.a=parseNumberArray(u))}parseNodePropertyContinued(t){const n=this.getCurrentNode();n.a+=t,t.slice(-1)!==","&&(n.a=parseNumberArray(n.a))}parseNodeSpecialProperty(t,n,r){const a=r.split('",').map(function(c){return c.trim().replace(/^\"/,"").replace(/\s/,"_")}),u=a[0],h=a[1],f=a[2],d=a[3];let p=a[4];switch(h){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":p=parseFloat(p);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":p=parseNumberArray(p);break}this.getPrevNode()[u]={type:h,type2:f,flag:d,value:p},this.setCurrentProp(this.getPrevNode(),u)}}class BinaryParser{parse(t){const n=new BinaryReader(t);n.skip(23);const r=n.getUint32();if(r<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+r);const a=new FBXTree;for(;!this.endOfContent(n);){const u=this.parseNode(n,r);u!==null&&a.add(u.name,u)}return a}endOfContent(t){return t.size()%16===0?(t.getOffset()+160+16&-16)>=t.size():t.getOffset()+160+16>=t.size()}parseNode(t,n){const r={},a=n>=7500?t.getUint64():t.getUint32(),u=n>=7500?t.getUint64():t.getUint32();n>=7500?t.getUint64():t.getUint32();const h=t.getUint8(),f=t.getString(h);if(a===0)return null;const d=[];for(let e=0;e<u;e++)d.push(this.parseProperty(t));const p=d.length>0?d[0]:"",c=d.length>1?d[1]:"",o=d.length>2?d[2]:"";for(r.singleProperty=u===1&&t.getOffset()===a;a>t.getOffset();){const e=this.parseNode(t,n);e!==null&&this.parseSubNode(f,r,e)}return r.propertyList=d,typeof p=="number"&&(r.id=p),c!==""&&(r.attrName=c),o!==""&&(r.attrType=o),f!==""&&(r.name=f),r}parseSubNode(t,n,r){if(r.singleProperty===!0){const a=r.propertyList[0];Array.isArray(a)?(n[r.name]=r,r.a=a):n[r.name]=a}else if(t==="Connections"&&r.name==="C"){const a=[];r.propertyList.forEach(function(u,h){h!==0&&a.push(u)}),n.connections===void 0&&(n.connections=[]),n.connections.push(a)}else if(r.name==="Properties70")Object.keys(r).forEach(function(u){n[u]=r[u]});else if(t==="Properties70"&&r.name==="P"){let a=r.propertyList[0],u=r.propertyList[1];const h=r.propertyList[2],f=r.propertyList[3];let d;a.indexOf("Lcl ")===0&&(a=a.replace("Lcl ","Lcl_")),u.indexOf("Lcl ")===0&&(u=u.replace("Lcl ","Lcl_")),u==="Color"||u==="ColorRGB"||u==="Vector"||u==="Vector3D"||u.indexOf("Lcl_")===0?d=[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:d=r.propertyList[4],n[a]={type:u,type2:h,flag:f,value:d}}else n[r.name]===void 0?typeof r.id=="number"?(n[r.name]={},n[r.name][r.id]=r):n[r.name]=r:r.name==="PoseNode"?(Array.isArray(n[r.name])||(n[r.name]=[n[r.name]]),n[r.name].push(r)):n[r.name][r.id]===void 0&&(n[r.name][r.id]=r)}parseProperty(t){const n=t.getString(1);let r;switch(n){case"C":return t.getBoolean();case"D":return t.getFloat64();case"F":return t.getFloat32();case"I":return t.getInt32();case"L":return t.getInt64();case"R":return r=t.getUint32(),t.getArrayBuffer(r);case"S":return r=t.getUint32(),t.getString(r);case"Y":return t.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const a=t.getUint32(),u=t.getUint32(),h=t.getUint32();if(u===0)switch(n){case"b":case"c":return t.getBooleanArray(a);case"d":return t.getFloat64Array(a);case"f":return t.getFloat32Array(a);case"i":return t.getInt32Array(a);case"l":return t.getInt64Array(a)}const f=unzlibSync(new Uint8Array(t.getArrayBuffer(h))),d=new BinaryReader(f.buffer);switch(n){case"b":case"c":return d.getBooleanArray(a);case"d":return d.getFloat64Array(a);case"f":return d.getFloat32Array(a);case"i":return d.getInt32Array(a);case"l":return d.getInt64Array(a)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+n)}}}class BinaryReader{constructor(t,n){this.dv=new DataView(t),this.offset=0,this.littleEndian=n!==void 0?n:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(t){this.offset+=t}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(t){const n=[];for(let r=0;r<t;r++)n.push(this.getBoolean());return n}getUint8(){const t=this.dv.getUint8(this.offset);return this.offset+=1,t}getInt16(){const t=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}getInt32(){const t=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}getInt32Array(t){const n=[];for(let r=0;r<t;r++)n.push(this.getInt32());return n}getUint32(){const t=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}getInt64(){let t,n;return this.littleEndian?(t=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),t=this.getUint32()),n&2147483648?(n=~n&4294967295,t=~t&4294967295,t===4294967295&&(n=n+1&4294967295),t=t+1&4294967295,-(n*4294967296+t)):n*4294967296+t}getInt64Array(t){const n=[];for(let r=0;r<t;r++)n.push(this.getInt64());return n}getUint64(){let t,n;return this.littleEndian?(t=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),t=this.getUint32()),n*4294967296+t}getFloat32(){const t=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}getFloat32Array(t){const n=[];for(let r=0;r<t;r++)n.push(this.getFloat32());return n}getFloat64(){const t=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}getFloat64Array(t){const n=[];for(let r=0;r<t;r++)n.push(this.getFloat64());return n}getArrayBuffer(t){const n=this.dv.buffer.slice(this.offset,this.offset+t);return this.offset+=t,n}getString(t){const n=this.offset;let r=new Uint8Array(this.dv.buffer,n,t);this.skip(t);const a=r.indexOf(0);return a>=0&&(r=new Uint8Array(this.dv.buffer,n,a)),this._textDecoder.decode(r)}}class FBXTree{add(t,n){this[t]=n}}function isFbxFormatBinary(m){const t="Kaydara FBX Binary  \0";return m.byteLength>=t.length&&t===convertArrayBufferToString(m,0,t.length)}function isFbxFormatASCII(m){const t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function r(a){const u=m[a-1];return m=m.slice(n+a),n++,u}for(let a=0;a<t.length;++a)if(r(1)===t[a])return!1;return!0}function getFbxVersion(m){const t=/FBXVersion: (\d+)/,n=m.match(t);if(n)return parseInt(n[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function convertFBXTimeToSeconds(m){return m/46186158e3}const dataArray=[];function getData(m,t,n,r){let a;switch(r.mappingType){case"ByPolygonVertex":a=m;break;case"ByPolygon":a=t;break;case"ByVertice":a=n;break;case"AllSame":a=r.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+r.mappingType)}r.referenceType==="IndexToDirect"&&(a=r.indices[a]);const u=a*r.dataSize,h=u+r.dataSize;return slice(dataArray,r.buffer,u,h)}const tempEuler=new Euler,tempVec=new Vector3;function generateTransform(m){const t=new Matrix4,n=new Matrix4,r=new Matrix4,a=new Matrix4,u=new Matrix4,h=new Matrix4,f=new Matrix4,d=new Matrix4,p=new Matrix4,c=new Matrix4,o=new Matrix4,e=new Matrix4,s=m.inheritType?m.inheritType:0;if(m.translation&&t.setPosition(tempVec.fromArray(m.translation)),m.preRotation){const D=m.preRotation.map(MathUtils.degToRad);D.push(m.eulerOrder||Euler.DEFAULT_ORDER),n.makeRotationFromEuler(tempEuler.fromArray(D))}if(m.rotation){const D=m.rotation.map(MathUtils.degToRad);D.push(m.eulerOrder||Euler.DEFAULT_ORDER),r.makeRotationFromEuler(tempEuler.fromArray(D))}if(m.postRotation){const D=m.postRotation.map(MathUtils.degToRad);D.push(m.eulerOrder||Euler.DEFAULT_ORDER),a.makeRotationFromEuler(tempEuler.fromArray(D)),a.invert()}m.scale&&u.scale(tempVec.fromArray(m.scale)),m.scalingOffset&&f.setPosition(tempVec.fromArray(m.scalingOffset)),m.scalingPivot&&h.setPosition(tempVec.fromArray(m.scalingPivot)),m.rotationOffset&&d.setPosition(tempVec.fromArray(m.rotationOffset)),m.rotationPivot&&p.setPosition(tempVec.fromArray(m.rotationPivot)),m.parentMatrixWorld&&(o.copy(m.parentMatrix),c.copy(m.parentMatrixWorld));const l=n.clone().multiply(r).multiply(a),g=new Matrix4;g.extractRotation(c);const y=new Matrix4;y.copyPosition(c);const b=y.clone().invert().multiply(c),_=g.clone().invert().multiply(b),v=u,T=new Matrix4;if(s===0)T.copy(g).multiply(l).multiply(_).multiply(v);else if(s===1)T.copy(g).multiply(_).multiply(l).multiply(v);else{const $=new Matrix4().scale(new Vector3().setFromMatrixScale(o)).clone().invert(),L=_.clone().multiply($);T.copy(g).multiply(l).multiply(L).multiply(v)}const w=p.clone().invert(),A=h.clone().invert();let S=t.clone().multiply(d).multiply(p).multiply(n).multiply(r).multiply(a).multiply(w).multiply(f).multiply(h).multiply(u).multiply(A);const O=new Matrix4().copyPosition(S),C=c.clone().multiply(O);return e.copyPosition(C),S=e.clone().multiply(T),S.premultiply(c.invert()),S}function getEulerOrder(m){m=m||0;const t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return m===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[m]}function parseNumberArray(m){return m.split(",").map(function(n){return parseFloat(n)})}function convertArrayBufferToString(m,t,n){return t===void 0&&(t=0),n===void 0&&(n=m.byteLength),new TextDecoder().decode(new Uint8Array(m,t,n))}function append(m,t){for(let n=0,r=m.length,a=t.length;n<a;n++,r++)m[r]=t[n]}function slice(m,t,n,r){for(let a=n,u=0;a<r;a++,u++)m[u]=t[a];return m}const _object_pattern=/^[og]\s*(.+)?/,_material_library_pattern=/^mtllib /,_material_use_pattern=/^usemtl /,_map_use_pattern=/^usemap /,_face_vertex_data_separator_pattern=/\s+/,_vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_ab=new Vector3,_cb=new Vector3,_color=new Color;function ParserState(){const m={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,n){if(this.object&&this.object.fromDeclaration===!1){this.object.name=t,this.object.fromDeclaration=n!==!1;return}const r=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:n!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(a,u){const h=this._finalize(!1);h&&(h.inherited||h.groupCount<=0)&&this.materials.splice(h.index,1);const f={index:this.materials.length,name:a||"",mtllib:Array.isArray(u)&&u.length>0?u[u.length-1]:"",smooth:h!==void 0?h.smooth:this.smooth,groupStart:h!==void 0?h.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(d){const p={index:typeof d=="number"?d:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return p.clone=this.clone.bind(p),p}};return this.materials.push(f),f},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(a){const u=this.currentMaterial();if(u&&u.groupEnd===-1&&(u.groupEnd=this.geometry.vertices.length/3,u.groupCount=u.groupEnd-u.groupStart,u.inherited=!1),a&&this.materials.length>1)for(let h=this.materials.length-1;h>=0;h--)this.materials[h].groupCount<=0&&this.materials.splice(h,1);return a&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),u}},r&&r.name&&typeof r.clone=="function"){const a=r.clone(0);a.inherited=!0,this.object.materials.push(a)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(t,n){const r=parseInt(t,10);return(r>=0?r-1:r+n/3)*3},parseNormalIndex:function(t,n){const r=parseInt(t,10);return(r>=0?r-1:r+n/3)*3},parseUVIndex:function(t,n){const r=parseInt(t,10);return(r>=0?r-1:r+n/2)*2},addVertex:function(t,n,r){const a=this.vertices,u=this.object.geometry.vertices;u.push(a[t+0],a[t+1],a[t+2]),u.push(a[n+0],a[n+1],a[n+2]),u.push(a[r+0],a[r+1],a[r+2])},addVertexPoint:function(t){const n=this.vertices;this.object.geometry.vertices.push(n[t+0],n[t+1],n[t+2])},addVertexLine:function(t){const n=this.vertices;this.object.geometry.vertices.push(n[t+0],n[t+1],n[t+2])},addNormal:function(t,n,r){const a=this.normals,u=this.object.geometry.normals;u.push(a[t+0],a[t+1],a[t+2]),u.push(a[n+0],a[n+1],a[n+2]),u.push(a[r+0],a[r+1],a[r+2])},addFaceNormal:function(t,n,r){const a=this.vertices,u=this.object.geometry.normals;_vA.fromArray(a,t),_vB.fromArray(a,n),_vC.fromArray(a,r),_cb.subVectors(_vC,_vB),_ab.subVectors(_vA,_vB),_cb.cross(_ab),_cb.normalize(),u.push(_cb.x,_cb.y,_cb.z),u.push(_cb.x,_cb.y,_cb.z),u.push(_cb.x,_cb.y,_cb.z)},addColor:function(t,n,r){const a=this.colors,u=this.object.geometry.colors;a[t]!==void 0&&u.push(a[t+0],a[t+1],a[t+2]),a[n]!==void 0&&u.push(a[n+0],a[n+1],a[n+2]),a[r]!==void 0&&u.push(a[r+0],a[r+1],a[r+2])},addUV:function(t,n,r){const a=this.uvs,u=this.object.geometry.uvs;u.push(a[t+0],a[t+1]),u.push(a[n+0],a[n+1]),u.push(a[r+0],a[r+1])},addDefaultUV:function(){const t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){const n=this.uvs;this.object.geometry.uvs.push(n[t+0],n[t+1])},addFace:function(t,n,r,a,u,h,f,d,p){const c=this.vertices.length;let o=this.parseVertexIndex(t,c),e=this.parseVertexIndex(n,c),s=this.parseVertexIndex(r,c);if(this.addVertex(o,e,s),this.addColor(o,e,s),f!==void 0&&f!==""){const l=this.normals.length;o=this.parseNormalIndex(f,l),e=this.parseNormalIndex(d,l),s=this.parseNormalIndex(p,l),this.addNormal(o,e,s)}else this.addFaceNormal(o,e,s);if(a!==void 0&&a!==""){const l=this.uvs.length;o=this.parseUVIndex(a,l),e=this.parseUVIndex(u,l),s=this.parseUVIndex(h,l),this.addUV(o,e,s),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";const n=this.vertices.length;for(let r=0,a=t.length;r<a;r++){const u=this.parseVertexIndex(t[r],n);this.addVertexPoint(u),this.addColor(u)}},addLineGeometry:function(t,n){this.object.geometry.type="Line";const r=this.vertices.length,a=this.uvs.length;for(let u=0,h=t.length;u<h;u++)this.addVertexLine(this.parseVertexIndex(t[u],r));for(let u=0,h=n.length;u<h;u++)this.addUVLine(this.parseUVIndex(n[u],a))}};return m.startObject("",!1),m}class OBJLoader extends Loader{constructor(t){super(t),this.materials=null}load(t,n,r,a){const u=this,h=new FileLoader(this.manager);h.setPath(this.path),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(t,function(f){try{n(u.parse(f))}catch(d){a?a(d):console.error(d),u.manager.itemError(t)}},r,a)}setMaterials(t){return this.materials=t,this}parse(t){const n=new ParserState;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const r=t.split(`
`);let a=[];for(let f=0,d=r.length;f<d;f++){const p=r[f].trimStart();if(p.length===0)continue;const c=p.charAt(0);if(c!=="#")if(c==="v"){const o=p.split(_face_vertex_data_separator_pattern);switch(o[0]){case"v":n.vertices.push(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3])),o.length>=7?(_color.setRGB(parseFloat(o[4]),parseFloat(o[5]),parseFloat(o[6])).convertSRGBToLinear(),n.colors.push(_color.r,_color.g,_color.b)):n.colors.push(void 0,void 0,void 0);break;case"vn":n.normals.push(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]));break;case"vt":n.uvs.push(parseFloat(o[1]),parseFloat(o[2]));break}}else if(c==="f"){const e=p.slice(1).trim().split(_face_vertex_data_separator_pattern),s=[];for(let g=0,y=e.length;g<y;g++){const b=e[g];if(b.length>0){const _=b.split("/");s.push(_)}}const l=s[0];for(let g=1,y=s.length-1;g<y;g++){const b=s[g],_=s[g+1];n.addFace(l[0],b[0],_[0],l[1],b[1],_[1],l[2],b[2],_[2])}}else if(c==="l"){const o=p.substring(1).trim().split(" ");let e=[];const s=[];if(p.indexOf("/")===-1)e=o;else for(let l=0,g=o.length;l<g;l++){const y=o[l].split("/");y[0]!==""&&e.push(y[0]),y[1]!==""&&s.push(y[1])}n.addLineGeometry(e,s)}else if(c==="p"){const e=p.slice(1).trim().split(" ");n.addPointGeometry(e)}else if((a=_object_pattern.exec(p))!==null){const o=(" "+a[0].slice(1).trim()).slice(1);n.startObject(o)}else if(_material_use_pattern.test(p))n.object.startMaterial(p.substring(7).trim(),n.materialLibraries);else if(_material_library_pattern.test(p))n.materialLibraries.push(p.substring(7).trim());else if(_map_use_pattern.test(p))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(c==="s"){if(a=p.split(" "),a.length>1){const e=a[1].trim().toLowerCase();n.object.smooth=e!=="0"&&e!=="off"}else n.object.smooth=!0;const o=n.object.currentMaterial();o&&(o.smooth=n.object.smooth)}else{if(p==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+p+'"')}}n.finalize();const u=new Group;if(u.materialLibraries=[].concat(n.materialLibraries),!(n.objects.length===1&&n.objects[0].geometry.vertices.length===0)===!0)for(let f=0,d=n.objects.length;f<d;f++){const p=n.objects[f],c=p.geometry,o=p.materials,e=c.type==="Line",s=c.type==="Points";let l=!1;if(c.vertices.length===0)continue;const g=new BufferGeometry;g.setAttribute("position",new Float32BufferAttribute(c.vertices,3)),c.normals.length>0&&g.setAttribute("normal",new Float32BufferAttribute(c.normals,3)),c.colors.length>0&&(l=!0,g.setAttribute("color",new Float32BufferAttribute(c.colors,3))),c.hasUVIndices===!0&&g.setAttribute("uv",new Float32BufferAttribute(c.uvs,2));const y=[];for(let _=0,v=o.length;_<v;_++){const T=o[_],w=T.name+"_"+T.smooth+"_"+l;let A=n.materials[w];if(this.materials!==null){if(A=this.materials.create(T.name),e&&A&&!(A instanceof LineBasicMaterial)){const S=new LineBasicMaterial;Material.prototype.copy.call(S,A),S.color.copy(A.color),A=S}else if(s&&A&&!(A instanceof PointsMaterial)){const S=new PointsMaterial({size:10,sizeAttenuation:!1});Material.prototype.copy.call(S,A),S.color.copy(A.color),S.map=A.map,A=S}}A===void 0&&(e?A=new LineBasicMaterial:s?A=new PointsMaterial({size:1,sizeAttenuation:!1}):A=new MeshPhongMaterial,A.name=T.name,A.flatShading=!T.smooth,A.vertexColors=l,n.materials[w]=A),y.push(A)}let b;if(y.length>1){for(let _=0,v=o.length;_<v;_++){const T=o[_];g.addGroup(T.groupStart,T.groupCount,_)}e?b=new LineSegments(g,y):s?b=new Points(g,y):b=new Mesh(g,y)}else e?b=new LineSegments(g,y[0]):s?b=new Points(g,y[0]):b=new Mesh(g,y[0]);b.name=p.name,u.add(b)}else if(n.vertices.length>0){const f=new PointsMaterial({size:1,sizeAttenuation:!1}),d=new BufferGeometry;d.setAttribute("position",new Float32BufferAttribute(n.vertices,3)),n.colors.length>0&&n.colors[0]!==void 0&&(d.setAttribute("color",new Float32BufferAttribute(n.colors,3)),f.vertexColors=!0);const p=new Points(d,f);u.add(p)}return u}}window.assets={};window.style={mean:[0,0,0],std:[1,1,1]};window.light={position:[1,0,0],color:[1,1,1],ambient:[.5,.5,.5]};async function load3DObject(m){let t=new OBJLoader;m.slice(-3)=="fbx"&&(t=new FBXLoader);const n=await t.loadAsync(m),r={};return n.traverse(a=>{if(a instanceof Mesh){console.log(a);for(const[u,h]of Object.entries(a.geometry.attributes))(u=="position"||u=="normal"||u=="uv")&&(r[u]={numComponents:h.itemSize,data:h.array})}}),r}async function loadAssets(){await Promise.all([(async()=>{window.assets.session=await ort_minExports.InferenceSession.create("resources/model32.onnx",{executionProviders:["webgl"]})})(),(async()=>{window.assets.objectBuffer=await load3DObject("resources/chocobunnyking.obj")})(),(async()=>{window.assets.sphereBuffer=await load3DObject("resources/sphere_smooth.obj")})()]),console.log("loading assets is done.")}function iota$1(m){for(var t=new Array(m),n=0;n<m;++n)t[n]=n;return t}var iota_1=iota$1;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var isBuffer_1=function(m){return m!=null&&(isBuffer$1(m)||isSlowBuffer(m)||!!m._isBuffer)};function isBuffer$1(m){return!!m.constructor&&typeof m.constructor.isBuffer=="function"&&m.constructor.isBuffer(m)}function isSlowBuffer(m){return typeof m.readFloatLE=="function"&&typeof m.slice=="function"&&isBuffer$1(m.slice(0,0))}var iota=iota_1,isBuffer=isBuffer_1,hasTypedArrays=typeof Float64Array<"u";function compare1st(m,t){return m[0]-t[0]}function order(){var m=this.stride,t=new Array(m.length),n;for(n=0;n<t.length;++n)t[n]=[Math.abs(m[n]),n];t.sort(compare1st);var r=new Array(t.length);for(n=0;n<r.length;++n)r[n]=t[n][1];return r}function compileConstructor(m,t){var n=["View",t,"d",m].join("");t<0&&(n="View_Nil"+m);var r=m==="generic";if(t===-1){var a="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+m+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}",g=new Function(a);return g()}else if(t===0){var a="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+m+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",g=new Function("TrivialArray",a);return g(CACHED_CONSTRUCTORS[m][0])}var a=["'use strict'"],u=iota(t),h=u.map(function(y){return"i"+y}),f="this.offset+"+u.map(function(y){return"this.stride["+y+"]*i"+y}).join("+"),d=u.map(function(y){return"b"+y}).join(","),p=u.map(function(y){return"c"+y}).join(",");a.push("function "+n+"(a,"+d+","+p+",d){this.data=a","this.shape=["+d+"]","this.stride=["+p+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+m+"'","proto.dimension="+t),a.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+u.map(function(y){return"this.shape["+y+"]"}).join("*"),"}})"),t===1?a.push("proto.order=[0]"):(a.push("Object.defineProperty(proto,'order',{get:"),t<4?(a.push("function "+n+"_order(){"),t===2?a.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):t===3&&a.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):a.push("ORDER})")),a.push("proto.set=function "+n+"_set("+h.join(",")+",v){"),r?a.push("return this.data.set("+f+",v)}"):a.push("return this.data["+f+"]=v}"),a.push("proto.get=function "+n+"_get("+h.join(",")+"){"),r?a.push("return this.data.get("+f+")}"):a.push("return this.data["+f+"]}"),a.push("proto.index=function "+n+"_index(",h.join(),"){return "+f+"}"),a.push("proto.hi=function "+n+"_hi("+h.join(",")+"){return new "+n+"(this.data,"+u.map(function(y){return["(typeof i",y,"!=='number'||i",y,"<0)?this.shape[",y,"]:i",y,"|0"].join("")}).join(",")+","+u.map(function(y){return"this.stride["+y+"]"}).join(",")+",this.offset)}");var c=u.map(function(y){return"a"+y+"=this.shape["+y+"]"}),o=u.map(function(y){return"c"+y+"=this.stride["+y+"]"});a.push("proto.lo=function "+n+"_lo("+h.join(",")+"){var b=this.offset,d=0,"+c.join(",")+","+o.join(","));for(var e=0;e<t;++e)a.push("if(typeof i"+e+"==='number'&&i"+e+">=0){d=i"+e+"|0;b+=c"+e+"*d;a"+e+"-=d}");a.push("return new "+n+"(this.data,"+u.map(function(y){return"a"+y}).join(",")+","+u.map(function(y){return"c"+y}).join(",")+",b)}"),a.push("proto.step=function "+n+"_step("+h.join(",")+"){var "+u.map(function(y){return"a"+y+"=this.shape["+y+"]"}).join(",")+","+u.map(function(y){return"b"+y+"=this.stride["+y+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var e=0;e<t;++e)a.push("if(typeof i"+e+"==='number'){d=i"+e+"|0;if(d<0){c+=b"+e+"*(a"+e+"-1);a"+e+"=ceil(-a"+e+"/d)}else{a"+e+"=ceil(a"+e+"/d)}b"+e+"*=d}");a.push("return new "+n+"(this.data,"+u.map(function(y){return"a"+y}).join(",")+","+u.map(function(y){return"b"+y}).join(",")+",c)}");for(var s=new Array(t),l=new Array(t),e=0;e<t;++e)s[e]="a[i"+e+"]",l[e]="b[i"+e+"]";a.push("proto.transpose=function "+n+"_transpose("+h+"){"+h.map(function(y,b){return y+"=("+y+"===undefined?"+b+":"+y+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+s.join(",")+","+l.join(",")+",this.offset)}"),a.push("proto.pick=function "+n+"_pick("+h+"){var a=[],b=[],c=this.offset");for(var e=0;e<t;++e)a.push("if(typeof i"+e+"==='number'&&i"+e+">=0){c=(c+this.stride["+e+"]*i"+e+")|0}else{a.push(this.shape["+e+"]);b.push(this.stride["+e+"])}");a.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),a.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+u.map(function(y){return"shape["+y+"]"}).join(",")+","+u.map(function(y){return"stride["+y+"]"}).join(",")+",offset)}");var g=new Function("CTOR_LIST","ORDER",a.join(`
`));return g(CACHED_CONSTRUCTORS[m],order)}function arrayDType(m){if(isBuffer(m))return"buffer";if(hasTypedArrays)switch(Object.prototype.toString.call(m)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(m)?"array":"generic"}var CACHED_CONSTRUCTORS={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function wrappedNDArrayCtor(m,t,n,r){if(m===void 0){var p=CACHED_CONSTRUCTORS.array[0];return p([])}else typeof m=="number"&&(m=[m]);t===void 0&&(t=[m.length]);var a=t.length;if(n===void 0){n=new Array(a);for(var u=a-1,h=1;u>=0;--u)n[u]=h,h*=t[u]}if(r===void 0){r=0;for(var u=0;u<a;++u)n[u]<0&&(r-=(t[u]-1)*n[u])}for(var f=arrayDType(m),d=CACHED_CONSTRUCTORS[f];d.length<=a+1;)d.push(compileConstructor(f,d.length-1));var p=d[a+1];return p(m,t,n,r)}var ndarray=wrappedNDArrayCtor;const ndarray$1=getDefaultExportFromCjs(ndarray);var ndarrayOps={};function unique_pred(m,t){for(var n=1,r=m.length,a=m[0],u=m[0],h=1;h<r;++h)if(u=a,a=m[h],t(a,u)){if(h===n){n++;continue}m[n++]=a}return m.length=n,m}function unique_eq(m){for(var t=1,n=m.length,r=m[0],a=m[0],u=1;u<n;++u,a=r)if(a=r,r=m[u],r!==a){if(u===t){t++;continue}m[t++]=r}return m.length=t,m}function unique(m,t,n){return m.length===0?m:t?(n||m.sort(t),unique_pred(m,t)):(n||m.sort(),unique_eq(m))}var uniq$1=unique,uniq=uniq$1;function innerFill(m,t,n){var r=m.length,a=t.arrayArgs.length,u=t.indexArgs.length>0,h=[],f=[],d=0,p=0,c,o;for(c=0;c<r;++c)f.push(["i",c,"=0"].join(""));for(o=0;o<a;++o)for(c=0;c<r;++c)p=d,d=m[c],c===0?f.push(["d",o,"s",c,"=t",o,"p",d].join("")):f.push(["d",o,"s",c,"=(t",o,"p",d,"-s",p,"*t",o,"p",p,")"].join(""));for(f.length>0&&h.push("var "+f.join(",")),c=r-1;c>=0;--c)d=m[c],h.push(["for(i",c,"=0;i",c,"<s",d,";++i",c,"){"].join(""));for(h.push(n),c=0;c<r;++c){for(p=d,d=m[c],o=0;o<a;++o)h.push(["p",o,"+=d",o,"s",c].join(""));u&&(c>0&&h.push(["index[",p,"]-=s",p].join("")),h.push(["++index[",d,"]"].join(""))),h.push("}")}return h.join(`
`)}function outerFill(m,t,n,r){for(var a=t.length,u=n.arrayArgs.length,h=n.blockSize,f=n.indexArgs.length>0,d=[],p=0;p<u;++p)d.push(["var offset",p,"=p",p].join(""));for(var p=m;p<a;++p)d.push(["for(var j"+p+"=SS[",t[p],"]|0;j",p,">0;){"].join("")),d.push(["if(j",p,"<",h,"){"].join("")),d.push(["s",t[p],"=j",p].join("")),d.push(["j",p,"=0"].join("")),d.push(["}else{s",t[p],"=",h].join("")),d.push(["j",p,"-=",h,"}"].join("")),f&&d.push(["index[",t[p],"]=j",p].join(""));for(var p=0;p<u;++p){for(var c=["offset"+p],o=m;o<a;++o)c.push(["j",o,"*t",p,"p",t[o]].join(""));d.push(["p",p,"=(",c.join("+"),")"].join(""))}d.push(innerFill(t,n,r));for(var p=m;p<a;++p)d.push("}");return d.join(`
`)}function countMatches(m){for(var t=0,n=m[0].length;t<n;){for(var r=1;r<m.length;++r)if(m[r][t]!==m[0][t])return t;++t}return t}function processBlock(m,t,n){for(var r=m.body,a=[],u=[],h=0;h<m.args.length;++h){var f=m.args[h];if(!(f.count<=0)){var d=new RegExp(f.name,"g"),p="",c=t.arrayArgs.indexOf(h);switch(t.argTypes[h]){case"offset":var o=t.offsetArgIndex.indexOf(h),e=t.offsetArgs[o];c=e.array,p="+q"+o;case"array":p="p"+c+p;var s="l"+h,l="a"+c;if(t.arrayBlockIndices[c]===0)f.count===1?n[c]==="generic"?f.lvalue?(a.push(["var ",s,"=",l,".get(",p,")"].join("")),r=r.replace(d,s),u.push([l,".set(",p,",",s,")"].join(""))):r=r.replace(d,[l,".get(",p,")"].join("")):r=r.replace(d,[l,"[",p,"]"].join("")):n[c]==="generic"?(a.push(["var ",s,"=",l,".get(",p,")"].join("")),r=r.replace(d,s),f.lvalue&&u.push([l,".set(",p,",",s,")"].join(""))):(a.push(["var ",s,"=",l,"[",p,"]"].join("")),r=r.replace(d,s),f.lvalue&&u.push([l,"[",p,"]=",s].join("")));else{for(var g=[f.name],y=[p],b=0;b<Math.abs(t.arrayBlockIndices[c]);b++)g.push("\\s*\\[([^\\]]+)\\]"),y.push("$"+(b+1)+"*t"+c+"b"+b);if(d=new RegExp(g.join(""),"g"),p=y.join("+"),n[c]==="generic")throw new Error("cwise: Generic arrays not supported in combination with blocks!");r=r.replace(d,[l,"[",p,"]"].join(""))}break;case"scalar":r=r.replace(d,"Y"+t.scalarArgs.indexOf(h));break;case"index":r=r.replace(d,"index");break;case"shape":r=r.replace(d,"shape");break}}}return[a.join(`
`),r,u.join(`
`)].join(`
`).trim()}function typeSummary(m){for(var t=new Array(m.length),n=!0,r=0;r<m.length;++r){var a=m[r],u=a.match(/\d+/);u?u=u[0]:u="",a.charAt(0)===0?t[r]="u"+a.charAt(1)+u:t[r]=a.charAt(0)+u,r>0&&(n=n&&t[r]===t[r-1])}return n?t[0]:t.join("")}function generateCWiseOp(m,t){for(var n=t[1].length-Math.abs(m.arrayBlockIndices[0])|0,r=new Array(m.arrayArgs.length),a=new Array(m.arrayArgs.length),u=0;u<m.arrayArgs.length;++u)a[u]=t[2*u],r[u]=t[2*u+1];for(var h=[],f=[],d=[],p=[],c=[],u=0;u<m.arrayArgs.length;++u){m.arrayBlockIndices[u]<0?(d.push(0),p.push(n),h.push(n),f.push(n+m.arrayBlockIndices[u])):(d.push(m.arrayBlockIndices[u]),p.push(m.arrayBlockIndices[u]+n),h.push(0),f.push(m.arrayBlockIndices[u]));for(var o=[],e=0;e<r[u].length;e++)d[u]<=r[u][e]&&r[u][e]<p[u]&&o.push(r[u][e]-d[u]);c.push(o)}for(var s=["SS"],l=["'use strict'"],g=[],e=0;e<n;++e)g.push(["s",e,"=SS[",e,"]"].join(""));for(var u=0;u<m.arrayArgs.length;++u){s.push("a"+u),s.push("t"+u),s.push("p"+u);for(var e=0;e<n;++e)g.push(["t",u,"p",e,"=t",u,"[",d[u]+e,"]"].join(""));for(var e=0;e<Math.abs(m.arrayBlockIndices[u]);++e)g.push(["t",u,"b",e,"=t",u,"[",h[u]+e,"]"].join(""))}for(var u=0;u<m.scalarArgs.length;++u)s.push("Y"+u);if(m.shapeArgs.length>0&&g.push("shape=SS.slice(0)"),m.indexArgs.length>0){for(var y=new Array(n),u=0;u<n;++u)y[u]="0";g.push(["index=[",y.join(","),"]"].join(""))}for(var u=0;u<m.offsetArgs.length;++u){for(var b=m.offsetArgs[u],_=[],e=0;e<b.offset.length;++e)b.offset[e]!==0&&(b.offset[e]===1?_.push(["t",b.array,"p",e].join("")):_.push([b.offset[e],"*t",b.array,"p",e].join("")));_.length===0?g.push("q"+u+"=0"):g.push(["q",u,"=",_.join("+")].join(""))}var v=uniq([].concat(m.pre.thisVars).concat(m.body.thisVars).concat(m.post.thisVars));g=g.concat(v),g.length>0&&l.push("var "+g.join(","));for(var u=0;u<m.arrayArgs.length;++u)l.push("p"+u+"|=0");m.pre.body.length>3&&l.push(processBlock(m.pre,m,a));var T=processBlock(m.body,m,a),w=countMatches(c);w<n?l.push(outerFill(w,c[0],m,T)):l.push(innerFill(c[0],m,T)),m.post.body.length>3&&l.push(processBlock(m.post,m,a)),m.debug&&console.log("-----Generated cwise routine for ",t,`:
`+l.join(`
`)+`
----------`);var A=[m.funcName||"unnamed","_cwise_loop_",r[0].join("s"),"m",w,typeSummary(a)].join(""),S=new Function(["function ",A,"(",s.join(","),"){",l.join(`
`),"} return ",A].join(""));return S()}var compile$1=generateCWiseOp,compile=compile$1;function createThunk$1(m){var t=["'use strict'","var CACHED={}"],n=[],r=m.funcName+"_cwise_thunk";t.push(["return function ",r,"(",m.shimArgs.join(","),"){"].join(""));for(var a=[],u=[],h=[["array",m.arrayArgs[0],".shape.slice(",Math.max(0,m.arrayBlockIndices[0]),m.arrayBlockIndices[0]<0?","+m.arrayBlockIndices[0]+")":")"].join("")],f=[],d=[],p=0;p<m.arrayArgs.length;++p){var c=m.arrayArgs[p];n.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join("")),a.push("t"+c),a.push("r"+c),u.push("t"+c),u.push("r"+c+".join()"),h.push("array"+c+".data"),h.push("array"+c+".stride"),h.push("array"+c+".offset|0"),p>0&&(f.push("array"+m.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(m.arrayBlockIndices[0])-Math.abs(m.arrayBlockIndices[p]))),d.push("array"+m.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,m.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,m.arrayBlockIndices[p])+"]"))}m.arrayArgs.length>1&&(t.push("if (!("+f.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+m.arrayArgs[0]+".shape.length-"+Math.abs(m.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),t.push("if (!("+d.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}"));for(var p=0;p<m.scalarArgs.length;++p)h.push("scalar"+m.scalarArgs[p]);n.push(["type=[",u.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),t.push("var "+n.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",a.join(","),"])}","return proc(",h.join(","),")}"].join("")),m.debug&&console.log(`-----Generated thunk:
`+t.join(`
`)+`
----------`);var o=new Function("compile",t.join(`
`));return o(compile.bind(void 0,m))}var thunk=createThunk$1,createThunk=thunk;function Procedure(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function compileCwise(m){var t=new Procedure;t.pre=m.pre,t.body=m.body,t.post=m.post;var n=m.args.slice(0);t.argTypes=n;for(var r=0;r<n.length;++r){var a=n[r];if(a==="array"||typeof a=="object"&&a.blockIndices){if(t.argTypes[r]="array",t.arrayArgs.push(r),t.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),t.shimArgs.push("array"+r),r<t.pre.args.length&&t.pre.args[r].count>0)throw new Error("cwise: pre() block may not reference array args");if(r<t.post.args.length&&t.post.args[r].count>0)throw new Error("cwise: post() block may not reference array args")}else if(a==="scalar")t.scalarArgs.push(r),t.shimArgs.push("scalar"+r);else if(a==="index"){if(t.indexArgs.push(r),r<t.pre.args.length&&t.pre.args[r].count>0)throw new Error("cwise: pre() block may not reference array index");if(r<t.body.args.length&&t.body.args[r].lvalue)throw new Error("cwise: body() block may not write to array index");if(r<t.post.args.length&&t.post.args[r].count>0)throw new Error("cwise: post() block may not reference array index")}else if(a==="shape"){if(t.shapeArgs.push(r),r<t.pre.args.length&&t.pre.args[r].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(r<t.body.args.length&&t.body.args[r].lvalue)throw new Error("cwise: body() block may not write to array shape");if(r<t.post.args.length&&t.post.args[r].lvalue)throw new Error("cwise: post() block may not write to array shape")}else if(typeof a=="object"&&a.offset)t.argTypes[r]="offset",t.offsetArgs.push({array:a.array,offset:a.offset}),t.offsetArgIndex.push(r);else throw new Error("cwise: Unknown argument type "+n[r])}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!m.printCode||!!m.debug,t.funcName=m.funcName||"cwise",t.blockSize=m.blockSize||64,createThunk(t)}var compiler=compileCwise;(function(m){var t=compiler,n={body:"",args:[],thisVars:[],localVars:[]};function r(e){if(!e)return n;for(var s=0;s<e.args.length;++s){var l=e.args[s];s===0?e.args[s]={name:l,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:e.args[s]={name:l,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function a(e){return t({args:e.args,pre:r(e.pre),body:r(e.body),post:r(e.proc),funcName:e.funcName})}function u(e){for(var s=[],l=0;l<e.args.length;++l)s.push("a"+l);var g=new Function("P",["return function ",e.funcName,"_ndarrayops(",s.join(","),") {P(",s.join(","),");return a0}"].join(""));return g(a(e))}var h={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var e in h){var s=h[e];m[e]=u({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+s+"c"},funcName:e}),m[e+"eq"]=u({args:["array","array"],body:{args:["a","b"],body:"a"+s+"=b"},rvalue:!0,funcName:e+"eq"}),m[e+"s"]=u({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+s+"s"},funcName:e+"s"}),m[e+"seq"]=u({args:["array","scalar"],body:{args:["a","s"],body:"a"+s+"=s"},rvalue:!0,funcName:e+"seq"})}})();var f={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var e in f){var s=f[e];m[e]=u({args:["array","array"],body:{args:["a","b"],body:"a="+s+"b"},funcName:e}),m[e+"eq"]=u({args:["array"],body:{args:["a"],body:"a="+s+"a"},rvalue:!0,count:2,funcName:e+"eq"})}})();var d={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var e in d){var s=d[e];m[e]=u({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+s+"c"},funcName:e}),m[e+"s"]=u({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+s+"s"},funcName:e+"s"}),m[e+"eq"]=u({args:["array","array"],body:{args:["a","b"],body:"a=a"+s+"b"},rvalue:!0,count:2,funcName:e+"eq"}),m[e+"seq"]=u({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+s+"s"},rvalue:!0,count:2,funcName:e+"seq"})}})();var p=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var e=0;e<p.length;++e){var s=p[e];m[s]=u({args:["array","array"],pre:{args:[],body:"this_f=Math."+s,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:s}),m[s+"eq"]=u({args:["array"],pre:{args:[],body:"this_f=Math."+s,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:s+"eq"})}})();var c=["max","min","atan2","pow"];(function(){for(var e=0;e<c.length;++e){var s=c[e];m[s]=u({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+s,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:s}),m[s+"s"]=u({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+s,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:s+"s"}),m[s+"eq"]=u({args:["array","array"],pre:{args:[],body:"this_f=Math."+s,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:s+"eq"}),m[s+"seq"]=u({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+s,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:s+"seq"})}})();var o=["atan2","pow"];(function(){for(var e=0;e<o.length;++e){var s=o[e];m[s+"op"]=u({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+s,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:s+"op"}),m[s+"ops"]=u({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+s,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:s+"ops"}),m[s+"opeq"]=u({args:["array","array"],pre:{args:[],body:"this_f=Math."+s,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:s+"opeq"}),m[s+"opseq"]=u({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+s,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:s+"opseq"})}})(),m.any=t({args:["array"],pre:n,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),m.all=t({args:["array"],pre:n,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),m.sum=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),m.prod=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),m.norm2squared=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),m.norm2=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),m.norminf=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),m.norm1=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),m.sup=t({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),m.inf=t({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),m.argmin=t({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),m.argmax=t({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),m.random=u({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),m.assign=u({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),m.assigns=u({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),m.equals=t({args:["array","array"],pre:n,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})})(ndarrayOps);const ops=getDefaultExportFromCjs(ndarrayOps);let mouseOnLight=!1;function setLightCtrlPanel(){const m=document.querySelector("#light");m.addEventListener("mousedown",t=>{console.log(`mousedown ${t}`),mouseOnLight=!0}),m.addEventListener("mouseup",t=>{console.log(`mouseup ${t}`),mouseOnLight=!1}),m.addEventListener("mouseout",t=>{console.log(`mouseout ${t}`),mouseOnLight=!1}),m.addEventListener("mousemove",t=>{if(!mouseOnLight)return;console.log("mousemove"),console.log(t);let n=.05*t.movementX,r=.05*t.movementY,a=Math.cos(r),u=Math.sin(r),h=Math.cos(n),f=Math.sin(n),[d,p,c]=light.position,o=h*d+u*f*p+a*f*c,e=a*p-u*c,s=-f*d+u*h*p+a*h*c;light.position=[o,e,s],console.log(light.position)})}function hex2rgb(m){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(m);return t?[parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255]:null}function rgb2hex(m){function t(h){let f=h.toString(16);return f.length==1?"0"+f:f}let[n,r,a]=m;return"#"+t(Number(Math.round(n*255)))+t(Number(Math.round(r*255)))+t(Number(Math.round(a*255)))}function setColorPickerPanel(){const m=document.querySelector("#light_color");m.value="#ffffff",m.addEventListener("change",n=>{window.light.color=hex2rgb(n.target.value)}),m.addEventListener("input",n=>{window.light.color=hex2rgb(n.target.value)});const t=document.querySelector("#ambient_color");t.value="#808080",t.addEventListener("change",n=>{window.light.ambient=hex2rgb(n.target.value)}),t.addEventListener("input",n=>{window.light.ambient=hex2rgb(n.target.value)})}function createStyleSliders(){const m=document.getElementById("style_std");for(let n=0;n<3;n++){const r=document.createElement("div");m.appendChild(r);const a=document.createElement("input");a.setAttribute("type","range"),a.setAttribute("min","0.0"),a.setAttribute("max","100.0"),a.setAttribute("step","any"),a.setAttribute("value","1.0"),r.appendChild(a);const u=document.createElement("input");u.setAttribute("type","number"),u.setAttribute("min","0.0"),u.setAttribute("max","100.0"),u.setAttribute("value","1.0"),u.setAttribute("step","any"),r.appendChild(u),a.addEventListener("input",h=>{u.value=h.target.value,window.style.std[n]=h.target.value}),a.addEventListener("change",h=>{u.value=h.target.value,window.style.std[n]=h.target.value}),u.addEventListener("change",h=>{a.value=h.target.value,window.style.std[n]=h.target.value})}const t=document.getElementById("style_mean");for(let n=0;n<3;n++){const r=document.createElement("div");t.appendChild(r);const a=document.createElement("input");a.setAttribute("type","range"),a.setAttribute("min","-50.0"),a.setAttribute("max","50.0"),a.setAttribute("step","any"),a.setAttribute("value","1.0"),r.appendChild(a);const u=document.createElement("input");u.setAttribute("type","number"),u.setAttribute("min","-50.0"),u.setAttribute("max","50.0"),u.setAttribute("value","1.0"),u.setAttribute("step","any"),r.appendChild(u),a.addEventListener("input",h=>{u.value=h.target.value,window.style.mean[n]=h.target.value}),a.addEventListener("change",h=>{u.value=h.target.value,window.style.mean[n]=h.target.value}),u.addEventListener("change",h=>{a.value=h.target.value,window.style.mean[n]=h.target.value})}}function updateStyle(){for(let m=0;m<3;m++){const t=document.getElementById("style_std").children[m];t.children[0].value=window.style.std[m],t.children[1].value=window.style.std[m];const n=document.getElementById("style_mean").children[m];n.children[0].value=window.style.mean[m],n.children[1].value=window.style.mean[m]}document.getElementById("light_color").value=rgb2hex(window.light.color),document.getElementById("ambient_color").value=rgb2hex(window.light.ambient)}function preProcess(m){const t=m.getImageData(0,0,m.canvas.width,m.canvas.height),{data:n,width:r,height:a}=t;console.log("data preprocess",r,a);const u=ndarray$1(new Float32Array(n),[r,a,4]),h=ndarray$1(new Float32Array(r*a*3),[1,3,r,a]);return ops.assign(h.pick(0,0,null,null),u.pick(null,null,0)),ops.assign(h.pick(0,1,null,null),u.pick(null,null,1)),ops.assign(h.pick(0,2,null,null),u.pick(null,null,2)),ops.divseq(h,255),new ort_minExports.Tensor("float32",h.data,[1,3,r,a])}function setTargetImageUploader(){const m=document.querySelector("#file"),n=document.querySelector("#imgCanvas").getContext("2d");m.onchange=function(r){let a=new Image(128,128);a.src=URL.createObjectURL(r.target.files[0]),a.onload=function(){console.log("image input size ",this.naturalWidth,this.naturalHeight),this.naturalWidth>this.naturalHeight?n.drawImage(this,(this.naturalWidth-this.naturalHeight)/2,0,this.naturalHeight,this.naturalHeight,0,0,this.width,this.height):n.drawImage(this,0,(this.naturalHeight-this.naturalWidth)/2,this.naturalWidth,this.naturalWidth,0,0,this.width,this.height),URL.revokeObjectURL(a.src);const u=preProcess(n);console.log(u),assets.session.run({input_0:u}).then(f=>{window.style.mean=f.style_mean.data,window.style.std=f.style_std.data,window.light.color=f.light_color.data,window.light.ambient=f.ambient_color.data,updateStyle()})}}}function prepareEvents(){setLightCtrlPanel(),setColorPickerPanel(),createStyleSliders(),setTargetImageUploader()}main();window.onload=m=>{prepareEvents()};async function main(){console.log("Hellow world?"),await loadAssets(),console.log(window.assets);const m=document.querySelector("#toon"),t=document.querySelector("#light"),n=m.parentElement,r=document.querySelector("#occlusion"),a=document.querySelector("#emission"),u=document.querySelector("#shininess"),f=document.querySelector("#glcanvas").getContext("webgl2");if(!f){alert("Unable to initialize WebGL. Your browser or machine may not support it.");return}setDefaults({attribPrefix:"a_"});const d=createProgramInfo(f,[vsSource,fsSource]),p=createProgramInfo(f,[vsSource,fsSphere]),c=createTextures(f,{albedo:{src:"resources/chocobunnyking_d.png"},occlusion:{src:"resources/chocobunnyking_o.png"},emission:{src:"resources/chocobunnyking_e.png"},shininess:{src:"resources/chocobunnyking_s.png"},white:{src:"resources/white.png"},black:{src:"resources/black.png"}}),o=createBufferInfoFromArrays(f,window.assets.objectBuffer),e=createBufferInfoFromArrays(f,window.assets.sphereBuffer),s=createVAOFromBufferInfo(f,d,o),l=createVAOFromBufferInfo(f,p,e),g=[0,0,0],y=[0,0,3],b=.1,_=50;function v(B){return B*Math.PI/180}const T=v(60),w=f.canvas.clientWidth/f.canvas.clientHeight,A=m4.perspective(T,w,b,_),S=[0,1,0],O=m4.lookAt(y,g,S),D={u_view:m4.inverse(O),u_projection:A,u_world:m4.identity(),u_albedo:c.albedo,u_occlusion:c.occlusion,u_emission:c.emission,u_shininess:c.shininess,u_lightPos:window.light.position,u_lightColor:window.light.color,u_ambientColor:window.light.ambient,u_styleMean:window.style.mean,u_styleStd:window.style.std},$=[{programInfo:d,bufferInfo:o,vertexArray:s,uniforms:D,element:m},{programInfo:p,bufferInfo:e,vertexArray:l,uniforms:D,element:t}];function L(B){f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT),f.useProgram(B.programInfo.program),f.bindVertexArray(B.vertexArray),setUniforms(B.programInfo,B.uniforms),drawBufferInfo(f,B.bufferInfo)}function P(B){B*=.001,resizeCanvasToDisplaySize(f.canvas),f.enable(f.DEPTH_TEST),f.enable(f.CULL_FACE),f.enable(f.SCISSOR_TEST),$.forEach(I=>{const M=I.element.getBoundingClientRect(),k=n.getBoundingClientRect(),X=M.width,G=M.height,J=M.left-k.left,Y=f.canvas.clientHeight-M.bottom+k.top;f.viewport(J,Y,X,G),f.scissor(J,Y,X,G),I.uniforms.u_world=m4.rotationY(B),I.uniforms.u_styleMean=style.mean,I.uniforms.u_styleStd=style.std,I.uniforms.u_lightColor=light.color,I.uniforms.u_ambientColor=light.ambient,I.uniforms.u_lightPos=light.position,I.uniforms.u_occlusion=r.checked?c.occlusion:c.white,I.uniforms.u_emission=a.checked?c.emission:c.black,I.uniforms.u_shininess=u.checked?c.shininess:c.black,L(I)}),requestAnimationFrame(P)}requestAnimationFrame(P)}
